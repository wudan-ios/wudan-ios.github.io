<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ä¸€ä¸ªå­¤ç‹¬çš„æ¬ç çŒ¿</title>
  
  <subtitle>è™½ç„¶ä»£ç è™æˆ‘åƒç™¾éï¼Œæˆ‘å¯¹ä»£ç å¦‚åˆæ‹ã€‚</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://wudan-ios.github.io/"/>
  <updated>2019-05-09T00:50:47.162Z</updated>
  <id>https://wudan-ios.github.io/</id>
  
  <author>
    <name>wudan</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title></title>
    <link href="https://wudan-ios.github.io/2019/05/09/iOS%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%A7%E4%BB%B6%EF%BC%9APopMenu/"/>
    <id>https://wudan-ios.github.io/2019/05/09/iOSè‡ªå®šä¹‰æ§ä»¶ï¼šPopMenu/</id>
    <published>2019-05-09T00:50:45.982Z</published>
    <updated>2019-05-09T00:50:47.162Z</updated>
    
    <content type="html"><![CDATA[<p>ç°åœ¨å¾ˆå¤šçš„åº”ç”¨éƒ½æœ‰ç±»ä¼¼çš„å¼¹çª—æ§ä»¶ï¼Œæœ€å‡ºååº”è¯¥æ˜¯ä¼é¹…å’Œå¾®ä¿¡äº†å§ã€‚æƒ³ç€ä¸ºäº†æ»¡è¶³è‡ªå·±çš„æ•ˆæœå°±åŠ¨æ‰‹å†™äº†è¿™ä¸ªã€‚é¦–å…ˆè¦æ„Ÿè°¢å†™å‡ºå¼¹çª—ç®­å¤´çš„ä»£ç çš„äºº<a href="https://github.com/iHandle/BubbleLayer" target="_blank" rel="noopener">iHandle</a>ï¼Œè¿™æ–¹é¢çš„çŸ¥è¯†æˆ‘å¾ˆæ¬ ç¼ºï¼Œä»¥åæ‰¾æœºä¼šæ¶è¡¥ä¸€ä¸‹ã€‚<br>å…ˆä¸Šä¸¤å¼ å‡ºåçš„æ•ˆæœå›¾ï¼š<br><img src="https://upload-images.jianshu.io/upload_images/3334769-4581178013f647fe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/375" alt="ğŸ§"></p><p><img src="https://upload-images.jianshu.io/upload_images/3334769-a4a9758369b0cfa6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/375" alt="å¾®ä¿¡"></p><h2 id="æ ·å¼å®šä¹‰"><a href="#æ ·å¼å®šä¹‰" class="headerlink" title="æ ·å¼å®šä¹‰"></a>æ ·å¼å®šä¹‰</h2><p>ä¸»è¦ä»¥UITableViewä½œä¸ºå®¹å™¨æ˜¾ç¤ºæ ·å¼</p><ol><li>èƒŒæ™¯é¢œè‰²</li><li>æ–‡å­—æ ·å¼ï¼šé¢œè‰²ï¼Œå­—ä½“å¤§å°ï¼Œå¯¹é½æ–¹å¼</li><li>æ˜¾ç¤ºç±»å‹ï¼šä»…æ–‡å­—ï¼Œä»…å›¾æ ‡ï¼Œæ–‡å­— + å›¾æ ‡</li><li>æ˜¯å¦æ˜¾ç¤ºä¸‹åˆ’çº¿</li><li>ç®­å¤´æ–¹å‘</li><li>å¼¹çª—å®½åº¦</li><li>å•å…ƒæ ¼çš„é«˜åº¦ </li></ol><h2 id="ç®­å¤´ç”Ÿæˆ"><a href="#ç®­å¤´ç”Ÿæˆ" class="headerlink" title="ç®­å¤´ç”Ÿæˆ"></a>ç®­å¤´ç”Ÿæˆ</h2><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSInteger</span>, ArrowDirection) &#123;</span><br><span class="line">    ArrowDirectionRight = <span class="number">0</span>,</span><br><span class="line">    ArrowDirectionBottom,</span><br><span class="line">    ArrowDirectionLeft,</span><br><span class="line">    ArrowDirectionTop,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#define CORNER_RADIUS   8   // é»˜è®¤çŸ©å½¢æ¡†åœ†è§’åŠå¾„</span></span><br><span class="line"><span class="meta">#define ARROW_WIDTH     30  // é»˜è®¤ç®­å¤´å®½å¸¦</span></span><br><span class="line"><span class="meta">#define ARROW_HEIGHT    12  // é»˜è®¤ç®­å¤´é«˜åº¦</span></span><br><span class="line"><span class="meta">#define ARROW_DIRECTION 1   // é»˜è®¤ç®­å¤´æ–¹å‘ï¼Œå‘ä¸‹</span></span><br><span class="line"><span class="meta">#define ARROW_POSITION  0.5 // é»˜è®¤ç®­å¤´ç›¸å¯¹ä½ç½®ï¼Œå±…ä¸­</span></span><br><span class="line"><span class="meta">#define ARROW_RADIUS    3   // é»˜è®¤ç®­å¤´æŒ‡å‘å¤„çš„åœ†è§’åŠå¾„</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">WudanLayer</span> : <span class="title">NSObject</span></span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">CGFloat</span> cornerRadius;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">CGFloat</span> arrowRadius;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">CGFloat</span> arrowHeight;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">CGFloat</span> arrowWidth;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) ArrowDirection arrowDirection;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">CGFloat</span> arrowPosition;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">CGSize</span> size;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">instancetype</span>)initWithSize:(<span class="built_in">CGSize</span>)size;</span><br><span class="line">- (<span class="built_in">CAShapeLayer</span> *)layer;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">WudanLayer</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - preparation</span></span><br><span class="line">- (<span class="built_in">NSMutableArray</span> *)keyPoints &#123;</span><br><span class="line">    <span class="built_in">NSMutableArray</span> *points = [<span class="built_in">NSMutableArray</span> array];</span><br><span class="line">    <span class="built_in">CGPoint</span> beginPoint;</span><br><span class="line">    <span class="built_in">CGPoint</span> topPoint;</span><br><span class="line">    <span class="built_in">CGPoint</span> endPoint;</span><br><span class="line">    <span class="built_in">CGFloat</span> validWidthForTopPoint = _size.width - <span class="number">2</span> * _cornerRadius - _arrowWidth;</span><br><span class="line">    <span class="built_in">CGFloat</span> validHeightForTopPoint = _size.height - <span class="number">2</span> * _cornerRadius - _arrowWidth;</span><br><span class="line">    <span class="built_in">CGFloat</span> x = <span class="number">0</span>, y = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">CGFloat</span> width = _size.width, height = _size.height;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">switch</span> (_arrowDirection)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">case</span> ArrowDirectionRight:</span><br><span class="line">        &#123;</span><br><span class="line">            width -= _arrowHeight;</span><br><span class="line">            topPoint = <span class="built_in">CGPointMake</span>(_size.width , _size.height / <span class="number">2</span> + validHeightForTopPoint*(_arrowPosition - <span class="number">0.5</span>));</span><br><span class="line">            beginPoint = <span class="built_in">CGPointMake</span>(topPoint.x - _arrowHeight, topPoint.y - _arrowWidth/<span class="number">2</span>);</span><br><span class="line">            endPoint = <span class="built_in">CGPointMake</span>(beginPoint.x, beginPoint.y + _arrowWidth);</span><br><span class="line">        &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> ArrowDirectionBottom:</span><br><span class="line">        &#123;</span><br><span class="line">            height -= _arrowHeight;</span><br><span class="line">            </span><br><span class="line">            topPoint = <span class="built_in">CGPointMake</span>(_size.width / <span class="number">2</span> + validWidthForTopPoint*(_arrowPosition - <span class="number">0.5</span>), _size.height);</span><br><span class="line">            beginPoint = <span class="built_in">CGPointMake</span>(topPoint.x + _arrowWidth/<span class="number">2</span>, topPoint.y - _arrowHeight);</span><br><span class="line">            endPoint = <span class="built_in">CGPointMake</span>(beginPoint.x - _arrowWidth, beginPoint.y);</span><br><span class="line">        &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> ArrowDirectionLeft:</span><br><span class="line">        &#123;</span><br><span class="line">            x = _arrowHeight;</span><br><span class="line">            width -= _arrowHeight;</span><br><span class="line">            </span><br><span class="line">            topPoint = <span class="built_in">CGPointMake</span>(<span class="number">0</span>, _size.height / <span class="number">2</span> + validHeightForTopPoint*(_arrowPosition - <span class="number">0.5</span>));</span><br><span class="line">            beginPoint = <span class="built_in">CGPointMake</span>(topPoint.x + _arrowHeight, topPoint.y + _arrowWidth/<span class="number">2</span>);</span><br><span class="line">            endPoint = <span class="built_in">CGPointMake</span>(beginPoint.x, beginPoint.y - _arrowWidth);</span><br><span class="line">        &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> ArrowDirectionTop:</span><br><span class="line">        &#123;</span><br><span class="line">            y = _arrowHeight;</span><br><span class="line">            height -= _arrowHeight;</span><br><span class="line">            </span><br><span class="line">            topPoint = <span class="built_in">CGPointMake</span>(_size.width / <span class="number">2</span> + validWidthForTopPoint*(_arrowPosition - <span class="number">0.5</span>), <span class="number">0</span>);</span><br><span class="line">            beginPoint = <span class="built_in">CGPointMake</span>(topPoint.x - _arrowWidth/<span class="number">2</span>, topPoint.y + _arrowHeight);</span><br><span class="line">            endPoint = <span class="built_in">CGPointMake</span>(beginPoint.x + _arrowWidth, beginPoint.y);</span><br><span class="line">        &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    points = [<span class="built_in">NSMutableArray</span> arrayWithObjects: [<span class="built_in">NSValue</span> valueWithCGPoint:beginPoint],</span><br><span class="line">              [<span class="built_in">NSValue</span> valueWithCGPoint:topPoint],</span><br><span class="line">              [<span class="built_in">NSValue</span> valueWithCGPoint:endPoint],</span><br><span class="line">              <span class="literal">nil</span>];</span><br><span class="line">    <span class="built_in">CGPoint</span> bottomRight = <span class="built_in">CGPointMake</span>(x + width, y + height);</span><br><span class="line">    <span class="built_in">CGPoint</span> bottomLeft = <span class="built_in">CGPointMake</span>(x, y + height);</span><br><span class="line">    <span class="built_in">CGPoint</span> topLeft = <span class="built_in">CGPointMake</span>(x, y);</span><br><span class="line">    <span class="built_in">CGPoint</span> topRight = <span class="built_in">CGPointMake</span>(x + width, y);</span><br><span class="line">    <span class="built_in">NSMutableArray</span> *rectPoints = [<span class="built_in">NSMutableArray</span> arrayWithObjects: [<span class="built_in">NSValue</span> valueWithCGPoint:bottomRight],</span><br><span class="line">                                  [<span class="built_in">NSValue</span> valueWithCGPoint:bottomLeft],</span><br><span class="line">                                  [<span class="built_in">NSValue</span> valueWithCGPoint:topLeft],</span><br><span class="line">                                  [<span class="built_in">NSValue</span> valueWithCGPoint:topRight],</span><br><span class="line">                                  <span class="literal">nil</span>];</span><br><span class="line">    <span class="keyword">int</span> rectPointIndex = (<span class="keyword">int</span>)_arrowDirection;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">        [points addObject:[rectPoints objectAtIndex:rectPointIndex]];</span><br><span class="line">        rectPointIndex = (rectPointIndex + <span class="number">1</span>) % <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> points;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - Draw bubblePath</span></span><br><span class="line">- (<span class="built_in">CGPathRef</span>)bubblePath &#123;</span><br><span class="line">    <span class="built_in">UIGraphicsBeginImageContextWithOptions</span>(<span class="keyword">self</span>.size, <span class="literal">NO</span>, <span class="number">0.0</span>);</span><br><span class="line">    <span class="built_in">CGContextRef</span> ctx = <span class="built_in">UIGraphicsGetCurrentContext</span>();</span><br><span class="line">    <span class="built_in">NSMutableArray</span> *points = [<span class="keyword">self</span> keyPoints];</span><br><span class="line">    <span class="built_in">CGPoint</span> currentPoint = [[points objectAtIndex:<span class="number">6</span>] <span class="built_in">CGPointValue</span>];</span><br><span class="line">    <span class="built_in">CGContextMoveToPoint</span>(ctx, currentPoint.x, currentPoint.y);</span><br><span class="line">    <span class="built_in">CGPoint</span> pointA, pointB;</span><br><span class="line">    <span class="built_in">CGFloat</span> radius;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt; <span class="number">6</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        radius = i &lt; <span class="number">3</span> ?  _arrowRadius : _cornerRadius;</span><br><span class="line">        pointA = [[points objectAtIndex:i] <span class="built_in">CGPointValue</span>];</span><br><span class="line">        pointB = [[points objectAtIndex:(i + <span class="number">1</span>) % <span class="number">7</span>] <span class="built_in">CGPointValue</span>];</span><br><span class="line">        <span class="built_in">CGContextAddArcToPoint</span>(ctx, pointA.x, pointA.y, pointB.x, pointB.y, radius);</span><br><span class="line">        i = i + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">CGContextClosePath</span>(ctx);</span><br><span class="line">    <span class="built_in">CGPathRef</span> path = <span class="built_in">CGContextCopyPath</span>(ctx);</span><br><span class="line">    <span class="built_in">CGContextRelease</span>(ctx);</span><br><span class="line">    <span class="keyword">return</span> path;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">CAShapeLayer</span> *)layer&#123;</span><br><span class="line">    <span class="built_in">CAShapeLayer</span> *layer = [<span class="built_in">CAShapeLayer</span> layer];</span><br><span class="line">    layer.path = [<span class="keyword">self</span> bubblePath];</span><br><span class="line">    <span class="keyword">return</span> layer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - Setup</span></span><br><span class="line">- (<span class="keyword">void</span>)setDefaultProperty &#123;</span><br><span class="line">    _cornerRadius   = CORNER_RADIUS;</span><br><span class="line">    _arrowWidth     = ARROW_WIDTH;</span><br><span class="line">    _arrowHeight    = ARROW_HEIGHT;</span><br><span class="line">    _arrowDirection = ARROW_DIRECTION;</span><br><span class="line">    _arrowPosition  = ARROW_POSITION;</span><br><span class="line">    _arrowRadius    = ARROW_RADIUS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - Init</span></span><br><span class="line">- (<span class="keyword">instancetype</span>)initWithSize:(<span class="built_in">CGSize</span>)size &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">self</span> = [<span class="keyword">super</span> init]) &#123;</span><br><span class="line">        [<span class="keyword">self</span> setDefaultProperty];</span><br><span class="line">        _size = size;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><h2 id="å•å…ƒæ ¼é»˜è®¤æ ·å¼"><a href="#å•å…ƒæ ¼é»˜è®¤æ ·å¼" class="headerlink" title="å•å…ƒæ ¼é»˜è®¤æ ·å¼"></a>å•å…ƒæ ¼é»˜è®¤æ ·å¼</h2><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSInteger</span>, WDPopMenuType) &#123;</span><br><span class="line">    WDPopMenuTypeNormal,</span><br><span class="line">    WDPopMenuTypeOnlyTitle,</span><br><span class="line">    WDPopMenuTypeOnlyIcon,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">WDPopMenuCell</span> : <span class="title">UITableViewCell</span></span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">UIImageView</span> *iconImageView;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">UILabel</span> *titleLabel;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) WDPopMenuType showType;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">WDPopMenuCell</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">instancetype</span>)initWithStyle:(<span class="built_in">UITableViewCellStyle</span>)style reuseIdentifier:(<span class="built_in">NSString</span> *)reuseIdentifier &#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> initWithStyle:style reuseIdentifier:reuseIdentifier];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">        [<span class="keyword">self</span> setupSubViewsProperties];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setupSubViewsProperties &#123;</span><br><span class="line">    <span class="keyword">self</span>.iconImageView                                           = [[<span class="built_in">UIImageView</span> alloc] init];</span><br><span class="line">    <span class="keyword">self</span>.iconImageView.contentMode                               = <span class="built_in">UIViewContentModeScaleAspectFit</span>;</span><br><span class="line">    <span class="keyword">self</span>.iconImageView.translatesAutoresizingMaskIntoConstraints = <span class="literal">NO</span>;</span><br><span class="line">    [<span class="keyword">self</span>.contentView addSubview:<span class="keyword">self</span>.iconImageView];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">self</span>.titleLabel                                              = [[<span class="built_in">UILabel</span> alloc] init];</span><br><span class="line">    <span class="keyword">self</span>.titleLabel.font                                         = [<span class="built_in">UIFont</span> systemFontOfSize:<span class="number">15</span>];</span><br><span class="line">    <span class="keyword">self</span>.titleLabel.textColor                                    = [<span class="built_in">UIColor</span> blackColor];</span><br><span class="line">    <span class="keyword">self</span>.titleLabel.translatesAutoresizingMaskIntoConstraints    = <span class="literal">NO</span>;</span><br><span class="line">    [<span class="keyword">self</span>.contentView addSubview:<span class="keyword">self</span>.titleLabel];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setShowType:(WDPopMenuType)showType &#123;</span><br><span class="line">    _showType = showType;</span><br><span class="line">    [<span class="keyword">self</span> setupSubViewsConstraint];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setTitleLabel:(<span class="built_in">UILabel</span> *)titleLabel &#123;</span><br><span class="line">    _titleLabel = titleLabel;</span><br><span class="line">    titleLabel.translatesAutoresizingMaskIntoConstraints = <span class="literal">NO</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setupSubViewsConstraint &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.showType == WDPopMenuTypeNormal) &#123;</span><br><span class="line">        <span class="keyword">self</span>.titleLabel.textAlignment = <span class="built_in">NSTextAlignmentLeft</span>;</span><br><span class="line">        </span><br><span class="line">        [<span class="keyword">self</span>.contentView addConstraints:@[</span><br><span class="line">                                           [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:<span class="keyword">self</span>.iconImageView attribute:<span class="built_in">NSLayoutAttributeLeading</span> relatedBy:<span class="built_in">NSLayoutRelationEqual</span> toItem:<span class="keyword">self</span>.contentView attribute:<span class="built_in">NSLayoutAttributeLeading</span> multiplier:<span class="number">1</span> constant:<span class="number">15</span>],</span><br><span class="line">                                           [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:<span class="keyword">self</span>.iconImageView attribute:<span class="built_in">NSLayoutAttributeCenterY</span> relatedBy:<span class="built_in">NSLayoutRelationEqual</span> toItem:<span class="keyword">self</span>.contentView attribute:<span class="built_in">NSLayoutAttributeCenterY</span> multiplier:<span class="number">1</span> constant:<span class="number">0</span>],</span><br><span class="line">                                           ]];</span><br><span class="line">        </span><br><span class="line">        [<span class="keyword">self</span>.contentView addConstraints:@[</span><br><span class="line">                                           [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:<span class="keyword">self</span>.titleLabel attribute:<span class="built_in">NSLayoutAttributeLeading</span> relatedBy:<span class="built_in">NSLayoutRelationEqual</span> toItem:<span class="keyword">self</span>.iconImageView attribute:<span class="built_in">NSLayoutAttributeTrailing</span> multiplier:<span class="number">1</span> constant:<span class="number">10</span>],</span><br><span class="line">                                           [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:<span class="keyword">self</span>.titleLabel attribute:<span class="built_in">NSLayoutAttributeCenterY</span> relatedBy:<span class="built_in">NSLayoutRelationEqual</span> toItem:<span class="keyword">self</span>.contentView attribute:<span class="built_in">NSLayoutAttributeCenterY</span> multiplier:<span class="number">1</span> constant:<span class="number">0</span>],</span><br><span class="line">                                           ]];</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">self</span>.showType == WDPopMenuTypeOnlyTitle)&#123;</span><br><span class="line">        <span class="keyword">self</span>.titleLabel.textAlignment = <span class="built_in">NSTextAlignmentCenter</span>;</span><br><span class="line">        [<span class="keyword">self</span>.contentView addConstraints:@[</span><br><span class="line">                                           [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:<span class="keyword">self</span>.titleLabel attribute:<span class="built_in">NSLayoutAttributeCenterX</span> relatedBy:<span class="built_in">NSLayoutRelationEqual</span> toItem:<span class="keyword">self</span>.contentView attribute:<span class="built_in">NSLayoutAttributeCenterX</span> multiplier:<span class="number">1</span> constant:<span class="number">0</span>],</span><br><span class="line">                                           [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:<span class="keyword">self</span>.titleLabel attribute:<span class="built_in">NSLayoutAttributeCenterY</span> relatedBy:<span class="built_in">NSLayoutRelationEqual</span> toItem:<span class="keyword">self</span>.contentView attribute:<span class="built_in">NSLayoutAttributeCenterY</span> multiplier:<span class="number">1</span> constant:<span class="number">0</span>],</span><br><span class="line">                                           ]];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        [<span class="keyword">self</span>.contentView addConstraints:@[</span><br><span class="line">                                           [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:<span class="keyword">self</span>.iconImageView attribute:<span class="built_in">NSLayoutAttributeCenterX</span> relatedBy:<span class="built_in">NSLayoutRelationEqual</span> toItem:<span class="keyword">self</span>.contentView attribute:<span class="built_in">NSLayoutAttributeCenterX</span> multiplier:<span class="number">1</span> constant:<span class="number">0</span>],</span><br><span class="line">                                           [<span class="built_in">NSLayoutConstraint</span> constraintWithItem:<span class="keyword">self</span>.iconImageView attribute:<span class="built_in">NSLayoutAttributeCenterY</span> relatedBy:<span class="built_in">NSLayoutRelationEqual</span> toItem:<span class="keyword">self</span>.contentView attribute:<span class="built_in">NSLayoutAttributeCenterY</span> multiplier:<span class="number">1</span> constant:<span class="number">0</span>],</span><br><span class="line">                                           ]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><h2 id="æ¥å£ä»£ç "><a href="#æ¥å£ä»£ç " class="headerlink" title="æ¥å£ä»£ç "></a>æ¥å£ä»£ç </h2><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">NS_ASSUME_NONNULL_BEGIN</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">WDPopMenu</span> : <span class="title">UIView</span></span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>, <span class="keyword">readonly</span>) <span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *titles;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>, <span class="keyword">readonly</span>) <span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *iconImageNames;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> ä»…æ˜¾ç¤ºå›¾æ ‡ + é»˜è®¤æ ·å¼</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> @param iconImageNames å›¾æ ‡æ•°ç»„</span></span><br><span class="line"><span class="comment"> @param position åˆå§‹ä½ç½®</span></span><br><span class="line"><span class="comment"> @param complete ç‚¹å‡»å›è°ƒ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">+ (<span class="keyword">void</span>)showPopMenuWithIconImageNames:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *)iconImageNames</span><br><span class="line">                       originPosition:(<span class="built_in">CGPoint</span>)position</span><br><span class="line">                 selectedItemComplete:(<span class="keyword">void</span>(^)(<span class="built_in">NSInteger</span> currentIndex))complete;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> ä»…æ˜¾ç¤ºå›¾æ ‡ + é»˜è®¤æ ·å¼</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> @param iconImageNames å›¾æ ‡æ•°ç»„</span></span><br><span class="line"><span class="comment"> @param position åˆå§‹ä½ç½®</span></span><br><span class="line"><span class="comment"> @param isNeedSeparatorLine æ˜¯å¦æ˜¾ç¤ºåˆ†å‰²çº¿</span></span><br><span class="line"><span class="comment"> @param complete ç‚¹å‡»å›è°ƒ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">+ (<span class="keyword">void</span>)showPopMenuWithIconImageNames:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *)iconImageNames</span><br><span class="line">                       originPosition:(<span class="built_in">CGPoint</span>)position</span><br><span class="line">                    needSeparatorLine:(<span class="built_in">BOOL</span>)isNeedSeparatorLine</span><br><span class="line">                 selectedItemComplete:(<span class="keyword">void</span>(^)(<span class="built_in">NSInteger</span> currentIndex))complete;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> ä»…æ˜¾ç¤ºæ ‡é¢˜ + é»˜è®¤æ ·å¼</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> @param titles æ ‡é¢˜æ•°ç»„</span></span><br><span class="line"><span class="comment"> @param position åˆå§‹ä½ç½®</span></span><br><span class="line"><span class="comment"> @param complete ç‚¹å‡»å›è°ƒ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">+ (<span class="keyword">void</span>)showPopMenuWithTitles:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *)titles</span><br><span class="line">               originPosition:(<span class="built_in">CGPoint</span>)position</span><br><span class="line">         selectedItemComplete:(<span class="keyword">void</span>(^)(<span class="built_in">NSInteger</span> currentIndex))complete;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> ä»…æ˜¾ç¤ºæ ‡é¢˜ + é»˜è®¤æ ·å¼</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> @param titles æ ‡é¢˜æ•°ç»„</span></span><br><span class="line"><span class="comment"> @param position åˆå§‹ä½ç½®</span></span><br><span class="line"><span class="comment"> @param isNeedSeparatorLine æ˜¯å¦æ˜¾ç¤ºåˆ†å‰²çº¿</span></span><br><span class="line"><span class="comment"> @param complete ç‚¹å‡»å›è°ƒ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">+ (<span class="keyword">void</span>)showPopMenuWithTitles:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *)titles</span><br><span class="line">               originPosition:(<span class="built_in">CGPoint</span>)position</span><br><span class="line">            needSeparatorLine:(<span class="built_in">BOOL</span>)isNeedSeparatorLine</span><br><span class="line">         selectedItemComplete:(<span class="keyword">void</span>(^)(<span class="built_in">NSInteger</span> currentIndex))complete;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> æ˜¾ç¤ºæ–‡å­—å’Œå›¾æ ‡ + é»˜è®¤æ ·å¼</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> @param iconImageNames å›¾æ ‡æ•°ç»„</span></span><br><span class="line"><span class="comment"> @param titles æ ‡é¢˜æ•°ç»„</span></span><br><span class="line"><span class="comment"> @param position åˆå§‹ä½ç½®</span></span><br><span class="line"><span class="comment"> @param complete ç‚¹å‡»å›è°ƒ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">+ (<span class="keyword">void</span>)showPopMenuWithIconImageNames:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; * _Nullable)iconImageNames</span><br><span class="line">                               titles:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; * _Nullable)titles</span><br><span class="line">                       originPosition:(<span class="built_in">CGPoint</span>)position</span><br><span class="line">                 selectedItemComplete:(<span class="keyword">void</span>(^)(<span class="built_in">NSInteger</span> currentIndex))complete;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> æ˜¾ç¤ºæ–‡å­—å’Œå›¾æ ‡ + é»˜è®¤æ ·å¼</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> @param iconImageNames å›¾æ ‡æ•°ç»„</span></span><br><span class="line"><span class="comment"> @param titles æ ‡é¢˜æ•°ç»„</span></span><br><span class="line"><span class="comment"> @param position åˆå§‹ä½ç½®</span></span><br><span class="line"><span class="comment"> @param isNeedSeparatorLine æ˜¯å¦æ˜¾ç¤ºåˆ†å‰²çº¿</span></span><br><span class="line"><span class="comment"> @param complete ç‚¹å‡»å›è°ƒ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">+ (<span class="keyword">void</span>)showPopMenuWithIconImageNames:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; * _Nullable)iconImageNames</span><br><span class="line">                               titles:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; * _Nullable)titles</span><br><span class="line">                       originPosition:(<span class="built_in">CGPoint</span>)position</span><br><span class="line">                    needSeparatorLine:(<span class="built_in">BOOL</span>)isNeedSeparatorLine</span><br><span class="line">                 selectedItemComplete:(<span class="keyword">void</span>(^)(<span class="built_in">NSInteger</span> currentIndex))complete;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> å¯é€‰æ˜¾ç¤ºå›¾æ ‡ã€æ ‡é¢˜</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> @param iconImageNames å›¾ç‰‡æ•°ç»„ å¯ä»¥ä¸ºç©º</span></span><br><span class="line"><span class="comment"> @param titles æ ‡é¢˜æ•°ç»„ å¯ä»¥ä¸ºç©º</span></span><br><span class="line"><span class="comment"> @param position åˆå§‹ä½ç½®</span></span><br><span class="line"><span class="comment"> @param height å•ä¸ªitemé«˜åº¦ é»˜è®¤ä¸º45</span></span><br><span class="line"><span class="comment"> @param width æ˜¾ç¤ºViewçš„é«˜åº¦ é»˜è®¤ä¸ºå±å¹•å®½åº¦çš„ä¸€åŠ</span></span><br><span class="line"><span class="comment"> @param color æ˜¾ç¤ºViewçš„èƒŒæ™¯é¢œè‰²</span></span><br><span class="line"><span class="comment"> @param isNeedSeparatorLine æ˜¯å¦æ˜¾ç¤ºåˆ†å‰²çº¿</span></span><br><span class="line"><span class="comment"> @param complete ç‚¹å‡»å›è°ƒ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">+ (<span class="keyword">void</span>)showPopMenuWithIconImageNames:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; * _Nullable)iconImageNames</span><br><span class="line">                               titles:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; * _Nullable)titles</span><br><span class="line">                       originPosition:(<span class="built_in">CGPoint</span>)position</span><br><span class="line">                         heightOfItem:(<span class="built_in">CGFloat</span>)height</span><br><span class="line">                          widthOfView:(<span class="built_in">CGFloat</span>)width</span><br><span class="line">                backgroundColorOfView:(<span class="built_in">UIColor</span> *)color</span><br><span class="line">                    needSeparatorLine:(<span class="built_in">BOOL</span>)isNeedSeparatorLine</span><br><span class="line">                 selectedItemComplete:(<span class="keyword">void</span>(^)(<span class="built_in">NSInteger</span> currentIndex))complete;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> å¯é€‰æ˜¾ç¤ºå›¾æ ‡ã€æ ‡é¢˜</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> @param iconImageNames å›¾ç‰‡æ•°ç»„ å¯ä»¥ä¸ºç©º</span></span><br><span class="line"><span class="comment"> @param titles æ ‡é¢˜æ•°ç»„ å¯ä»¥ä¸ºç©º</span></span><br><span class="line"><span class="comment"> @param position åˆå§‹ä½ç½®</span></span><br><span class="line"><span class="comment"> @param height å•ä¸ªitemé«˜åº¦ é»˜è®¤ä¸º45</span></span><br><span class="line"><span class="comment"> @param width æ˜¾ç¤ºViewçš„é«˜åº¦ é»˜è®¤ä¸ºå±å¹•å®½åº¦çš„ä¸€åŠ</span></span><br><span class="line"><span class="comment"> @param color æ˜¾ç¤ºViewçš„èƒŒæ™¯é¢œè‰²</span></span><br><span class="line"><span class="comment"> @param isNeedSeparatorLine æ˜¯å¦æ˜¾ç¤ºåˆ†å‰²çº¿</span></span><br><span class="line"><span class="comment"> @param titleLabel è‡ªå®šä¹‰Itemçš„Labelæ ·å¼</span></span><br><span class="line"><span class="comment"> @param complete ç‚¹å‡»å›è°ƒ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">+ (<span class="keyword">void</span>)showPopMenuWithIconImageNames:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; * _Nullable)iconImageNames</span><br><span class="line">                               titles:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; * _Nullable)titles</span><br><span class="line">                       originPosition:(<span class="built_in">CGPoint</span>)position</span><br><span class="line">                         heightOfItem:(<span class="built_in">CGFloat</span>)height</span><br><span class="line">                          widthOfView:(<span class="built_in">CGFloat</span>)width</span><br><span class="line">                backgroundColorOfView:(<span class="built_in">UIColor</span> *)color</span><br><span class="line">                     titleLabelOfItem:(<span class="built_in">UILabel</span> * _Nullable)titleLabel</span><br><span class="line">                    needSeparatorLine:(<span class="built_in">BOOL</span>)isNeedSeparatorLine</span><br><span class="line">                 selectedItemComplete:(<span class="keyword">void</span>(^)(<span class="built_in">NSInteger</span> currentIndex))complete;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">NS_ASSUME_NONNULL_END</span></span><br></pre></td></tr></table></figure><h2 id="å®ç°ä»£ç "><a href="#å®ç°ä»£ç " class="headerlink" title="å®ç°ä»£ç "></a>å®ç°ä»£ç </h2><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#define WD_SCREEN_WIDTH ([[UIScreen mainScreen] bounds].size.width)</span></span><br><span class="line"><span class="meta">#define WD_SCREEN_HEIGHT ([[UIScreen mainScreen] bounds].size.height)</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">WDPopMenu</span> () &lt;<span class="title">UITableViewDataSource</span>, <span class="title">UITableViewDelegate</span>&gt;</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="keyword">void</span> (^selectedItemComplete)(<span class="built_in">NSInteger</span> currentIndex);</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">UIView</span> *backgroundView;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">UITableView</span> *tableView;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">UILabel</span> *titleLabel;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">CGFloat</span> viewWidth;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">CGFloat</span> itemHeight;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">CGPoint</span> beginPosition;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">UIColor</span> *cellColor;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>, <span class="keyword">readwrite</span>) <span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *titles;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>, <span class="keyword">readwrite</span>) <span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *iconImageNames;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">WDPopMenu</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">instancetype</span>)init &#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">        [<span class="keyword">self</span> addSubview:<span class="keyword">self</span>.tableView];</span><br><span class="line">        <span class="built_in">UITapGestureRecognizer</span> *tap = [[<span class="built_in">UITapGestureRecognizer</span> alloc] initWithTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(backgroundTappedTarget:)];</span><br><span class="line">        [<span class="keyword">self</span>.backgroundView addGestureRecognizer:tap];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)showPopMenuWithIconImageNames:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *)iconImageNames</span><br><span class="line">                       originPosition:(<span class="built_in">CGPoint</span>)position</span><br><span class="line">                 selectedItemComplete:(<span class="keyword">void</span>(^)(<span class="built_in">NSInteger</span> currentIndex))complete &#123;</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span> showPopMenuWithIconImageNames:iconImageNames</span><br><span class="line">                         originPosition:position</span><br><span class="line">                      needSeparatorLine:<span class="literal">YES</span></span><br><span class="line">                   selectedItemComplete:complete];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)showPopMenuWithIconImageNames:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *)iconImageNames</span><br><span class="line">                       originPosition:(<span class="built_in">CGPoint</span>)position</span><br><span class="line">                    needSeparatorLine:(<span class="built_in">BOOL</span>)isNeedSeparatorLine</span><br><span class="line">                 selectedItemComplete:(<span class="keyword">void</span>(^)(<span class="built_in">NSInteger</span> currentIndex))complete &#123;</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span> showPopMenuWithIconImageNames:iconImageNames</span><br><span class="line">                                 titles:<span class="literal">nil</span></span><br><span class="line">                         originPosition:position</span><br><span class="line">                      needSeparatorLine:isNeedSeparatorLine</span><br><span class="line">                   selectedItemComplete:complete];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)showPopMenuWithTitles:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *)titles</span><br><span class="line">               originPosition:(<span class="built_in">CGPoint</span>)position</span><br><span class="line">         selectedItemComplete:(<span class="keyword">void</span>(^)(<span class="built_in">NSInteger</span> currentIndex))complete &#123;</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span> showPopMenuWithTitles:titles</span><br><span class="line">                 originPosition:position</span><br><span class="line">              needSeparatorLine:<span class="literal">YES</span></span><br><span class="line">           selectedItemComplete:complete];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)showPopMenuWithTitles:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *)titles</span><br><span class="line">               originPosition:(<span class="built_in">CGPoint</span>)position</span><br><span class="line">            needSeparatorLine:(<span class="built_in">BOOL</span>)isNeedSeparatorLine</span><br><span class="line">         selectedItemComplete:(<span class="keyword">void</span>(^)(<span class="built_in">NSInteger</span> currentIndex))complete &#123;</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span> showPopMenuWithIconImageNames:<span class="literal">nil</span></span><br><span class="line">                                 titles:titles</span><br><span class="line">                         originPosition:position</span><br><span class="line">                      needSeparatorLine:isNeedSeparatorLine</span><br><span class="line">                   selectedItemComplete:complete];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)showPopMenuWithIconImageNames:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; * _Nullable)iconImageNames</span><br><span class="line">                               titles:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; * _Nullable)titles</span><br><span class="line">                       originPosition:(<span class="built_in">CGPoint</span>)position</span><br><span class="line">                 selectedItemComplete:(<span class="keyword">void</span>(^)(<span class="built_in">NSInteger</span> currentIndex))complete &#123;</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span> showPopMenuWithIconImageNames:iconImageNames</span><br><span class="line">                                 titles:titles</span><br><span class="line">                         originPosition:position</span><br><span class="line">                      needSeparatorLine:<span class="literal">YES</span></span><br><span class="line">                   selectedItemComplete:complete];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)showPopMenuWithIconImageNames:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; * _Nullable)iconImageNames</span><br><span class="line">                               titles:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; * _Nullable)titles</span><br><span class="line">                       originPosition:(<span class="built_in">CGPoint</span>)position</span><br><span class="line">                    needSeparatorLine:(<span class="built_in">BOOL</span>)isNeedSeparatorLine</span><br><span class="line">                 selectedItemComplete:(<span class="keyword">void</span>(^)(<span class="built_in">NSInteger</span> currentIndex))complete &#123;</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span> showPopMenuWithIconImageNames:iconImageNames</span><br><span class="line">                                 titles:titles</span><br><span class="line">                         originPosition:position</span><br><span class="line">                           heightOfItem:<span class="number">0</span></span><br><span class="line">                            widthOfView:<span class="number">0</span></span><br><span class="line">                  backgroundColorOfView:[<span class="built_in">UIColor</span> whiteColor]</span><br><span class="line">                      needSeparatorLine:isNeedSeparatorLine</span><br><span class="line">                   selectedItemComplete:complete];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)showPopMenuWithIconImageNames:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; * _Nullable)iconImageNames</span><br><span class="line">                               titles:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; * _Nullable)titles</span><br><span class="line">                       originPosition:(<span class="built_in">CGPoint</span>)position</span><br><span class="line">                         heightOfItem:(<span class="built_in">CGFloat</span>)height</span><br><span class="line">                          widthOfView:(<span class="built_in">CGFloat</span>)width</span><br><span class="line">                backgroundColorOfView:(<span class="built_in">UIColor</span> *)color</span><br><span class="line">                    needSeparatorLine:(<span class="built_in">BOOL</span>)isNeedSeparatorLine</span><br><span class="line">                 selectedItemComplete:(<span class="keyword">void</span>(^)(<span class="built_in">NSInteger</span> currentIndex))complete &#123;</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span> showPopMenuWithIconImageNames:iconImageNames</span><br><span class="line">                                 titles:titles</span><br><span class="line">                         originPosition:position</span><br><span class="line">                           heightOfItem:height</span><br><span class="line">                            widthOfView:width</span><br><span class="line">                  backgroundColorOfView:color</span><br><span class="line">                       titleLabelOfItem:<span class="literal">nil</span></span><br><span class="line">                      needSeparatorLine:isNeedSeparatorLine</span><br><span class="line">                   selectedItemComplete:complete];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)showPopMenuWithIconImageNames:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; * _Nullable)iconImageNames</span><br><span class="line">                               titles:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; * _Nullable)titles</span><br><span class="line">                       originPosition:(<span class="built_in">CGPoint</span>)position</span><br><span class="line">                         heightOfItem:(<span class="built_in">CGFloat</span>)height</span><br><span class="line">                          widthOfView:(<span class="built_in">CGFloat</span>)width</span><br><span class="line">                backgroundColorOfView:(<span class="built_in">UIColor</span> *)color</span><br><span class="line">                     titleLabelOfItem:(<span class="built_in">UILabel</span> * _Nullable)titleLabel</span><br><span class="line">                    needSeparatorLine:(<span class="built_in">BOOL</span>)isNeedSeparatorLine</span><br><span class="line">                 selectedItemComplete:(<span class="keyword">void</span>(^)(<span class="built_in">NSInteger</span> currentIndex))complete &#123;</span><br><span class="line">    </span><br><span class="line">    WDPopMenu *v                = [[WDPopMenu alloc] init];</span><br><span class="line">    v.iconImageNames            = iconImageNames;</span><br><span class="line">    v.titles                    = titles;</span><br><span class="line">    v.beginPosition             = position;</span><br><span class="line">    v.itemHeight                = height == <span class="number">0</span> ? <span class="number">45</span> : height;</span><br><span class="line">    v.viewWidth                 = width == <span class="number">0</span> ? [[<span class="built_in">UIScreen</span> mainScreen] bounds].size.width / <span class="number">2</span> : width;</span><br><span class="line">    v.tableView.backgroundColor = color;</span><br><span class="line">    v.cellColor                 = color;</span><br><span class="line">    v.titleLabel                = titleLabel;</span><br><span class="line">    v.selectedItemComplete      = complete;</span><br><span class="line">    v.tableView.rowHeight       = v.itemHeight;</span><br><span class="line">    <span class="keyword">if</span> (isNeedSeparatorLine) &#123;</span><br><span class="line">        v.tableView.separatorStyle  = <span class="built_in">UITableViewCellSeparatorStyleSingleLine</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        v.tableView.separatorStyle  = <span class="built_in">UITableViewCellSeparatorStyleNone</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    [v.tableView reloadData];</span><br><span class="line">    [v showView];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)backgroundTappedTarget:(<span class="keyword">id</span>)sender &#123;</span><br><span class="line">    [<span class="keyword">self</span> hidenView];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)showView &#123;</span><br><span class="line">    [[[<span class="built_in">UIApplication</span> sharedApplication] keyWindow] addSubview:<span class="keyword">self</span>.backgroundView];</span><br><span class="line">    [[[<span class="built_in">UIApplication</span> sharedApplication] keyWindow] addSubview:<span class="keyword">self</span>];</span><br><span class="line">    [<span class="keyword">self</span> setupViewAndArrowShape];</span><br><span class="line">    [<span class="keyword">self</span> showAnimation];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setupViewAndArrowShape &#123;</span><br><span class="line">    <span class="built_in">CGRect</span> toFrame = <span class="built_in">CGRectZero</span>;</span><br><span class="line">    toFrame.size.width = <span class="keyword">self</span>.viewWidth;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.iconImageNames.count == <span class="number">0</span> || <span class="keyword">self</span>.iconImageNames == <span class="literal">nil</span>) &#123;</span><br><span class="line">        toFrame.size.height = <span class="keyword">self</span>.itemHeight * <span class="keyword">self</span>.titles.count + <span class="number">15</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">self</span>.titles == <span class="literal">nil</span> || <span class="keyword">self</span>.titles.count == <span class="number">0</span>) &#123;</span><br><span class="line">        toFrame.size.height = <span class="keyword">self</span>.itemHeight * <span class="keyword">self</span>.iconImageNames.count + <span class="number">15</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        toFrame.size.height = <span class="keyword">self</span>.itemHeight * <span class="keyword">self</span>.titles.count + <span class="number">15</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    WudanLayer *bbLayer = [[WudanLayer alloc] initWithSize:toFrame.size];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.beginPosition.x + <span class="keyword">self</span>.viewWidth / <span class="number">2</span> &gt; WD_SCREEN_WIDTH) &#123;</span><br><span class="line">        toFrame.origin.x = WD_SCREEN_WIDTH - <span class="number">10</span> - <span class="keyword">self</span>.viewWidth;</span><br><span class="line">        bbLayer.arrowDirection = ArrowDirectionTop;</span><br><span class="line">        bbLayer.arrowPosition = (<span class="keyword">self</span>.beginPosition.x - toFrame.origin.x + <span class="number">15</span>) / <span class="keyword">self</span>.viewWidth;</span><br><span class="line">        <span class="keyword">self</span>.layer.anchorPoint = <span class="built_in">CGPointMake</span>(bbLayer.arrowPosition, <span class="number">0</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">self</span>.beginPosition.x - <span class="keyword">self</span>.viewWidth / <span class="number">2</span> &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        toFrame.origin.x = <span class="number">10</span>;</span><br><span class="line">        bbLayer.arrowDirection = ArrowDirectionTop;</span><br><span class="line">        bbLayer.arrowPosition = (<span class="keyword">self</span>.beginPosition.x - toFrame.origin.x - <span class="number">15</span>) / <span class="keyword">self</span>.viewWidth;</span><br><span class="line">        <span class="keyword">self</span>.layer.anchorPoint = <span class="built_in">CGPointMake</span>(bbLayer.arrowPosition, <span class="number">0</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        toFrame.origin.x = <span class="keyword">self</span>.beginPosition.x - <span class="keyword">self</span>.viewWidth / <span class="number">2</span>;</span><br><span class="line">        bbLayer.arrowDirection = ArrowDirectionTop;</span><br><span class="line">        bbLayer.arrowPosition = (<span class="keyword">self</span>.beginPosition.x - toFrame.origin.x) / <span class="keyword">self</span>.viewWidth;</span><br><span class="line">        <span class="keyword">self</span>.layer.anchorPoint = <span class="built_in">CGPointMake</span>(bbLayer.arrowPosition, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.beginPosition.y + toFrame.size.height &gt; WD_SCREEN_HEIGHT) &#123;</span><br><span class="line">        toFrame.origin.y = <span class="keyword">self</span>.beginPosition.y - toFrame.size.height - <span class="number">15</span>;</span><br><span class="line">        bbLayer.arrowDirection = ArrowDirectionBottom;</span><br><span class="line">        <span class="keyword">self</span>.layer.anchorPoint = <span class="built_in">CGPointMake</span>(bbLayer.arrowPosition, <span class="number">1</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        toFrame.origin.y = <span class="keyword">self</span>.beginPosition.y + <span class="number">15</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">self</span>.tableView.frame = <span class="built_in">CGRectZero</span>;</span><br><span class="line">    <span class="keyword">self</span>.frame = <span class="built_in">CGRectMake</span>(<span class="keyword">self</span>.beginPosition.x, <span class="keyword">self</span>.beginPosition.y, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">self</span>.alpha = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">self</span>.frame = toFrame;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.beginPosition.y + toFrame.size.height &gt; WD_SCREEN_HEIGHT) &#123;</span><br><span class="line">        <span class="keyword">self</span>.tableView.contentInset = <span class="built_in">UIEdgeInsetsZero</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.tableView.contentInset = <span class="built_in">UIEdgeInsetsMake</span>(<span class="number">15</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">self</span>.tableView.frame = <span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, toFrame.size.width, toFrame.size.height);</span><br><span class="line">    </span><br><span class="line">    bbLayer.cornerRadius = <span class="number">8</span>;</span><br><span class="line">    bbLayer.arrowHeight = <span class="number">15</span>;</span><br><span class="line">    bbLayer.arrowWidth = <span class="number">30</span>;</span><br><span class="line">    bbLayer.arrowRadius = <span class="number">0</span>;</span><br><span class="line">    [<span class="keyword">self</span>.layer setMask:[bbLayer layer]];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)showAnimation &#123;</span><br><span class="line">    <span class="keyword">self</span>.layer.affineTransform = <span class="built_in">CGAffineTransformMakeScale</span>(<span class="number">0.1</span>, <span class="number">0.1</span>);</span><br><span class="line">    [<span class="built_in">UIView</span> animateWithDuration:<span class="number">0.35</span> animations:^&#123;</span><br><span class="line">        <span class="keyword">self</span>.backgroundView.backgroundColor = [<span class="built_in">UIColor</span> colorWithWhite:<span class="number">0</span> alpha:<span class="number">0.1</span>];</span><br><span class="line">        <span class="keyword">self</span>.alpha = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">self</span>.layer.affineTransform = <span class="built_in">CGAffineTransformIdentity</span>;</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)hidenView &#123;</span><br><span class="line">    [<span class="built_in">UIView</span> animateWithDuration:<span class="number">0.35</span> animations:^&#123;</span><br><span class="line">        <span class="keyword">self</span>.alpha = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">self</span>.layer.affineTransform = <span class="built_in">CGAffineTransformMakeScale</span>(<span class="number">0.1</span>, <span class="number">0.1</span>);</span><br><span class="line">        <span class="keyword">self</span>.backgroundView.backgroundColor = [<span class="built_in">UIColor</span> colorWithWhite:<span class="number">0</span> alpha:<span class="number">0</span>];</span><br><span class="line">    &#125; completion:^(<span class="built_in">BOOL</span> finished) &#123;</span><br><span class="line">        [<span class="keyword">self</span> removeFromSuperview];</span><br><span class="line">        <span class="keyword">self</span>.layer.affineTransform = <span class="built_in">CGAffineTransformIdentity</span>;</span><br><span class="line">        [<span class="keyword">self</span>.backgroundView removeFromSuperview];</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - UITableView DataSource Method</span></span><br><span class="line">- (<span class="built_in">NSInteger</span>)tableView:(<span class="built_in">UITableView</span> *)tableView numberOfRowsInSection:(<span class="built_in">NSInteger</span>)section &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.titles.count &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.titles.count;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.iconImageNames.count &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.iconImageNames.count;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">UITableViewCell</span> *)tableView:(<span class="built_in">UITableView</span> *)tableView cellForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;</span><br><span class="line">    WDPopMenuCell *cell = [tableView dequeueReusableCellWithIdentifier:<span class="string">@"WDPopMenuCell"</span>];</span><br><span class="line">    <span class="keyword">if</span> (!cell) &#123;</span><br><span class="line">        cell = [[WDPopMenuCell alloc] initWithStyle:<span class="built_in">UITableViewCellStyleDefault</span> reuseIdentifier:<span class="string">@"WDPopMenuCell"</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.iconImageNames.count == <span class="number">0</span> || <span class="keyword">self</span>.iconImageNames == <span class="literal">nil</span>) &#123;</span><br><span class="line">        cell.showType = WDPopMenuTypeOnlyTitle;</span><br><span class="line">        cell.titleLabel.text = <span class="keyword">self</span>.titles[indexPath.row];</span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">self</span>.titles == <span class="literal">nil</span> || <span class="keyword">self</span>.titles.count == <span class="number">0</span>) &#123;</span><br><span class="line">        cell.showType = WDPopMenuTypeOnlyIcon;</span><br><span class="line">        cell.iconImageView.image = [<span class="built_in">UIImage</span> imageNamed:<span class="keyword">self</span>.iconImageNames[indexPath.row]];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        cell.showType = WDPopMenuTypeNormal;</span><br><span class="line">        cell.iconImageView.image = [<span class="built_in">UIImage</span> imageNamed:<span class="keyword">self</span>.iconImageNames[indexPath.row]];</span><br><span class="line">        cell.titleLabel.text = <span class="keyword">self</span>.titles[indexPath.row];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.titleLabel) &#123;</span><br><span class="line">        cell.titleLabel.textColor = <span class="keyword">self</span>.titleLabel.textColor;</span><br><span class="line">        cell.titleLabel.textAlignment = <span class="keyword">self</span>.titleLabel.textAlignment;</span><br><span class="line">        cell.titleLabel.font = <span class="keyword">self</span>.titleLabel.font;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    cell.contentView.backgroundColor = <span class="keyword">self</span>.cellColor;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (indexPath.row == [tableView numberOfRowsInSection:indexPath.section] - <span class="number">1</span>) &#123;</span><br><span class="line">        cell.separatorInset = <span class="built_in">UIEdgeInsetsMake</span>(<span class="number">0</span>, <span class="keyword">self</span>.bounds.size.width, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        cell.separatorInset = <span class="built_in">UIEdgeInsetsMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cell;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - UITableView Delegate Method</span></span><br><span class="line">- (<span class="keyword">void</span>)tableView:(<span class="built_in">UITableView</span> *)tableView didSelectRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;</span><br><span class="line">    [tableView deselectRowAtIndexPath:indexPath animated:<span class="literal">YES</span>];</span><br><span class="line">    [<span class="keyword">self</span> hidenView];</span><br><span class="line">    <span class="keyword">self</span>.selectedItemComplete(indexPath.row);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - Setter</span></span><br><span class="line">- (<span class="built_in">UITableView</span> *)tableView &#123;</span><br><span class="line">    <span class="keyword">if</span> (!_tableView) &#123;</span><br><span class="line">        _tableView                 = [[<span class="built_in">UITableView</span> alloc] initWithFrame:<span class="built_in">CGRectZero</span> style:<span class="built_in">UITableViewStylePlain</span>];</span><br><span class="line">        _tableView.tableFooterView = [[<span class="built_in">UIView</span> alloc] init];</span><br><span class="line">        _tableView.dataSource      = <span class="keyword">self</span>;</span><br><span class="line">        _tableView.delegate        = <span class="keyword">self</span>;</span><br><span class="line">        _tableView.scrollEnabled   = <span class="literal">NO</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _tableView;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">UIView</span> *)backgroundView &#123;</span><br><span class="line">    <span class="keyword">if</span> (!_backgroundView) &#123;</span><br><span class="line">        _backgroundView = [[<span class="built_in">UIView</span> alloc] initWithFrame:[[<span class="built_in">UIScreen</span> mainScreen] bounds]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _backgroundView;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><h2 id="å®ç°æ•ˆæœå›¾"><a href="#å®ç°æ•ˆæœå›¾" class="headerlink" title="å®ç°æ•ˆæœå›¾"></a>å®ç°æ•ˆæœå›¾</h2><p><img src="https://upload-images.jianshu.io/upload_images/3334769-31da61cc372f13af.gif?imageMogr2/auto-orient/strip" alt="æ•ˆæœå›¾"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ç°åœ¨å¾ˆå¤šçš„åº”ç”¨éƒ½æœ‰ç±»ä¼¼çš„å¼¹çª—æ§ä»¶ï¼Œæœ€å‡ºååº”è¯¥æ˜¯ä¼é¹…å’Œå¾®ä¿¡äº†å§ã€‚æƒ³ç€ä¸ºäº†æ»¡è¶³è‡ªå·±çš„æ•ˆæœå°±åŠ¨æ‰‹å†™äº†è¿™ä¸ªã€‚é¦–å…ˆè¦æ„Ÿè°¢å†™å‡ºå¼¹çª—ç®­å¤´çš„ä»£ç çš„äºº&lt;a href=&quot;https://github.com/iHandle/BubbleLayer&quot; target=&quot;_blank&quot; rel=&quot;n
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Flutter-GridView(UICollectionView)</title>
    <link href="https://wudan-ios.github.io/2019/04/26/Flutter-GridView(UICollectionView)/"/>
    <id>https://wudan-ios.github.io/2019/04/26/Flutter-GridView(UICollectionView)/</id>
    <published>2019-04-26T01:59:16.675Z</published>
    <updated>2019-04-26T01:59:16.867Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://upload-images.jianshu.io/upload_images/3334769-7a78181ca9b9d37c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Flutter"><br><code>ListView</code>åˆ—è¡¨è§†å›¾ï¼Œç±»ä¼¼iOSä¸­çš„<code>UITableView</code>ï¼Œä½¿ç”¨æ›´åŠ æ–¹ä¾¿å’Œä¸ªæ€§åŒ–ï¼Œé‡Œé¢<code>children</code>è§†å›¾å¯ä»¥æ˜¯ä»»æ„çš„<code>Widge</code>ã€‚<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">void main() =&gt; runApp(<span class="type">WudanTableViewPage</span>());</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WudanTableViewPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="type">Widget</span> build(<span class="type">BuildContext</span> context) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">MaterialApp</span>(</span><br><span class="line">      title: <span class="symbol">'Class</span> <span class="type">Name</span>',</span><br><span class="line">      home: <span class="type">Scaffold</span>(</span><br><span class="line">        appBar: <span class="type">AppBar</span>(title: <span class="type">Text</span>(<span class="symbol">'UITableVie</span>w')),</span><br><span class="line">        body: <span class="type">Center</span>(</span><br><span class="line">          child: <span class="type">ListView</span>(</span><br><span class="line">            scrollDirection: <span class="type">Axis</span>.vertical, <span class="comment">// æ»šåŠ¨æ–¹å‘</span></span><br><span class="line">            children: &lt;<span class="type">Widget</span>&gt;[</span><br><span class="line">              <span class="keyword">new</span> <span class="type">ListTile</span>(</span><br><span class="line">                title: <span class="type">Text</span>(<span class="string">"æ ‡é¢˜"</span>),</span><br><span class="line">                subtitle: <span class="type">Text</span>(<span class="string">"å‰¯æ ‡é¢˜"</span>),</span><br><span class="line">                leading: <span class="type">Icon</span>(<span class="type">Icons</span>.add_box),<span class="comment">// å·¦è¾¹Widge</span></span><br><span class="line">                trailing: <span class="type">Icon</span>(<span class="type">Icons</span>.airline_seat_flat), <span class="comment">// å³è¾¹Widge</span></span><br><span class="line">                isThreeLine: <span class="literal">true</span>, <span class="comment">// æ˜¯å¦é»˜è®¤3è¡Œé«˜åº¦ï¼Œsubtitleä¸ä¸ºç©ºæ—¶æ‰èƒ½ä½¿ç”¨</span></span><br><span class="line">                dense: <span class="literal">false</span>, <span class="comment">// è®¾ç½®ä¸ºtrueåå­—ä½“å˜å°</span></span><br><span class="line">                selected: <span class="literal">false</span>, <span class="comment">// å±•ç¤ºæ˜¯å¦é»˜è®¤æ˜¾ç¤ºé€‰ä¸­</span></span><br><span class="line">              ),</span><br><span class="line">              <span class="keyword">new</span> <span class="type">Image</span>.network(</span><br><span class="line">                <span class="string">"https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1554110093883&amp;di=9db9b92f1e6ee0396b574a093cc987d6&amp;imgtype=0&amp;src=http%3A%2F%2Fn.sinaimg.cn%2Fsinacn20%2F151%2Fw2048h1303%2F20180429%2F37c0-fzvpatr1915813.jpg"</span>,</span><br><span class="line">                height: <span class="number">60</span>,</span><br><span class="line">                fit: <span class="type">BoxFit</span>.fitWidth,</span><br><span class="line">              ),</span><br><span class="line">              <span class="keyword">new</span> <span class="type">Container</span>(</span><br><span class="line">                margin: <span class="type">EdgeInsets</span>.all(<span class="number">10</span>),</span><br><span class="line">                color: <span class="type">Colors</span>.orange,</span><br><span class="line">                height: <span class="number">100</span>,</span><br><span class="line">              )</span><br><span class="line">            ],</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="å±æ€§ä»‹ç»"><a href="#å±æ€§ä»‹ç»" class="headerlink" title="å±æ€§ä»‹ç»"></a>å±æ€§ä»‹ç»</h4><ul><li>paddingï¼šå†…è¾¹è·</li><li>scrollDirectionï¼šæ»šåŠ¨æ–¹å‘</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3334769-68ec5c06933f5639.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/370" alt="ç¤ºä¾‹å›¾"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/3334769-7a78181ca9b9d37c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot;
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Flutter-ListView(UITableView)</title>
    <link href="https://wudan-ios.github.io/2019/04/26/Flutter-ListView(UITableView)/"/>
    <id>https://wudan-ios.github.io/2019/04/26/Flutter-ListView(UITableView)/</id>
    <published>2019-04-26T01:58:43.145Z</published>
    <updated>2019-04-26T01:58:43.334Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://upload-images.jianshu.io/upload_images/3334769-7a78181ca9b9d37c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Flutter"><br><code>ListView</code>åˆ—è¡¨è§†å›¾ï¼Œç±»ä¼¼iOSä¸­çš„<code>UITableView</code>ï¼Œä½¿ç”¨æ›´åŠ æ–¹ä¾¿å’Œä¸ªæ€§åŒ–ï¼Œé‡Œé¢<code>children</code>è§†å›¾å¯ä»¥æ˜¯ä»»æ„çš„<code>Widge</code>ã€‚<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">void main() =&gt; runApp(<span class="type">WudanTableViewPage</span>());</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WudanTableViewPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="type">Widget</span> build(<span class="type">BuildContext</span> context) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">MaterialApp</span>(</span><br><span class="line">      title: <span class="symbol">'Class</span> <span class="type">Name</span>',</span><br><span class="line">      home: <span class="type">Scaffold</span>(</span><br><span class="line">        appBar: <span class="type">AppBar</span>(title: <span class="type">Text</span>(<span class="symbol">'UITableVie</span>w')),</span><br><span class="line">        body: <span class="type">Center</span>(</span><br><span class="line">          child: <span class="type">ListView</span>(</span><br><span class="line">            scrollDirection: <span class="type">Axis</span>.vertical, <span class="comment">// æ»šåŠ¨æ–¹å‘</span></span><br><span class="line">            children: &lt;<span class="type">Widget</span>&gt;[</span><br><span class="line">              <span class="keyword">new</span> <span class="type">ListTile</span>(</span><br><span class="line">                title: <span class="type">Text</span>(<span class="string">"æ ‡é¢˜"</span>),</span><br><span class="line">                subtitle: <span class="type">Text</span>(<span class="string">"å‰¯æ ‡é¢˜"</span>),</span><br><span class="line">                leading: <span class="type">Icon</span>(<span class="type">Icons</span>.add_box),<span class="comment">// å·¦è¾¹Widge</span></span><br><span class="line">                trailing: <span class="type">Icon</span>(<span class="type">Icons</span>.airline_seat_flat), <span class="comment">// å³è¾¹Widge</span></span><br><span class="line">                isThreeLine: <span class="literal">true</span>, <span class="comment">// æ˜¯å¦é»˜è®¤3è¡Œé«˜åº¦ï¼Œsubtitleä¸ä¸ºç©ºæ—¶æ‰èƒ½ä½¿ç”¨</span></span><br><span class="line">                dense: <span class="literal">false</span>, <span class="comment">// è®¾ç½®ä¸ºtrueåå­—ä½“å˜å°</span></span><br><span class="line">                selected: <span class="literal">false</span>, <span class="comment">// å±•ç¤ºæ˜¯å¦é»˜è®¤æ˜¾ç¤ºé€‰ä¸­</span></span><br><span class="line">              ),</span><br><span class="line">              <span class="keyword">new</span> <span class="type">Image</span>.network(</span><br><span class="line">                <span class="string">"https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1554110093883&amp;di=9db9b92f1e6ee0396b574a093cc987d6&amp;imgtype=0&amp;src=http%3A%2F%2Fn.sinaimg.cn%2Fsinacn20%2F151%2Fw2048h1303%2F20180429%2F37c0-fzvpatr1915813.jpg"</span>,</span><br><span class="line">                height: <span class="number">60</span>,</span><br><span class="line">                fit: <span class="type">BoxFit</span>.fitWidth,</span><br><span class="line">              ),</span><br><span class="line">              <span class="keyword">new</span> <span class="type">Container</span>(</span><br><span class="line">                margin: <span class="type">EdgeInsets</span>.all(<span class="number">10</span>),</span><br><span class="line">                color: <span class="type">Colors</span>.orange,</span><br><span class="line">                height: <span class="number">100</span>,</span><br><span class="line">              )</span><br><span class="line">            ],</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="å±æ€§ä»‹ç»"><a href="#å±æ€§ä»‹ç»" class="headerlink" title="å±æ€§ä»‹ç»"></a>å±æ€§ä»‹ç»</h4><ul><li>paddingï¼šå†…è¾¹è·</li><li>scrollDirectionï¼šæ»šåŠ¨æ–¹å‘</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3334769-68ec5c06933f5639.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/370" alt="ç¤ºä¾‹å›¾"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/3334769-7a78181ca9b9d37c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot;
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Flutter-Image(UIImageView)</title>
    <link href="https://wudan-ios.github.io/2019/04/26/Flutter-Image(UIImageView)/"/>
    <id>https://wudan-ios.github.io/2019/04/26/Flutter-Image(UIImageView)/</id>
    <published>2019-04-26T01:57:44.237Z</published>
    <updated>2019-04-26T01:57:44.425Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://upload-images.jianshu.io/upload_images/3334769-7a78181ca9b9d37c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Flutter"><br><code>Image</code>å°±æ˜¯ç›¸å¯¹äºiOSå¼€å‘ä¸­çš„<code>UIImageView</code>ï¼ŒæŠŠä¸UIImageViewè®¾ç½®å·®åˆ«å¾ˆå¤§çš„ç‚¹æ‹å‡ºæ¥è¯´æ˜ä¸€ä¸‹ã€‚<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">void main() =&gt; runApp(<span class="type">WudanImageViewPage</span>());</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WudanImageViewPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="type">Widget</span> build(<span class="type">BuildContext</span> context) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">MaterialApp</span>(</span><br><span class="line">      title: <span class="symbol">'Class</span> <span class="type">Name</span>',</span><br><span class="line">      home: <span class="type">Scaffold</span>(</span><br><span class="line">        appBar: <span class="type">AppBar</span>(title: <span class="type">Text</span>(<span class="symbol">'UIImageVie</span>w')),</span><br><span class="line">        body: <span class="type">Center</span>(</span><br><span class="line">          child: <span class="type">Image</span>.network(</span><br><span class="line">            <span class="string">"https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1554110093883&amp;di=9db9b92f1e6ee0396b574a093cc987d6&amp;imgtype=0&amp;src=http%3A%2F%2Fn.sinaimg.cn%2Fsinacn20%2F151%2Fw2048h1303%2F20180429%2F37c0-fzvpatr1915813.jpg"</span>,</span><br><span class="line">            fit: <span class="type">BoxFit</span>.cover,</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="åŠ è½½æ–¹å¼"><a href="#åŠ è½½æ–¹å¼" class="headerlink" title="åŠ è½½æ–¹å¼"></a>åŠ è½½æ–¹å¼</h4><ul><li>Image.assetï¼šåŠ è½½èµ„æºå›¾ç‰‡ï¼Œå°±æ˜¯åŠ è½½é¡¹ç›®èµ„æºç›®å½•ä¸­çš„å›¾ç‰‡,åŠ å…¥å›¾ç‰‡åä¼šå¢å¤§æ‰“åŒ…çš„åŒ…ä½“ä½“ç§¯ï¼Œç”¨çš„æ˜¯ç›¸å¯¹è·¯å¾„ã€‚</li><li>Image.networkï¼šç½‘ç»œèµ„æºå›¾ç‰‡</li><li>Image.fileï¼šåŠ è½½æœ¬åœ°å›¾ç‰‡ï¼Œå°±æ˜¯åŠ è½½æœ¬åœ°æ–‡ä»¶ä¸­çš„å›¾ç‰‡ï¼Œè¿™ä¸ªæ˜¯ä¸€ä¸ªç»å¯¹è·¯å¾„ï¼Œè·ŸåŒ…ä½“æ— å…³ã€‚</li><li>Image.memoryï¼šåŠ è½½Uint8Listèµ„æºå›¾ç‰‡<h4 id="fitå±æ€§çš„è®¾ç½®"><a href="#fitå±æ€§çš„è®¾ç½®" class="headerlink" title="fitå±æ€§çš„è®¾ç½®"></a>fitå±æ€§çš„è®¾ç½®</h4></li><li>BoxFit.fill:å…¨å›¾æ˜¾ç¤ºï¼Œå›¾ç‰‡ä¼šè¢«æ‹‰ä¼¸ï¼Œå¹¶å……æ»¡çˆ¶å®¹å™¨ã€‚</li><li>BoxFit.contain:å…¨å›¾æ˜¾ç¤ºï¼Œæ˜¾ç¤ºåŸæ¯”ä¾‹ï¼Œå¯èƒ½ä¼šæœ‰ç©ºéš™ã€‚<br>BoxFit.coverï¼šæ˜¾ç¤ºå¯èƒ½æ‹‰ä¼¸ï¼Œå¯èƒ½è£åˆ‡ï¼Œå……æ»¡ï¼ˆå›¾ç‰‡è¦å……æ»¡æ•´ä¸ªå®¹å™¨ï¼Œè¿˜ä¸å˜å½¢ï¼‰ã€‚</li><li>BoxFit.fitWidthï¼šå®½åº¦å……æ»¡ï¼ˆæ¨ªå‘å……æ»¡ï¼‰ï¼Œæ˜¾ç¤ºå¯èƒ½æ‹‰ä¼¸ï¼Œå¯èƒ½è£åˆ‡ã€‚</li><li>BoxFit.fitHeight ï¼šé«˜åº¦å……æ»¡ï¼ˆç«–å‘å……æ»¡ï¼‰,æ˜¾ç¤ºå¯èƒ½æ‹‰ä¼¸ï¼Œå¯èƒ½è£åˆ‡ã€‚</li><li>BoxFit.scaleDownï¼šæ•ˆæœå’Œcontainå·®ä¸å¤šï¼Œä½†æ˜¯æ­¤å±æ€§ä¸å…è®¸æ˜¾ç¤ºè¶…è¿‡æºå›¾ç‰‡å¤§å°ï¼Œå¯å°ä¸å¯å¤§ã€‚<h4 id="å›¾ç‰‡çš„æ··åˆæ¨¡å¼"><a href="#å›¾ç‰‡çš„æ··åˆæ¨¡å¼" class="headerlink" title="å›¾ç‰‡çš„æ··åˆæ¨¡å¼"></a>å›¾ç‰‡çš„æ··åˆæ¨¡å¼</h4>å›¾ç‰‡æ··åˆæ¨¡å¼ï¼ˆcolorBlendModeï¼‰å’Œcolorå±æ€§é…åˆä½¿ç”¨ï¼Œèƒ½è®©å›¾ç‰‡æ”¹å˜é¢œè‰²ï¼Œé‡Œè¾¹çš„æ¨¡å¼éå¸¸çš„å¤šï¼Œäº§ç”Ÿçš„æ•ˆæœä¹Ÿæ˜¯éå¸¸ä¸°å¯Œçš„ã€‚<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">child: Image.network(</span><br><span class="line">  'https://timgsa.baidu.com/timg?image&amp;quality=<span class="number">80</span>&amp;size=b<span class="number">9999</span>_<span class="number">10000</span>&amp;sec=<span class="number">1554110093883</span>&amp;di=<span class="number">9</span>db<span class="number">9</span>b<span class="number">92</span>f<span class="number">1e6</span>ee<span class="number">0396</span>b<span class="number">574</span>a<span class="number">093</span><span class="keyword">cc</span><span class="number">987</span>d<span class="number">6</span>&amp;imgtype=<span class="number">0</span>&amp;src=http<span class="symbol">%3</span>A<span class="symbol">%2</span>F<span class="symbol">%2</span>Fn.sinaimg.cn<span class="symbol">%2</span>Fsinacn<span class="number">20</span><span class="symbol">%2</span>F<span class="number">151</span><span class="symbol">%2</span>Fw<span class="number">2048</span>h<span class="number">1303</span><span class="symbol">%2</span>F<span class="number">20180429</span><span class="symbol">%2</span>F<span class="number">37</span><span class="keyword">c</span><span class="number">0</span>-fzvpatr<span class="number">1915813</span>.jpg',</span><br><span class="line">    color: Colors.greenAccent,</span><br><span class="line">    colorBlendMode: BlendMode.darken,</span><br><span class="line">),</span><br></pre></td></tr></table></figure></li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3334769-1f12e0ee1a048d11.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ç¤ºä¾‹å›¾"><br><img src="https://upload-images.jianshu.io/upload_images/3334769-67fbe4a7fc4a886f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ç¤ºä¾‹å›¾2"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/3334769-7a78181ca9b9d37c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot;
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Flutter-Container(UIView)</title>
    <link href="https://wudan-ios.github.io/2019/04/26/Flutter-Container(UIView)/"/>
    <id>https://wudan-ios.github.io/2019/04/26/Flutter-Container(UIView)/</id>
    <published>2019-04-26T01:56:58.293Z</published>
    <updated>2019-04-26T01:56:58.487Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://upload-images.jianshu.io/upload_images/3334769-7a78181ca9b9d37c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Flutter"><br><code>Container</code>å°±æ˜¯ç›¸å¯¹äºiOSå¼€å‘ä¸­çš„<code>UIView</code>ï¼ŒæŠŠä¸UIViewè®¾ç½®å·®åˆ«å¾ˆå¤§çš„ç‚¹æ‹å‡ºæ¥è¯´æ˜ä¸€ä¸‹ã€‚<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">void main() =&gt; runApp(<span class="type">WudanViewPage</span>());</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WudanViewPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="type">Widget</span> build(<span class="type">BuildContext</span> context) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">MaterialApp</span>(</span><br><span class="line">      title: <span class="symbol">'Class</span> <span class="type">Name</span>',</span><br><span class="line">      home: <span class="type">Scaffold</span>(</span><br><span class="line">        appBar: <span class="type">AppBar</span>(title: <span class="type">Text</span>(<span class="symbol">'UIVie</span>w')),</span><br><span class="line">        body: <span class="type">Center</span>(</span><br><span class="line">          child: <span class="type">Container</span>(</span><br><span class="line">            height: <span class="number">300</span>,</span><br><span class="line">            color: <span class="type">Colors</span>.red,</span><br><span class="line">            padding: <span class="type">EdgeInsets</span>.fromLTRB(<span class="number">10</span>, <span class="number">30</span>, <span class="number">30</span>, <span class="number">10</span>), <span class="comment">// å†…è¾¹è·</span></span><br><span class="line">            margin: <span class="type">EdgeInsets</span>.fromLTRB(<span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>), <span class="comment">// å¤–è¾¹è·</span></span><br><span class="line">            child: <span class="type">Container</span>(</span><br><span class="line">              color: <span class="type">Colors</span>.orange,</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="æ·»åŠ å­è§†å›¾"><a href="#æ·»åŠ å­è§†å›¾" class="headerlink" title="æ·»åŠ å­è§†å›¾"></a>æ·»åŠ å­è§†å›¾</h4><p>ä½¿ç”¨<code>child</code>ï¼Œåœ¨å…¶å†…éƒ¨è®¾ç½®å­è§†å›¾æ ·å¼</p><h4 id="ç›’å­æ¨¡å‹"><a href="#ç›’å­æ¨¡å‹" class="headerlink" title="ç›’å­æ¨¡å‹"></a>ç›’å­æ¨¡å‹</h4><ul><li><code>fromLTRB</code> æ˜¯<code>(Left, Top, Right, Bottom)</code> </li><li><code>padding</code>å†…è¾¹è·</li><li><code>margin</code>å¤–è¾¹è·</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3334769-71eec567ddeb9df1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/335" alt="å®ä¾‹å›¾"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/3334769-7a78181ca9b9d37c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot;
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Flutter-Text(UILabel)</title>
    <link href="https://wudan-ios.github.io/2019/04/26/Flutter-Text(UILabel)/"/>
    <id>https://wudan-ios.github.io/2019/04/26/Flutter-Text(UILabel)/</id>
    <published>2019-04-26T01:54:14.945Z</published>
    <updated>2019-04-26T02:03:34.218Z</updated>
    
    <content type="html"><![CDATA[<h2 id=""><a href="#" class="headerlink" title=""></a><img src="https://upload-images.jianshu.io/upload_images/3334769-7a78181ca9b9d37c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Flutter"></h2><p><code>Text</code>å°±æ˜¯ç›¸å¯¹äºiOSå¼€å‘ä¸­çš„<code>UILabel</code>ï¼ŒæŠŠä¸UILabelè®¾ç½®å·®åˆ«å¾ˆå¤§çš„ç‚¹æ‹å‡ºæ¥è¯´æ˜ä¸€ä¸‹ã€‚<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">void main() =&gt; runApp(<span class="type">WudanUILabel</span>());</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WudanUILabel</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="type">Widget</span> build(<span class="type">BuildContext</span> context) &#123;</span><br><span class="line">     <span class="keyword">return</span> <span class="type">MaterialApp</span>(</span><br><span class="line">       title: <span class="symbol">'Class</span> <span class="type">Name</span>',</span><br><span class="line">       home: <span class="type">Scaffold</span>(</span><br><span class="line">         appBar: <span class="type">AppBar</span>(title: <span class="type">Text</span>(<span class="symbol">'UILabe</span>l')),</span><br><span class="line">         body: <span class="type">Center</span>(</span><br><span class="line">           child: <span class="type">Text</span>(</span><br><span class="line">             <span class="string">"Flutteræ˜¯è°·æ­Œçš„ç§»åŠ¨UIæ¡†æ¶ï¼Œå¯ä»¥å¿«é€Ÿåœ¨iOSå’ŒAndroidä¸Šæ„å»ºé«˜è´¨é‡çš„åŸç”Ÿç”¨æˆ·ç•Œé¢ã€‚ Flutterå¯ä»¥ä¸ç°æœ‰çš„ä»£ç ä¸€èµ·å·¥ä½œã€‚åœ¨å…¨ä¸–ç•Œï¼ŒFlutteræ­£åœ¨è¢«è¶Šæ¥è¶Šå¤šçš„å¼€å‘è€…å’Œç»„ç»‡ä½¿ç”¨ï¼Œå¹¶ä¸”Flutteræ˜¯å®Œå…¨å…è´¹ã€å¼€æºçš„ã€‚"</span>, <span class="comment">// å†…å®¹</span></span><br><span class="line">             maxLines: <span class="number">2</span>, <span class="comment">// æœ€å¤§æ˜¾ç¤ºè¡Œæ•°ï¼Œé»˜è®¤ä¸ºæœ€å¤§</span></span><br><span class="line">             textAlign: <span class="type">TextAlign</span>.left, <span class="comment">// å¯¹é½æ–¹å¼</span></span><br><span class="line">             overflow: <span class="type">TextOverflow</span>.ellipsis, <span class="comment">// æ–‡å­—æ˜¾ç¤ºä¸å…¨æ ·å¼</span></span><br><span class="line">             style: <span class="type">TextStyle</span>( <span class="comment">// å­—ä½“æ ·å¼</span></span><br><span class="line">               color: <span class="type">Colors</span>.pink, <span class="comment">// é¢œè‰²</span></span><br><span class="line">               fontSize: <span class="number">18</span>, <span class="comment">// å¤§å°</span></span><br><span class="line">               decoration: <span class="type">TextDecoration</span>.underline,       <span class="comment">// åˆ’çº¿ä½ç½®</span></span><br><span class="line">               decorationStyle: <span class="type">TextDecorationStyle</span>.solid <span class="comment">// åˆ’çº¿æ ·å¼</span></span><br><span class="line">             ),</span><br><span class="line">           ),</span><br><span class="line">         ),</span><br><span class="line">       ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="overflowå±æ€§"><a href="#overflowå±æ€§" class="headerlink" title="overflowå±æ€§"></a>overflowå±æ€§</h4><p>ç±»ä¼¼ä¸UILabelä¸­çš„<code>lineBreakMode</code></p><ul><li>clipï¼šç›´æ¥åˆ‡æ–­ï¼Œå‰©ä¸‹çš„æ–‡å­—å°±æ²¡æœ‰äº†ï¼Œæ„Ÿè§‰ä¸å¤ªå‹å¥½ï¼Œä½“éªŒæ€§ä¸å¥½ã€‚</li><li>ellipsis: åœ¨åè¾¹æ˜¾ç¤ºçœç•¥å·ï¼Œä½“éªŒæ€§è¾ƒå¥½ï¼Œè¿™ä¸ªåœ¨å·¥ä½œä¸­ç»å¸¸ä½¿ç”¨ã€‚</li><li>fade: æº¢å‡ºçš„éƒ¨åˆ†ä¼šè¿›è¡Œä¸€ä¸ªæ¸å˜æ¶ˆå¤±çš„æ•ˆæœï¼Œå½“ç„¶æ˜¯ä¸Šçº¿çš„æ¸å˜ã€‚<h4 id="decoration"><a href="#decoration" class="headerlink" title="decoration"></a>decoration</h4>ç±»ä¼¼äº<code>NSAttributedString</code>åˆ¶ä½œçš„åˆ’çº¿</li><li>noneï¼šé»˜è®¤æ ·å¼ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰</li><li>underlineï¼šä¸‹åˆ’çº¿</li><li>lineThroughï¼šç©¿è¿‡æ–‡å­—ä¸­é—´</li><li>overlineï¼šæ–‡å­—é¡¶éƒ¨</li></ul><h4 id="decorationStyle"><a href="#decorationStyle" class="headerlink" title="decorationStyle"></a>decorationStyle</h4><p>åˆ’çº¿çš„æ ·å¼</p><ul><li>solidï¼šå®çº¿</li><li>doubleï¼šåŒçº¿</li><li>dashedï¼šè™šçº¿(å¤§ç‚¹)</li><li>dottedï¼šè™šçº¿(å°ç‚¹)</li><li>wavyï¼šæ³¢æµªçº¿</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/3334769-c5cbd7a84c22137a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/335" alt="ç¤ºä¾‹å›¾"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;headerlink&quot; title=&quot;&quot;&gt;&lt;/a&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/3334769-7a78181ca9b9d37c.png?
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>iOSè‡ªå®šä¹‰æ§ä»¶ï¼šå›¾ç‰‡æµè§ˆå™¨</title>
    <link href="https://wudan-ios.github.io/2019/04/19/iOS%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%A7%E4%BB%B6%EF%BC%9A%E5%9B%BE%E7%89%87%E6%B5%8F%E8%A7%88%E5%99%A8/"/>
    <id>https://wudan-ios.github.io/2019/04/19/iOSè‡ªå®šä¹‰æ§ä»¶ï¼šå›¾ç‰‡æµè§ˆå™¨/</id>
    <published>2019-04-19T08:39:19.330Z</published>
    <updated>2019-04-26T01:45:56.865Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://upload-images.jianshu.io/upload_images/3334769-32704538aebd1e35.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é•‡æ¥¼ä¸“ç”¨"><br>ä¸€ç›´æƒ³å†™ä¸€ä¸ªè‡ªå·±çš„å›¾ç‰‡æµè§ˆå™¨ï¼Œä½†æ˜¯è‡ªå·±èƒ½åŠ›åˆä¸æ˜¯å¾ˆå¤Ÿï¼Œæ‰€ä»¥ä¸€ç›´æ‹–è¿™ï¼Œæœ€è¿‘è¶è‡ªå·±æ—¶é—´å……è£•ï¼Œè‡ªå·±ç ”ç©¶äº†ä¸€ä¸‹è¿™æ–¹é¢çš„çŸ¥è¯†ã€‚æ„Ÿè§‰æœ‰ä»¥ä¸‹å‡ ä¸ªéš¾ç‚¹ï¼š</p><ol><li>æ˜¾ç¤ºå’Œæ¶ˆå¤±çš„è½¬åœºåŠ¨ç”»</li><li>æ‰‹åŠ¿æ‹–æ‹½</li><li>å›¾ç‰‡åŠ è½½</li></ol><h2 id="åŠ è½½æ–¹å¼å’Œè½¬åœºåŠ¨ç”»"><a href="#åŠ è½½æ–¹å¼å’Œè½¬åœºåŠ¨ç”»" class="headerlink" title="åŠ è½½æ–¹å¼å’Œè½¬åœºåŠ¨ç”»"></a>åŠ è½½æ–¹å¼å’Œè½¬åœºåŠ¨ç”»</h2><ul><li>é€šè¿‡<code>Controller</code>åŠ è½½ï¼šéœ€è¦ä½¿ç”¨<code>ViewController</code>å®ç°<code>UIViewControllerAnimatedTransitioning</code>å®ç°è½¬åœºæ•ˆæœ</li><li>é€šè¿‡<code>View</code>åŠ è½½ï¼šä½¿ç”¨<code>UIView</code>åŠ¨ç”»è¯•ä¸‹è½¬åœºæ•ˆæœ</li></ul><p>è½¬åœºåŠ¨ç”»å¿…è¦å…ƒç´ </p><ol><li>æ˜¾ç¤ºæ—¶éœ€è¦<code>fromView</code>çš„<code>frame</code></li><li>æ¶ˆå¤±æ—¶éœ€è¦<code>toView</code>çš„<code>frame</code><h4 id="æ˜¾ç¤º"><a href="#æ˜¾ç¤º" class="headerlink" title="æ˜¾ç¤º"></a>æ˜¾ç¤º</h4>é€šè¿‡ä¿®æ”¹å½“å‰éœ€è¦æ˜¾ç¤ºå›¾ç‰‡çš„<code>CollectionViewCell</code>ä¸­<code>ImageView</code>çš„<code>frame</code>ï¼ŒåŒæ—¶ä¿®æ”¹å½“æœŸ<code>View</code>çš„èƒŒæ™¯é¢œè‰²é€æ˜åº¦<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">WDImageCollectionViewCell</span> <span class="meta">*cell</span> <span class="string">=</span> <span class="string">(WDImageCollectionViewCell</span> <span class="string">*)[self.collectionView</span> <span class="attr">cellForItemAtIndexPath:[NSIndexPath</span> <span class="attr">indexPathForRow:self.tappedIndex</span> <span class="attr">inSection:0]];</span></span><br><span class="line"><span class="string">CGRect</span> <span class="string">fromFrame</span>                <span class="string">=</span> <span class="string">[self.originView</span> <span class="attr">convertRect:self.originView.bounds</span> <span class="attr">toView:cell.contentView];</span></span><br><span class="line"><span class="string">cell.imageView.frame</span>            <span class="string">=</span> <span class="string">fromFrame;</span></span><br><span class="line"><span class="string">[UIView</span> <span class="attr">animateWithDuration:0.5</span> <span class="attr">animations:^&#123;</span></span><br><span class="line">    <span class="string">self.backgroundColor</span> <span class="string">=</span> <span class="string">[[UIColor</span> <span class="string">alloc]</span> <span class="attr">initWithWhite:0</span> <span class="attr">alpha:1];</span></span><br><span class="line">    <span class="string">cell.imageView.frame</span> <span class="string">=</span> <span class="string">cell.contentView.bounds;</span></span><br><span class="line"><span class="string">&#125;];</span></span><br></pre></td></tr></table></figure></li></ol><h4 id="æ¶ˆå¤±"><a href="#æ¶ˆå¤±" class="headerlink" title="æ¶ˆå¤±"></a>æ¶ˆå¤±</h4><p>åŸç†ä¸æ˜¾ç¤ºç›¸åŒ<br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CGRect toRect = [self.<span class="keyword">originView </span>convertRect:self.<span class="keyword">originView.bounds </span>toView:self.window]<span class="comment">;</span></span><br><span class="line">[UIView animateWithDuration:<span class="number">0</span>.<span class="number">5</span> animations:^&#123;</span><br><span class="line">    cell.imageView.clipsToBounds = YES<span class="comment">;</span></span><br><span class="line">    cell.imageView.frame         = toRect<span class="comment">;</span></span><br><span class="line">    self.<span class="keyword">backgroundColor </span>        = [[UIColor alloc] initWithWhite:<span class="number">0</span> alpha:<span class="number">0</span>]<span class="comment">;</span></span><br><span class="line">&#125; completion:^(<span class="keyword">BOOL </span>finished) &#123;</span><br><span class="line">    [self removeFromSuperview]<span class="comment">;</span></span><br><span class="line">&#125;]<span class="comment">;</span></span><br></pre></td></tr></table></figure></p><h2 id="æ‹–æ‹½çš„æ‰‹åŠ¿"><a href="#æ‹–æ‹½çš„æ‰‹åŠ¿" class="headerlink" title="æ‹–æ‹½çš„æ‰‹åŠ¿"></a>æ‹–æ‹½çš„æ‰‹åŠ¿</h2><p>å°†æ‰‹åŠ¿æ·»åŠ åœ¨<code>CollectionViewCell</code>ä¸­<code>ScrollView</code>ä¸Šï¼Œå¹¶éµå¾ª<code>UIGestureRecognizerDelegate</code>åè®®ï¼Œä¸ç„¶ä¼š<code>CollectionView</code>æ— æ³•è¿›è¡Œæ»šåŠ¨æ“ä½œã€‚</p><ol><li>å£°æ˜ä¸€ä¸ªå…¨å±€å±æ€§</li></ol><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CGPoint firstTouchPoint<span class="comment">;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>å®ç°ä»£ç†</li></ol><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#pragma mark - UIGestureRecognizer Delegate Method</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)gestureRecognizer:(<span class="built_in">UIGestureRecognizer</span> *)gestureRecognizer shouldReceiveTouch:(<span class="built_in">UITouch</span> *)touch &#123;</span><br><span class="line">    firstTouchPoint = [touch locationInView:<span class="keyword">self</span>.window];</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">BOOL</span>)gestureRecognizerShouldBegin:(<span class="built_in">UIGestureRecognizer</span> *)gestureRecognizer &#123;</span><br><span class="line">    <span class="built_in">CGPoint</span> touchPoint = [gestureRecognizer locationInView:<span class="keyword">self</span>.window];</span><br><span class="line">    <span class="built_in">CGFloat</span> dirTop = firstTouchPoint.y - touchPoint.y;</span><br><span class="line">    <span class="keyword">if</span> (dirTop &gt; <span class="number">-10</span> &amp;&amp; dirTop &lt; <span class="number">10</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">CGFloat</span> dirLift = firstTouchPoint.x - touchPoint.x;</span><br><span class="line">    <span class="keyword">if</span> (dirLift &gt; <span class="number">-10</span> &amp;&amp; dirLift &lt; <span class="number">10</span> &amp;&amp; <span class="keyword">self</span>.scrollView.frame.size.height &gt; [[<span class="built_in">UIScreen</span> mainScreen] bounds].size.height) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br><span class="line">```</span><br></pre></td></tr></table></figure><ol start="3"><li>æ‹–åŠ¨æ‰‹åŠ¿æ“ä½œï¼ŒåŒæ„ä»£ç†ä¼ ç»™<code>View</code></li></ol><ul><li><p>åè®®æ–¹æ³•</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="meta">@class</span> WDImageCollectionViewCell;</span><br><span class="line"><span class="meta">@protocol</span> WDImageCollectionViewCellDelegate &lt;NSObject&gt;</span><br><span class="line">- (<span class="keyword">void</span>)<span class="string">collectionViewCell:</span>(WDImageCollectionViewCell *)cell <span class="string">singleTapActionWithImageUrl:</span>(NSString *)imageUrl;</span><br><span class="line">- (<span class="keyword">void</span>)<span class="string">collectionViewCell:</span>(WDImageCollectionViewCell *)cell <span class="string">panActionWithPercent:</span>(CGFloat)percent;</span><br><span class="line">- (<span class="keyword">void</span>)<span class="string">collectionViewCell:</span>(WDImageCollectionViewCell *)cell <span class="string">dimssViewWithImageUrl:</span>(NSString *)imageUrl;</span><br><span class="line"><span class="meta">@end</span></span><br></pre></td></tr></table></figure></li><li><p>æ‹–åŠ¨æ‰‹åŠ¿æ–¹æ³•</p></li></ul><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#pragma mark - UIGestureRecognizer Target Event</span></span><br><span class="line"><span class="comment">/** æ»‘åŠ¨æ‰‹åŠ¿ */</span></span><br><span class="line">- (<span class="keyword">void</span>)didRecognizedPanGuesture:(<span class="built_in">UIPanGestureRecognizer</span> *)pan &#123;</span><br><span class="line">    <span class="built_in">CGPoint</span> point = [pan translationInView:<span class="keyword">self</span>.window];</span><br><span class="line">    <span class="built_in">CGFloat</span> scale = <span class="number">1.0</span> - ABS(point.y) / [[<span class="built_in">UIScreen</span> mainScreen] bounds].size.height;</span><br><span class="line">    <span class="keyword">switch</span> (pan.state) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="built_in">UIGestureRecognizerStateBegan</span>: &#123;&#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="built_in">UIGestureRecognizerStateChanged</span>:</span><br><span class="line">        &#123;</span><br><span class="line">            scale = MAX(scale, <span class="number">0</span>);</span><br><span class="line">            <span class="built_in">CGFloat</span> s = MAX(scale, <span class="number">0.5</span>);</span><br><span class="line">            <span class="built_in">CGAffineTransform</span> translation = <span class="built_in">CGAffineTransformMakeTranslation</span>(point.x / s, point.y / s);</span><br><span class="line">            <span class="built_in">CGAffineTransform</span> translationScale = <span class="built_in">CGAffineTransformMakeScale</span>(s, s);</span><br><span class="line">            <span class="keyword">self</span>.imageView.transform = <span class="built_in">CGAffineTransformConcat</span>(translation, translationScale);</span><br><span class="line">            <span class="comment">// ä¼ å‡ºtranslationScaleï¼Œä¿®æ”¹èƒŒæ™¯é¢œè‰²é€æ˜åº¦</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">self</span>.delegate &amp;&amp; [<span class="keyword">self</span>.delegate respondsToSelector:<span class="keyword">@selector</span>(collectionViewCell:panActionWithPercent:)]) &#123;</span><br><span class="line">                [<span class="keyword">self</span>.delegate collectionViewCell:<span class="keyword">self</span> panActionWithPercent:scale];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span>  <span class="built_in">UIGestureRecognizerStateCancelled</span> | <span class="built_in">UIGestureRecognizerStateFailed</span>:</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">self</span>.imageView.transform = <span class="built_in">CGAffineTransformIdentity</span>;</span><br><span class="line">            <span class="comment">// å›å¤åˆå§‹æ ·å¼ï¼Œä¼ å‡ºtranslationScaleï¼Œä¿®æ”¹èƒŒæ™¯é¢œè‰²é€æ˜åº¦</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">self</span>.delegate &amp;&amp; [<span class="keyword">self</span>.delegate respondsToSelector:<span class="keyword">@selector</span>(collectionViewCell:panActionWithPercent:)]) &#123;</span><br><span class="line">                [<span class="keyword">self</span>.delegate collectionViewCell:<span class="keyword">self</span> panActionWithPercent:<span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="built_in">UIGestureRecognizerStateEnded</span>:</span><br><span class="line">        &#123;</span><br><span class="line">            [<span class="built_in">UIView</span> animateWithDuration:<span class="number">0.5</span> animations:^&#123;</span><br><span class="line">                <span class="built_in">CGAffineTransform</span> transform1 = <span class="built_in">CGAffineTransformMakeTranslation</span>(<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">                <span class="keyword">self</span>.imageView.transform = <span class="built_in">CGAffineTransformScale</span>(transform1, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">            &#125;];</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// å›å¤åˆå§‹æ ·å¼ï¼Œä¼ å‡ºtranslationScaleï¼Œä¿®æ”¹èƒŒæ™¯é¢œè‰²é€æ˜åº¦</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">self</span>.delegate &amp;&amp; [<span class="keyword">self</span>.delegate respondsToSelector:<span class="keyword">@selector</span>(collectionViewCell:panActionWithPercent:)]) &#123;</span><br><span class="line">                [<span class="keyword">self</span>.delegate collectionViewCell:<span class="keyword">self</span> panActionWithPercent:scale];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (scale &lt; <span class="number">0.7</span>) &#123;</span><br><span class="line">                <span class="comment">// æ‹–åŠ¨ç»“æŸï¼Œè®©é¡µé¢æ¶ˆå¤±</span></span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">self</span>.delegate &amp;&amp; [<span class="keyword">self</span>.delegate respondsToSelector:<span class="keyword">@selector</span>(collectionViewCell:dimssViewWithImageUrl:)]) &#123;</span><br><span class="line">                    [<span class="keyword">self</span>.delegate collectionViewCell:<span class="keyword">self</span> dimssViewWithImageUrl:<span class="keyword">self</span>.imageUrl];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// å›å¤åˆå§‹æ ·å¼ï¼Œä¼ å‡ºtranslationScaleï¼Œä¿®æ”¹èƒŒæ™¯é¢œè‰²é€æ˜åº¦</span></span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">self</span>.delegate &amp;&amp; [<span class="keyword">self</span>.delegate respondsToSelector:<span class="keyword">@selector</span>(collectionViewCell:panActionWithPercent:)]) &#123;</span><br><span class="line">                    [<span class="keyword">self</span>.delegate collectionViewCell:<span class="keyword">self</span> panActionWithPercent:<span class="number">1</span>];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å›¾ç‰‡åŠ è½½"><a href="#å›¾ç‰‡åŠ è½½" class="headerlink" title="å›¾ç‰‡åŠ è½½"></a>å›¾ç‰‡åŠ è½½</h2><p>ä½¿ç”¨<code>SDWebImage</code>è·å–å›¾ç‰‡ï¼Œé€šè¿‡<code>FLAnimatedImageView</code>åŠ è½½<code>gif</code>å›¾</p><h2 id="Githubåœ°å€"><a href="#Githubåœ°å€" class="headerlink" title="Githubåœ°å€"></a>Githubåœ°å€</h2><p><a href="https://github.com/wudan-ios/WDImageBrowser.git" target="_blank" rel="noopener">é¡¹ç›®åœ°å€</a></p><h2 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾"></a>æ•ˆæœå›¾</h2><p><img src="https://upload-images.jianshu.io/upload_images/3334769-daf79ce9d51e3359.gif?imageMogr2/auto-orient/strip" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/3334769-32704538aebd1e35.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot;
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>JavaScriptä¸åŸç”Ÿäº¤äº’</title>
    <link href="https://wudan-ios.github.io/2019/03/29/JavaScript%E4%B8%8E%E5%8E%9F%E7%94%9F%E4%BA%A4%E4%BA%92/"/>
    <id>https://wudan-ios.github.io/2019/03/29/JavaScriptä¸åŸç”Ÿäº¤äº’/</id>
    <published>2019-03-29T01:19:55.918Z</published>
    <updated>2019-04-26T01:11:51.548Z</updated>
    
    <content type="html"><![CDATA[<p> <img src="https://upload-images.jianshu.io/upload_images/3334769-b397461b46272052.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å®ä¾‹æ ·å¼"></p><p>åŸç”Ÿé¡µé¢ä¸HTMLé¡µé¢è¿›è¡Œç›¸äº’è°ƒç”¨<br>æ–¹å¼ | é€‚ç”¨å¯¹è±¡<br>â€”|â€”<br>æ‹¦æˆªURL | <code>UIWebView</code>å’Œ<code>WKWebView</code><br>JavaScriptCore | <code>UIWebView</code><br>MessageHandler | <code>WKWebView</code><br>WebViewJavascriptBridge| <code>UIWebView</code>å’Œ<code>WKWebView</code></p><h3 id="å®ä¾‹HTMLä»£ç "><a href="#å®ä¾‹HTMLä»£ç " class="headerlink" title="å®ä¾‹HTMLä»£ç "></a>å®ä¾‹HTMLä»£ç </h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>æŒ‰é’®ç‚¹å‡»<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">onclick</span>=<span class="string">"buttonEvent()"</span> <span class="attr">id</span>=<span class="string">"submitButto"</span>&gt;</span>æäº¤<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>æ–‡ä»¶ä¸Šä¼ <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>åŸç”Ÿæ³¨å…¥æ•°æ®<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"textField"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">onclick</span>=<span class="string">"getTextEvent()"</span> <span class="attr">value</span>=<span class="string">"å¼€å§‹æ³¨å…¥"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="actionscript">        <span class="function"><span class="keyword">function</span> <span class="title">loadURL</span><span class="params">(url)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">var</span> iFrame;</span></span><br><span class="line"><span class="javascript">            iFrame = <span class="built_in">document</span>.createElement(<span class="string">"iframe"</span>);</span></span><br><span class="line"><span class="actionscript">            iFrame.setAttribute(<span class="string">"src"</span>, url);</span></span><br><span class="line"><span class="actionscript">            iFrame.setAttribute(<span class="string">"style"</span>, <span class="string">"display:none;"</span>);</span></span><br><span class="line"><span class="actionscript">            iFrame.setAttribute(<span class="string">"height"</span>, <span class="string">"0px"</span>);</span></span><br><span class="line"><span class="actionscript">            iFrame.setAttribute(<span class="string">"width"</span>, <span class="string">"0px"</span>);</span></span><br><span class="line"><span class="actionscript">            iFrame.setAttribute(<span class="string">"frameborder"</span>, <span class="string">"0"</span>);</span></span><br><span class="line"><span class="javascript">            <span class="built_in">document</span>.body.appendChild(iFrame);</span></span><br><span class="line"><span class="undefined">            iFrame.parentNode.removeChild(iFrame);</span></span><br><span class="line"><span class="actionscript">            iFrame = <span class="literal">null</span>;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="actionscript">        <span class="function"><span class="keyword">function</span> <span class="title">buttonEvent</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="actionscript">            loadURL(<span class="string">"/buttonEvent"</span>);</span></span><br><span class="line"><span class="undefined">            buttonDidPapped();</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    </span></span><br><span class="line"><span class="actionscript">        <span class="function"><span class="keyword">function</span> <span class="title">getTextEvent</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">            loadURL(<span class="string">"/getText"</span>);</span></span><br><span class="line"><span class="undefined">            getTextButtonDidPapped();</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="actionscript">        <span class="function"><span class="keyword">function</span> <span class="title">getText</span><span class="params">(text)</span></span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">document</span>.getElementById(<span class="string">"textField"</span>).value = text;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="æ‹¦æˆªURL"><a href="#æ‹¦æˆªURL" class="headerlink" title="æ‹¦æˆªURL"></a>æ‹¦æˆªURL</h2><h4 id="UIWebView"><a href="#UIWebView" class="headerlink" title="UIWebView"></a>UIWebView</h4><p>éµå¾ª<code>UIWebViewDelegate</code>è°ƒç”¨<code>- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType</code>æ–¹æ³•ï¼Œåˆ¤æ–­è·å–çš„Urlåœ°å€<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è°ƒç”¨JS</span></span><br><span class="line"><span class="keyword">if</span> ([request.URL.absoluteString <span class="string">hasSuffix:</span>@<span class="string">"buttonEvent"</span>]) &#123;</span><br><span class="line">    UIAlertController *vc = [<span class="string">UIAlertControlleralertControllerWithTitle:</span>@<span class="string">"æ¸©é¦¨æç¤º"</span> <span class="string">message:</span>@<span class="string">"ç‚¹å‡»äº†æäº¤æŒ‰é’®"</span> <span class="string">preferredStyle:</span>UIAlertControllerStyleAlert];</span><br><span class="line">        [vc <span class="string">addAction:</span>[UIAlertAction <span class="string">actionWithTitle:</span>@<span class="string">"ç¡®å®š"</span> <span class="string">style:</span>UIAlertActionStyleDefault <span class="string">handler:</span>^(UIAlertAction * _Nonnull action) &#123;</span><br><span class="line">            </span><br><span class="line">    &#125;]];</span><br><span class="line">    [self <span class="string">presentViewController:</span>vc <span class="string">animated:</span><span class="literal">true</span> <span class="string">completion:</span>nil];  </span><br><span class="line">    <span class="keyword">return</span> NO;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// æ³¨å…¥æ•°æ®ç»™JS</span></span><br><span class="line"><span class="keyword">if</span> ([request.URL.absoluteString <span class="string">hasSuffix:</span>@<span class="string">"getText"</span>]) &#123; </span><br><span class="line">    [webView <span class="string">stringByEvaluatingJavaScriptFromString:</span>@<span class="string">"getText('å“ˆå“ˆ')"</span>];</span><br><span class="line">     <span class="keyword">return</span> NO;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> YES;</span><br></pre></td></tr></table></figure></p><h4 id="WKWebView"><a href="#WKWebView" class="headerlink" title="WKWebView"></a>WKWebView</h4><p>éµå¾ª<code>WKNavigationDelegate</code>è°ƒç”¨<code>- (void)webView:(WKWebView *)webView decidePolicyForNavigationAction:(WKNavigationAction *)navigationAction decisionHandler:(void (^)(WKNavigationActionPolicy))decisionHandler</code>æ–¹æ³•åˆ¤æ–­è·å–çš„åœ°å€<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *strRequest = [navigationAction.request.URL.absoluteString stringByRemovingPercentEncoding];</span><br><span class="line"><span class="comment">// è°ƒç”¨JS</span></span><br><span class="line"><span class="keyword">if</span> ([strRequest hasSuffix:<span class="string">@"buttonEvent"</span>]) &#123;</span><br><span class="line">    <span class="built_in">UIAlertController</span> *vc = [<span class="built_in">UIAlertController</span> alertControllerWithTitle:<span class="string">@"æ¸©é¦¨æç¤º"</span> message:<span class="string">@"ç‚¹å‡»äº†æäº¤æŒ‰é’®"</span> preferredStyle:<span class="built_in">UIAlertControllerStyleAlert</span>];</span><br><span class="line">    [vc addAction:[<span class="built_in">UIAlertAction</span> actionWithTitle:<span class="string">@"ç¡®å®š"</span> style:<span class="built_in">UIAlertActionStyleDefault</span> handler:^(<span class="built_in">UIAlertAction</span> * _Nonnull action) &#123;</span><br><span class="line">            </span><br><span class="line">    &#125;]];</span><br><span class="line">    [<span class="keyword">self</span> presentViewController:vc animated:<span class="literal">true</span> completion:<span class="literal">nil</span>];</span><br><span class="line">    decisionHandler(<span class="built_in">WKNavigationActionPolicyCancel</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> ([strRequest hasSuffix:<span class="string">@"getText"</span>]) &#123; <span class="comment">// æ³¨å…¥æ•°æ®ç»™JS</span></span><br><span class="line">    [webView evaluateJavaScript:<span class="string">@"getText('å“ˆå“ˆ')"</span> completionHandler:^(<span class="keyword">id</span> _Nullable info, <span class="built_in">NSError</span> * _Nullable error) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"Error--%@, info--%@"</span>, error, info);</span><br><span class="line">    &#125;];</span><br><span class="line">    decisionHandler(<span class="built_in">WKNavigationActionPolicyCancel</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    decisionHandler(<span class="built_in">WKNavigationActionPolicyAllow</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="JavaScriptCore"><a href="#JavaScriptCore" class="headerlink" title="JavaScriptCore"></a>JavaScriptCore</h2><ol><li>å¯¼å…¥<code>&lt;JavaScriptCore/JavaScriptCore.h&gt;</code></li><li>éµå¾ª<code>&lt;UIWebViewDelegate&gt;</code>å¹¶å®ç°<code>- (void)webViewDidFinishLoad:(UIWebView *)webView</code>æ–¹æ³•ã€‚</li></ol><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¹JSContextå¯¹è±¡è¿›è¡Œåˆå§‹åŒ–</span></span><br><span class="line">JSContext *context = [self.webView <span class="string">valueForKeyPath:</span>@<span class="string">"documentView.webView.mainFrame.javaScriptContext"</span>];</span><br><span class="line"><span class="comment">// éªŒè¯JSContextå¯¹è±¡æ˜¯å¦åˆå§‹åŒ–æˆåŠŸ</span></span><br><span class="line">context.exceptionHandler = ^(JSContext *context, JSValue *exceptionValue)&#123;</span><br><span class="line">    context.exception = exceptionValue;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// è°ƒç”¨JS  </span></span><br><span class="line">context[@<span class="string">"buttonDidPapped"</span>] = ^&#123;</span><br><span class="line">    UIAlertController *vc = [UIAlertController <span class="string">alertControllerWithTitle:</span>@<span class="string">"æ¸©é¦¨æç¤º"</span> <span class="string">message:</span>@<span class="string">"ç‚¹å‡»äº†æäº¤æŒ‰é’®"</span> <span class="string">preferredStyle:</span>UIAlertControllerStyleAlert];</span><br><span class="line">    [vc <span class="string">addAction:</span>[UIAlertAction <span class="string">actionWithTitle:</span>@<span class="string">"ç¡®å®š"</span> <span class="string">style:</span>UIAlertActionStyleDefault <span class="string">handler:</span>^(UIAlertAction * _Nonnull action) &#123;</span><br><span class="line">            </span><br><span class="line">    &#125;]];</span><br><span class="line">    [self <span class="string">presentViewController:</span>vc <span class="string">animated:</span><span class="literal">true</span> <span class="string">completion:</span>nil];</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// æ³¨å…¥æ•°æ®ç»™JS   </span></span><br><span class="line">context[@<span class="string">"getTextButtonDidPapped"</span>] = ^&#123;</span><br><span class="line">    dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">      [self.webView <span class="string">stringByEvaluatingJavaScriptFromString:</span>@<span class="string">"getText('å“ˆå“ˆ')"</span>];</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="MessageHandler"><a href="#MessageHandler" class="headerlink" title="MessageHandler"></a>MessageHandler</h2><ol><li>ä¿®æ”¹jsä¸­çš„æ–¹æ³•ï¼Œ é€šè¿‡<code>window.webkit.messageHandlers</code>+æ“ä½œæ–¹æ³•</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">buttonEvent</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">window</span>.webkit.messageHandlers.buttonEvent.postMessage(<span class="literal">null</span>);</span><br><span class="line">&#125;</span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getTextEvent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">window</span>.webkit.messageHandlers.getTextEvent.postMessage(<span class="literal">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li><p>éµå¾ª<code>WKScriptMessageHandler</code></p></li><li><p>åœ¨<code>- (void)viewWillAppear:(BOOL)animated</code>ä¸­æ·»åŠ <code>scriptMessageHandler</code></p></li><li><p>åœ¨<code>- (void)viewWillDisappear:(BOOL)animated</code>ä¸­ç§»é™¤<code>scriptMessageHandler</code></p></li><li><p>å®ç°<code>WKScriptMessageHandler</code>æ–¹æ³•</p></li></ol><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)viewWillAppear:(<span class="built_in">BOOL</span>)animated &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewWillAppear:animated];</span><br><span class="line">    [<span class="keyword">self</span>.webView.configuration.userContentController addScriptMessageHandler:<span class="keyword">self</span> name:<span class="string">@"buttonEvent"</span>];</span><br><span class="line">    [<span class="keyword">self</span>.webView.configuration.userContentController addScriptMessageHandler:<span class="keyword">self</span> name:<span class="string">@"getTextEvent"</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewWillDisappear:(<span class="built_in">BOOL</span>)animated &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewWillDisappear:animated];</span><br><span class="line">    [<span class="keyword">self</span>.webView.configuration.userContentController removeScriptMessageHandlerForName:<span class="string">@"buttonEvent"</span>];</span><br><span class="line">    [<span class="keyword">self</span>.webView.configuration.userContentController removeScriptMessageHandlerForName:<span class="string">@"getTextEvent"</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - WKScriptMessageHandler Method</span></span><br><span class="line">- (<span class="keyword">void</span>)userContentController:(<span class="built_in">WKUserContentController</span> *)userContentController didReceiveScriptMessage:(<span class="built_in">WKScriptMessage</span> *)message &#123;</span><br><span class="line">    <span class="comment">// è°ƒç”¨JS</span></span><br><span class="line">    <span class="keyword">if</span> ([message.name isEqualToString:<span class="string">@"buttonEvent"</span>]) &#123;</span><br><span class="line">        <span class="built_in">UIAlertController</span> *vc = [<span class="built_in">UIAlertController</span> alertControllerWithTitle:<span class="string">@"æ¸©é¦¨æç¤º"</span> message:<span class="string">@"ç‚¹å‡»äº†æäº¤æŒ‰é’®"</span> preferredStyle:<span class="built_in">UIAlertControllerStyleAlert</span>];</span><br><span class="line">        [vc addAction:[<span class="built_in">UIAlertAction</span> actionWithTitle:<span class="string">@"ç¡®å®š"</span> style:<span class="built_in">UIAlertActionStyleDefault</span> handler:^(<span class="built_in">UIAlertAction</span> * _Nonnull action) &#123;</span><br><span class="line">            </span><br><span class="line">        &#125;]];</span><br><span class="line">        [<span class="keyword">self</span> presentViewController:vc animated:<span class="literal">true</span> completion:<span class="literal">nil</span>];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ³¨å…¥æ•°æ®ç»™JS</span></span><br><span class="line">    <span class="keyword">if</span>  ([message.name isEqualToString:<span class="string">@"getTextEvent"</span>]) &#123;</span><br><span class="line">        [<span class="keyword">self</span>.webView evaluateJavaScript:<span class="string">@"getText('å“ˆå“ˆ')"</span> completionHandler:^(<span class="keyword">id</span> _Nullable info, <span class="built_in">NSError</span> * _Nullable error) &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"Error--%@, info--%@"</span>, error, info);</span><br><span class="line">        &#125;];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="WebViewJavascriptBridge"><a href="#WebViewJavascriptBridge" class="headerlink" title="WebViewJavascriptBridge"></a>WebViewJavascriptBridge</h2><p>HTMLä»£ç <br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>æŒ‰é’®ç‚¹å‡»<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span> = <span class="string">'submitBtn'</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"æäº¤æŒ‰é’®"</span> <span class="attr">onclick</span>=<span class="string">"submitClick()"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>æ–‡ä»¶é€‰æ‹©<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">id</span>=<span class="string">"image"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>æ³¨å…¥æ•°æ®<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"getTextField"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"å¼€å§‹è·å–"</span> <span class="attr">id</span> = <span class="string">'startGet'</span> <span class="attr">onclick</span>=<span class="string">"getTextClick()"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="actionscript">        <span class="function"><span class="keyword">function</span> <span class="title">setupWebViewJavascriptBridge</span><span class="params">(callback)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">if</span> (<span class="built_in">window</span>.WebViewJavascriptBridge) &#123; <span class="keyword">return</span> callback(WebViewJavascriptBridge); &#125;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">if</span> (<span class="built_in">window</span>.WVJBCallbacks) &#123; <span class="keyword">return</span> <span class="built_in">window</span>.WVJBCallbacks.push(callback); &#125;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">window</span>.WVJBCallbacks = [callback];</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> WVJBIframe = <span class="built_in">document</span>.createElement(<span class="string">'iframe'</span>);</span></span><br><span class="line"><span class="actionscript">        WVJBIframe.style.display = <span class="string">'none'</span>;</span></span><br><span class="line"><span class="actionscript">        WVJBIframe.src = <span class="string">'https://__bridge_loaded__'</span>;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.documentElement.appendChild(WVJBIframe);</span></span><br><span class="line"><span class="javascript">        setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="built_in">document</span>.documentElement.removeChild(WVJBIframe) &#125;, <span class="number">0</span>)</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="actionscript">        setupWebViewJavascriptBridge(<span class="function"><span class="keyword">function</span><span class="params">(bridge)</span> </span>&#123;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        &#125;)</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="actionscript">        <span class="function"><span class="keyword">function</span> <span class="title">submitClick</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">            WebViewJavascriptBridge.callHandler(<span class="string">'submitClick'</span>, <span class="literal">null</span>, <span class="function"><span class="keyword">function</span><span class="params">(response)</span> </span>&#123;</span></span><br><span class="line"><span class="undefined">                </span></span><br><span class="line"><span class="undefined">            &#125;);</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="actionscript">        <span class="function"><span class="keyword">function</span> <span class="title">getTextClick</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">            WebViewJavascriptBridge.callHandler(<span class="string">'getTextClick'</span>, <span class="literal">null</span>, <span class="function"><span class="keyword">function</span><span class="params">(response)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">document</span>.getElementById(<span class="string">"getTextField"</span>).value = response;</span></span><br><span class="line"><span class="undefined">            &#125;);</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>ç¬¬ä¸‰æ–¹åº“ï¼š<a href="https://github.com/marcuswestin/WebViewJavascriptBridge" target="_blank" rel="noopener">åœ°å€</a></p><ol><li>æ·»åŠ <code>WebViewJavascriptBridge</code>åº“</li><li>å¯¼å…¥å¤´æ–‡ä»¶<code>#import &lt;WebViewJavascriptBridge.h&gt;</code></li><li>å£°æ˜æ–¹æ³•<code>@property WebViewJavascriptBridge* bridge;</code></li><li>ä¸WebViewå…³è”</li></ol><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">_bridge</span> = [WebViewJavascriptBridge bridgeForWebView:self.webView];</span><br><span class="line"></span><br><span class="line"><span class="section">[_bridge setWebViewDelegate:self]</span><span class="comment">;</span></span><br></pre></td></tr></table></figure><ol start="5"><li><p>è°ƒç”¨js</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[<span class="name">_bridge</span> registerHandler:@<span class="string">"submitClick"</span> handler:^(<span class="name">id</span> data, WVJBResponseCallback responseCallback) &#123;</span><br><span class="line">        UIAlertController *vc = [<span class="name">UIAlertController</span> alertControllerWithTitle:@<span class="string">"æ¸©é¦¨æç¤º"</span> message:@<span class="string">"ç‚¹å‡»äº†æäº¤æŒ‰é’®"</span> preferredStyle:UIAlertControllerStyleAlert]<span class="comment">;</span></span><br><span class="line">        [<span class="name">vc</span> addAction:[<span class="name">UIAlertAction</span> actionWithTitle:@<span class="string">"ç¡®å®š"</span> style:UIAlertActionStyleDefault handler:^(<span class="name">UIAlertAction</span> * _Nonnull action) &#123;</span><br><span class="line">            </span><br><span class="line">        &#125;]]<span class="comment">;</span></span><br><span class="line">        [<span class="name">self</span> presentViewController:vc animated:true completion:nil]<span class="comment">;</span></span><br><span class="line">&#125;]<span class="comment">;</span></span><br></pre></td></tr></table></figure></li><li><p>æ³¨å…¥æ•°æ®</p></li></ol><figure class="highlight hy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[_bridge registerHandler:@<span class="string">"getTextClick"</span> handler:^(<span class="name"><span class="builtin-name">id</span></span> data, WVJBResponseCallback responseCallback) &#123;</span><br><span class="line">        responseCallback(@<span class="string">"å“ˆå“ˆå“ˆ"</span>)<span class="comment">;</span></span><br><span class="line">&#125;]<span class="comment">;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt; &lt;img src=&quot;https://upload-images.jianshu.io/upload_images/3334769-b397461b46272052.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>iOS å•å…ƒæµ‹è¯•</title>
    <link href="https://wudan-ios.github.io/2019/03/27/iOS%20%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/"/>
    <id>https://wudan-ios.github.io/2019/03/27/iOS å•å…ƒæµ‹è¯•/</id>
    <published>2019-03-27T07:58:09.443Z</published>
    <updated>2019-04-26T01:15:22.325Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://upload-images.jianshu.io/upload_images/3334769-4eef772205a43353.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é•‡æ¥¼ä¸“ç”¨"></p><h2 id="å•å…ƒæµ‹è¯•"><a href="#å•å…ƒæµ‹è¯•" class="headerlink" title="å•å…ƒæµ‹è¯•"></a>å•å…ƒæµ‹è¯•</h2><p>ä»¥æµ‹è¯•ViewControllerä¸ºä¾‹ã€‚</p><h5 id="ViewController-hæ–‡ä»¶"><a href="#ViewController-hæ–‡ä»¶" class="headerlink" title="ViewController.hæ–‡ä»¶"></a>ViewController.hæ–‡ä»¶</h5><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> : <span class="title">UIViewController</span></span></span><br><span class="line"><span class="comment">/** é€»è¾‘æµ‹è¯• */</span></span><br><span class="line">- (<span class="keyword">int</span>)getSumWithNum1:(<span class="keyword">int</span>)a num2:(<span class="keyword">int</span>)b;</span><br><span class="line"><span class="comment">/** å¼‚æ­¥æµ‹è¯• */</span></span><br><span class="line">- (<span class="keyword">void</span>)loadDataComplete:(<span class="keyword">void</span>(^)(<span class="keyword">id</span> info))complete;</span><br><span class="line"><span class="comment">/** æ€§èƒ½æµ‹è¯• */</span></span><br><span class="line">- (<span class="keyword">void</span>)openCamera;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><h5 id="ViewController-mæ–‡ä»¶"><a href="#ViewController-mæ–‡ä»¶" class="headerlink" title="ViewController.mæ–‡ä»¶"></a>ViewController.mæ–‡ä»¶</h5><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">int</span>)getSumWithNum1:(<span class="keyword">int</span>)a num2:(<span class="keyword">int</span>)b &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)loadDataComplete:(<span class="keyword">void</span> (^)(<span class="keyword">id</span>))complete &#123;    </span><br><span class="line">    <span class="built_in">dispatch_async</span>(dispatch_get_global_queue(<span class="number">0</span>, <span class="number">0</span>), ^&#123;</span><br><span class="line">        sleep(<span class="number">2</span>);</span><br><span class="line">        <span class="built_in">NSString</span> *data = <span class="string">@"ğŸ˜"</span>;</span><br><span class="line">        <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">            complete(data);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)openCamera &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; ++i) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²%d"</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºäº†è¿›è¡Œå•å…ƒåŒ–æµ‹è¯•ï¼Œæ‰€ä»¥æ–°å»ºä¸€ä¸ª<code>ViewControllerTest</code>æ–‡ä»¶ã€‚<br>æ­¥éª¤<br><img src="https://upload-images.jianshu.io/upload_images/3334769-c0d1455212a740ba.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ–°å»ºæ–‡ä»¶"></p><ul><li>å¯¼å…¥æµ‹è¯•å¤´æ–‡ä»¶<code>#import &quot;ViewController.h&quot;</code></li><li>å£°æ˜å±æ€§<code>@property (nonatomic, strong) ViewController *vc;</code></li><li>åœ¨<code>- (void)setUp;</code>è¿›è¡Œåˆå§‹åŒ–ä»£ç </li></ul><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (void)setUp &#123;</span><br><span class="line">    self.vc = <span class="comment">[<span class="comment">[ViewController alloc]</span> init]</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1ã€é€»è¾‘æµ‹è¯•"><a href="#1ã€é€»è¾‘æµ‹è¯•" class="headerlink" title="1ã€é€»è¾‘æµ‹è¯•"></a>1ã€é€»è¾‘æµ‹è¯•</h3><ol><li>ç»™å‡ºæµ‹è¯•æ•°æ®</li><li>è¿›è¡Œæµ‹è¯•</li><li>ä½¿ç”¨æ–­è¨€è¿›è¡Œåˆ¤å®š</li></ol><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)testSum &#123;</span><br><span class="line"><span class="comment">// 1. given</span></span><br><span class="line"><span class="keyword">int</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> b = <span class="number">22</span>;</span><br><span class="line"><span class="comment">// 2. when</span></span><br><span class="line"><span class="keyword">int</span> <span class="keyword">sum</span> = [self.vc getSumWithNum1:a num2:b];</span><br><span class="line"><span class="comment">// 3. then</span></span><br><span class="line">XCTAssertEqual(<span class="keyword">sum</span>, <span class="number">32</span>, @<span class="string">"é”™è¯¯"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ã€å¼‚æ­¥æµ‹è¯•"><a href="#2ã€å¼‚æ­¥æµ‹è¯•" class="headerlink" title="2ã€å¼‚æ­¥æµ‹è¯•"></a>2ã€å¼‚æ­¥æµ‹è¯•</h3><ol><li>åˆ›å»º<code>XCTestExpectation</code>ï¼Œè®¾ç½®é”™è¯¯æç¤º</li><li><p>è°ƒç”¨æ–¹æ³•ï¼Œåœ¨å¼‚æ­¥ä¸­è°ƒç”¨<code>fulfill</code></p></li><li><p>è¿›è¡Œåˆ¤æ–­æ—¶é—´ï¼Œæ˜¯å¦åœ¨é¢„æœŸæ—¶é—´å†…å®¹</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">XCTestExpectation</span> *exp = [<span class="keyword">self</span> expectationWithDescription:<span class="string">@"è¶…è¿‡é¢„æœŸæ—¶é—´"</span>];</span><br><span class="line">[<span class="keyword">self</span>.vc loadDataComplete:^(<span class="keyword">id</span> info) &#123;</span><br><span class="line">    <span class="built_in">XCTAssertNil</span>(info, <span class="string">@"æ•°æ®ä¸ºç©º"</span>);</span><br><span class="line">    [exp fulfill];</span><br><span class="line">&#125;];</span><br><span class="line">[<span class="keyword">self</span> waitForExpectationsWithTimeout:<span class="number">4</span> handler:^(<span class="built_in">NSError</span> * _Nullable error) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, error);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure></li></ol><h3 id="3ã€æ€§èƒ½æµ‹è¯•"><a href="#3ã€æ€§èƒ½æµ‹è¯•" class="headerlink" title="3ã€æ€§èƒ½æµ‹è¯•"></a>3ã€æ€§èƒ½æµ‹è¯•</h3><p><img src="https://upload-images.jianshu.io/upload_images/3334769-96f0facc7307a744.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ€§èƒ½æµ‹è¯•"></p><ol><li>è®¾ç½®Baselineæ—¶é—´</li><li>Max STDDEV æœ€å¤§æ ·æœ¬æ ‡å‡†åå·®æ¯”ä¾‹</li></ol><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="literal">void</span>)testPerformanceExample &#123;</span><br><span class="line">    <span class="meta">[</span><span class="built_in">self</span> measureBlock:^&#123;</span><br><span class="line">        <span class="meta">[</span><span class="built_in">self</span>.vc openCamera<span class="meta">]</span>;</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="UIæµ‹è¯•"><a href="#UIæµ‹è¯•" class="headerlink" title="UIæµ‹è¯•"></a>UIæµ‹è¯•</h2><p><img src="https://upload-images.jianshu.io/upload_images/3334769-0dc163b565bdcbf6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è„šæœ¬å½•åˆ¶"><br>1ã€å½•åˆ¶è„šæœ¬<br><br>2ã€ç¼–è¾‘è„šæœ¬<br><br>3ã€è‡ªåŠ¨åŒ–æµ‹è¯•</p><h2 id="è·å–ä»£ç è¦†ç›–ç‡"><a href="#è·å–ä»£ç è¦†ç›–ç‡" class="headerlink" title="è·å–ä»£ç è¦†ç›–ç‡"></a>è·å–ä»£ç è¦†ç›–ç‡</h2><p>1ã€ç‚¹å‡»<code>Edit Secheme</code><br><img src="https://upload-images.jianshu.io/upload_images/3334769-4a5476214d38ea7d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Edit Secheme"><br>2ã€é€‰æ‹©<code>Test</code>-&gt;<code>Options</code>-&gt;<code>Code Coverage</code>å‹¾èµ·<br><img src="https://upload-images.jianshu.io/upload_images/3334769-b1b529d4111e737b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Code Coverage"><br>3ã€è¿è¡Œä»£ç æŸ¥çœ‹ç»“æœ<br><img src="https://upload-images.jianshu.io/upload_images/3334769-01e76835566d7ae7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æŸ¥çœ‹ç»“æœ"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/3334769-4eef772205a43353.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>å±æ€§ä¿®é¥°è¯</title>
    <link href="https://wudan-ios.github.io/2019/03/27/%E5%B1%9E%E6%80%A7%E4%BF%AE%E9%A5%B0%E8%AF%8D/"/>
    <id>https://wudan-ios.github.io/2019/03/27/å±æ€§ä¿®é¥°è¯/</id>
    <published>2019-03-27T02:19:31.456Z</published>
    <updated>2019-03-27T02:19:32.272Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://upload-images.jianshu.io/upload_images/3334769-f0679730c4864b7b.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é•‡æ¥¼ä¸“ç”¨"></p><h3 id="property"><a href="#property" class="headerlink" title="@property"></a>@property</h3><p>é»˜è®¤æ ¼å¼ï¼š<code>@syntheszie var = _var;</code></p><p><code>ARC</code>ä¸­ï¼Œé»˜è®¤ä¿®é¥°<br></p><ul><li>åŸºæœ¬æ•°æ®ç±»å‹<code>@property (atomic, assign)</code><br></li><li>å¯¹è±¡æ•°æ®ç±»å‹<code>@property (atomic, strong)</code></li></ul><h3 id="ä¿®é¥°è¯è§£é‡Š"><a href="#ä¿®é¥°è¯è§£é‡Š" class="headerlink" title="ä¿®é¥°è¯è§£é‡Š"></a>ä¿®é¥°è¯è§£é‡Š</h3><ul><li><p><code>nonatomic</code> éåŸå­æ€§è®¿é—®ï¼Œä¸å¯¹setæ–¹æ³•åŠ é”ï¼Œä¸æ˜¯å®‰å…¨çº¿ç¨‹ï¼Œä½†æ˜¯æ€§èƒ½é«˜ã€‚</p></li><li><p><code>atomic</code> åŸå­æ€§è®¿é—®ï¼Œå¯¹ç”Ÿæˆçš„ set æ–¹æ³•åŠ äº’æ–¥é” @synchronized(é”å¯¹è±¡ï¼‰ï¼Œå®‰å…¨çº¿ç¨‹ï¼ˆä¸æ˜¯ç»å¯¹å®‰å…¨çº¿ç¨‹ï¼‰,æ€§èƒ½å·®ã€‚</p></li><li><code>strong</code>ARCä¸­ä½¿ç”¨ï¼Œä¿®é¥°OCå¯¹è±¡ï¼Œ<code>æ‹¥æœ‰å…³ç³»</code>ï¼Œå¼•ç”¨è®¡æ•°å™¨+1ã€‚</li><li><code>reatain</code>MRCä¸­ä½¿ç”¨ï¼Œä¿®é¥°OCå¯¹è±¡ï¼Œ<code>æ‹¥æœ‰å…³ç³»</code>ï¼Œå¼•ç”¨è®¡æ•°å™¨+1ã€‚</li><li><code>assign</code>ä¿®é¥°åŸºç¡€æ•°æ®ç±»å‹ï¼Œç›´æ¥èµ‹å€¼ï¼Œ<code>éæ‹¥æœ‰å…³ç³»</code>ï¼Œä¸ä½¿ç”¨å¼•ç”¨è®¡æ•°å™¨ã€‚</li><li><code>weak</code>ä¿®é¥°åè®®ï¼Œæ§ä»¶ï¼Œ<code>éæ‹¥æœ‰å…³ç³»</code>ï¼ŒæŒ‡å‘çš„å¯¹è±¡é”€æ¯ï¼ŒæŒ‡é’ˆä¼šè‡ªåŠ¨ç½®ä¸ºnilï¼Œä¸ä½¿ç”¨å¼•ç”¨è®¡æ•°å™¨ã€‚</li><li><code>unsafe_unretained</code>ä¸weakç±»ä¼¼ï¼Œä¸ä¼šè‡ªåŠ¨nilåŒ–ï¼Œå¦‚æœæ‰€æŒ‡å‘çš„å†…å­˜åŒºåŸŸè¢«é‡Šæ”¾äº†ï¼Œè¿™ä¸ªæŒ‡é’ˆå°±æ˜¯ä¸€ä¸ªé‡æŒ‡é’ˆã€‚</li><li><code>copy</code>åœ¨ MRC æ—¶æ˜¯è¿™æ ·åšçš„ release æ—§å¯¹è±¡( æ—§å¯¹è±¡çš„å¼•ç”¨è®¡æ•°å™¨ -1 ) , copy æ–°å¯¹è±¡( æ–°å¯¹è±¡çš„å¼•ç”¨è®¡æ•°å™¨ +1 ) , ç„¶åæŒ‡å‘æ–°å¯¹è±¡ .ï¼ˆæ–°å¯¹è±¡æ˜¯æŒ‡æœ€ç»ˆæŒ‡å‘çš„é‚£ä¸ªå¯¹è±¡ï¼Œä¸ç®¡æ·±æ‹·è´è¿˜æ˜¯æµ…æ‹·è´ï¼‰ï¼Œåœ¨ ARC æ—¶æ˜¯è¿™ä¹ˆå¹²çš„ copy æ–°å¯¹è±¡( æ–°å¯¹è±¡çš„å¼•ç”¨è®¡æ•°å™¨ +1 ) , ç„¶åæŒ‡å‘æ–°å¯¹è±¡ã€‚</li><li><code>readonly</code>åªç”Ÿæˆgetæ–¹æ³•ï¼Œä¸æƒ³æŠŠæš´éœ²çš„å±æ€§è¢«äººéšä¾¿æ›¿æ¢æ—¶ , å¯ä»¥ä½¿ç”¨ã€‚</li><li><code>readwrite</code>ç”Ÿæˆget/setæ–¹æ³•ã€‚</li></ul><h3 id="dynamic"><a href="#dynamic" class="headerlink" title="@dynamic"></a>@dynamic</h3><p>å‘Šè¯‰ç¼–è¯‘å™¨:å±æ€§çš„ setter ä¸ getter æ–¹æ³•ç”±ç”¨æˆ·è‡ªå·±å®ç°,ä¸è‡ªåŠ¨ç”Ÿæˆã€‚(å½“ç„¶å¯¹äº readonly çš„å±æ€§åªéœ€æä¾› getter å³å¯)</p><h3 id="synthesize"><a href="#synthesize" class="headerlink" title="@synthesize"></a>@synthesize</h3><p>å¦‚æœä½ æ²¡æœ‰æ‰‹åŠ¨å®ç° setter æ–¹æ³•å’Œ getter æ–¹æ³•,é‚£ä¹ˆç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ä¸ºä½ åŠ ä¸Šè¿™ä¸¤ä¸ªæ–¹æ³•ã€‚</p><h3 id="synchronized"><a href="#synchronized" class="headerlink" title="@synchronized"></a>@synchronized</h3><p>çº¿ç¨‹åŒæ­¥é”</p><h3 id="é—®é¢˜ï¼š"><a href="#é—®é¢˜ï¼š" class="headerlink" title="é—®é¢˜ï¼š"></a>é—®é¢˜ï¼š</h3><p>ï¼ˆ1ï¼‰ä»€ä¹ˆæƒ…å†µä½¿ç”¨ weak å…³é”®å­—ï¼Ÿç›¸æ¯” assign æœ‰ä»€ä¹ˆä¸åŒ?</p><ul><li>ä½¿ç”¨<blockquote><ol><li>åè®®å£°æ˜ä½¿ç”¨weak</li><li>IBOutlet ä½¿ç”¨weak</li></ol></blockquote></li><li>weak å’Œ assign çš„ä¸åŒç‚¹:<blockquote><p>weak ç­–ç•¥åœ¨å±æ€§æ‰€æŒ‡çš„å¯¹è±¡é­åˆ°æ‘§æ¯æ—¶,ç³»ç»Ÿä¼šå°† weak ä¿®é¥°çš„å±æ€§å¯¹è±¡çš„æŒ‡é’ˆæŒ‡å‘ nil,åœ¨ OC ç»™ nil å‘æ¶ˆæ¯æ˜¯ä¸ä¼šæœ‰ä»€ä¹ˆé—®é¢˜çš„;å¦‚æœä½¿ç”¨ assign ç­–ç•¥åœ¨å±æ€§æ‰€æŒ‡çš„å¯¹è±¡é­åˆ°æ‘§æ¯æ—¶,å±æ€§å¯¹è±¡æŒ‡é’ˆè¿˜æŒ‡å‘åŸæ¥çš„å¯¹è±¡,ç”±äºå¯¹è±¡å·²ç»è¢«é”€æ¯,è¿™æ—¶å€™å°±äº§ç”Ÿäº†é‡æŒ‡é’ˆ,å¦‚æœè¿™æ—¶å€™åœ¨ç»™æ­¤å¯¹è±¡å‘é€æ¶ˆæ¯,å¾ˆå®¹é€ æˆç¨‹åºå¥”æºƒassigin å¯ä»¥ç”¨äºä¿®é¥°é OC å¯¹è±¡,è€Œ weak å¿…é¡»ç”¨äº OC å¯¹è±¡ã€‚</p></blockquote></li></ul><p>ï¼ˆ2ï¼‰ä½¿ç”¨ atomic ä¸€å®šæ˜¯çº¿ç¨‹å®‰å…¨çš„å—?</p><ul><li>ä¸æ˜¯,atomic çš„æœ¬æ„æ˜¯æŒ‡å±æ€§çš„å­˜å–æ–¹æ³•æ˜¯çº¿ç¨‹å®‰å…¨çš„,å¹¶ä¸ä¿è¯æ•´ä¸ªå¯¹è±¡æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚<blockquote><p>ä¾‹å¦‚ï¼š å£°æ˜ä¸€ä¸ª NSMutableArray çš„åŸå­å±æ€§ stuff,æ­¤æ—¶ self.stuff å’Œ self.stuff =othersulf éƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä½†æ˜¯,ä½¿ç”¨[self.stuff objectAtIndex:index]å°±ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„,éœ€è¦ç”¨äº’æ–¥é”æ¥ä¿è¯çº¿ç¨‹å®‰å…¨æ€§ã€‚</p></blockquote></li></ul><p>ï¼ˆ3ï¼‰@synthesize å’Œ @dynamic åˆ†åˆ«æœ‰ä»€ä¹ˆä½œç”¨</p><ul><li><p>@property æœ‰ä¸¤ä¸ªå¯¹åº”çš„è¯,ä¸€ä¸ªæ˜¯@synthesize,ä¸€ä¸ªæ˜¯@dynamicã€‚<br>å¦‚æœ@synthesize å’Œ@dynamic éƒ½æ²¡å†™,é‚£ä¹ˆé»˜è®¤çš„å°±æ˜¯<br>@syntheszie var = _var;</p></li><li><p>@synthesize çš„è¯­ä¹‰æ˜¯å¦‚æœä½ æ²¡æœ‰æ‰‹åŠ¨å®ç° setter æ–¹æ³•å’Œ getter æ–¹æ³•,é‚£ä¹ˆç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ä¸ºä½ åŠ ä¸Šè¿™ä¸¤ä¸ªæ–¹æ³•ã€‚</p></li><li>@dynamic å‘Šè¯‰ç¼–è¯‘å™¨:å±æ€§çš„ setter ä¸ getter æ–¹æ³•ç”±ç”¨æˆ·è‡ªå·±å®ç°,ä¸è‡ªåŠ¨ç”Ÿæˆã€‚(å½“ç„¶å¯¹äº readonly çš„å±æ€§åªéœ€æä¾› getter å³å¯)</li><li>å‡å¦‚ä¸€ä¸ªå±æ€§è¢«å£°æ˜ä¸º@dynamic varï¼›ç„¶åä½ æ²¡æœ‰æä¾›@setter æ–¹æ³•å’Œ@getter æ–¹æ³•,ç¼–è¯‘çš„æ—¶å€™æ²¡é—®é¢˜,ä½†æ˜¯å½“ç¨‹åºè¿è¡Œåˆ° instance.var = someVar,ç”±äºç¼º setteræ–¹æ³•ä¼šå¯¼è‡´ç¨‹åºå´©æºƒ;<br>æˆ–è€…å½“è¿è¡Œåˆ° someVar = instance.var æ—¶,ç”±äºç¼º getter æ–¹æ³•åŒæ ·ä¼šå¯¼è‡´å´©æºƒã€‚</li></ul><p>ï¼ˆ4ï¼‰ARC ä¸‹,ä¸æ˜¾å¼æŒ‡å®šä»»ä½•å±æ€§å…³é”®å­—æ—¶,é»˜è®¤çš„å…³é”®å­—éƒ½æœ‰å“ªäº›?</p><ul><li><p>åŸºæœ¬æ•°æ®ï¼š  <code>atomic,readwrite,assign</code></p></li><li><p>æ™®é€šçš„ OC å¯¹è±¡: <code>atomic,readwrite,strong</code></p></li></ul><p>ï¼ˆ5ï¼‰ç”¨@property å£°æ˜çš„ NSString(æˆ– NSArray,NSDictionary)ç»å¸¸ä½¿ç”¨ copy å…³é”®å­—,ä¸ºä»€ä¹ˆ?å¦‚æœæ”¹ç”¨ strong å…³é”®å­—,å¯èƒ½é€ æˆä»€ä¹ˆé—®é¢˜?</p><blockquote><p>å› ä¸ºçˆ¶ç±»æŒ‡é’ˆå¯ä»¥æŒ‡å‘å­ç±»å¯¹è±¡,ä½¿ç”¨ copy çš„ç›®çš„æ˜¯ä¸ºäº†è®©æœ¬å¯¹è±¡çš„å±æ€§ä¸å—å¤–ç•Œå½±å“,ä½¿ç”¨ copy æ— è®ºç»™æˆ‘ä¼ å…¥æ˜¯ä¸€ä¸ªå¯å˜å¯¹è±¡è¿˜æ˜¯ä¸å¯å¯¹è±¡,æˆ‘æœ¬èº«æŒæœ‰çš„å°±æ˜¯ä¸€ä¸ªä¸å¯å˜çš„å‰¯æœ¬.</p><p>å¦‚æœæˆ‘ä»¬ä½¿ç”¨æ˜¯ strong,é‚£ä¹ˆè¿™ä¸ªå±æ€§å°±æœ‰å¯èƒ½æŒ‡å‘ä¸€ä¸ªå¯å˜å¯¹è±¡,å¦‚æœè¿™ä¸ªå¯å˜å¯¹è±¡åœ¨å¤–éƒ¨è¢«ä¿®æ”¹äº†,é‚£ä¹ˆä¼šå½±å“è¯¥å±æ€§.</p></blockquote><p>ï¼ˆ6ï¼‰è¿™ä¸ªå†™æ³•ä¼šå‡ºä»€ä¹ˆé—®é¢˜: @property(copy)NSMutableArray *array;</p><blockquote><p>å› ä¸º copy ç­–ç•¥æ‹·è´å‡ºæ¥çš„æ˜¯ä¸€ä¸ªä¸å¯å˜å¯¹è±¡,ç„¶è€Œå´æŠŠå®ƒå½“æˆå¯å˜å¯¹è±¡ä½¿ç”¨,å¾ˆå®¹æ˜“é€ æˆç¨‹åºå¥”æºƒè¿™é‡Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜,è¯¥å±æ€§ä½¿ç”¨äº†åŒæ­¥é”,ä¼šåœ¨åˆ›å»ºæ—¶ç”Ÿæˆä¸€äº›é¢å¤–çš„ä»£ç ç”¨äºå¸®åŠ©ç¼–å†™å¤šçº¿ç¨‹ç¨‹åº,è¿™ä¼šå¸¦æ¥æ€§èƒ½é—®é¢˜,é€šè¿‡å£°æ˜ nonatomic å¯ä»¥èŠ‚çœè¿™äº›è™½ç„¶<br>å¾ˆå°ä½†æ˜¯ä¸å¿…è¦é¢å¤–å¼€é”€,åœ¨ iOS å¼€å‘ä¸­åº”è¯¥ä½¿ç”¨ nonatomic æ›¿ä»£ atomic.</p></blockquote><p>ï¼ˆ7ï¼‰å¦‚ä½•è®©è‡ªå®šä¹‰ç±»å¯ä»¥ç”¨ copy ä¿®é¥°ç¬¦?å¦‚ä½•é‡å†™å¸¦ copy å…³é”®å­—çš„ setter?</p><blockquote><p>è‹¥æƒ³ä»¤è‡ªå·±æ‰€å†™çš„å¯¹è±¡å…·æœ‰æ‹·è´åŠŸèƒ½,åˆ™éœ€å®ç° NSCopying åè®®ã€‚<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®ç°ä¸å¯å˜ç‰ˆæœ¬æ‹·è´</span></span><br><span class="line">- (<span class="keyword">id</span>)copyWithZone:(<span class="built_in">NSZone</span> *)zone; <span class="comment">// å®ç°å¯å˜ç‰ˆæœ¬æ‹·è´</span></span><br><span class="line">- (<span class="keyword">id</span>)mutableCopyWithZone:(<span class="built_in">NSZone</span> *)zone;</span><br><span class="line"><span class="comment">// é‡å†™å¸¦ copy å…³é”®å­—çš„ setter</span></span><br><span class="line">- (<span class="keyword">void</span>)setName:(<span class="built_in">NSString</span> *)name &#123;</span><br><span class="line">    _name = [name <span class="keyword">copy</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></blockquote><h3 id="æ·±æ‹·è´å’Œæµ…æ‹·è´"><a href="#æ·±æ‹·è´å’Œæµ…æ‹·è´" class="headerlink" title="æ·±æ‹·è´å’Œæµ…æ‹·è´"></a>æ·±æ‹·è´å’Œæµ…æ‹·è´</h3><h4 id="copy-å’Œ-mutableCopy"><a href="#copy-å’Œ-mutableCopy" class="headerlink" title="copy å’Œ mutableCopy"></a>copy å’Œ mutableCopy</h4><ul><li><p><code>copy</code>æ‹·è´å‡ºæ¥çš„å¯¹è±¡ç±»å‹æ€»æ˜¯ä¸å¯å˜ç±»å‹(ä¾‹å¦‚, NSString, NSDictionary, NSArrayç­‰ç­‰)</p></li><li><p><code>mutableCopy</code>æ‹·è´å‡ºæ¥çš„å¯¹è±¡ç±»å‹æ€»æ˜¯å¯å˜ç±»å‹(ä¾‹å¦‚, NSMutableString, NSMutableDictionary, NSMutableArrayç­‰ç­‰)</p></li></ul><hr><ul><li><code>copy</code> å¯¹äºå¯å˜å¯¹è±¡ä¸ºæ·±æ‹·è´ï¼Œå¯¹äºä¸å¯å˜å¯¹è±¡ä¸ºæµ…æ‹·è´</li><li><code>mutableCopy</code> å§‹ç»ˆæ˜¯æ·±æ‹·è´</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/3334769-f0679730c4864b7b.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Block</title>
    <link href="https://wudan-ios.github.io/2019/03/26/Block/"/>
    <id>https://wudan-ios.github.io/2019/03/26/Block/</id>
    <published>2019-03-26T02:46:08.805Z</published>
    <updated>2019-03-26T02:46:08.997Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://upload-images.jianshu.io/upload_images/3334769-cd0f22bd52a1e015.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é•‡æ¥¼ä¸“ç”¨"></p><h3 id="Blockçš„å®è´¨"><a href="#Blockçš„å®è´¨" class="headerlink" title="Blockçš„å®è´¨"></a>Blockçš„å®è´¨</h3><p>æœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ä¸ªOCå¯¹è±¡ï¼Œä»–å†…éƒ¨ä¹Ÿæœ‰ä¸€ä¸ªisaæŒ‡é’ˆã€‚Blockæ˜¯å°è£…äº†å‡½æ•°è°ƒç”¨ä»¥åŠå‡½æ•°è°ƒç”¨ç¯å¢ƒçš„OCå¯¹è±¡ã€‚</p><h3 id="Blockä¸‰ç§ç±»å‹"><a href="#Blockä¸‰ç§ç±»å‹" class="headerlink" title="Blockä¸‰ç§ç±»å‹"></a>Blockä¸‰ç§ç±»å‹</h3><table><thead><tr><th>ç±»å‹</th><th>å­˜å‚¨åŒºåŸŸ</th></tr></thead><tbody><tr><td>GlobalBlock</td><td>æ•°æ®åŒº</td></tr><tr><td>StackBlock</td><td>æ ˆåŒº</td></tr><tr><td>MallocBlock</td><td>å †åŒº</td></tr></tbody></table><h3 id="Blocké¿å…å¾ªç¯å¼•ç”¨çš„ä¸‰ç§æ–¹å¼"><a href="#Blocké¿å…å¾ªç¯å¼•ç”¨çš„ä¸‰ç§æ–¹å¼" class="headerlink" title="Blocké¿å…å¾ªç¯å¼•ç”¨çš„ä¸‰ç§æ–¹å¼"></a>Blocké¿å…å¾ªç¯å¼•ç”¨çš„ä¸‰ç§æ–¹å¼</h3><p>1ã€åˆ©ç”¨ <code>__weak</code>å’Œ<code>__strong</code><br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> __<span class="keyword">weak</span> <span class="keyword">typeof</span>(<span class="keyword">self</span>) weakSelf = <span class="keyword">self</span>;</span><br><span class="line"><span class="keyword">self</span>.block = ^&#123;</span><br><span class="line">    __<span class="keyword">strong</span> <span class="keyword">typeof</span>(<span class="keyword">self</span>) strongSelf = weakSelf;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, <span class="built_in">NSStringFromCGRect</span>(strongSelf.view.frame));</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">self</span>.block();</span><br></pre></td></tr></table></figure></p><p>2ã€åˆ©ç”¨é€ æˆå¾ªç¯å¼•ç”¨çš„ä¸´æ—¶å˜é‡<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">__block ViewController *vc = <span class="keyword">self</span>;</span><br><span class="line"><span class="keyword">self</span>.block = ^&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, <span class="built_in">NSStringFromCGRect</span>(vc.view.frame));</span><br><span class="line">    vc = <span class="literal">nil</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">self</span>.block();</span><br></pre></td></tr></table></figure></p><p>3ã€ç›´æ¥å£°æ˜Blockä¸­æ·»åŠ é€ æˆå¾ªç¯å¼•ç”¨çš„å‚æ•°<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">void</span>(^Block)(<span class="built_in">UIViewController</span> *vc);</span><br><span class="line"></span><br><span class="line"><span class="keyword">self</span>.block = ^(<span class="built_in">UIViewController</span> *vc)&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, <span class="built_in">NSStringFromCGRect</span>(vc.view.frame));</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">self</span>.block(<span class="keyword">self</span>);</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/3334769-cd0f22bd52a1e015.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot;
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>KVO</title>
    <link href="https://wudan-ios.github.io/2019/03/26/KVO/"/>
    <id>https://wudan-ios.github.io/2019/03/26/KVO/</id>
    <published>2019-03-26T02:45:39.565Z</published>
    <updated>2019-03-26T02:45:40.608Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://upload-images.jianshu.io/upload_images/3334769-0c2f7bf66b38a01a.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é•‡æ¥¼ä¸“ç”¨"></p><h3 id="ç±»çš„å•ä¸ªå±æ€§è§‚å¯Ÿ"><a href="#ç±»çš„å•ä¸ªå±æ€§è§‚å¯Ÿ" class="headerlink" title="ç±»çš„å•ä¸ªå±æ€§è§‚å¯Ÿ"></a>ç±»çš„å•ä¸ªå±æ€§è§‚å¯Ÿ</h3><p>è§‚å¯Ÿå€¼çš„4ä¸­æ¨¡å¼<br><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  NSKeyValueObservingOptionNew     æ–°å€¼</span></span><br><span class="line"><span class="comment"> *  NSKeyValueObservingOptionOld     æ—§å€¼</span></span><br><span class="line"><span class="comment"> *  NSKeyValueObservingOptionInitial æ³¨å†Œå‘é€é€šçŸ¥ï¼Œæ”¹å˜æ—¶å‘é€é€šçŸ¥</span></span><br><span class="line"><span class="comment"> *  NSKeyValueObservingOptionPrior   æ”¹å˜ä¹‹å‰å‘é€é€šçŸ¥ï¼Œæ”¹å˜åå‘é€é€šçŸ¥</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure></p><p>é’ˆå¯¹<code>Person</code>ç±»é‡Œé¢çš„<code>name</code>å±æ€§è¿›è¡Œè§‚å¯Ÿ<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[person <span class="string">addObserver:</span>self <span class="string">forKeyPath:</span>@<span class="string">"name"</span> <span class="string">options:</span>NSKeyValueObservingOptionNew <span class="string">context:</span>nil];</span><br></pre></td></tr></table></figure></p><p>æŸ¥çœ‹è§‚å¯Ÿ<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)observeValueForKeyPath:(<span class="built_in">NSString</span> *)keyPath ofObject:(<span class="keyword">id</span>)object change:(<span class="built_in">NSDictionary</span>&lt;<span class="built_in">NSKeyValueChangeKey</span>,<span class="keyword">id</span>&gt; *)change context:(<span class="keyword">void</span> *)context &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, change);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ‰“å°æ•ˆæœ<br><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2019-03-22</span> <span class="number">09</span>:<span class="number">20</span>:<span class="number">16.875033</span>+<span class="number">0800</span> KVO[<span class="number">1844:81256</span>] &#123;</span><br><span class="line">    kind = <span class="number">1</span><span class="comment">;</span></span><br><span class="line">    new = <span class="number">0</span><span class="comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="ç±»çš„é‡Œé¢åµŒå¥—å…¶ä»–çš„å±æ€§è§‚å¯Ÿ"><a href="#ç±»çš„é‡Œé¢åµŒå¥—å…¶ä»–çš„å±æ€§è§‚å¯Ÿ" class="headerlink" title="ç±»çš„é‡Œé¢åµŒå¥—å…¶ä»–çš„å±æ€§è§‚å¯Ÿ"></a>ç±»çš„é‡Œé¢åµŒå¥—å…¶ä»–çš„å±æ€§è§‚å¯Ÿ</h3><p>è§‚å¯Ÿ<code>Person</code>é‡Œé¢<code>Dog</code>ç±»çš„<code>age</code>ï¼Œé€šè¿‡ç‚¹è¯­æ³•ç›´æ¥ç›‘å¬<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[person <span class="string">addObserver:</span>self <span class="string">forKeyPath:</span>@<span class="string">"dog.age"</span> <span class="string">options:</span>NSKeyValueObservingOptionNew <span class="string">context:</span>nil];</span><br></pre></td></tr></table></figure></p><p>è¾“å…¥ç»“æœ<br><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2019-03-22</span> <span class="number">09</span>:<span class="number">23</span>:<span class="number">25.854859</span>+<span class="number">0800</span> KVO[<span class="number">1876:84141</span>] &#123;</span><br><span class="line">    kind = <span class="number">1</span><span class="comment">;</span></span><br><span class="line">    new = <span class="number">11</span><span class="comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="ä¸€æ¬¡æ€§è§‚å¯Ÿå¤šä¸ªå€¼"><a href="#ä¸€æ¬¡æ€§è§‚å¯Ÿå¤šä¸ªå€¼" class="headerlink" title="ä¸€æ¬¡æ€§è§‚å¯Ÿå¤šä¸ªå€¼"></a>ä¸€æ¬¡æ€§è§‚å¯Ÿå¤šä¸ªå€¼</h3><p>ä¾‹å¦‚è§‚å¯Ÿ<code>Person</code>é‡Œé¢çš„<code>Dog</code>çš„<code>age</code>å’Œ<code>level</code>ï¼Œåˆ™åœ¨<code>Person</code>ç±»ä¸­é‡æ–°<code>+ (NSSet&lt;NSString *&gt; *)keyPathsForValuesAffectingValueForKey:(NSString *)key</code><br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="built_in">NSSet</span>&lt;<span class="built_in">NSString</span> *&gt; *)keyPathsForValuesAffectingValueForKey:(<span class="built_in">NSString</span> *)key &#123;</span><br><span class="line">    <span class="built_in">NSSet</span> *keyPaths = [<span class="keyword">super</span> keyPathsForValuesAffectingValueForKey:key];</span><br><span class="line">    <span class="keyword">if</span> ([key isEqualToString:<span class="string">@"dog"</span>]) &#123;</span><br><span class="line">        <span class="built_in">NSArray</span> *array = @[<span class="string">@"_dog.name"</span>, <span class="string">@"_dog.level"</span>];</span><br><span class="line">        keyPaths = [keyPaths setByAddingObjectsFromArray:array];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> keyPaths;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ç›´æ¥è§‚å¯Ÿ<code>Dog</code>ç±»<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[person <span class="string">addObserver:</span>self <span class="string">forKeyPath:</span>@<span class="string">"dog"</span> <span class="string">options:</span>NSKeyValueObservingOptionNew <span class="string">context:</span>nil];</span><br></pre></td></tr></table></figure></p><p>æ‰“å°ç»“æœ<br><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2019-03-22</span> <span class="number">09</span>:<span class="number">27:11.485240</span>+<span class="number">0800</span> KVO[<span class="number">1929:87568</span>] &#123;</span><br><span class="line">    kind = <span class="number">1</span><span class="comment">;</span></span><br><span class="line">    new = "&lt;Dog: <span class="number">0</span>x60<span class="number">00027c0b80</span>&gt;"<span class="comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="æ‰‹åŠ¨æ¨¡å¼"><a href="#æ‰‹åŠ¨æ¨¡å¼" class="headerlink" title="æ‰‹åŠ¨æ¨¡å¼"></a>æ‰‹åŠ¨æ¨¡å¼</h3><p>åœ¨Personç±»ä¸­é‡å†™<code>+ (BOOL)automaticallyNotifiesObserversForKey:(NSString *)key</code><br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="built_in">BOOL</span>)automaticallyNotifiesObserversForKey:(<span class="built_in">NSString</span> *)key &#123;</span><br><span class="line">    <span class="comment">// ä¿®æ”¹ä¸ºæ‰‹åŠ¨æ¨¡å¼</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ‰‹åŠ¨è§¦å‘<br><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="name">self.person</span> willChangeValueForKey:@<span class="string">"name"</span>]<span class="comment">;</span></span><br><span class="line">[<span class="name">self.person</span> didChangeValueForKey:@<span class="string">"name"</span>]<span class="comment">;</span></span><br></pre></td></tr></table></figure></p><h3 id="è§‚å¯Ÿå®¹å™¨ç±»"><a href="#è§‚å¯Ÿå®¹å™¨ç±»" class="headerlink" title="è§‚å¯Ÿå®¹å™¨ç±»"></a>è§‚å¯Ÿå®¹å™¨ç±»</h3><p>éœ€è¦åˆ©ç”¨<code>KVC</code><br>ä¾‹å¦‚è§‚å¯Ÿ<code>person</code>ä¸­çš„<code>array</code><br><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="name">self.person</span> mutableArrayValueForKey:@<span class="string">"array"</span>] addObject:@<span class="string">"obj"</span>]<span class="comment">;</span></span><br></pre></td></tr></table></figure></p><p>è¾“å‡ºç»“æœ<br><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2019-03-22</span> <span class="number">11</span>:<span class="number">02</span>:<span class="number">13.996095</span>+<span class="number">0800</span> KVO[<span class="number">5521:170395</span>] &#123;</span><br><span class="line">    indexes = "&lt;_NSCachedIndexSet: <span class="number">0</span>x<span class="number">600002216160</span>&gt;[number of indexes: <span class="number">1</span> (in <span class="number">1</span> ranges), indexes: (<span class="number">0</span>)]"<span class="comment">;</span></span><br><span class="line">    kind = <span class="number">2</span><span class="comment">;</span></span><br><span class="line">    new =     (</span><br><span class="line">        obj</span><br><span class="line">    )<span class="comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><hr><h3 id="KVOçš„åº•å±‚å®ç°"><a href="#KVOçš„åº•å±‚å®ç°" class="headerlink" title="KVOçš„åº•å±‚å®ç°"></a>KVOçš„åº•å±‚å®ç°</h3><p>å®è´¨ï¼šè§‚å¯Ÿå€¼çš„setteræ–¹æ³•<br>é€šè¿‡runtimeï¼Œæ–°å»ºä¸€ä¸ªå­ç±»ç»§æ‰¿äºè§‚å¯Ÿç±»ï¼ˆNSKVONotifing_ç±»åï¼‰ï¼ŒåŠ¨æ€çš„ä¿®æ”¹äº†è§‚å¯Ÿç±»çš„ç±»å‹ä¸ºå­ç±»çš„ç±»å‹,åœ¨å­ç±»é‡Œé¢é‡å†™setæ–¹æ³•ï¼Œè°ƒç”¨<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)<span class="string">setName:</span>(NSString *)name &#123;</span><br><span class="line">    [self <span class="string">willChangeValueForKey:</span>@<span class="string">"name"</span>];</span><br><span class="line">    [<span class="keyword">super</span> <span class="string">setName:</span>name];</span><br><span class="line">    [self <span class="string">didChangeValueForKey:</span>@<span class="string">"name"</span>];   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/3334769-0c2f7bf66b38a01a.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot;
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>iOS-3D Touch</title>
    <link href="https://wudan-ios.github.io/2019/03/21/iOS-3D%20Touch/"/>
    <id>https://wudan-ios.github.io/2019/03/21/iOS-3D Touch/</id>
    <published>2019-03-21T01:51:49.822Z</published>
    <updated>2019-03-21T02:05:23.145Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://upload-images.jianshu.io/upload_images/3334769-f28947056b8dfe49.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é•‡æ¥¼ä¸“ç”¨"></p><h3 id="æ¡Œé¢å›¾æ ‡ç‚¹å‡»"><a href="#æ¡Œé¢å›¾æ ‡ç‚¹å‡»" class="headerlink" title="æ¡Œé¢å›¾æ ‡ç‚¹å‡»"></a>æ¡Œé¢å›¾æ ‡ç‚¹å‡»</h3><p>éœ€è¦åœ¨<code>AppDelegate</code>é‡Œé¢è¿›è¡Œä»£ç ç¼–å†™ã€‚<br>1ã€åˆ›å»ºæ–¹å¼<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** type  å”¯ä¸€æ ‡ç¤ºrç¬¦</span></span><br><span class="line"><span class="comment">*  localizedTitle æ ‡é¢˜</span></span><br><span class="line"><span class="comment">*  localizedSubtitle å‰¯æ ‡é¢˜</span></span><br><span class="line"><span class="comment">*  icon UIApplicationShortcutIconå¯¹è±¡</span></span><br><span class="line"><span class="comment">*  userInfo ä¼ é€’ä¿¡æ¯</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ç³»ç»Ÿæä¾›çš„å›¾æ ‡ç”ŸæˆUIApplicationShortcutIconå¯¹è±¡</span></span><br><span class="line">UIApplicationShortcutItem *shoreItem1 = [[UIApplicationShortcutItem alloc] <span class="string">initWithType:</span>@<span class="string">"type1"</span></span><br><span class="line"><span class="string">localizedTitle:</span>@<span class="string">"æ ‡é¢˜"</span></span><br><span class="line"><span class="string">localizedSubtitle:</span>@<span class="string">"å‰¯æ ‡é¢˜"</span></span><br><span class="line"><span class="string">icon:</span>[UIApplicationShortcutIcon <span class="string">iconWithType:</span>UIApplicationShortcutIconTypeCompose]</span><br><span class="line"><span class="string">userInfo:</span>nil];</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨è‡ªå®šä¹‰å›¾ç‰‡ç”ŸæˆUIApplicationShortcutIconå¯¹è±¡</span></span><br><span class="line">UIApplicationShortcutItem *shoreItem2 = [[UIApplicationShortcutItem alloc] <span class="string">initWithType:</span>@<span class="string">"type2"</span></span><br><span class="line"><span class="string">localizedTitle:</span>@<span class="string">"æ ‡é¢˜2"</span></span><br><span class="line"><span class="string">localizedSubtitle:</span>@<span class="string">"å‰¯æ ‡é¢˜2"</span></span><br><span class="line"><span class="string">icon:</span>[UIApplicationShortcutIcon <span class="string">iconWithTemplateImageName:</span>@<span class="string">"éªŒè¯ç "</span>]</span><br><span class="line"><span class="string">userInfo:</span>nil];</span><br><span class="line">[UIApplication sharedApplication].shortcutItems = @[shoreItem1, shoreItem2];</span><br></pre></td></tr></table></figure></p><blockquote><p>æ³¨ï¼šç³»ç»Ÿçš„UIApplicationShortcutIconæ ·å¼ï¼Œè‡ªå·±å»ç ”ç©¶å§ï¼<a href="https://developer.apple.com/documentation/uikit/uiapplicationshortcuticontype?language=objc" target="_blank" rel="noopener">ç‚¹å‡»è¿™ä¸ªæ˜¯å®˜æ–¹åœ°å€</a></p></blockquote><p>2ã€ç‚¹å‡»å›è°ƒï¼Œå¯ä»¥æ ¹æ®<code>shortcutItem.type</code> è¿›è¡Œåˆ¤æ–­ç‚¹å‡»çš„æ˜¯å“ªä¸ªitem<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">application</span><span class="selector-pseudo">:(UIApplication</span> *)<span class="selector-tag">application</span> <span class="selector-tag">performActionForShortcutItem</span><span class="selector-pseudo">:(UIApplicationShortcutItem</span> *)<span class="selector-tag">shortcutItem</span> <span class="selector-tag">completionHandler</span><span class="selector-pseudo">:(void</span> (^)(BOOL))<span class="selector-tag">completionHandler</span> &#123;</span><br><span class="line"><span class="selector-tag">NSLog</span>(@<span class="string">"ç‚¹å‡»äº†%@"</span>, shortcutItem);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="åº”ç”¨å†…ï¼Œç‚¹å‡»è¿›è¡Œé¡µé¢æ“ä½œ"><a href="#åº”ç”¨å†…ï¼Œç‚¹å‡»è¿›è¡Œé¡µé¢æ“ä½œ" class="headerlink" title="åº”ç”¨å†…ï¼Œç‚¹å‡»è¿›è¡Œé¡µé¢æ“ä½œ"></a>åº”ç”¨å†…ï¼Œç‚¹å‡»è¿›è¡Œé¡µé¢æ“ä½œ</h3><p>1ã€éµå¾ªä»£ç†<code>UIViewControllerPreviewingDelegate</code></p><p>2ã€åˆ¤æ–­è®¾å¤‡æ˜¯å¦æ”¯æŒ<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">self</span>.traitCollection.forceTouchCapability == <span class="built_in">UIForceTouchCapabilityAvailable</span>)&#123;</span><br><span class="line">[<span class="keyword">self</span> registerForPreviewingWithDelegate:<span class="keyword">self</span> sourceView:<span class="keyword">self</span>.view];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"3D Touch  å¯ç”¨!"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"3D Touch  ä¸å¯ç”¨!"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>3ã€å®ç°ä»£ç†æ–¹æ³•<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">nullable</span> <span class="built_in">UIViewController</span> *)previewingContext:(<span class="keyword">id</span> &lt;<span class="built_in">UIViewControllerPreviewing</span>&gt;)previewingContext viewControllerForLocation:(<span class="built_in">CGPoint</span>)location &#123;</span><br><span class="line">NextViewController *vc = [[NextViewController alloc] init];</span><br><span class="line"><span class="keyword">return</span> vc;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(<span class="keyword">void</span>)previewingContext:(<span class="keyword">id</span>&lt;<span class="built_in">UIViewControllerPreviewing</span>&gt;)previewingContext commitViewController:(<span class="built_in">UIViewController</span> *)viewControllerToCommit &#123;</span><br><span class="line">[<span class="keyword">self</span> showViewController:viewControllerToCommit sender:<span class="keyword">self</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>4ã€åœ¨éœ€è¦æ˜¾ç¤ºçš„é¡µé¢é‡Œé¢è°ƒç”¨<code>- (NSArray&lt;id&lt;UIPreviewActionItem&gt;&gt; *)previewActionItems</code>æ·»åŠ Items<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">NSArray</span>&lt;<span class="keyword">id</span>&lt;<span class="built_in">UIPreviewActionItem</span>&gt;&gt; *)previewActionItems &#123;</span><br><span class="line"><span class="built_in">UIPreviewAction</span> *action1 = [<span class="built_in">UIPreviewAction</span> actionWithTitle:<span class="string">@"æ ‡é¢˜1"</span> style:<span class="built_in">UIPreviewActionStyleDefault</span> handler:^(<span class="built_in">UIPreviewAction</span> * _Nonnull action, <span class="built_in">UIViewController</span> * _Nonnull previewViewController) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"click---æ ‡é¢˜1"</span>);</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line"><span class="built_in">UIPreviewAction</span> *action2 = [<span class="built_in">UIPreviewAction</span> actionWithTitle:<span class="string">@"æ ‡é¢˜2"</span> style:<span class="built_in">UIPreviewActionStyleSelected</span> handler:^(<span class="built_in">UIPreviewAction</span> * _Nonnull action, <span class="built_in">UIViewController</span> * _Nonnull previewViewController) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"click---æ ‡é¢˜2"</span>);</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line"><span class="built_in">UIPreviewAction</span> *action3 = [<span class="built_in">UIPreviewAction</span> actionWithTitle:<span class="string">@"æ ‡é¢˜3"</span> style:<span class="built_in">UIPreviewActionStyleDestructive</span> handler:^(<span class="built_in">UIPreviewAction</span> * _Nonnull action, <span class="built_in">UIViewController</span> * _Nonnull previewViewController) &#123;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"click---æ ‡é¢˜3"</span>);</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSArray</span> *actions = @[action1,action2,action3];</span><br><span class="line"><span class="keyword">return</span> actions;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="æ¸©é¦¨æç¤º"><a href="#æ¸©é¦¨æç¤º" class="headerlink" title="æ¸©é¦¨æç¤º"></a>æ¸©é¦¨æç¤º</h3><ul><li>ç‚¹å‡»Appå›¾æ ‡æ˜¾ç¤ºæœ€åˆ†äº«æŒ‰é’®ï¼Œæ˜¯è‹¹æœç»™ä¸Šæ¶Appæ·»åŠ çš„<br><img src="https://upload-images.jianshu.io/upload_images/3334769-cffec3aa7180b169.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/680" alt="IMG_2873.PNG"></li><li>ç‚¹å‡»åˆ†äº«çš„æ•ˆæœ<br><img src="https://upload-images.jianshu.io/upload_images/3334769-ec648a2fc0916645.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/680" alt="IMG_2872.PNG"></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/3334769-f28947056b8dfe49.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Runtime-æ¶ˆæ¯è½¬å‘</title>
    <link href="https://wudan-ios.github.io/2019/03/19/Runtime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91/"/>
    <id>https://wudan-ios.github.io/2019/03/19/Runtime-æ¶ˆæ¯è½¬å‘/</id>
    <published>2019-03-19T05:15:50.881Z</published>
    <updated>2019-03-19T05:15:51.093Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://poldw0h4y.bkt.clouddn.com/%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B%E5%9B%BE.jpg" alt="æ¶ˆæ¯è½¬å‘æµç¨‹å›¾"></p><p>iOS æ–¹æ³•çš„åŠ¨æ€è§£æå’Œæ¶ˆæ¯è½¬å‘</p><p>ä»¥åˆ›å»ºçš„Messageç±»ä¸ºç¤ºä¾‹<br>Message.h<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@interface</span> <span class="string">Message :</span> NSObject</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)<span class="string">sendMessage:</span>(NSString *)message;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)<span class="string">sendClassMessage:</span>(NSString *)message;</span><br><span class="line"></span><br><span class="line"><span class="meta">@end</span></span><br></pre></td></tr></table></figure></p><p>Message.m<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@implementation</span> Message</span><br><span class="line"></span><br><span class="line"><span class="variable">@end</span></span><br></pre></td></tr></table></figure></p><h3 id="åŠ¨æ€æ–¹æ³•è§£æ"><a href="#åŠ¨æ€æ–¹æ³•è§£æ" class="headerlink" title="åŠ¨æ€æ–¹æ³•è§£æ"></a>åŠ¨æ€æ–¹æ³•è§£æ</h3><p>å¾è¯¢æ¥æ”¶è€…æ‰€å±çš„ç±»ï¼Œæ˜¯å¦éœ€è¦åŠ¨æ€æ·»åŠ ç±»æ–¹æ³•æˆ–å®ä¾‹æ–¹æ³•ï¼Œæ¥å¤„ç†è¿™ä¸ªæœªæ‰¾åˆ°çš„æ–¹æ³•ã€‚</p><ol><li>é¦–å…ˆåˆ¤æ–­æ˜¯å¦å®ç°äº† <code>resolveInstanceMethod</code>ï¼Œå¦‚æœæ²¡æœ‰å®ç°ï¼Œè¿›å…¥ä¸‹ä¸€æ­¥å¤„ç†ï¼›</li><li>å¦‚æœå®ç°äº†ï¼Œè°ƒç”¨ <code>resolveInstanceMethod</code>ï¼Œè·å–è¿”å›å€¼ï¼›</li><li>å¦‚æœè¿”å›å€¼ä¸º YESï¼Œè¡¨ç¤º <code>resolveInstanceMethod</code> å£°ç§°å®ƒå·²ç»æä¾›äº† <code>selector</code> çš„å®ç°ï¼Œå› æ­¤å†æ¬¡æŸ¥æ‰¾ method listï¼Œå¦‚æœæ‰¾åˆ°å¯¹åº”çš„ <code>IMP</code>ï¼Œåˆ™è¿”å›è¯¥å®ç°ï¼Œå¦åˆ™æç¤ºè­¦å‘Šä¿¡æ¯ï¼Œè¿›å…¥ä¸‹ä¸€æ­¥å¤„ç†ï¼›</li><li>å¦‚æœè¿”å›å€¼ä¸º NOï¼Œè¿›å…¥ä¸‹ä¸€æ­¥å¤„ç†ï¼›<h4 id="1-å¯¹è±¡æ–¹æ³•"><a href="#1-å¯¹è±¡æ–¹æ³•" class="headerlink" title="1. å¯¹è±¡æ–¹æ³•"></a>1. å¯¹è±¡æ–¹æ³•</h4>é€šè¿‡<code>+ (BOOL)resolveInstanceMethod:(SEL)sel;</code>æ–¹æ³•è¿›è¡Œè§£æ<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">+ (BOOL)resolveInstanceMethod:(SEL)sel &#123;</span><br><span class="line">    <span class="keyword">if</span> (sel == <span class="meta">@selector(sendMessage:)</span>) &#123;</span><br><span class="line">        class_addMethod([self <span class="class"><span class="keyword">class</span>], <span class="type">sel</span>, <span class="type"></span></span>(IMP)innerSenderMessageMetod, <span class="string">"v@:@"</span>);</span><br><span class="line">        <span class="keyword">return</span> YES;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">super</span> resolveInstanceMethod:sel];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void innerSenderMessageMetod(id obj, SEL _cmd) &#123;</span><br><span class="line">    NSLog(@<span class="string">"å¯¹è±¡æ–¹æ³•ï¼ŒåŠ¨æ€è§£æ"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h4 id="2-ç±»æ–¹æ³•"><a href="#2-ç±»æ–¹æ³•" class="headerlink" title="2. ç±»æ–¹æ³•"></a>2. ç±»æ–¹æ³•</h4><p>é€šè¿‡<code>+ (BOOL)resolveClassMethod:(SEL)sel;</code>æ–¹æ³•è¿›è¡Œè§£æ<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="built_in">BOOL</span>)resolveClassMethod:(SEL)sel &#123;</span><br><span class="line">    <span class="keyword">if</span> (sel == <span class="keyword">@selector</span>(sendClassMessage:)) &#123;</span><br><span class="line">        class_addMethod(object_getClass(<span class="keyword">self</span>), sel, (IMP)innerSenderClassMessageMetod, <span class="string">"v@:@"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">super</span> resolveClassMethod:sel];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> innerSenderClassMessageMetod(<span class="keyword">id</span> obj, SEL _cmd) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"ç±»æ–¹æ³•ï¼ŒåŠ¨æ€è§£æ"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="é‡å®šå‘"><a href="#é‡å®šå‘" class="headerlink" title="é‡å®šå‘"></a>é‡å®šå‘</h3><p>å¦‚æœæ²¡æœ‰åŠ¨æ€æ·»åŠ æ–¹æ³•ï¼Œåˆ™ä¼šè¿›å…¥æ­¤é˜¶æ®µï¼Œæ­¤æ—¶è¯¢é—®æ˜¯å¦è¦å°†è¿™æ¡æ¶ˆæ¯è½¬å‘ç»™å…¶ä»–çš„å¯¹è±¡ï¼Œæ¥å¤„ç†è¿™ä¸ªæ–¹æ³•ã€‚å¦‚æœè¿”å›nilï¼Œå³è¡¨ç¤ºä¸è½¬å‘ç»™å…¶ä»–å¯¹è±¡ï¼Œæ­¤æ—¶ä¼šè¿›å…¥ç¬¬3é˜¶æ®µ<br>åˆ›å»ºäº†ä¸€ä¸ªå¤‡ç”¨ç±»<code>MessageTemp</code><br>MessageTemp.h<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@interface</span> <span class="string">MessageTemp :</span> NSObject</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)<span class="string">sendMessage:</span>(NSString *)message;</span><br><span class="line">- (<span class="keyword">void</span>)<span class="string">sendClassMessage:</span>(NSString *)message;</span><br><span class="line"><span class="meta">@end</span></span><br></pre></td></tr></table></figure></p><p>MessageTemp.m<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">MessageTemp</span></span></span><br><span class="line">- (<span class="keyword">void</span>)sendMessage:(<span class="built_in">NSString</span> *)message &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"å¤‡ç”¨Messageï¼Œè§£æå¯¹è±¡æ–¹æ³•"</span>);</span><br><span class="line">&#125;</span><br><span class="line">- (<span class="keyword">void</span>)sendClassMessage:(<span class="built_in">NSString</span> *)message &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"å¤‡ç”¨Messageï¼Œè§£æç±»æ–¹æ³•"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p><h4 id="1-å¯¹è±¡æ–¹æ³•-1"><a href="#1-å¯¹è±¡æ–¹æ³•-1" class="headerlink" title="1. å¯¹è±¡æ–¹æ³•"></a>1. å¯¹è±¡æ–¹æ³•</h4><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">-</span> (id)<span class="selector-tag">forwardingTargetForSelector</span><span class="selector-pseudo">:(SEL)aSelector</span> &#123;</span><br><span class="line">    <span class="selector-tag">if</span> (aSelector == <span class="variable">@selector</span>(<span class="attribute">sendMessage</span>:)) &#123;</span><br><span class="line">        <span class="selector-tag">return</span> <span class="selector-attr">[MessageTemp new]</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">return</span> <span class="selector-attr">[super forwardingTargetForSelector:aSelector]</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-ç±»æ–¹æ³•-1"><a href="#2-ç±»æ–¹æ³•-1" class="headerlink" title="2. ç±»æ–¹æ³•"></a>2. ç±»æ–¹æ³•</h4><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+ (id)<span class="string">forwardingTargetForSelector:</span>(SEL)aSelector &#123;</span><br><span class="line">    <span class="keyword">if</span> (aSelector == <span class="meta">@selector</span>(<span class="string">sendClassMessage:</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> [MessageTemp <span class="keyword">new</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">super</span> <span class="string">forwardingTargetForSelector:</span>aSelector];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¶ˆæ¯è½¬å‘"><a href="#æ¶ˆæ¯è½¬å‘" class="headerlink" title="æ¶ˆæ¯è½¬å‘"></a>æ¶ˆæ¯è½¬å‘</h3><p>å½“ <code>forwardingTargetForSelector:</code> æ–¹æ³•æœªåšå‡ºä»»ä½•å“åº”çš„è¯ï¼Œä¼šæ¥åˆ°æ¶ˆæ¯è½¬å‘æµç¨‹ã€‚æ¶ˆæ¯è½¬å‘æ—¶ä¼šé¦–å…ˆè°ƒç”¨ <code>methodSignatureForSelector:</code> æ–¹æ³•ï¼Œåœ¨æ–¹æ³•å†…éƒ¨ç”Ÿæˆ <code>NSMethodSignature</code> ç±»å‹çš„æ–¹æ³•ç­¾åå¯¹è±¡ã€‚åœ¨ç”Ÿæˆç­¾åå¯¹è±¡æ—¶ï¼Œå¯ä»¥æŒ‡å®š <code>target</code> å’Œ <code>SEL</code>ï¼Œå¯ä»¥å°†è¿™ä¸¤ä¸ªå‚æ•°æ¢æˆå…¶ä»–å‚æ•°ï¼Œå°†æ¶ˆæ¯è½¬å‘ç»™å…¶ä»–å¯¹è±¡ã€‚</p><h4 id="1-å¯¹è±¡æ–¹æ³•-2"><a href="#1-å¯¹è±¡æ–¹æ³•-2" class="headerlink" title="1. å¯¹è±¡æ–¹æ³•"></a>1. å¯¹è±¡æ–¹æ³•</h4><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">forwardInvocation</span><span class="selector-pseudo">:(NSInvocation</span> *)<span class="selector-tag">anInvocation</span> &#123;</span><br><span class="line">    <span class="selector-tag">if</span> ([anInvocation selector] == <span class="variable">@selector</span>(<span class="attribute">sendMessage</span>:)) &#123;</span><br><span class="line">        <span class="selector-attr">[anInvocation invokeWithTarget:[MessageTemp new]</span>];</span><br><span class="line">    &#125; <span class="selector-tag">else</span> &#123;</span><br><span class="line">        <span class="selector-attr">[super forwardInvocation:anInvocation]</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-</span> (NSMethodSignature *)<span class="selector-tag">methodSignatureForSelector</span><span class="selector-pseudo">:(SEL)aSelector</span> &#123;</span><br><span class="line">    <span class="selector-tag">if</span> (aSelector == <span class="variable">@selector</span>(<span class="attribute">sendMessage</span>:)) &#123;</span><br><span class="line">        <span class="selector-tag">return</span> <span class="selector-attr">[NSMethodSignature signatureWithObjCTypes:"v@:@"]</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">return</span> <span class="selector-attr">[super methodSignatureForSelector:aSelector]</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-ç±»æ–¹æ³•-2"><a href="#2-ç±»æ–¹æ³•-2" class="headerlink" title="2. ç±»æ–¹æ³•"></a>2. ç±»æ–¹æ³•</h4><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="keyword">void</span>)<span class="string">forwardInvocation:</span>(NSInvocation *)anInvocation &#123;</span><br><span class="line">    <span class="keyword">if</span> ([anInvocation selector] == <span class="meta">@selector</span>(<span class="string">sendClassMessage:</span>)) &#123;</span><br><span class="line">        [anInvocation <span class="string">invokeWithTarget:</span>[MessageTemp <span class="keyword">new</span>]];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        [<span class="keyword">super</span> <span class="string">forwardInvocation:</span>anInvocation];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (NSMethodSignature *)<span class="string">methodSignatureForSelector:</span>(SEL)aSelector &#123;</span><br><span class="line">    <span class="keyword">if</span> (aSelector == <span class="meta">@selector</span>(<span class="string">sendClassMessage:</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> [NSMethodSignature <span class="string">signatureWithObjCTypes:</span><span class="string">"v@:@"</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">super</span> <span class="string">methodSignatureForSelector:</span>aSelector];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h3><ul><li>é€‚ç”¨äºæŠŠæ“ä½œç»™å¦å¤–ä¸€ä¸ªç±»æ¥å®ç°</li><li>åˆ©ç”¨åˆ†ç±»ï¼Œé˜²æ­¢åº”ç”¨ç¨‹åºå› ä¸ºæœªå¤„ç†æ¶ˆæ¯è€Œå´©æºƒ</li><li>Jspatch </li><li>Aspects</li><li>BlocksKit</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;http://poldw0h4y.bkt.clouddn.com/%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%E6%B5%81%E7%A8%8B%E5%9B%BE.jpg&quot; alt=&quot;æ¶ˆæ¯è½¬å‘æµç¨‹å›¾&quot;&gt;&lt;/p&gt;
&lt;p&gt;iOS
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>iOSä»£ç å—(Snippet)</title>
    <link href="https://wudan-ios.github.io/2019/03/13/%E4%BB%A3%E7%A0%81%E5%9D%97(Snippet)/"/>
    <id>https://wudan-ios.github.io/2019/03/13/ä»£ç å—(Snippet)/</id>
    <published>2019-03-13T03:03:18.597Z</published>
    <updated>2019-04-04T05:45:32.416Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://upload-images.jianshu.io/upload_images/3334769-b07622a36a646add.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é•‡æ¥¼ä¸“ç”¨"></p><p>ä»£ç å—(Snippet)ï¼Œæ–¹ä¾¿äº†ä»£ç å¿«é€Ÿåˆ›å»ºã€‚</p><h4 id="ç®¡ç†ï¼šåœ¨æ–°ç‰ˆXcodeä¸­ç®¡ç†é¡µé¢åœ¨ç¼–è¯‘å™¨çš„å³ä¸Šè§’"><a href="#ç®¡ç†ï¼šåœ¨æ–°ç‰ˆXcodeä¸­ç®¡ç†é¡µé¢åœ¨ç¼–è¯‘å™¨çš„å³ä¸Šè§’" class="headerlink" title="ç®¡ç†ï¼šåœ¨æ–°ç‰ˆXcodeä¸­ç®¡ç†é¡µé¢åœ¨ç¼–è¯‘å™¨çš„å³ä¸Šè§’"></a>ç®¡ç†ï¼šåœ¨æ–°ç‰ˆXcodeä¸­ç®¡ç†é¡µé¢åœ¨ç¼–è¯‘å™¨çš„å³ä¸Šè§’</h4><p><img src="https://upload-images.jianshu.io/upload_images/3334769-80379a923c19ef74.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ä»£ç å—ç®¡ç†"></p><h4 id="æ·»åŠ ï¼šé€‰ä¸­ä»£ç é¼ æ ‡å³å‡»"><a href="#æ·»åŠ ï¼šé€‰ä¸­ä»£ç é¼ æ ‡å³å‡»" class="headerlink" title="æ·»åŠ ï¼šé€‰ä¸­ä»£ç é¼ æ ‡å³å‡»"></a>æ·»åŠ ï¼šé€‰ä¸­ä»£ç é¼ æ ‡å³å‡»</h4><p><img src="https://upload-images.jianshu.io/upload_images/3334769-52aa3439524de38c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ·»åŠ "></p><h4 id="ç¼–è¾‘"><a href="#ç¼–è¾‘" class="headerlink" title="ç¼–è¾‘"></a>ç¼–è¾‘</h4><p><img src="https://upload-images.jianshu.io/upload_images/3334769-df39d293cbb6e8b1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ç¼–è¾‘"></p><ol><li>Titleï¼šæ ‡é¢˜ã€‚ </li><li>Summaryï¼šæè¿°æ–‡å­—ã€‚ </li><li>Platformï¼šå¯ä»¥ä½¿ç”¨çš„å¹³å°ï¼ˆå¦‚iOSã€Mac OSï¼‰ã€‚ </li><li>Languageï¼šå¯ä»¥åœ¨å“ªäº›è¯­è¨€ä¸­ä½¿ç”¨ï¼ˆå¦‚ Objective-Cã€Swiftï¼‰ã€‚ </li><li>Completion Shortcutï¼šå¿«æ·æ–¹å¼ï¼Œä»¥å­—æ¯å¼€å¤´ï¼ˆæ”¯æŒå°‘æ•°ç¬¦å·ï¼Œå¦‚@ï¼‰ã€‚ </li><li>Completion Scopesï¼šä½œç”¨èŒƒå›´ï¼Œä¸€èˆ¬å†™åœ¨æ­£ç¡®çš„ä½ç½®æ‹–åŠ¨å³å¯ï¼ŒXcodeä¼šè‡ªè¡Œé€‰æ‹©å¥½ã€‚<h4 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) &lt;<span class="meta">#ClassName#&gt; *<span class="meta-string">&lt;#class#&gt;</span>; ///<span class="meta-string">&lt; &lt;#æ³¨é‡Š#&gt;</span></span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) &lt;<span class="meta">#DataType#&gt; <span class="meta-string">&lt;#name#&gt;</span>; ///<span class="meta-string">&lt; &lt;#æ³¨é‡Š#&gt;</span></span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) &lt;<span class="meta">#ClassName#&gt; *<span class="meta-string">&lt;#name#&gt;</span>; ///<span class="meta-string">&lt; &lt;#æ³¨é‡Š#&gt;</span></span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">weak</span>) <span class="keyword">id</span>&lt;&lt;<span class="meta">#delegateOrDataSouce#&gt;&gt; <span class="meta-string">&lt;#delegateOrDataSouce#&gt;</span>; ///<span class="meta-string">&lt; &lt;#æ³¨é‡Š#&gt;</span></span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">weak</span>) &lt;<span class="meta">#Class#&gt; *<span class="meta-string">&lt;#name#&gt;</span>; ///<span class="meta-string">&lt; &lt;#æ³¨é‡Š#&gt;</span></span></span><br></pre></td></tr></table></figure></li></ol><h4 id="å¸¸ç”¨æ³¨é‡Š"><a href="#å¸¸ç”¨æ³¨é‡Š" class="headerlink" title="å¸¸ç”¨æ³¨é‡Š"></a>å¸¸ç”¨æ³¨é‡Š</h4><ol><li><p>é¡¶éƒ¨æ³¨é‡Š</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/** &lt;<span class="meta">#å±æ€§æ³¨é‡Š#&gt; */</span></span><br></pre></td></tr></table></figure></li><li><p>å³ä¾§æ³¨é‡Š</p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span><span class="doctag">&lt; &lt;#æ³¨é‡Š#&gt;</span></span></span><br></pre></td></tr></table></figure></li><li><p>ç®€è¿°é¡¶éƒ¨æ³¨é‡Š</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/** &lt;<span class="meta">#ç®€è¦æè¿°#&gt;</span></span><br><span class="line"> * &lt;<span class="meta">#è¯¦ç»†æè¿°#&gt;</span></span><br><span class="line"> */</span><br></pre></td></tr></table></figure></li><li><p>Pragma</p></li></ol><ul><li><p>æœ‰åˆ†å‰²çº¿</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#pragma</span> <span class="selector-tag">mark</span> &lt;#mark#&gt;</span><br></pre></td></tr></table></figure></li><li><p>æ— åˆ†å‰²çº¿</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#pragma</span> <span class="selector-tag">mark</span> - &lt;#mark&gt; æˆ– <span class="comment">// MARK: &lt;#mark#&gt;</span></span><br></pre></td></tr></table></figure></li></ul><ol start="5"><li><p>Warning(è­¦å‘Š)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">warning</span> <span class="meta-string">&lt;#message#&gt;</span></span></span><br></pre></td></tr></table></figure></li><li><p>???(ä¸ç¡®å®š)</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">//</span> ???: &lt;<span class="comment">#???#&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>!!!(è­¦å‘Š)</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">// !!!: &lt;#???#&gt;</span><br></pre></td></tr></table></figure></li><li><p>FIXME(éœ€è¦ä¿®æ”¹çš„åœ°æ–¹)</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">//</span> FIXME: &lt;<span class="comment">#Fixè¯¦æƒ…#&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>å¸¸ç”¨æ–¹æ³•</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#pragma</span> <span class="selector-tag">mark</span> - é¡µé¢æ§ä»¶é…ç½®</span><br><span class="line">- (void)setupSubViewsProperties &#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#pragma</span> <span class="selector-tag">mark</span> - é¡µé¢æ§ä»¶å¸ƒå±€</span><br><span class="line">- (void)setupSubViewsConstraint &#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æšä¸¾</p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">typedef <span class="type">NS_ENUM</span>(<span class="type">NSInteger</span>, &lt;#<span class="type">TypeName</span>#&gt;) &#123;</span><br><span class="line">    </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">typedef <span class="type">NS_OPTIONS</span>(<span class="type">NSUInteger</span>, &lt;#<span class="type">TypeName</span>#&gt;) &#123;</span><br><span class="line">                </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li><li><p>IFDEBUG</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">if</span> DEBUG</span><br><span class="line">&lt;#TODO#&gt;</span><br><span class="line">#else</span><br><span class="line">&lt;#TODO#&gt;</span><br><span class="line">#endif</span><br></pre></td></tr></table></figure></li><li><p>å¿«æ·åˆå§‹åŒ–UILabel</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">UILabel *<span class="attr">l</span> = [[UILabel alloc] init];</span><br><span class="line">l.<span class="attr">font</span> = [UIFont &lt;<span class="comment">#font#&gt;];</span></span><br><span class="line">l.<span class="attr">text</span> = @<span class="string">"&lt;#conent#&gt;"</span>;</span><br><span class="line">l.<span class="attr">textColor</span> = [UIColor &lt;<span class="comment">#textColor#&gt;];</span></span><br><span class="line">l.<span class="attr">numberOfLines</span> = <span class="number">0</span>;</span><br><span class="line">[&lt;<span class="comment">#view#&gt; addSubview:l];</span></span><br></pre></td></tr></table></figure></li><li><p>å¿«æ·åˆå§‹åŒ–UIButton</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">UIButton *<span class="keyword">b </span>= [UIButton <span class="keyword">buttonWithType:UIButtonTypeCustom];</span></span><br><span class="line"><span class="keyword">b.backgroundColor </span>= [UIColor &lt;<span class="comment">#backgroundColor#&gt;];</span></span><br><span class="line"><span class="keyword">b.titleLabel.font </span>= [UIFont &lt;<span class="comment">#font#&gt;];</span></span><br><span class="line">[<span class="keyword">b </span>setTitle:&lt;<span class="comment">#title#&gt; forState:UIControlStateNormal];</span></span><br><span class="line">[<span class="keyword">b </span>setTitleColor:[UIColor &lt;<span class="comment">#titleColor#&gt;] forState:UIControlStateNormal];</span></span><br><span class="line">[<span class="keyword">b </span>setImage:[UIImage imageNamed:&lt;<span class="comment">#(nonnull NSString *)#&gt;] forState:UIControlStateNormal]</span></span><br><span class="line">[<span class="keyword">b </span><span class="keyword">addTarget:self </span>action:@selector(<span class="keyword">didTapped&lt;#Button </span>Name<span class="comment">#&gt;:) forControlEvents:UIControlEventTouchUpInside];</span></span><br><span class="line">[&lt;<span class="comment">#view#&gt; addSubview:b];</span></span><br></pre></td></tr></table></figure></li><li><p>UIButton ç‚¹å‡»äº‹ä»¶</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** &lt;#ButtonName#&gt;ç‚¹å‡»äº‹ä»¶ */</span></span><br><span class="line"><span class="selector-tag">-</span> (<span class="selector-tag">void</span>)<span class="selector-tag">didTapped</span>&lt;<span class="selector-id">#ButtonName</span>#&gt;<span class="selector-pseudo">:(UIButton</span> *)<span class="selector-tag">sender</span> &#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>Notificationäº‹ä»¶</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** &lt;#Notification Name#&gt;é€šçŸ¥äº‹ä»¶ */</span></span><br><span class="line"><span class="selector-tag">-</span> (<span class="selector-tag">void</span>)<span class="selector-tag">didReceive</span>&lt;<span class="selector-id">#Notification</span> <span class="selector-tag">Name</span>#&gt;<span class="selector-pseudo">:(NSNotification</span> *)<span class="selector-tag">notification</span> &#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>UIGestureRecognizerè§¦æ‘¸äº‹ä»¶</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** &lt;#GestureRecognizer Name#&gt;è§¦æ‘¸äº‹ä»¶ */</span></span><br><span class="line"><span class="selector-tag">-</span> (<span class="selector-tag">void</span>)<span class="selector-tag">didRecognized</span>&lt;<span class="selector-id">#GestureRecognizer</span> <span class="selector-tag">Name</span>#&gt;<span class="selector-pseudo">:(UIGestureRecognizer</span> *)<span class="selector-tag">recognizer</span> &#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h4 id="ç»“æŸè¯­"><a href="#ç»“æŸè¯­" class="headerlink" title="ç»“æŸè¯­"></a>ç»“æŸè¯­</h4><p>è¿™ä¹Ÿæ˜¯ä¸ºäº†ä¸ªäººæ„è§ï¼Œå…¶ä»–è¿˜æœ‰å¾ˆå¤šå¯ä»¥åšæˆä»£ç å—çš„ï¼Œä¾‹å¦‚CGDï¼ŒTableViewDataSourceç­‰ç­‰ï¼Œå¸Œæœ›çŸ­çŸ­çš„æ–‡ç« å¯ä»¥è®©ä½ ä»£ç å¯ä»¥å†™çš„æ›´å¥½ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/3334769-b07622a36a646add.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot;
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>iOSå·¥å…·ç±»-æ—¶é—´å·®</title>
    <link href="https://wudan-ios.github.io/2019/02/26/iOS%E5%B7%A5%E5%85%B7%E7%B1%BB-%E6%97%B6%E9%97%B4%E5%B7%AE/"/>
    <id>https://wudan-ios.github.io/2019/02/26/iOSå·¥å…·ç±»-æ—¶é—´å·®/</id>
    <published>2019-02-26T06:56:01.346Z</published>
    <updated>2019-02-26T07:48:48.016Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://upload-images.jianshu.io/upload_images/3334769-073af85178d8c456.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é•‡æ¥¼ä¸“ç”¨"></p><p>æœ€è¿‘æƒ³å†™ç‚¹æ—¥å¸¸ä½¿ç”¨çš„å·¥å…·ç±»ï¼Œæ–¹ä¾¿å¼€å‘ã€‚<br>é¦–å…ˆæƒ³åˆ°å°±æ˜¯æ—¶é—´ä¹‹ç±»çš„é—®é¢˜ï¼Œæ‰€ä»¥æ‰“å¼€<code>Xocde</code>ï¼Œè¿›è¡Œä»£ç ç¼–è¾‘ã€‚<br>è¿™ä¸ªä»£ç è€ƒè™‘ä¸æ˜¯å¾ˆå®Œå…¨ï¼Œæ—¥åæœ‰æ—¶é—´å†è¿›è¡Œä¿®æ”¹è¡¥å……ã€‚</p><h3 id="æ¥å£æ–‡ä»¶"><a href="#æ¥å£æ–‡ä»¶" class="headerlink" title="æ¥å£æ–‡ä»¶"></a>æ¥å£æ–‡ä»¶</h3><p>æˆ‘ä½¿ç”¨çš„ç±»åç§°ä¸º<code>DateHandleUtils</code><br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NS_ASSUME_NONNULL_BEGIN</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSInteger</span>, WeiBoTimeStyle) &#123;</span><br><span class="line">    WeiBoTimeStyleSecond,</span><br><span class="line">    WeiBoTimeStyleMillisecond</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">DateHandleUtils</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> æ ¹æ®æ—¶é—´è¿”å›æ–‡å­—æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> @param timeInterval æ¯”è¾ƒæ—¶é—´</span></span><br><span class="line"><span class="comment"> @param style æ—¶é—´æˆ³æ ¼å¼</span></span><br><span class="line"><span class="comment"> @return `åˆšåˆš`ã€`10ç§’å‰`ã€`10åˆ†é’Ÿå‰`ã€`1å°æ—¶å‰`ç­‰ç­‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">+ (<span class="built_in">NSString</span> *)weiboTimeWithPublicTime:(<span class="built_in">NSTimeInterval</span>)timeInterval timeStyel:(WeiBoTimeStyle)style;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å½“å‰æ—¶é—´æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> @return æ¯«ç§’çš„æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">+ (<span class="built_in">NSTimeInterval</span>)currentMilliSecondTimeInterval;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å½“å‰æ—¶é—´æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> @return ç§’çš„æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">+ (<span class="built_in">NSTimeInterval</span>)currentSecondTimeInterval;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ ¹æ®æ—¶é—´æˆ³è·å–æ—¶é—´å·®</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> @param startTime å¼€å§‹æ—¶é—´çš„æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment"> @param endTime ç»“æŸæ—¶é—´çš„æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment"> @return è¿”å›å·®å€¼ï¼Œå•ä½ä¸ºç§’</span></span><br><span class="line"><span class="comment"> @warning ä¼ å€¼æ ¼å¼ä¸ºï¼šæ¯«ç§’çº§æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">+ (<span class="built_in">NSTimeInterval</span>)timeDifferenceOfMillisecondWithStartTimeInterval:(<span class="built_in">NSTimeInterval</span>)startTime endTimeInterval:(<span class="built_in">NSTimeInterval</span>)endTime;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ ¹æ®æ—¶é—´æˆ³è·å–æ—¶é—´å·®</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> @param startTime å¼€å§‹æ—¶é—´çš„æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment"> @param endTime ç»“æŸæ—¶é—´çš„æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment"> @return è¿”å›å·®å€¼ï¼Œå•ä½ä¸ºç§’</span></span><br><span class="line"><span class="comment"> @warning ä¼ å€¼æ ¼å¼ä¸ºï¼šç§’çº§æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">+ (<span class="built_in">NSTimeInterval</span>)timeDifferenceOfSecondsWithStartTimeInterval:(<span class="built_in">NSTimeInterval</span>)startTime endTimeInterval:(<span class="built_in">NSTimeInterval</span>)endTime;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">NS_ASSUME_NONNULL_END</span></span><br></pre></td></tr></table></figure></p><h3 id="å®ç°æ–‡ä»¶"><a href="#å®ç°æ–‡ä»¶" class="headerlink" title="å®ç°æ–‡ä»¶"></a>å®ç°æ–‡ä»¶</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@implementation</span> DateHandleUtils</span><br><span class="line"></span><br><span class="line">+ (NSString *)<span class="string">weiboTimeWithPublicTime:</span>(NSTimeInterval)timeInterval <span class="string">timeStyel:</span>(WeiBoTimeStyle)style &#123;</span><br><span class="line">    NSTimeInterval interval;</span><br><span class="line">        <span class="keyword">switch</span> (style) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">WeiBoTimeStyleSecond:</span></span><br><span class="line">            interval = [DateHandleUtils <span class="string">timeDifferenceOfSecondsWithStartTimeInterval:</span>timeInterval <span class="string">endTimeInterval:</span>[DateHandleUtils currentSecondTimeInterval]];</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">WeiBoTimeStyleMillisecond:</span></span><br><span class="line">            interval = [DateHandleUtils <span class="string">timeDifferenceOfMillisecondWithStartTimeInterval:</span>timeInterval <span class="string">endTimeInterval:</span>[DateHandleUtils currentMilliSecondTimeInterval]];</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"><span class="symbol">        default:</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (interval &lt; <span class="number">10</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> @<span class="string">"åˆšåˆš"</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (interval &lt; <span class="number">60</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> [NSString <span class="string">stringWithFormat:</span>@<span class="string">"%.fç§’å‰"</span>, interval];</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (interval / <span class="number">60</span> &lt; <span class="number">60</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> [NSString <span class="string">stringWithFormat:</span>@<span class="string">"%.fåˆ†é’Ÿå‰"</span>, interval / <span class="number">60</span>];</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (interval <span class="regexp">/ 60 /</span> <span class="number">60</span> &lt; <span class="number">24</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> [NSString <span class="string">stringWithFormat:</span>@<span class="string">"%.få°æ—¶å‰"</span>, interval <span class="regexp">/ 60 /</span> <span class="number">60</span> - <span class="number">1</span>];</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (interval <span class="regexp">/ 60 /</span> <span class="number">60</span> / <span class="number">24</span> &lt; <span class="number">30</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> [NSString <span class="string">stringWithFormat:</span>@<span class="string">"%.få¤©å‰"</span>, interval <span class="regexp">/ 60 /</span> <span class="number">60</span> / <span class="number">24</span>];</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (interval <span class="regexp">/ 60 /</span> <span class="number">60</span> <span class="regexp">/ 24 /</span> <span class="number">30</span> &lt; <span class="number">12</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> [NSString <span class="string">stringWithFormat:</span>@<span class="string">"%.fæœˆå‰"</span>, interval <span class="regexp">/ 60 /</span> <span class="number">60</span> <span class="regexp">/ 24 /</span> <span class="number">30</span>];</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (interval <span class="regexp">/ 60 /</span> <span class="number">60</span> <span class="regexp">/ 24 /</span> <span class="number">30</span> / <span class="number">12</span> &gt;= <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> [NSString <span class="string">stringWithFormat:</span>@<span class="string">"%.få¹´å‰"</span>, interval <span class="regexp">/ 60 /</span> <span class="number">60</span> <span class="regexp">/ 24 /</span> <span class="number">30</span> / <span class="number">12</span>];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> @<span class="string">"æœªçŸ¥æ—¶é—´"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (NSTimeInterval)currentMilliSecondTimeInterval &#123;</span><br><span class="line">    NSDateFormatter *formatter = [[NSDateFormatter alloc] init];</span><br><span class="line">    [formatter <span class="string">setDateStyle:</span> NSDateFormatterMediumStyle];</span><br><span class="line">    [formatter <span class="string">setTimeStyle:</span> NSDateFormatterShortStyle];</span><br><span class="line">    [formatter <span class="string">setDateFormat:</span> @<span class="string">"YYYY-MM-dd HH:mm:ss SSS"</span>];</span><br><span class="line">    </span><br><span class="line">    NSTimeZone *timeZone = [NSTimeZone <span class="string">timeZoneWithName:</span> @<span class="string">"Asia/Shanghai"</span>];</span><br><span class="line">    [formatter <span class="string">setTimeZone:</span> timeZone];</span><br><span class="line">    NSDate *datenow = [NSDate date];</span><br><span class="line">    <span class="keyword">return</span> [datenow timeIntervalSince1970] * <span class="number">1000</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (NSTimeInterval)currentSecondTimeInterval &#123;</span><br><span class="line">    NSDateFormatter *formatter = [[NSDateFormatter alloc] init];</span><br><span class="line">    [formatter <span class="string">setDateStyle:</span> NSDateFormatterMediumStyle];</span><br><span class="line">    [formatter <span class="string">setTimeStyle:</span> NSDateFormatterShortStyle];</span><br><span class="line">    [formatter <span class="string">setDateFormat:</span> @<span class="string">"YYYY-MM-dd HH:mm:ss SSS"</span>];</span><br><span class="line">    </span><br><span class="line">    NSTimeZone *timeZone = [NSTimeZone <span class="string">timeZoneWithName:</span> @<span class="string">"Asia/Shanghai"</span>];</span><br><span class="line">    [formatter <span class="string">setTimeZone:</span> timeZone];</span><br><span class="line">    NSDate *datenow = [NSDate date];</span><br><span class="line">    <span class="keyword">return</span> [datenow timeIntervalSince1970];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (NSTimeInterval)<span class="string">timeDifferenceOfMillisecondWithStartTimeInterval:</span>(NSTimeInterval)startTime <span class="string">endTimeInterval:</span>(NSTimeInterval)endTime &#123;</span><br><span class="line">    <span class="keyword">if</span> (startTime &lt; endTime) &#123;</span><br><span class="line">        <span class="keyword">return</span> (endTime - startTime) / <span class="number">1000</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (startTime - endTime) / <span class="number">1000</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (NSTimeInterval)<span class="string">timeDifferenceOfSecondsWithStartTimeInterval:</span>(NSTimeInterval)startTime <span class="string">endTimeInterval:</span>(NSTimeInterval)endTime &#123;</span><br><span class="line">    <span class="keyword">if</span> (startTime &lt; endTime) &#123;</span><br><span class="line">        <span class="keyword">return</span> (endTime - startTime);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (startTime - endTime);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@end</span></span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨æ–¹å¼"><a href="#ä½¿ç”¨æ–¹å¼" class="headerlink" title="ä½¿ç”¨æ–¹å¼"></a>ä½¿ç”¨æ–¹å¼</h3><p>éƒ½æ˜¯ç±»æ–¹æ³•ï¼Œç”¨çš„æ—¶å€™ç›´æ¥ä½¿ç”¨ç±»åè°ƒç”¨å°±å¯ä»¥äº†(å®ä¾‹ï¼š<code>[DateHandleUtils currentMilliSecondTimeInterval];</code>);</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/3334769-073af85178d8c456.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot;
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>iOSå¼€å‘æŠ€å·§-ä¸æ–­æ›´æ–°ä¸­</title>
    <link href="https://wudan-ios.github.io/2019/01/24/%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7/"/>
    <id>https://wudan-ios.github.io/2019/01/24/å¼€å‘æŠ€å·§/</id>
    <published>2019-01-24T06:23:46.585Z</published>
    <updated>2019-04-19T08:28:20.726Z</updated>
    
    <content type="html"><![CDATA[<p>1ã€PrefixHeaderå¯¼å…¥ä½ç½®å†™æ³•<br><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$(</span>SRCROOT)/<span class="variable">$(</span>PROJECT_NAME)/&lt;<span class="comment">#æ–‡ä»¶æ‰€åœ¨æ–‡ä»¶å¤¹åç§°#&gt;/PrefixHeader.pch</span></span><br></pre></td></tr></table></figure></p><p>2ã€éšè—å¯¼èˆªæ çš„ä¸¤ç§æ–¹å¼<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ–¹å¼ä¸€ ã€Šæ¨èã€‹</span></span><br><span class="line"><span class="comment">//åœ¨éœ€è¦éšè—çš„viewControllerä¸­éµå¾ª&lt;UINavigationControllerDelegate&gt;</span></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line"> <span class="comment">// è®¾ç½®å¯¼èˆªæ§åˆ¶å™¨çš„ä»£ç†ä¸ºself</span></span><br><span class="line">    <span class="keyword">self</span>.navigationController.delegate = <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - UINavigationControllerDelegate</span></span><br><span class="line"><span class="comment">// å°†è¦æ˜¾ç¤ºæ§åˆ¶å™¨</span></span><br><span class="line">- (<span class="keyword">void</span>)navigationController:(<span class="built_in">UINavigationController</span> *)navigationController willShowViewController:(<span class="built_in">UIViewController</span> *)viewController animated:(<span class="built_in">BOOL</span>)animated &#123;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­è¦æ˜¾ç¤ºçš„æ§åˆ¶å™¨æ˜¯å¦æ˜¯è‡ªå·±</span></span><br><span class="line">    <span class="built_in">BOOL</span> isShowHomePage = [viewController isKindOfClass:[<span class="keyword">self</span> <span class="keyword">class</span>]];</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span>.navigationController setNavigationBarHidden:isShowHomePage animated:<span class="literal">YES</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ–¹å¼äºŒ</span></span><br><span class="line">- (<span class="keyword">void</span>)viewWillAppear:(<span class="built_in">BOOL</span>)animated &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewWillAppear:animated];</span><br><span class="line"></span><br><span class="line">    [<span class="keyword">self</span>.navigationController setNavigationBarHidden:<span class="literal">YES</span> animated:<span class="literal">YES</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewWillDisappear:(<span class="built_in">BOOL</span>)animated &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewWillDisappear:animated];</span><br><span class="line"></span><br><span class="line">    [<span class="keyword">self</span>.navigationController setNavigationBarHidden:<span class="literal">NO</span> animated:<span class="literal">YES</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>3ã€TabBarItemè¦æ±‚åªæ˜¾ç¤ºå›¾ç‰‡ä¸æ˜¾ç¤ºæ–‡å­—<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// self è¡¨ç¤ºéœ€è¦è®¾ç½®æ ·å¼çš„æ§åˆ¶å™¨</span></span><br><span class="line">[<span class="keyword">self</span>.tabBarItem setImageInsets:<span class="built_in">UIEdgeInsetsMake</span>(<span class="number">6</span>, <span class="number">0</span>, <span class="number">-6</span>, <span class="number">0</span>)];</span><br></pre></td></tr></table></figure></p><p>4ã€TableViewæˆ–CollectionViewå•é€‰<br><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="comment">&lt;!--æ­¥éª¤ä¸€ã€ å£°æ˜ä¸€ä¸ªå…¨å±€å˜é‡--&gt;</span></span></span><br><span class="line"><span class="xml">@property (nonatomic, assign) NSInteger selectedIndex;</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!--æ­¥éª¤äºŒã€TableViewæˆ–CollectionViewç‚¹å‡»äº‹ä»¶çš„æ–¹æ³•ä¸­ä¿å­˜ç‚¹å‡»çš„indexï¼Œå¹¶åˆ·æ–°--&gt;</span></span></span><br><span class="line"><span class="xml">self.selectedIndex = indexPath.row;</span></span><br><span class="line"><span class="xml">[collectionView reloadData];æˆ–[tableView reloadData];</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!--æ­¥éª¤ä¸‰ã€åœ¨cellForItemAtIndexPathæˆ–cellForRowAtIndexPathæ–¹æ³•ä¸­åˆ¤æ–­æ˜¯å¦æ˜¯æ‰€ä¿å­˜çš„index--&gt;</span></span></span><br><span class="line"><span class="xml">if (self.selectedIndex == indexPath.row) </span><span class="template-variable">&#123;</span></span><br><span class="line"><span class="template-variable">    // è®¾ç½®é€‰ä¸­æ ·å¼</span></span><br><span class="line"><span class="template-variable">&#125;</span><span class="xml"> else </span><span class="template-variable">&#123;</span></span><br><span class="line"><span class="template-variable">    // è®¾ç½®æˆé»˜è®¤æ ·å¼    </span></span><br><span class="line"><span class="template-variable">&#125;</span><span class="xml"></span></span><br></pre></td></tr></table></figure></p><p>5ã€æ€ä¹ˆåŒºåˆ†çœŸæœºè¿˜æ˜¯æ¨¡æ‹Ÿå™¨<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">if</span> TARGET_IPHONE_SIMULATOR  </span></span><br><span class="line">    NSLog(@<span class="string">"run on simulator"</span>);  </span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SIMULATOR_TEST</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span>  </span></span><br><span class="line"><span class="comment">//ä¸å®šä¹‰SIMULATOR_TESTè¿™ä¸ªå®</span></span><br><span class="line">    NSLog(@<span class="string">"run on device"</span>);  </span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure></p><p>6ã€if Debug<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> DEBUG    </span></span><br><span class="line"><span class="comment">// do sth</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span>   </span></span><br><span class="line"><span class="comment">// do sth</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure></p><p>7ã€ä¸€é”®æ¸…ç†æ‰€æœ‰æ¨¡æ‹Ÿå™¨å®‰è£…è¿‡çš„APP<br><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å…ˆå…³é—­æ‰€æœ‰æ¨¡æ‹Ÿå™¨ åœ¨ç»ˆç«¯ä¸­è¾“å…¥ä¸‹é¢å‘½ä»¤å³å¯</span></span><br><span class="line">xcrun simctl erase <span class="keyword">all</span></span><br></pre></td></tr></table></figure></p><p>8ã€SDWebImageæ¸…ç†ç¼“å­˜<br><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- (void)didReceiveMemoryWarning &#123;</span><br><span class="line">    <span class="comment">[super didReceiveMemoryWarning]</span>;</span><br><span class="line">    <span class="comment">[<span class="comment">[<span class="comment">[SDWebImageManager sharedManager]</span> imageCache]</span> clearMemory]</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>9ã€UITableViewçš„HeaderViewä¸‹æ‹‰æ”¾å¤§<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>ã€View1:ä½œä¸ºæ˜¾ç¤ºView</span><br><span class="line"><span class="number">2</span>ã€View2:ä½œä¸ºtableViewçš„tableHeaderViewï¼Œå¹¶æ·»åŠ View1ï¼ŒView2çš„å¤§å°å’ŒView1å¤§å°ç›¸åŒ.</span><br><span class="line"><span class="number">3</span>ã€åœ¨<span class="built_in">UIScrollViewDelegate</span>æ–¹æ³•ä¸­è¿›è¡Œè®¾è®¡</span><br><span class="line">- (<span class="keyword">void</span>)scrollViewDidScroll:(<span class="built_in">UIScrollView</span> *)scrollView &#123;</span><br><span class="line">    <span class="built_in">CGFloat</span> width = <span class="built_in">UIScreen</span>.mainScreen.bounds.size.width;</span><br><span class="line">    <span class="built_in">CGFloat</span> viewHeight = kScreenWidth * <span class="number">0.5</span>; <span class="comment">// View1çš„åˆå§‹é«˜åº¦</span></span><br><span class="line">    <span class="built_in">CGFloat</span> yOffset = scrollView.contentOffset.y;</span><br><span class="line">    <span class="keyword">if</span> (yOffset &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">CGFloat</span> totalOffset = viewHeight + ABS(yOffset);</span><br><span class="line">        <span class="built_in">CGFloat</span> f = totalOffset / viewHeight;</span><br><span class="line">        <span class="keyword">self</span>.headerView.frame = <span class="built_in">CGRectMake</span>(- (width * f - width) / <span class="number">2</span>, yOffset, width * f, totalOffset);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>10ã€Masonryåˆ¶ä½œå°±å®«æ ¼<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Objective-C ----&gt; Masonry</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> å¤šè§†å›¾å¸ƒå±€</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> @param viewArray è§†å›¾æ•°ç»„</span></span><br><span class="line"><span class="comment"> @param column åˆ—æ•°</span></span><br><span class="line"><span class="comment"> @param tbSpeace è§†å›¾ä¸Šä¸‹é—´è·</span></span><br><span class="line"><span class="comment"> @param lrSpeace è§†å›¾å·¦å³é—´è·</span></span><br><span class="line"><span class="comment"> @param topSpeace å’Œçˆ¶è§†å›¾ä¸Šé—´è·</span></span><br><span class="line"><span class="comment"> @param lrSuperViewSpeace çˆ¶è§†å›¾å·¦å³é—´è·</span></span><br><span class="line"><span class="comment"> @param superView çˆ¶è§†å›¾</span></span><br><span class="line"><span class="comment"> @param viewHeight è§†å›¾é«˜åº¦</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)wd_masLayoutSubViewsWithViewArray:(<span class="built_in">NSArray</span>&lt;<span class="built_in">UIView</span> *&gt; *)viewArray</span><br><span class="line">                              columnOfRow:(<span class="built_in">NSInteger</span>)column</span><br><span class="line">                    topBottomOfItemSpeace:(<span class="built_in">CGFloat</span>)tbSpeace</span><br><span class="line">                      leftRightItemSpeace:(<span class="built_in">CGFloat</span>)lrSpeace</span><br><span class="line">                     topOfSuperViewSpeace:(<span class="built_in">CGFloat</span>)topSpeace</span><br><span class="line">                 leftRightSuperViewSpeace:(<span class="built_in">CGFloat</span>)lrSuperViewSpeace</span><br><span class="line">                          addToSubperView:(<span class="built_in">UIView</span> *)superView</span><br><span class="line">                               viewHeight:(<span class="built_in">CGFloat</span>)viewHeight&#123;</span><br><span class="line">  </span><br><span class="line">                    <span class="built_in">CGFloat</span> viewWidth = superView.bounds.size.width;</span><br><span class="line">                    <span class="built_in">CGFloat</span> itemWidth = (viewWidth - lrSuperViewSpeace * <span class="number">2</span> - (column - <span class="number">1</span>) * lrSpeace) / column * <span class="number">1.0</span>f;</span><br><span class="line">                    <span class="built_in">CGFloat</span> itemHeight = viewHeight;</span><br><span class="line">                    <span class="built_in">UIView</span> *last = <span class="literal">nil</span>;</span><br><span class="line">  </span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; viewArray.count; i++) &#123;</span><br><span class="line">                        <span class="built_in">UIView</span> *item = viewArray[i];</span><br><span class="line">                        [superView addSubview:item];</span><br><span class="line"></span><br><span class="line">                        [item mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line">                            make.width.mas_equalTo(itemWidth);</span><br><span class="line">                            make.height.mas_equalTo(itemHeight);</span><br><span class="line">                          </span><br><span class="line">                            <span class="built_in">CGFloat</span> top = topSpeace + (i / column) * (itemHeight + tbSpeace);</span><br><span class="line">                            make.top.mas_offset(top);</span><br><span class="line">                            <span class="keyword">if</span> (!last || (i % column) == <span class="number">0</span>) &#123;</span><br><span class="line">                                make.left.mas_offset(lrSuperViewSpeace);</span><br><span class="line">                            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                                make.left.mas_equalTo(last.mas_right).mas_offset(lrSpeace);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;];</span><br><span class="line">                      </span><br><span class="line">                        last = item;</span><br><span class="line">                    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>11ã€Snapkitåˆ¶ä½œä¹å®«æ ¼<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Swift ----&gt; SnapKit</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/// å¤šè§†å›¾å¸ƒå±€</span></span><br><span class="line">    <span class="comment">///</span></span><br><span class="line">    <span class="comment">/// - Parameters:</span></span><br><span class="line">    <span class="comment">///   - viewArray: è§†å›¾æ•°ç»„</span></span><br><span class="line">    <span class="comment">///   - columnOfRow: åˆ—æ•°</span></span><br><span class="line">    <span class="comment">///   - topBottomOfItemSpeace: è§†å›¾ä¸Šä¸‹é—´è·</span></span><br><span class="line">    <span class="comment">///   - leftRightItemSpeace: è§†å›¾å·¦å³é—´è·</span></span><br><span class="line">    <span class="comment">///   - topOfSuperViewSpeace: å’Œçˆ¶è§†å›¾ä¸Šé—´è·</span></span><br><span class="line">    <span class="comment">///   - leftRightSuperViewSpeace: çˆ¶è§†å›¾å·¦å³é—´è·</span></span><br><span class="line">    <span class="comment">///   - addToSubperView: çˆ¶è§†å›¾</span></span><br><span class="line">    <span class="comment">///   - viewHeight: è§†å›¾é«˜åº¦</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">wd_masLayoutSubViews</span><span class="params">(viewArray:Array&lt;UIView&gt;,</span></span></span><br><span class="line"><span class="function"><span class="params">                              columnOfRow:Int,</span></span></span><br><span class="line"><span class="function"><span class="params">                              topBottomOfItemSpeace:CGFloat,</span></span></span><br><span class="line"><span class="function"><span class="params">                              leftRightItemSpeace:CGFloat,</span></span></span><br><span class="line"><span class="function"><span class="params">                              topOfSuperViewSpeace:CGFloat,</span></span></span><br><span class="line"><span class="function"><span class="params">                              leftRightSuperViewSpeace:CGFloat,</span></span></span><br><span class="line"><span class="function"><span class="params">                              addToSubperView:UIView,</span></span></span><br><span class="line"><span class="function"><span class="params">                              viewHeight:CGFloat)</span></span> -&gt; <span class="type">Void</span> &#123;</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> viewWidth = addToSubperView.bounds.width</span><br><span class="line">        <span class="keyword">let</span> tempW = leftRightSuperViewSpeace * <span class="number">2</span> + <span class="type">CGFloat</span>(columnOfRow - <span class="number">1</span>) * leftRightItemSpeace</span><br><span class="line">        <span class="keyword">let</span> itemWidth = (viewWidth - tempW) / <span class="type">CGFloat</span>(columnOfRow)</span><br><span class="line">        <span class="keyword">let</span> itemHeight = viewHeight</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(leftRightSuperViewSpeace,leftRightItemSpeace,itemWidth)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> lastView:<span class="type">UIView</span>?</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (index) <span class="keyword">in</span> viewArray.enumerated() &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">let</span> item = viewArray[i]</span><br><span class="line">            addToSubperView.addSubview(item)</span><br><span class="line">            </span><br><span class="line">            item.snp.makeConstraints &#123; (make) <span class="keyword">in</span></span><br><span class="line">                make.width.equalTo(itemWidth)</span><br><span class="line">                make.height.equalTo(itemHeight)</span><br><span class="line">                <span class="keyword">let</span> top = topOfSuperViewSpeace + <span class="type">CGFloat</span>(i / columnOfRow) * (itemHeight + topBottomOfItemSpeace)</span><br><span class="line">                make.top.equalTo(top)</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> !(lastView != <span class="literal">nil</span>) || i%columnOfRow == <span class="number">0</span> &#123;</span><br><span class="line">                    make.<span class="keyword">left</span>.equalTo(leftRightSuperViewSpeace)</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    make.<span class="keyword">left</span>.equalTo((lastView?.snp.<span class="keyword">right</span>)!).offset(leftRightItemSpeace)</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                lastView = item</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>12ã€æ²‰æµ¸å¼TableView(ScrollViewã€CollectionView)<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (@available(iOS <span class="number">11.0</span>, *)) &#123;</span><br><span class="line">    <span class="keyword">self</span>.tableView.contentInsetAdjustmentBehavior = UIScrollViewContentInsetAdjustmentNever;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">self</span>.automaticallyAdjustsScrollViewInsets = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>13ã€é€šè¿‡èº«ä»½è¯è®¡ç®—å¹´é¾„<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** é€šè¿‡èº«ä»½è¯è®¡ç®—å¹´é¾„ */</span></span><br><span class="line">- (<span class="built_in">NSString</span> *)calculationAgeWithBirthday: (<span class="built_in">NSString</span> *)birthday &#123;</span><br><span class="line">    <span class="built_in">NSCalendar</span> *calendar = [<span class="built_in">NSCalendar</span> currentCalendar];</span><br><span class="line">    <span class="built_in">NSDate</span> *nowDate = [<span class="built_in">NSDate</span> date];</span><br><span class="line">    <span class="built_in">NSString</span> *birth = birthday;</span><br><span class="line">    <span class="built_in">NSDateFormatter</span> *dateFormatter = [[<span class="built_in">NSDateFormatter</span> alloc]init];</span><br><span class="line">    [dateFormatter setDateFormat:<span class="string">@"yyyy-MM-dd"</span>];</span><br><span class="line">    <span class="built_in">NSDate</span> *birthDay = [dateFormatter dateFromString:birth];</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> unitFlags = <span class="built_in">NSCalendarUnitYear</span> | <span class="built_in">NSCalendarUnitMonth</span> | <span class="built_in">NSCalendarUnitDay</span>;</span><br><span class="line">    <span class="built_in">NSDateComponents</span> *date = [calendar components:unitFlags fromDate:birthDay toDate:nowDate options:<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">if</span> ([date year] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%ldå²"</span>, (<span class="keyword">long</span>)[date year]];</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>([date month] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%ldæœˆ"</span>, (<span class="keyword">long</span>)[date month]];</span><br><span class="line">    &#125;  <span class="keyword">else</span> <span class="keyword">if</span>([date day] &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%ldå¤©"</span>, (<span class="keyword">long</span>)[date day]];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">@"0å¤©"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSString</span> *)ageStrFromIdentityCard:(<span class="built_in">NSString</span> *)numberStr &#123;</span><br><span class="line">    <span class="built_in">NSString</span> *dateSt;</span><br><span class="line">    <span class="built_in">NSMutableString</span> *dateS;</span><br><span class="line">    <span class="keyword">if</span> (numberStr.length &gt; <span class="number">15</span>) &#123;</span><br><span class="line">        dateSt = [numberStr substringWithRange:<span class="built_in">NSMakeRange</span>(<span class="number">6</span>, <span class="number">8</span>)];</span><br><span class="line">        dateS = [<span class="built_in">NSMutableString</span> stringWithFormat:<span class="string">@"%@"</span>, dateSt];</span><br><span class="line">        [dateS insertString:<span class="string">@"-"</span> atIndex:<span class="number">4</span>];</span><br><span class="line">        [dateS insertString:<span class="string">@"-"</span> atIndex:<span class="number">7</span>];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// åªè€ƒè™‘ 19å¼€å¤´çš„15ä½çš„èº«ä»½è¯å·</span></span><br><span class="line">        dateSt = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"19%@"</span>,[numberStr substringWithRange:<span class="built_in">NSMakeRange</span>(<span class="number">6</span>, <span class="number">6</span>)]];</span><br><span class="line">        dateS = [<span class="built_in">NSMutableString</span> stringWithFormat:<span class="string">@"%@"</span>, dateSt];</span><br><span class="line">        [dateS insertString:<span class="string">@"-"</span> atIndex:<span class="number">4</span>];</span><br><span class="line">        [dateS insertString:<span class="string">@"-"</span> atIndex:<span class="number">7</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">self</span> calculationAgeWithBirthday:dateS];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>14ã€åˆ©ç”¨<code>runtime</code>è‡ªåŠ¨å½’æ¡£<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥å¤´æ–‡ä»¶</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;objc/runtime.h&gt;</span></span></span><br><span class="line"><span class="comment">// éµå¾ªåè®®</span></span><br><span class="line">&lt;<span class="built_in">NSCoding</span>&gt;</span><br><span class="line"><span class="comment">// å®ç°æ–¹æ³•</span></span><br><span class="line">- (<span class="keyword">id</span>)initWithCoder:(<span class="built_in">NSCoder</span> *)aDecoder &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span> = [<span class="keyword">super</span> init]) &#123;</span><br><span class="line">        <span class="keyword">unsigned</span> <span class="keyword">int</span> outCount;</span><br><span class="line">        Ivar * ivars = class_copyIvarList([<span class="keyword">self</span> <span class="keyword">class</span>], &amp;outCount);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; outCount; i ++) &#123;</span><br><span class="line">            Ivar ivar = ivars[i];</span><br><span class="line">            <span class="built_in">NSString</span> * key = [<span class="built_in">NSString</span> stringWithUTF8String:ivar_getName(ivar)];</span><br><span class="line">            [<span class="keyword">self</span> setValue:[aDecoder decodeObjectForKey:key] forKey:key];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)encodeWithCoder:(<span class="built_in">NSCoder</span> *)aCoder &#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> outCount;</span><br><span class="line">    Ivar * ivars = class_copyIvarList([<span class="keyword">self</span> <span class="keyword">class</span>], &amp;outCount);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; outCount; i ++) &#123;</span><br><span class="line">        Ivar ivar = ivars[i];</span><br><span class="line">        <span class="built_in">NSString</span> * key = [<span class="built_in">NSString</span> stringWithUTF8String:ivar_getName(ivar)];</span><br><span class="line">        [aCoder encodeObject:[<span class="keyword">self</span> valueForKey:key] forKey:key];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>15ã€ä¼˜åŒ–Snipkit æ²¡æœ‰<code>distributeViewsAlong</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;1ã€PrefixHeaderå¯¼å…¥ä½ç½®å†™æ³•&lt;br&gt;&lt;figure class=&quot;highlight elixir&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>AVPlayerå°è£…</title>
    <link href="https://wudan-ios.github.io/2019/01/11/AVPlayer%E5%B0%81%E8%A3%85/"/>
    <id>https://wudan-ios.github.io/2019/01/11/AVPlayerå°è£…/</id>
    <published>2019-01-11T07:41:50.499Z</published>
    <updated>2019-01-11T07:45:56.494Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://upload-images.jianshu.io/upload_images/3334769-066df343391a04f5.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="60920ddb4ccdca50074568b5ea54679f.jpg"></p><p>æœ€è¿‘åœ¨å†™å…³äºéŸ³è§†é¢‘æ’­æ”¾çš„æ¡ˆä¾‹ï¼Œæ‰€ä»¥å°±è¶æœºä¼šç ”ç©¶äº†ä¸€ä¸‹AVPlayerçš„å†…å®¹ã€‚æˆ‘å°è£…çš„ç›®å‰åªèƒ½æ’­æ”¾ç½‘ç»œéŸ³è§†é¢‘ã€‚è¿˜æœªæ·»åŠ ç¼“å­˜ï¼Œä»¥åæ‰¾æœºä¼šç ”ç©¶ä¸€ä¸‹å†æ›´æ–°ã€‚ä»£ç ä¸­æä¾›äº†éŸ³è§†é¢‘çš„ä¸Šä¸€æ›²ã€ä¸‹ä¸€æ›²ã€æš‚åœã€å¼€å§‹ã€åœæ­¢ã€å•æ›²æ’­æ”¾ã€é¡ºåºæ’­æ”¾ã€éšæœºæ’­æ”¾ç­‰åŠŸèƒ½ã€‚ä»£ç å†™çš„ä¸å¥½ï¼Œä»…ä¾›å‚è€ƒ~</p><h3 id="ä»£ç æ¥å£æ–‡ä»¶"><a href="#ä»£ç æ¥å£æ–‡ä»¶" class="headerlink" title="ä»£ç æ¥å£æ–‡ä»¶"></a>ä»£ç æ¥å£æ–‡ä»¶</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;AVFoundation/AVFoundation.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">NS_ASSUME_NONNULL_BEGIN</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å½“å‰æ’­æ”¾å™¨çš„æ’­æ”¾å½¢å¼</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSInteger</span>, MediaPlayType) &#123;</span><br><span class="line">    MediaPlayTypeCycle,   <span class="comment">///&lt; é¡ºåº</span></span><br><span class="line">    MediaPlayTypeSingle,  <span class="comment">///&lt; å•æ›²å¾ªç¯</span></span><br><span class="line">    MediaPlayTypeRandom   <span class="comment">///&lt; éšæœºæ’­æ”¾</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å½“å‰æ’­æ”¾å™¨çš„æ’­æ”¾çŠ¶æ€</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSInteger</span>, MediaPlayStatus) &#123;</span><br><span class="line">    MediaPlayStatusStop,        <span class="comment">///&lt; åœæ­¢æ’­æ”¾</span></span><br><span class="line">    MediaPlayStatusPause,       <span class="comment">///&lt; æš‚åœæ’­æ”¾</span></span><br><span class="line">    MediaPlayStatusPlaying      <span class="comment">///&lt; æ­£åœ¨æ’­æ”¾</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åª’ä½“åŠ è½½çŠ¶æ€</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSInteger</span>, MediaLoadStatus) &#123;</span><br><span class="line">    MediaLoadStatusReadyToPlay,  <span class="comment">///&lt; å‡†å¤‡æ’­æ”¾</span></span><br><span class="line">    MediaLoadStatusUnknown,      <span class="comment">///&lt; æœªçŸ¥</span></span><br><span class="line">    MediaPlayStatusFailed        <span class="comment">///&lt; å¤±è´¥</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@class</span> <span class="title">MediaPlyerManager</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">MediaPlyerManagerDelegate</span> &lt;<span class="title">NSObject</span>&gt;</span></span><br><span class="line"><span class="keyword">@optional</span></span><br><span class="line"><span class="comment">// æ•°æ®åŠ è½½çŠ¶æ€ æ ¹æ®çŠ¶æ€è¿›è¡Œæ’­æ”¾æˆ–å…¶ä»–æ“ä½œ</span></span><br><span class="line">- (<span class="keyword">void</span>)MediaPlayer:(MediaPlyerManager *)playerManager playerItemStatus:(MediaLoadStatus)status;</span><br><span class="line"><span class="comment">// ç¼“å†²è¿›åº¦</span></span><br><span class="line">- (<span class="keyword">void</span>)MediaPlayer:(MediaPlyerManager *)playerManager netBufferValue:(<span class="built_in">CGFloat</span>)value;</span><br><span class="line"><span class="comment">// ç¼“å†²æ˜¯å¦è¶³å¤Ÿæ’­æ”¾</span></span><br><span class="line">- (<span class="keyword">void</span>)MediaPlayer:(MediaPlyerManager *)playerManager bufferHasEnough:(<span class="built_in">BOOL</span>)enough;</span><br><span class="line"><span class="comment">// å½“å‰æ’­æ”¾çš„æ—¶é—´</span></span><br><span class="line">- (<span class="keyword">void</span>)MediaPlayer:(MediaPlyerManager *)playerManager currentPlayTime:(<span class="built_in">NSString</span> *)time currentPlayTimeValue:(<span class="built_in">CGFloat</span>)value;</span><br><span class="line"><span class="comment">// æ’­æ”¾æ€»æ—¶é—´</span></span><br><span class="line">- (<span class="keyword">void</span>)MediaPlayer:(MediaPlyerManager *)playerManager mediaEndTime:(<span class="built_in">NSString</span> *)time mediaEndTimeValue:(<span class="built_in">CGFloat</span>)value;</span><br><span class="line"><span class="comment">// æ’­æ”¾ç»“æŸ</span></span><br><span class="line">- (<span class="keyword">void</span>)MediaPlayerCurrentMediaPlayFinish:(MediaPlyerManager *)playerManager;</span><br><span class="line"><span class="comment">// æ’­æ”¾çŠ¶æ€</span></span><br><span class="line">- (<span class="keyword">void</span>)MediaPlayer:(MediaPlyerManager *)playerManager playeStatus:(MediaPlayStatus)status;</span><br><span class="line"><span class="comment">// è·å–æ•°æ®åˆ‡æ¢æ—¶è·å–æ­£åœ¨æ’­æ”¾çš„URLå’Œå½“å‰çš„index</span></span><br><span class="line">- (<span class="keyword">void</span>)MediaPlayer:(MediaPlyerManager *)playerManager currentUrl:(<span class="built_in">NSString</span> *)url currentIndex:(<span class="built_in">NSInteger</span>)index;</span><br><span class="line"><span class="comment">// ä¸ºäº†é…åˆæ‰‹æœºåå°æ’­æ”¾ å®æ—¶è·å–æ’­æ”¾çš„è¿›åº¦ï¼Œæ€»çš„æ—¶é—´ï¼Œå½“å‰çš„index&lt;é€šè¿‡indexè·å–å›¾ç‰‡ç­‰ä¿¡æ¯&gt;</span></span><br><span class="line">- (<span class="keyword">void</span>)MediaPlayer:(MediaPlyerManager *)playerManager currentProgressValue:(<span class="built_in">CGFloat</span>)value totalValue:(<span class="built_in">CGFloat</span>)totalValue currentIndex:(<span class="built_in">NSInteger</span>)index;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> MediaPlyerManager *(^playerCurrentTime)(<span class="built_in">NSString</span> *time);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MediaPlyerManager</span> : <span class="title">NSObject</span></span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) <span class="built_in">AVPlayer</span>                  *mediaPlayer;          <span class="comment">///&lt; æ’­æ”¾å™¨</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) <span class="built_in">AVPlayerItem</span>              *meidaPlayerItem;      <span class="comment">///&lt; æ’­æ”¾å™¨çš„CurrentItem</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readonly</span>) <span class="built_in">NSMutableArray</span>&lt;<span class="built_in">NSString</span>*&gt; *dataUrlArray;         <span class="comment">///&lt; æ­£åœ¨æ’­æ”¾çš„åˆ—è¡¨æ•°æ®</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>, <span class="keyword">readonly</span>) MediaPlayType              playType;             <span class="comment">///&lt; å½“å‰æ’­æ”¾ç±»å‹</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>, <span class="keyword">readonly</span>) MediaPlayStatus            playStatus;           <span class="comment">///&lt; å½“å‰æ’­æ”¾çŠ¶æ€</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>, <span class="keyword">readonly</span>) <span class="built_in">NSInteger</span>                  currentIndex;         <span class="comment">///&lt; å½“å‰æ’­æ”¾çš„ç´¢å¼•</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>, <span class="keyword">readonly</span>) <span class="built_in">BOOL</span>                       isPlaying;            <span class="comment">///&lt; æ˜¯å¦åœ¨æ’­æ”¾</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>, <span class="keyword">readonly</span>) <span class="built_in">CGFloat</span>                    curentPlayTimeValue;  <span class="comment">///&lt; å½“å‰æ’­æ”¾æ—¶é—´å€¼</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>, <span class="keyword">readonly</span>) <span class="built_in">NSString</span>                    *curentPlayTime;       <span class="comment">///&lt; å½“å‰æ’­æ”¾æ—¶é—´</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>, <span class="keyword">readonly</span>) <span class="built_in">CGFloat</span>                    endPlayTimeValue;     <span class="comment">///&lt; å½“å‰æ’­æ”¾æ—¶é—´å€¼</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>, <span class="keyword">readonly</span>) <span class="built_in">NSString</span>                    *endPlayTime;          <span class="comment">///&lt; å½“å‰æ’­æ”¾æ—¶é—´</span></span><br><span class="line">+ (<span class="keyword">instancetype</span>)defaultManager;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> åˆ—è¡¨æ’­æ”¾ âš ï¸&lt;é»˜è®¤ä¸è‡ªåŠ¨æ’­æ”¾&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> @param urls æ–‡ä»¶è·¯å¾„æ•°ç»„</span></span><br><span class="line"><span class="comment"> @param delegate å›è°ƒä»£ç†</span></span><br><span class="line"><span class="comment"> @return MediaPlyerManager</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (MediaPlyerManager *)playerWithUrls:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *)urls actionWithDelegate:(<span class="keyword">id</span>&lt;MediaPlyerManagerDelegate&gt;)delegate;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> å•ä¸ªéŸ³è§†é¢‘æ’­æ”¾ âš ï¸&lt;é»˜è®¤ä¸è‡ªåŠ¨æ’­æ”¾&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> @param url æ–‡ä»¶è·¯å¾„</span></span><br><span class="line"><span class="comment"> @param delegate å›è°ƒä»£ç†</span></span><br><span class="line"><span class="comment"> @return MediaPlyerManager</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (MediaPlyerManager *)playerWithUrl:(<span class="built_in">NSString</span> *)url actionWithDelegate:(<span class="keyword">id</span>&lt;MediaPlyerManagerDelegate&gt;)delegate;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    å¼€å§‹æ’­æ”¾</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)play;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    æš‚åœæ’­æ”¾</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)pause;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    åœæ­¢æ’­æ”¾</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)stop;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    ä¸‹ä¸€æ›²</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)next;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    ä¸Šä¸€æ›²</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)previous;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> æŒ‡å®šè¿›åº¦å¼€å§‹æ’­æ”¾</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> @param progress è¿›åº¦ç™¾åˆ†æ¯”</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)setupPlayerSeekToProgress:(<span class="built_in">CGFloat</span>)progress;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> åˆ¶å®šæ’­æ”¾ç±»å‹</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> @param type ç±»å‹</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)setupMediaPlayerType:(MediaPlayType)type;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> æŒ‡å®šæ’­æ”¾çš„index</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> @param index ç´¢å¼•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)setupPlayerIndex:(<span class="built_in">NSInteger</span>)index;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> æ·»åŠ æ•°æ®</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> @param files æ–‡ä»¶æ•°ç»„</span></span><br><span class="line"><span class="comment"> @param index ç´¢å¼•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)insertMediaFile:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *)files atIndex:(<span class="built_in">NSInteger</span>)index;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    ç§»é™¤å…¨éƒ¨æ•°æ®</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)removeAllFiles;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> ç§»é™¤ç´¢å¼•ä¸­çš„å•ä¸ªæ•°æ®</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> @param index ç´¢å¼•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)removeObjectAtIndex:(<span class="built_in">NSInteger</span>)index;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> è®¾ç½®é”å±æ ·å¼</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> @param coverImage ä¸“è¾‘å›¾ç‰‡</span></span><br><span class="line"><span class="comment"> @param size æ˜¾ç¤ºå¤§å°</span></span><br><span class="line"><span class="comment"> @param title æ ‡é¢˜</span></span><br><span class="line"><span class="comment"> @param author ä¸“è¾‘ä½œè€…</span></span><br><span class="line"><span class="comment"> @param album ä¸“è¾‘åç§°</span></span><br><span class="line"><span class="comment"> @param currentTime å½“å‰æ’­æ”¾æ—¶é—´</span></span><br><span class="line"><span class="comment"> @param duration æ’­æ”¾æ€»æ—¶é•¿</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)setupLockScreenPlayInfo:(<span class="built_in">UIImage</span> *)coverImage</span><br><span class="line">                      imageSize:(<span class="built_in">CGSize</span>)size</span><br><span class="line">                          title:(<span class="built_in">NSString</span> *)title</span><br><span class="line">                         ahthor:(<span class="built_in">NSString</span> *)author</span><br><span class="line">                         album:(<span class="built_in">NSString</span> *)album</span><br><span class="line">                currentPlayTime:(<span class="built_in">CGFloat</span>)currentTime</span><br><span class="line">                       duration:(<span class="built_in">CGFloat</span>)duration;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">NS_ASSUME_NONNULL_END</span></span><br></pre></td></tr></table></figure><h3 id="ä»£ç å®ç°æ–‡ä»¶"><a href="#ä»£ç å®ç°æ–‡ä»¶" class="headerlink" title="ä»£ç å®ç°æ–‡ä»¶"></a>ä»£ç å®ç°æ–‡ä»¶</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">"MediaPlyerManager.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;MediaPlayer/MediaPlayer.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MediaPlyerManager</span> ()</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readwrite</span>) <span class="built_in">NSMutableArray</span>&lt;<span class="built_in">NSString</span> *&gt; *dataUrlArray;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readwrite</span>) <span class="built_in">AVPlayer</span>                  *mediaPlayer;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>, <span class="keyword">readwrite</span>) <span class="built_in">BOOL</span>                      isPlaying;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>, <span class="keyword">readwrite</span>) <span class="built_in">AVPlayerItem</span>              *meidaPlayerItem;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>, <span class="keyword">readwrite</span>) MediaPlayType             playeType;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>, <span class="keyword">readwrite</span>) <span class="built_in">NSInteger</span>                 currentIndex;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>, <span class="keyword">readwrite</span>) MediaPlayStatus           playStatus;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>, <span class="keyword">readwrite</span>) <span class="built_in">CGFloat</span>                   curentPlayTimeValue;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>, <span class="keyword">readwrite</span>  ) <span class="built_in">NSString</span>                  *curentPlayTime;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>, <span class="keyword">readwrite</span>) <span class="built_in">CGFloat</span>                   endPlayTimeValue;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>, <span class="keyword">readwrite</span>  ) <span class="built_in">NSString</span>                  *endPlayTime;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">weak</span>             ) <span class="keyword">id</span> &lt;MediaPlyerManagerDelegate&gt; delegate;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">MediaPlyerManager</span></span></span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">instancetype</span>)defaultManager &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</span><br><span class="line">    <span class="keyword">static</span> MediaPlyerManager *manger;</span><br><span class="line">    <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</span><br><span class="line">        manger = [[MediaPlyerManager alloc] init];</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> manger;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - åˆå§‹åŒ–</span></span><br><span class="line"></span><br><span class="line">- (MediaPlyerManager *)playerWithUrl:(<span class="built_in">NSString</span> *)url actionWithDelegate:(<span class="keyword">id</span>&lt;MediaPlyerManagerDelegate&gt;)delegate &#123;</span><br><span class="line">    [<span class="keyword">self</span> playerWithUrls:@[url] actionWithDelegate:delegate];</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (MediaPlyerManager *)playerWithUrls:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *)urls actionWithDelegate:(<span class="keyword">id</span>&lt;MediaPlyerManagerDelegate&gt;)delegate &#123;</span><br><span class="line">    <span class="keyword">self</span>.delegate         = delegate;</span><br><span class="line">    <span class="keyword">self</span>.currentIndex     = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">self</span>.dataUrlArray     = [<span class="built_in">NSMutableArray</span> array];</span><br><span class="line">    <span class="built_in">NSMutableArray</span> *array = [<span class="built_in">NSMutableArray</span> arrayWithCapacity:urls.count];</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">NSString</span> *urlStr <span class="keyword">in</span> urls) &#123;</span><br><span class="line">        [array addObject:[<span class="keyword">self</span> createPlayerItemWithUrl:urlStr]];</span><br><span class="line">        [<span class="keyword">self</span>.dataUrlArray addObject:urlStr];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">self</span>.playeType = MediaPlayTypeCycle;</span><br><span class="line">    <span class="keyword">self</span>.mediaPlayer = [[<span class="built_in">AVPlayer</span> alloc] initWithPlayerItem:array.firstObject];</span><br><span class="line">    <span class="keyword">self</span>.meidaPlayerItem = <span class="keyword">self</span>.mediaPlayer.currentItem;</span><br><span class="line">    [<span class="keyword">self</span> getCurrentIndex:<span class="keyword">self</span>.currentIndex];</span><br><span class="line">    [<span class="keyword">self</span> addObserver];</span><br><span class="line">    </span><br><span class="line">    __<span class="keyword">weak</span> <span class="keyword">typeof</span>(<span class="keyword">self</span>) weakself = <span class="keyword">self</span>;</span><br><span class="line">    [<span class="keyword">self</span>.mediaPlayer addPeriodicTimeObserverForInterval:<span class="built_in">CMTimeMake</span>(<span class="number">1</span>, <span class="number">1</span>) queue:<span class="literal">NULL</span> usingBlock:^(<span class="built_in">CMTime</span> time) &#123;</span><br><span class="line">        <span class="built_in">NSString</span> *currentString = [weakself getStringFromCMTime:time];</span><br><span class="line">        weakself.curentPlayTime = currentString;</span><br><span class="line">        weakself.curentPlayTimeValue = (<span class="built_in">CGFloat</span>)time.value/time.timescale;        </span><br><span class="line"><span class="meta">#pragma mark - è·å–å½“å‰æ’­æ”¾æ—¶é—´</span></span><br><span class="line">        <span class="keyword">if</span> (weakself.delegate &amp;&amp; [weakself.delegate respondsToSelector:<span class="keyword">@selector</span>(MediaPlayer:currentPlayTime:currentPlayTimeValue:)]) &#123;</span><br><span class="line">            [weakself.delegate MediaPlayer:weakself currentPlayTime:currentString currentPlayTimeValue:(<span class="built_in">CGFloat</span>)time.value/time.timescale];</span><br><span class="line">        &#125;</span><br><span class="line"><span class="meta">#pragma mark - å®æ—¶è·å–æ’­æ”¾ä¿¡æ¯</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">self</span>.delegate &amp;&amp; [<span class="keyword">self</span>.delegate respondsToSelector:<span class="keyword">@selector</span>(MediaPlayer:currentProgressValue:totalValue:currentIndex:)]) &#123;</span><br><span class="line">            [weakself.delegate MediaPlayer:weakself currentProgressValue:weakself.curentPlayTimeValue totalValue:weakself.endPlayTimeValue currentIndex:weakself.currentIndex];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - æ’­æ”¾ç»“æŸ</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)playFinish:(<span class="built_in">NSNotification</span> *)notification &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.delegate &amp;&amp; [<span class="keyword">self</span>.delegate respondsToSelector:<span class="keyword">@selector</span>(MediaPlayerCurrentMediaPlayFinish:)]) &#123;</span><br><span class="line">        [<span class="keyword">self</span>.delegate MediaPlayerCurrentMediaPlayFinish:<span class="keyword">self</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.playeType == MediaPlayTypeSingle) &#123;</span><br><span class="line">        [<span class="keyword">self</span>.mediaPlayer seekToTime:kCMTimeZero];</span><br><span class="line">        [<span class="keyword">self</span> play];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">self</span>.currentIndex &lt; <span class="keyword">self</span>.dataUrlArray.count - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">self</span>.currentIndex += <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">self</span>.currentIndex = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        [<span class="keyword">self</span>.mediaPlayer replaceCurrentItemWithPlayerItem:[<span class="keyword">self</span> createPlayerItemWithUrl:<span class="keyword">self</span>.dataUrlArray[<span class="keyword">self</span>.currentIndex]]];</span><br><span class="line">        <span class="keyword">self</span>.meidaPlayerItem = <span class="keyword">self</span>.mediaPlayer.currentItem;</span><br><span class="line">        [<span class="keyword">self</span> getCurrentIndex:<span class="keyword">self</span>.currentIndex];</span><br><span class="line">        [<span class="keyword">self</span> play];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - KVO</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)observeValueForKeyPath:(<span class="built_in">NSString</span> *)keyPath</span><br><span class="line">                      ofObject:(<span class="keyword">id</span>)object</span><br><span class="line">                        change:(<span class="built_in">NSDictionary</span>&lt;<span class="built_in">NSKeyValueChangeKey</span>,<span class="keyword">id</span>&gt; *)change</span><br><span class="line">                       context:(<span class="keyword">void</span> *)context &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">AVPlayerItem</span> *playerItem = object;</span><br><span class="line">    <span class="keyword">if</span> ([keyPath isEqualToString:<span class="string">@"status"</span>]) &#123;</span><br><span class="line">        MediaLoadStatus status = [change[<span class="string">@"new"</span>] integerValue];</span><br><span class="line"><span class="meta">#pragma mark - è·å–åª’ä½“åŠ è½½çŠ¶æ€</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">self</span>.delegate &amp;&amp; [<span class="keyword">self</span>.delegate respondsToSelector:<span class="keyword">@selector</span>(MediaPlayer:playerItemStatus:)]) &#123;</span><br><span class="line">            [<span class="keyword">self</span>.delegate MediaPlayer:<span class="keyword">self</span> playerItemStatus:status];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ([keyPath isEqualToString:<span class="string">@"loadedTimeRanges"</span>]) &#123;</span><br><span class="line">        <span class="built_in">NSArray</span> * timeRanges         = playerItem.loadedTimeRanges;</span><br><span class="line">        <span class="built_in">CMTimeRange</span> timeRange        = [timeRanges.firstObject <span class="built_in">CMTimeRangeValue</span>];</span><br><span class="line">        <span class="built_in">NSTimeInterval</span> totalLoadTime = <span class="built_in">CMTimeGetSeconds</span>(timeRange.start) \</span><br><span class="line">                                                + <span class="built_in">CMTimeGetSeconds</span>(timeRange.duration);</span><br><span class="line">        <span class="built_in">NSTimeInterval</span> duration      = <span class="built_in">CMTimeGetSeconds</span>(playerItem.duration);</span><br><span class="line">        <span class="built_in">NSTimeInterval</span> scale         = totalLoadTime/duration;</span><br><span class="line">        </span><br><span class="line"><span class="meta">#pragma mark - è·å–åª’ä½“æ€»æ—¶é—´</span></span><br><span class="line">        <span class="keyword">if</span> ((<span class="built_in">CGFloat</span>)duration/scale &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">self</span>.endPlayTime = [<span class="keyword">self</span> getStringFromCMTime:playerItem.duration];</span><br><span class="line">            <span class="keyword">self</span>.endPlayTimeValue = (<span class="built_in">CGFloat</span>)duration/scale;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">self</span>.delegate &amp;&amp; [<span class="keyword">self</span>.delegate respondsToSelector:<span class="keyword">@selector</span>(MediaPlayer:mediaEndTime:mediaEndTimeValue:)]) &#123;</span><br><span class="line">                [<span class="keyword">self</span>.delegate MediaPlayer:<span class="keyword">self</span> mediaEndTime:[<span class="keyword">self</span> getStringFromCMTime:playerItem.duration] mediaEndTimeValue:(<span class="built_in">CGFloat</span>)duration/scale];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line"><span class="meta">#pragma mark - ç¼“å†²ç™¾åˆ†æ¯”</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">self</span>.delegate &amp;&amp; [<span class="keyword">self</span>.delegate respondsToSelector:<span class="keyword">@selector</span>(MediaPlayer:netBufferValue:)]) &#123;</span><br><span class="line">            [<span class="keyword">self</span>.delegate MediaPlayer:<span class="keyword">self</span> netBufferValue:scale];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ([keyPath isEqualToString:<span class="string">@"playbackBufferEmpty"</span>]) &#123;</span><br><span class="line">        </span><br><span class="line"><span class="meta">#pragma mark - ç¼“å†²ä¸è¶³å¤Ÿæ’­æ”¾</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">self</span>.delegate &amp;&amp; [<span class="keyword">self</span>.delegate respondsToSelector:<span class="keyword">@selector</span>(MediaPlayer:bufferHasEnough:)]) &#123;</span><br><span class="line">            [<span class="keyword">self</span>.delegate MediaPlayer:<span class="keyword">self</span> bufferHasEnough:<span class="literal">false</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ([keyPath isEqualToString:<span class="string">@"playbackLikelyToKeepUp"</span>]) &#123;</span><br><span class="line">        </span><br><span class="line"><span class="meta">#pragma mark - ç¼“å†²è¶³å¤Ÿæ’­æ”¾</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">self</span>.delegate &amp;&amp; [<span class="keyword">self</span>.delegate respondsToSelector:<span class="keyword">@selector</span>(MediaPlayer:bufferHasEnough:)]) &#123;</span><br><span class="line">            [<span class="keyword">self</span>.delegate MediaPlayer:<span class="keyword">self</span> bufferHasEnough:<span class="literal">true</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - å¼€å§‹æ’­æ”¾</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)play &#123;</span><br><span class="line">    [<span class="keyword">self</span>.mediaPlayer play];</span><br><span class="line">    [<span class="keyword">self</span> getPlayStatus:MediaPlayStatusPlaying];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - æš‚åœæ’­æ”¾</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)pause &#123;</span><br><span class="line">    [<span class="keyword">self</span>.mediaPlayer pause];</span><br><span class="line">    [<span class="keyword">self</span> getPlayStatus:MediaPlayStatusPause];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - åœæ­¢æ’­æ”¾</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)stop &#123;</span><br><span class="line">    [<span class="keyword">self</span>.mediaPlayer replaceCurrentItemWithPlayerItem:<span class="literal">nil</span>];</span><br><span class="line">    [<span class="keyword">self</span> getPlayStatus:MediaPlayStatusStop];</span><br><span class="line">    [<span class="keyword">self</span> removeObserver];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - ä¸‹ä¸€ä¸ª</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)next &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.playeType == MediaPlayTypeRandom) &#123;</span><br><span class="line">        <span class="keyword">self</span>.currentIndex = (<span class="built_in">NSInteger</span>)arc4random_uniform((int32_t)(<span class="keyword">self</span>.dataUrlArray.count - <span class="number">1</span>));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">self</span>.currentIndex == <span class="keyword">self</span>.dataUrlArray.count - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">self</span>.currentIndex = <span class="number">0</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">self</span>.currentIndex += <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    [<span class="keyword">self</span>.mediaPlayer replaceCurrentItemWithPlayerItem:[<span class="keyword">self</span> createPlayerItemWithUrl:<span class="keyword">self</span>.dataUrlArray[<span class="keyword">self</span>.currentIndex]]];</span><br><span class="line">    <span class="keyword">self</span>.meidaPlayerItem = <span class="keyword">self</span>.mediaPlayer.currentItem;</span><br><span class="line">    [<span class="keyword">self</span> getCurrentIndex:<span class="keyword">self</span>.currentIndex];</span><br><span class="line">    [<span class="keyword">self</span> addObserver];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - ä¸Šä¸€ä¸ª</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)previous &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.playeType == MediaPlayTypeRandom) &#123;</span><br><span class="line">        <span class="keyword">self</span>.currentIndex = (<span class="built_in">NSInteger</span>)arc4random_uniform((int32_t)(<span class="keyword">self</span>.dataUrlArray.count - <span class="number">1</span>));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">self</span>.currentIndex == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">self</span>.currentIndex = <span class="keyword">self</span>.dataUrlArray.count - <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">self</span>.currentIndex -= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    [<span class="keyword">self</span>.mediaPlayer replaceCurrentItemWithPlayerItem:[<span class="keyword">self</span> createPlayerItemWithUrl:<span class="keyword">self</span>.dataUrlArray[<span class="keyword">self</span>.currentIndex]]];</span><br><span class="line">    <span class="keyword">self</span>.meidaPlayerItem = <span class="keyword">self</span>.mediaPlayer.currentItem;</span><br><span class="line">    [<span class="keyword">self</span> getCurrentIndex:<span class="keyword">self</span>.currentIndex];</span><br><span class="line">    [<span class="keyword">self</span> addObserver];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - æ’­æ”¾çŠ¶æ€</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)getPlayStatus:(MediaPlayStatus)status &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.delegate &amp;&amp; [<span class="keyword">self</span>.delegate respondsToSelector:<span class="keyword">@selector</span>(MediaPlayer:playeStatus:)]) &#123;</span><br><span class="line">        [<span class="keyword">self</span>.delegate MediaPlayer:<span class="keyword">self</span> playeStatus:status];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">self</span>.playStatus = status;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (status == MediaPlayStatusPlaying) &#123;</span><br><span class="line">        <span class="keyword">self</span>.isPlaying = <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.isPlaying = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - æ ¹æ®indexè¿›è¡Œå›è°ƒ</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)getCurrentIndex:(<span class="built_in">NSInteger</span>)index &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.delegate &amp;&amp; [<span class="keyword">self</span>.delegate respondsToSelector:<span class="keyword">@selector</span>(MediaPlayer:currentUrl:currentIndex:)]) &#123;</span><br><span class="line">        [<span class="keyword">self</span>.delegate MediaPlayer:<span class="keyword">self</span> currentUrl:<span class="keyword">self</span>.dataUrlArray[index] currentIndex:index];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - è®¾ç½®æ’­æ”¾è¿›åº¦ç™¾åˆ†æ¯”</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setupPlayerSeekToProgress:(<span class="built_in">CGFloat</span>)progress &#123;</span><br><span class="line">    <span class="keyword">float</span> timeValue = progress * <span class="built_in">CMTimeGetSeconds</span>(<span class="keyword">self</span>.mediaPlayer.currentItem.duration);</span><br><span class="line">    [<span class="keyword">self</span>.mediaPlayer seekToTime:<span class="built_in">CMTimeMake</span>(timeValue, <span class="number">1</span>)];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - è®¾ç½®æ’­æ”¾å½¢å¼</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setupMediaPlayerType:(MediaPlayType)type &#123;</span><br><span class="line">    <span class="keyword">self</span>.playeType = type;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - æ’­æ”¾æŒ‡å®šindexçš„åª’ä½“</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setupPlayerIndex:(<span class="built_in">NSInteger</span>)index &#123;</span><br><span class="line">    <span class="keyword">if</span> (index &gt; (<span class="keyword">self</span>.dataUrlArray.count - <span class="number">1</span>)) &#123;</span><br><span class="line">        <span class="keyword">@throw</span> [<span class="built_in">NSException</span> exceptionWithName:<span class="string">@"è¶Šç•Œé”™è¯¯"</span> reason:<span class="string">@"index ä¸èƒ½è¶…å‡ºURLæ•°ç»„çš„é•¿åº¦"</span> userInfo:<span class="literal">nil</span>];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">self</span>.currentIndex = index;</span><br><span class="line">    [<span class="keyword">self</span>.mediaPlayer replaceCurrentItemWithPlayerItem:[<span class="keyword">self</span> createPlayerItemWithUrl:<span class="keyword">self</span>.dataUrlArray[<span class="keyword">self</span>.currentIndex]]];</span><br><span class="line">    <span class="keyword">self</span>.meidaPlayerItem = <span class="keyword">self</span>.mediaPlayer.currentItem;</span><br><span class="line">    [<span class="keyword">self</span> getCurrentIndex:<span class="keyword">self</span>.currentIndex];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - æ’å…¥æ•°æ®</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)insertMediaFile:(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSString</span> *&gt; *)files atIndex:(<span class="built_in">NSInteger</span>)index &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">NSString</span> *urlStr <span class="keyword">in</span> files) &#123;</span><br><span class="line">        <span class="built_in">NSInteger</span> i = [files indexOfObject:urlStr];</span><br><span class="line">        [<span class="keyword">self</span>.dataUrlArray insertObject:urlStr atIndex:index + i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (index &lt; <span class="keyword">self</span>.currentIndex) &#123;</span><br><span class="line">        <span class="keyword">self</span>.currentIndex += <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - åˆ é™¤æ•°æ®</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)removeAllFiles &#123;</span><br><span class="line">    [<span class="keyword">self</span> stop];</span><br><span class="line">    [<span class="keyword">self</span>.dataUrlArray removeAllObjects];</span><br><span class="line">    <span class="keyword">self</span>.dataUrlArray = [<span class="built_in">NSMutableArray</span> array];</span><br><span class="line">    <span class="keyword">self</span>.currentIndex = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)removeObjectAtIndex:(<span class="built_in">NSInteger</span>)index &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.dataUrlArray.count == <span class="number">1</span>) &#123;</span><br><span class="line">        [<span class="keyword">self</span> removeAllFiles];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        [<span class="keyword">self</span>.dataUrlArray removeObjectAtIndex:index];</span><br><span class="line">        <span class="keyword">if</span> (index == <span class="keyword">self</span>.currentIndex) &#123;</span><br><span class="line">            <span class="keyword">if</span> (index == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">self</span>.currentIndex = <span class="number">0</span>;</span><br><span class="line">                [<span class="keyword">self</span> next];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">self</span>.currentIndex -= <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">self</span>.currentIndex &gt; index) &#123;</span><br><span class="line">                <span class="keyword">self</span>.currentIndex -= <span class="number">1</span>;</span><br><span class="line">            &#125; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - Utils</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSString</span> *)getStringFromCMTime:(<span class="built_in">CMTime</span>)time &#123;</span><br><span class="line">    <span class="keyword">float</span> currentTimeValue       = (<span class="built_in">CGFloat</span>)time.value/time.timescale;</span><br><span class="line">    <span class="built_in">NSDate</span> * currentDate         = [<span class="built_in">NSDate</span> dateWithTimeIntervalSince1970:currentTimeValue];</span><br><span class="line">    <span class="built_in">NSCalendar</span> *calendar         = [[<span class="built_in">NSCalendar</span> alloc] initWithCalendarIdentifier:<span class="built_in">NSCalendarIdentifierGregorian</span>];</span><br><span class="line">    <span class="built_in">NSInteger</span> unitFlags          = <span class="built_in">NSCalendarUnitHour</span> | <span class="built_in">NSCalendarUnitMinute</span> | <span class="built_in">NSCalendarUnitSecond</span>;</span><br><span class="line">    <span class="built_in">NSDateComponents</span> *components = [calendar components:unitFlags fromDate:currentDate];</span><br><span class="line">    <span class="keyword">if</span> (currentTimeValue &gt;= <span class="number">3600</span> ) &#123;</span><br><span class="line">        <span class="keyword">return</span> [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%02ld:%02ld:%02ld"</span>, (<span class="keyword">long</span>)components.hour, (<span class="keyword">long</span>)components.minute, (<span class="keyword">long</span>)components.second];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%02ld:%02ld"</span>, (<span class="keyword">long</span>)components.minute, (<span class="keyword">long</span>)components.second];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)addObserver &#123;</span><br><span class="line">    <span class="comment">// ç›‘æ§çŠ¶æ€å±æ€§</span></span><br><span class="line">    [<span class="keyword">self</span>.meidaPlayerItem addObserver:<span class="keyword">self</span></span><br><span class="line">                           forKeyPath:<span class="string">@"status"</span></span><br><span class="line">                              options:(<span class="built_in">NSKeyValueObservingOptionOld</span>|<span class="built_in">NSKeyValueObservingOptionNew</span>)</span><br><span class="line">                              context:<span class="literal">nil</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç›‘æ§ç¼“å†²åŠ è½½æƒ…å†µå±æ€§</span></span><br><span class="line">    [<span class="keyword">self</span>.meidaPlayerItem addObserver:<span class="keyword">self</span></span><br><span class="line">                           forKeyPath:<span class="string">@"loadedTimeRanges"</span></span><br><span class="line">                              options:(<span class="built_in">NSKeyValueObservingOptionOld</span>|<span class="built_in">NSKeyValueObservingOptionNew</span>)</span><br><span class="line">                              context:<span class="literal">nil</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç›‘å¬ç¼“å†²ä¸è¶³å¤Ÿæ’­æ”¾</span></span><br><span class="line">    [<span class="keyword">self</span>.meidaPlayerItem addObserver:<span class="keyword">self</span></span><br><span class="line">                           forKeyPath:<span class="string">@"playbackBufferEmpty"</span></span><br><span class="line">                              options:<span class="built_in">NSKeyValueObservingOptionNew</span></span><br><span class="line">                              context:<span class="literal">nil</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç›‘å¬ç¼“å†²è¶³å¤Ÿæ’­æ”¾</span></span><br><span class="line">    [<span class="keyword">self</span>.meidaPlayerItem addObserver:<span class="keyword">self</span></span><br><span class="line">                           forKeyPath:<span class="string">@"playbackLikelyToKeepUp"</span></span><br><span class="line">                              options:<span class="built_in">NSKeyValueObservingOptionNew</span></span><br><span class="line">                              context:<span class="literal">nil</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è·å–æ˜¯å¦æ’­æ”¾ç»“æŸ</span></span><br><span class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:<span class="keyword">self</span></span><br><span class="line">                                             selector:<span class="keyword">@selector</span>(playFinish:)</span><br><span class="line">                                                 name:<span class="built_in">AVPlayerItemDidPlayToEndTimeNotification</span></span><br><span class="line">                                               object:<span class="keyword">self</span>.meidaPlayerItem];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)removeObserver &#123;</span><br><span class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] removeObserver:<span class="keyword">self</span>];</span><br><span class="line">    <span class="keyword">@try</span> &#123;</span><br><span class="line">        [<span class="keyword">self</span>.meidaPlayerItem removeObserver:<span class="keyword">self</span> forKeyPath:<span class="string">@"loadedTimeRanges"</span>];</span><br><span class="line">        [<span class="keyword">self</span>.meidaPlayerItem removeObserver:<span class="keyword">self</span> forKeyPath:<span class="string">@"playbackBufferEmpty"</span>];</span><br><span class="line">        [<span class="keyword">self</span>.meidaPlayerItem removeObserver:<span class="keyword">self</span> forKeyPath:<span class="string">@"playbackLikelyToKeepUp"</span>];</span><br><span class="line">        [<span class="keyword">self</span>.meidaPlayerItem removeObserver:<span class="keyword">self</span> forKeyPath:<span class="string">@"status"</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">@catch</span>(<span class="built_in">NSException</span> *exception) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, exception);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma mark - è®¾ç½®é”å±æ ·å¼</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setupLockScreenPlayInfo:(<span class="built_in">UIImage</span> *)coverImage</span><br><span class="line">                      imageSize:(<span class="built_in">CGSize</span>)size</span><br><span class="line">                          title:(<span class="built_in">NSString</span> *)title</span><br><span class="line">                         ahthor:(<span class="built_in">NSString</span> *)author</span><br><span class="line">                          album:(<span class="built_in">NSString</span> *)album</span><br><span class="line">                currentPlayTime:(<span class="built_in">CGFloat</span>)currentTime</span><br><span class="line">                       duration:(<span class="built_in">CGFloat</span>)duration &#123;</span><br><span class="line">    </span><br><span class="line">    Class playingInfoCenter = <span class="built_in">NSClassFromString</span>(<span class="string">@"MPNowPlayingInfoCenter"</span>);</span><br><span class="line">    <span class="keyword">if</span> (playingInfoCenter) &#123;</span><br><span class="line">        <span class="built_in">NSMutableDictionary</span> *songInfo = [[<span class="built_in">NSMutableDictionary</span> alloc] init];</span><br><span class="line">        <span class="built_in">MPMediaItemArtwork</span> *albumArt = [[<span class="built_in">MPMediaItemArtwork</span> alloc] initWithBoundsSize:size requestHandler:^<span class="built_in">UIImage</span> * _Nonnull(<span class="built_in">CGSize</span> size) &#123;</span><br><span class="line">            <span class="keyword">return</span> coverImage;</span><br><span class="line">        &#125;];</span><br><span class="line">        [songInfo setObject:title forKey:<span class="built_in">MPMediaItemPropertyTitle</span>];</span><br><span class="line">        [songInfo setObject:author forKey:<span class="built_in">MPMediaItemPropertyArtist</span>];</span><br><span class="line">        [songInfo setObject:album forKey:<span class="built_in">MPMediaItemPropertyAlbumTitle</span>];</span><br><span class="line">        [songInfo setObject:albumArt forKey:<span class="built_in">MPMediaItemPropertyArtwork</span>];</span><br><span class="line">        [songInfo setObject:[<span class="built_in">NSNumber</span> numberWithDouble:currentTime] forKey:<span class="built_in">MPNowPlayingInfoPropertyElapsedPlaybackTime</span>];</span><br><span class="line">        [songInfo setObject:[<span class="built_in">NSNumber</span> numberWithDouble:duration] forKey:<span class="built_in">MPMediaItemPropertyPlaybackDuration</span>];</span><br><span class="line">        [[<span class="built_in">MPNowPlayingInfoCenter</span> defaultCenter] setNowPlayingInfo:songInfo];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">AVPlayerItem</span> *)createPlayerItemWithUrl:(<span class="built_in">NSString</span> *)url &#123;</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">AVPlayerItem</span> playerItemWithURL:[<span class="built_in">NSURL</span> URLWithString:url]];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><h3 id="æé—®"><a href="#æé—®" class="headerlink" title="æé—®"></a>æé—®</h3><p>æœ¬æ¥ç›¸åŒä½¿ç”¨AVQueuePlayeræ¥è¿›è¡Œåˆ—è¡¨æ’­æ”¾çš„ï¼Œä½†æ˜¯å½“åšå•æ›²å¾ªç¯çš„æ—¶å€™é‡åˆ°é—®é¢˜ï¼šé€šè¿‡é€šçŸ¥ç›‘å¬æ’­æ”¾å®Œæˆï¼Œåœ¨é€šçŸ¥çš„æ–¹æ³•é‡Œè¿›è¡Œå…·ä½“æ“ä½œï¼Œä½†æ˜¯è®¾ç½®æ— æ•ˆï¼Œç›´æ¥æ’­æ”¾çš„è¿˜æ˜¯ä¸‹ä¸€ä¸ªæ–‡ä»¶ã€‚å¦‚æœæœ‰äººçŸ¥é“å¦‚ä½•è§£å†³ï¼Œå¸®å¿™å›å¤ä¸€ä¸‹ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/3334769-066df343391a04f5.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot;
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>RxSwiftå­¦ä¹ æ—¥å¸¸</title>
    <link href="https://wudan-ios.github.io/2019/01/03/RxSwift%E5%AD%A6%E4%B9%A0%E6%97%A5%E5%B8%B8%EF%BC%88%E5%9F%BA%E7%A1%80%E4%BB%8B%E7%BB%8D%EF%BC%89/"/>
    <id>https://wudan-ios.github.io/2019/01/03/RxSwiftå­¦ä¹ æ—¥å¸¸ï¼ˆåŸºç¡€ä»‹ç»ï¼‰/</id>
    <published>2019-01-03T01:52:22.730Z</published>
    <updated>2019-01-03T01:52:23.454Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Observable-ä»‹ç»"><a href="#Observable-ä»‹ç»" class="headerlink" title="Observable ä»‹ç»"></a>Observable ä»‹ç»</h1><h2 id="Observable"><a href="#Observable" class="headerlink" title="Observable"></a>Observable<t></t></h2><ul><li>Observable<t> è¿™ä¸ªç±»å°±æ˜¯ Rx æ¡†æ¶çš„åŸºç¡€ï¼Œæˆ‘ä»¬å¯ä»¥ç§°å®ƒä¸ºå¯è§‚å¯Ÿåºåˆ—ã€‚å®ƒçš„ä½œç”¨å°±æ˜¯å¯ä»¥å¼‚æ­¥åœ°äº§ç”Ÿä¸€ç³»åˆ—çš„ Eventï¼ˆäº‹ä»¶ï¼‰ï¼Œå³ä¸€ä¸ª Observable<t> å¯¹è±¡ä¼šéšç€æ—¶é—´æ¨ç§»ä¸å®šæœŸåœ°å‘å‡º event(element : T) è¿™æ ·ä¸€ä¸ªä¸œè¥¿ã€‚</t></t></li><li>è€Œä¸”è¿™äº› Event è¿˜å¯ä»¥æºå¸¦æ•°æ®ï¼Œå®ƒçš„æ³›å‹ <t> å°±æ˜¯ç”¨æ¥æŒ‡å®šè¿™ä¸ª Event æºå¸¦çš„æ•°æ®çš„ç±»å‹ã€‚</t></li><li>æœ‰äº†å¯è§‚å¯Ÿåºåˆ—ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æœ‰ä¸€ä¸ª Observerï¼ˆè®¢é˜…è€…ï¼‰æ¥è®¢é˜…å®ƒï¼Œè¿™æ ·è¿™ä¸ªè®¢é˜…è€…æ‰èƒ½æ”¶åˆ° Observable<t> ä¸æ—¶å‘å‡ºçš„ Eventã€‚<h2 id="Event"><a href="#Event" class="headerlink" title="Event"></a>Event</h2>æŸ¥çœ‹ RxSwift æºç å¯ä»¥å‘ç°ï¼Œäº‹ä»¶ Event çš„å®šä¹‰å¦‚ä¸‹ï¼š</t></li></ul><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">enum</span> <span class="title">Event</span>&lt;<span class="title">Element</span>&gt; &#123;</span></span><br><span class="line">    /<span class="regexp">//</span> Next element is produced.</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">next</span>(Element)</span><br><span class="line"> </span><br><span class="line">    /<span class="regexp">//</span> Sequence terminated <span class="keyword">with</span> an error.</span><br><span class="line">    <span class="keyword">case</span> error(Swift.Error)</span><br><span class="line"> </span><br><span class="line">    /<span class="regexp">//</span> Sequence completed successfully.</span><br><span class="line">    <span class="keyword">case</span> completed</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° Event å°±æ˜¯ä¸€ä¸ªæšä¸¾ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ª Observable æ˜¯å¯ä»¥å‘å‡º 3 ç§ä¸åŒç±»å‹çš„ Event äº‹ä»¶ï¼š</p><ul><li>nextï¼šnext äº‹ä»¶å°±æ˜¯é‚£ä¸ªå¯ä»¥æºå¸¦æ•°æ® <t> çš„äº‹ä»¶ï¼Œå¯ä»¥è¯´å®ƒå°±æ˜¯ä¸€ä¸ªâ€œæœ€æ­£å¸¸â€çš„äº‹ä»¶ã€‚</t></li><li>errorï¼šerror äº‹ä»¶è¡¨ç¤ºä¸€ä¸ªé”™è¯¯ï¼Œå®ƒå¯ä»¥æºå¸¦å…·ä½“çš„é”™è¯¯å†…å®¹ï¼Œä¸€æ—¦ Observable å‘å‡ºäº† error eventï¼Œåˆ™è¿™ä¸ª Observable å°±ç­‰äºç»ˆæ­¢äº†ï¼Œä»¥åå®ƒå†ä¹Ÿä¸ä¼šå‘å‡º event äº‹ä»¶äº†ã€‚</li><li>completedï¼šcompleted äº‹ä»¶è¡¨ç¤º Observable å‘å‡ºçš„äº‹ä»¶æ­£å¸¸åœ°ç»“æŸäº†ï¼Œè·Ÿ error ä¸€æ ·ï¼Œä¸€æ—¦ Observable å‘å‡ºäº† completed eventï¼Œåˆ™è¿™ä¸ª Observable å°±ç­‰äºç»ˆæ­¢äº†ï¼Œä»¥åå®ƒå†ä¹Ÿä¸ä¼šå‘å‡º event äº‹ä»¶äº†<h2 id="Observable-ä¸-Sequenceæ¯”è¾ƒ"><a href="#Observable-ä¸-Sequenceæ¯”è¾ƒ" class="headerlink" title="Observable ä¸ Sequenceæ¯”è¾ƒ"></a>Observable ä¸ Sequenceæ¯”è¾ƒ</h2>(1)ã€ä¸ºæ›´å¥½åœ°ç†è§£ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ¯ä¸€ä¸ª Observable çš„å®ä¾‹æƒ³è±¡æˆäºä¸€ä¸ª Swift ä¸­çš„ Sequenceï¼š</li><li>å³ä¸€ä¸ª Observableï¼ˆObservableTypeï¼‰ç›¸å½“äºä¸€ä¸ªåºåˆ— Sequenceï¼ˆSequenceTypeï¼‰ã€‚</li><li>ObservableType.subscribe(_:) æ–¹æ³•å…¶å®å°±ç›¸å½“äº SequenceType.generate()ã€‚</li></ul><p>(2)ã€ä½†å®ƒä»¬ä¹‹é—´è¿˜æ˜¯æœ‰è®¸å¤šåŒºåˆ«çš„ï¼š</p><ul><li>Swift ä¸­çš„ SequenceType æ˜¯åŒæ­¥çš„å¾ªç¯ï¼Œè€Œ Observable æ˜¯å¼‚æ­¥çš„ã€‚</li><li>Observable å¯¹è±¡ä¼šåœ¨æœ‰ä»»ä½• Event æ—¶å€™ï¼Œè‡ªåŠ¨å°† Event ä½œä¸ºä¸€ä¸ªå‚æ•°é€šè¿‡ ObservableType.subscribe(_:) å‘å‡ºï¼Œå¹¶ä¸éœ€è¦ä½¿ç”¨ next æ–¹æ³•ã€‚<h2 id="åˆ›å»º-Observable-åºåˆ—"><a href="#åˆ›å»º-Observable-åºåˆ—" class="headerlink" title="åˆ›å»º Observable åºåˆ—"></a>åˆ›å»º Observable åºåˆ—</h2><h3 id="just-æ–¹æ³•"><a href="#just-æ–¹æ³•" class="headerlink" title="just() æ–¹æ³•"></a>just() æ–¹æ³•</h3>ï¼ˆ1ï¼‰è¯¥æ–¹æ³•é€šè¿‡ä¼ å…¥ä¸€ä¸ªé»˜è®¤å€¼æ¥åˆå§‹åŒ–ã€‚<br><br>ï¼ˆ2ï¼‰ä¸‹é¢æ ·ä¾‹æˆ‘ä»¬æ˜¾å¼åœ°æ ‡æ³¨å‡ºäº† observable çš„ç±»å‹ä¸º Observable<int>ï¼Œå³æŒ‡å®šäº†è¿™ä¸ª Observable æ‰€å‘å‡ºçš„äº‹ä»¶æºå¸¦çš„æ•°æ®ç±»å‹å¿…é¡»æ˜¯ Int ç±»å‹çš„ã€‚</int></li></ul><figure class="highlight golo"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> observable = <span class="keyword">Observable</span>&lt;Int&gt;.just(<span class="number">5</span>)</span><br></pre></td></tr></table></figure><h3 id="of-æ–¹æ³•"><a href="#of-æ–¹æ³•" class="headerlink" title="of() æ–¹æ³•"></a>of() æ–¹æ³•</h3><p>ï¼ˆ1ï¼‰è¯¥æ–¹æ³•å¯ä»¥æ¥å—å¯å˜æ•°é‡çš„å‚æ•°ï¼ˆå¿…éœ€è¦æ˜¯åŒç±»å‹çš„ï¼‰<br><br>ï¼ˆ2ï¼‰ä¸‹é¢æ ·ä¾‹ä¸­æˆ‘æ²¡æœ‰æ˜¾å¼åœ°å£°æ˜å‡º Observable çš„æ³›å‹ç±»å‹ï¼ŒSwift ä¹Ÿä¼šè‡ªåŠ¨æ¨æ–­ç±»å‹ã€‚<br><figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> observable = Observable.<span class="keyword">of</span>(<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>)</span><br></pre></td></tr></table></figure></p><h3 id="from-æ–¹æ³•"><a href="#from-æ–¹æ³•" class="headerlink" title="from() æ–¹æ³•"></a>from() æ–¹æ³•</h3><p>ï¼ˆ1ï¼‰è¯¥æ–¹æ³•éœ€è¦ä¸€ä¸ªæ•°ç»„å‚æ•°ã€‚<br><br>ï¼ˆ2ï¼‰ä¸‹é¢æ ·ä¾‹ä¸­æ•°æ®é‡Œçš„å…ƒç´ å°±ä¼šè¢«å½“åšè¿™ä¸ª Observable æ‰€å‘å‡º event æºå¸¦çš„æ•°æ®å†…å®¹ï¼Œæœ€ç»ˆæ•ˆæœåŒä¸Šé¢é¥¿ of() æ ·ä¾‹æ˜¯ä¸€æ ·çš„ã€‚<br><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> observable = Observable.<span class="keyword">from</span>([<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>])</span><br></pre></td></tr></table></figure></p><h3 id="empty-æ–¹æ³•"><a href="#empty-æ–¹æ³•" class="headerlink" title="empty() æ–¹æ³•"></a>empty() æ–¹æ³•</h3><p>è¯¥æ–¹æ³•åˆ›å»ºä¸€ä¸ªç©ºå†…å®¹çš„ Observable åºåˆ—ã€‚<br><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> observable = Observable&lt;<span class="built_in">Int</span>&gt;.<span class="literal">empty</span>()</span><br></pre></td></tr></table></figure></p><h3 id="never-æ–¹æ³•"><a href="#never-æ–¹æ³•" class="headerlink" title="never() æ–¹æ³•"></a>never() æ–¹æ³•</h3><p>è¯¥æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ°¸è¿œä¸ä¼šå‘å‡º Eventï¼ˆä¹Ÿä¸ä¼šç»ˆæ­¢ï¼‰çš„ Observable åºåˆ—ã€‚<br><figure class="highlight golo"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> observable = <span class="keyword">Observable</span>&lt;Int&gt;.never()</span><br></pre></td></tr></table></figure></p><h3 id="error-æ–¹æ³•"><a href="#error-æ–¹æ³•" class="headerlink" title="error() æ–¹æ³•"></a>error() æ–¹æ³•</h3><p>è¯¥æ–¹æ³•åˆ›å»ºä¸€ä¸ªä¸åšä»»ä½•æ“ä½œï¼Œè€Œæ˜¯ç›´æ¥å‘é€ä¸€ä¸ªé”™è¯¯çš„ Observable åºåˆ—ã€‚<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">MyError</span>: <span class="title">Error</span> &#123;</span></span><br><span class="line">    <span class="keyword">case</span> A</span><br><span class="line">    <span class="keyword">case</span> B</span><br><span class="line">&#125;</span><br><span class="line">         </span><br><span class="line">let observable = Observable&lt;Int&gt;.error(MyError.A)</span><br></pre></td></tr></table></figure></p><h3 id="range-æ–¹æ³•"><a href="#range-æ–¹æ³•" class="headerlink" title="range() æ–¹æ³•"></a>range() æ–¹æ³•</h3><p>ï¼ˆ1ï¼‰è¯¥æ–¹æ³•é€šè¿‡æŒ‡å®šèµ·å§‹å’Œç»“æŸæ•°å€¼ï¼Œåˆ›å»ºä¸€ä¸ªä»¥è¿™ä¸ªèŒƒå›´å†…æ‰€æœ‰å€¼ä½œä¸ºåˆå§‹å€¼çš„ Observable åºåˆ—ã€‚<br><br>ï¼ˆ2ï¼‰ä¸‹é¢æ ·ä¾‹ä¸­ï¼Œä¸¤ç§æ–¹æ³•åˆ›å»ºçš„ Observable åºåˆ—éƒ½æ˜¯ä¸€æ ·çš„ã€‚<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//ä½¿ç”¨<span class="built_in">range</span>()</span><br><span class="line"><span class="keyword">let</span> observable = Observable.<span class="built_in">range</span>(<span class="keyword">star</span><span class="variable">t:</span> <span class="number">1</span>, coun<span class="variable">t:</span> <span class="number">5</span>)</span><br><span class="line"> </span><br><span class="line">//ä½¿ç”¨of()</span><br><span class="line"><span class="keyword">let</span> observable = Observable.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span> ,<span class="number">5</span>)</span><br></pre></td></tr></table></figure></p><h3 id="repeatElement-æ–¹æ³•"><a href="#repeatElement-æ–¹æ³•" class="headerlink" title="repeatElement() æ–¹æ³•"></a>repeatElement() æ–¹æ³•</h3><p>è¯¥æ–¹æ³•åˆ›å»ºä¸€ä¸ªå¯ä»¥æ— é™å‘å‡ºç»™å®šå…ƒç´ çš„ Event çš„ Observable åºåˆ—ï¼ˆæ°¸ä¸ç»ˆæ­¢ï¼‰ã€‚<br><figure class="highlight golo"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> observable = <span class="keyword">Observable</span>.repeatElement(<span class="number">1</span>)</span><br></pre></td></tr></table></figure></p><h3 id="generate-æ–¹æ³•"><a href="#generate-æ–¹æ³•" class="headerlink" title="generate() æ–¹æ³•"></a>generate() æ–¹æ³•</h3><p>ï¼ˆ1ï¼‰è¯¥æ–¹æ³•åˆ›å»ºä¸€ä¸ªåªæœ‰å½“æä¾›çš„æ‰€æœ‰çš„åˆ¤æ–­æ¡ä»¶éƒ½ä¸º true çš„æ—¶å€™ï¼Œæ‰ä¼šç»™å‡ºåŠ¨ä½œçš„ Observable åºåˆ—ã€‚<br><br>ï¼ˆ2ï¼‰ä¸‹é¢æ ·ä¾‹ä¸­ï¼Œä¸¤ç§æ–¹æ³•åˆ›å»ºçš„ Observable åºåˆ—éƒ½æ˜¯ä¸€æ ·çš„ã€‚<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//ä½¿ç”¨generate()æ–¹æ³•</span><br><span class="line"><span class="keyword">let</span> observable = Observable.generate(</span><br><span class="line">    initialState: <span class="number">0</span>,</span><br><span class="line">    condition: &#123; $0 &lt;= <span class="number">10</span> &#125;,</span><br><span class="line">    iterate: &#123; $0 + <span class="number">2</span> &#125;</span><br><span class="line">)</span><br><span class="line"> </span><br><span class="line">//ä½¿ç”¨<span class="keyword">of</span>()æ–¹æ³•</span><br><span class="line"><span class="keyword">let</span> observable = Observable.<span class="keyword">of</span>(<span class="number">0</span> , <span class="number">2</span> ,<span class="number">4</span> ,<span class="number">6</span> ,<span class="number">8</span> ,<span class="number">10</span>)</span><br></pre></td></tr></table></figure></p><h3 id="create-æ–¹æ³•"><a href="#create-æ–¹æ³•" class="headerlink" title="create() æ–¹æ³•"></a>create() æ–¹æ³•</h3><p>ï¼ˆ1ï¼‰è¯¥æ–¹æ³•æ¥å—ä¸€ä¸ª block å½¢å¼çš„å‚æ•°ï¼Œä»»åŠ¡æ˜¯å¯¹æ¯ä¸€ä¸ªè¿‡æ¥çš„è®¢é˜…è¿›è¡Œå¤„ç†ã€‚<br><br>ï¼ˆ2ï¼‰ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„æ ·ä¾‹ã€‚ä¸ºæ–¹ä¾¿æ¼”ç¤ºï¼Œè¿™é‡Œå¢åŠ äº†è®¢é˜…ç›¸å…³ä»£ç ï¼ˆå…³äºè®¢é˜…æˆ‘ä¹‹åä¼šè¯¦ç»†ä»‹ç»çš„ï¼‰ã€‚<br><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¿™ä¸ªblockæœ‰ä¸€ä¸ªå›è°ƒå‚æ•°observerå°±æ˜¯è®¢é˜…è¿™ä¸ªObservableå¯¹è±¡çš„è®¢é˜…è€…</span></span><br><span class="line"><span class="comment">//å½“ä¸€ä¸ªè®¢é˜…è€…è®¢é˜…è¿™ä¸ªObservableå¯¹è±¡çš„æ—¶å€™ï¼Œå°±ä¼šå°†è®¢é˜…è€…ä½œä¸ºå‚æ•°ä¼ å…¥è¿™ä¸ªblockæ¥æ‰§è¡Œä¸€äº›å†…å®¹</span></span><br><span class="line"><span class="keyword">let</span> observable = Observable&lt;<span class="keyword">String</span>&gt;.<span class="keyword">create</span>&#123;observer in</span><br><span class="line">    <span class="comment">//å¯¹è®¢é˜…è€…å‘å‡ºäº†.nextäº‹ä»¶ï¼Œä¸”æºå¸¦äº†ä¸€ä¸ªæ•°æ®"hangge.com"</span></span><br><span class="line">    observer.onNext(<span class="string">"hangge.com"</span>)</span><br><span class="line">    <span class="comment">//å¯¹è®¢é˜…è€…å‘å‡ºäº†.completedäº‹ä»¶</span></span><br><span class="line">    observer.onCompleted()</span><br><span class="line">    <span class="comment">//å› ä¸ºä¸€ä¸ªè®¢é˜…è¡Œä¸ºä¼šæœ‰ä¸€ä¸ªDisposableç±»å‹çš„è¿”å›å€¼ï¼Œæ‰€ä»¥åœ¨ç»“å°¾ä¸€å®šè¦returenä¸€ä¸ªDisposable</span></span><br><span class="line">    <span class="keyword">return</span> Disposables.<span class="keyword">create</span>()</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//è®¢é˜…æµ‹è¯•</span></span><br><span class="line">observable.subscribe &#123;</span><br><span class="line">    <span class="keyword">print</span>($<span class="number">0</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="deferred-æ–¹æ³•"><a href="#deferred-æ–¹æ³•" class="headerlink" title="deferred() æ–¹æ³•"></a>deferred() æ–¹æ³•</h3><p>è¯¥ä¸ªæ–¹æ³•ç›¸å½“äºæ˜¯åˆ›å»ºä¸€ä¸ª Observable å·¥å‚ï¼Œé€šè¿‡ä¼ å…¥ä¸€ä¸ª block æ¥æ‰§è¡Œå»¶è¿Ÿ Observable åºåˆ—åˆ›å»ºçš„è¡Œä¸ºï¼Œè€Œè¿™ä¸ª block é‡Œå°±æ˜¯çœŸæ­£çš„å®ä¾‹åŒ–åºåˆ—å¯¹è±¡çš„åœ°æ–¹ã€‚<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç”¨äºæ ‡è®°æ˜¯å¥‡æ•°ã€è¿˜æ˜¯å¶æ•°</span></span><br><span class="line"><span class="keyword">var</span> isOdd = <span class="literal">true</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//ä½¿ç”¨deferred()æ–¹æ³•å»¶è¿ŸObservableåºåˆ—çš„åˆå§‹åŒ–ï¼Œé€šè¿‡ä¼ å…¥çš„blockæ¥å®ç°Observableåºåˆ—çš„åˆå§‹åŒ–å¹¶ä¸”è¿”å›ã€‚</span></span><br><span class="line"><span class="keyword">let</span> factory : Observable&lt;Int&gt; = Observable.deferred &#123;</span><br><span class="line">     </span><br><span class="line">    <span class="comment">//è®©æ¯æ¬¡æ‰§è¡Œè¿™ä¸ªblockæ—¶å€™éƒ½ä¼šè®©å¥‡ã€å¶æ•°è¿›è¡Œäº¤æ›¿</span></span><br><span class="line">    isOdd = !isOdd</span><br><span class="line">     </span><br><span class="line">    <span class="comment">//æ ¹æ®isOddå‚æ•°ï¼Œå†³å®šåˆ›å»ºå¹¶è¿”å›çš„æ˜¯å¥‡æ•°Observableã€è¿˜æ˜¯å¶æ•°Observable</span></span><br><span class="line">    <span class="keyword">if</span> isOdd &#123;</span><br><span class="line">        <span class="keyword">return</span> Observable.of(<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span> ,<span class="number">7</span>)</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Observable.of(<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//ç¬¬1æ¬¡è®¢é˜…æµ‹è¯•</span></span><br><span class="line">factory.subscribe &#123; <span class="keyword">event</span> <span class="keyword">in</span></span><br><span class="line">    print(<span class="string">"\(isOdd)"</span>, <span class="keyword">event</span>)</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//ç¬¬2æ¬¡è®¢é˜…æµ‹è¯•</span></span><br><span class="line">factory.subscribe &#123; <span class="keyword">event</span> <span class="keyword">in</span></span><br><span class="line">    print(<span class="string">"\(isOdd)"</span>, <span class="keyword">event</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="interval-æ–¹æ³•"><a href="#interval-æ–¹æ³•" class="headerlink" title="interval() æ–¹æ³•"></a>interval() æ–¹æ³•</h3><p>ï¼ˆ1ï¼‰è¿™ä¸ªæ–¹æ³•åˆ›å»ºçš„ Observable åºåˆ—æ¯éš”ä¸€æ®µè®¾å®šçš„æ—¶é—´ï¼Œä¼šå‘å‡ºä¸€ä¸ªç´¢å¼•æ•°çš„å…ƒç´ ã€‚è€Œä¸”å®ƒä¼šä¸€ç›´å‘é€ä¸‹å»ã€‚<br><br>ï¼ˆ2ï¼‰ä¸‹é¢æ–¹æ³•è®©å…¶æ¯ 1 ç§’å‘é€ä¸€æ¬¡ï¼Œå¹¶ä¸”æ˜¯åœ¨ä¸»çº¿ç¨‹ï¼ˆMainSchedulerï¼‰å‘é€ã€‚<br><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">let observable = Observable&lt;Int&gt;.interval(<span class="number">1</span>, scheduler: MainScheduler.<span class="keyword">instance</span>)</span><br><span class="line">observable.subscribe &#123; <span class="keyword">event</span> <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">print</span>(<span class="keyword">event</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="timer-æ–¹æ³•"><a href="#timer-æ–¹æ³•" class="headerlink" title="timer() æ–¹æ³•"></a>timer() æ–¹æ³•</h3><p>ï¼ˆ1ï¼‰è¿™ä¸ªæ–¹æ³•æœ‰ä¸¤ç§ç”¨æ³•ï¼Œä¸€ç§æ˜¯åˆ›å»ºçš„ Observable åºåˆ—åœ¨ç»è¿‡è®¾å®šçš„ä¸€æ®µæ—¶é—´åï¼Œäº§ç”Ÿå”¯ä¸€çš„ä¸€ä¸ªå…ƒç´ ã€‚<br><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//5ç§’ç§åå‘å‡ºå”¯ä¸€çš„ä¸€ä¸ªå…ƒç´ 0</span></span><br><span class="line">let observable = Observable&lt;Int&gt;.timer(<span class="number">5</span>, scheduler: MainScheduler.<span class="keyword">instance</span>)</span><br><span class="line">observable.subscribe &#123; <span class="keyword">event</span> <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">print</span>(<span class="keyword">event</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ï¼ˆ2ï¼‰å¦ä¸€ç§æ˜¯åˆ›å»ºçš„ Observable åºåˆ—åœ¨ç»è¿‡è®¾å®šçš„ä¸€æ®µæ—¶é—´åï¼Œæ¯éš”ä¸€æ®µæ—¶é—´äº§ç”Ÿä¸€ä¸ªå…ƒç´ ã€‚<br><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å»¶æ—¶5ç§’ç§åï¼Œæ¯éš”1ç§’é’Ÿå‘å‡ºä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">let observable = Observable&lt;Int&gt;.timer(<span class="number">5</span>, period: <span class="number">1</span>, scheduler: MainScheduler.<span class="keyword">instance</span>)</span><br><span class="line">observable.subscribe &#123; <span class="keyword">event</span> <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">print</span>(<span class="keyword">event</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="è®¢é˜…-Observable"><a href="#è®¢é˜…-Observable" class="headerlink" title="è®¢é˜… Observable"></a>è®¢é˜… Observable</h1><h3 id="ç¬¬ä¸€ç§ç”¨æ³•ï¼š"><a href="#ç¬¬ä¸€ç§ç”¨æ³•ï¼š" class="headerlink" title="ç¬¬ä¸€ç§ç”¨æ³•ï¼š"></a>ç¬¬ä¸€ç§ç”¨æ³•ï¼š</h3><p>ï¼ˆ1ï¼‰æˆ‘ä»¬ä½¿ç”¨ subscribe() è®¢é˜…äº†ä¸€ä¸ª Observable å¯¹è±¡ï¼Œè¯¥æ–¹æ³•çš„ block çš„å›è°ƒå‚æ•°å°±æ˜¯è¢«å‘å‡ºçš„ event äº‹ä»¶ï¼Œæˆ‘ä»¬å°†å…¶ç›´æ¥æ‰“å°å‡ºæ¥ã€‚<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> observable = Observable.of(<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>)</span><br><span class="line">         </span><br><span class="line">observable.subscribe &#123; <span class="keyword">event</span> <span class="keyword">in</span></span><br><span class="line">    print(<span class="keyword">event</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¾“å…¥ç»“æœå¯ä»¥çœ‹å‡º</p><ul><li>åˆå§‹åŒ– Observable åºåˆ—æ—¶è®¾ç½®çš„é»˜è®¤å€¼éƒ½æŒ‰é¡ºåºé€šè¿‡ .next äº‹ä»¶å‘é€å‡ºæ¥ã€‚</li><li>å½“ Observable åºåˆ—çš„åˆå§‹æ•°æ®éƒ½å‘é€å®Œæ¯•ï¼Œå®ƒè¿˜ä¼šè‡ªåŠ¨å‘ä¸€ä¸ª .completed äº‹ä»¶å‡ºæ¥ã€‚<br></li></ul><p>ï¼ˆ2ï¼‰å¦‚æœæƒ³è¦è·å–åˆ°è¿™ä¸ªäº‹ä»¶é‡Œçš„æ•°æ®ï¼Œå¯ä»¥é€šè¿‡ event.element å¾—åˆ°ã€‚<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> observable = Observable.of(<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>)</span><br><span class="line">         </span><br><span class="line">observable.subscribe &#123; <span class="keyword">event</span> <span class="keyword">in</span></span><br><span class="line">    print(<span class="keyword">event</span>.element)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="ç¬¬äºŒç§ç”¨æ³•ï¼š"><a href="#ç¬¬äºŒç§ç”¨æ³•ï¼š" class="headerlink" title="ç¬¬äºŒç§ç”¨æ³•ï¼š"></a>ç¬¬äºŒç§ç”¨æ³•ï¼š</h3><p>ï¼ˆ1ï¼‰RxSwift è¿˜æä¾›äº†å¦ä¸€ä¸ª subscribe æ–¹æ³•ï¼Œå®ƒå¯ä»¥æŠŠ event è¿›è¡Œåˆ†ç±»ï¼š</p><ul><li>é€šè¿‡ä¸åŒçš„ block å›è°ƒå¤„ç†ä¸åŒç±»å‹çš„ eventã€‚ï¼ˆå…¶ä¸­ onDisposed è¡¨ç¤ºè®¢é˜…è¡Œä¸ºè¢« dispose åçš„å›è°ƒï¼Œè¿™ä¸ªæˆ‘åé¢ä¼šè¯´ï¼‰</li><li>åŒæ—¶ä¼šæŠŠ event æºå¸¦çš„æ•°æ®ç›´æ¥è§£åŒ…å‡ºæ¥ä½œä¸ºå‚æ•°ï¼Œæ–¹ä¾¿æˆ‘ä»¬ä½¿ç”¨ã€‚<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">let observable = Observable.of(<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>)</span><br><span class="line">         </span><br><span class="line">observable.subscribe(onNext: &#123; element <span class="keyword">in</span></span><br><span class="line">    <span class="builtin-name">print</span>(element)</span><br><span class="line">&#125;, onError: &#123; <span class="builtin-name">error</span> <span class="keyword">in</span></span><br><span class="line">    <span class="builtin-name">print</span>(error)</span><br><span class="line">&#125;, onCompleted: &#123;</span><br><span class="line">    <span class="builtin-name">print</span>(<span class="string">"completed"</span>)</span><br><span class="line">&#125;, onDisposed: &#123;</span><br><span class="line">    <span class="builtin-name">print</span>(<span class="string">"disposed"</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li></ul><p>2ï¼‰subscribe() æ–¹æ³•çš„ onNextã€onErrorã€onCompleted å’Œ onDisposed è¿™å››ä¸ªå›è°ƒ block å‚æ•°éƒ½æ˜¯æœ‰é»˜è®¤å€¼çš„ï¼Œå³å®ƒä»¬éƒ½æ˜¯å¯é€‰çš„ã€‚æ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥åªå¤„ç† onNext è€Œä¸ç®¡å…¶ä»–çš„æƒ…å†µã€‚<br><figure class="highlight golo"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> observable = <span class="keyword">Observable</span>.of(<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>)</span><br><span class="line">         </span><br><span class="line">observable.subscribe(onNext: &#123; element <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">print</span>(element)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p><h1 id="ç›‘å¬äº‹ä»¶çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#ç›‘å¬äº‹ä»¶çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç›‘å¬äº‹ä»¶çš„ç”Ÿå‘½å‘¨æœŸ"></a>ç›‘å¬äº‹ä»¶çš„ç”Ÿå‘½å‘¨æœŸ</h1><h3 id="1ã€-doOn-ä»‹ç»"><a href="#1ã€-doOn-ä»‹ç»" class="headerlink" title="1ã€ doOn ä»‹ç»"></a>1ã€ doOn ä»‹ç»</h3><p>ï¼ˆ1ï¼‰æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ doOn æ–¹æ³•æ¥ç›‘å¬äº‹ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Œå®ƒä¼šåœ¨æ¯ä¸€æ¬¡äº‹ä»¶å‘é€å‰è¢«è°ƒç”¨ã€‚<br><br>ï¼ˆ2ï¼‰åŒæ—¶å®ƒå’Œ subscribe ä¸€æ ·ï¼Œå¯ä»¥é€šè¿‡ä¸åŒçš„ block å›è°ƒå¤„ç†ä¸åŒç±»å‹çš„ eventã€‚æ¯”å¦‚ï¼š</p><ul><li>do(onNext:) æ–¹æ³•å°±æ˜¯åœ¨ subscribe(onNext:) å‰è°ƒç”¨</li><li>è€Œ do(onCompleted:) æ–¹æ³•åˆ™ä¼šåœ¨ subscribe(onCompleted:) å‰é¢è°ƒç”¨ã€‚</li></ul><h3 id="ä½¿ç”¨æ ·ä¾‹"><a href="#ä½¿ç”¨æ ·ä¾‹" class="headerlink" title="ä½¿ç”¨æ ·ä¾‹"></a>ä½¿ç”¨æ ·ä¾‹</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">let observable = Observable.of(<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>)</span><br><span class="line"> </span><br><span class="line">observable</span><br><span class="line">    .<span class="keyword">do</span>(onNext: &#123; element <span class="keyword">in</span></span><br><span class="line">        <span class="builtin-name">print</span>(<span class="string">"Intercepted Nextï¼š"</span>, element)</span><br><span class="line">    &#125;, onError: &#123; <span class="builtin-name">error</span> <span class="keyword">in</span></span><br><span class="line">        <span class="builtin-name">print</span>(<span class="string">"Intercepted Errorï¼š"</span>, error)</span><br><span class="line">    &#125;, onCompleted: &#123;</span><br><span class="line">        <span class="builtin-name">print</span>(<span class="string">"Intercepted Completed"</span>)</span><br><span class="line">    &#125;, onDispose: &#123;</span><br><span class="line">        <span class="builtin-name">print</span>(<span class="string">"Intercepted Disposed"</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    .subscribe(onNext: &#123; element <span class="keyword">in</span></span><br><span class="line">        <span class="builtin-name">print</span>(element)</span><br><span class="line">    &#125;, onError: &#123; <span class="builtin-name">error</span> <span class="keyword">in</span></span><br><span class="line">        <span class="builtin-name">print</span>(error)</span><br><span class="line">    &#125;, onCompleted: &#123;</span><br><span class="line">        <span class="builtin-name">print</span>(<span class="string">"completed"</span>)</span><br><span class="line">    &#125;, onDisposed: &#123;</span><br><span class="line">        <span class="builtin-name">print</span>(<span class="string">"disposed"</span>)</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure><h1 id="Observable-çš„é”€æ¯ï¼ˆDisposeï¼‰"><a href="#Observable-çš„é”€æ¯ï¼ˆDisposeï¼‰" class="headerlink" title="Observable çš„é”€æ¯ï¼ˆDisposeï¼‰"></a>Observable çš„é”€æ¯ï¼ˆDisposeï¼‰</h1><h3 id="1ã€Observable-ä»åˆ›å»ºåˆ°ç»ˆç»“æµç¨‹"><a href="#1ã€Observable-ä»åˆ›å»ºåˆ°ç»ˆç»“æµç¨‹" class="headerlink" title="1ã€Observable ä»åˆ›å»ºåˆ°ç»ˆç»“æµç¨‹"></a>1ã€Observable ä»åˆ›å»ºåˆ°ç»ˆç»“æµç¨‹</h3><p>ï¼ˆ1ï¼‰ä¸€ä¸ª Observable åºåˆ—è¢«åˆ›å»ºå‡ºæ¥åå®ƒä¸ä¼šé©¬ä¸Šå°±å¼€å§‹è¢«æ¿€æ´»ä»è€Œå‘å‡º Eventï¼Œè€Œæ˜¯è¦ç­‰åˆ°å®ƒè¢«æŸä¸ªäººè®¢é˜…äº†æ‰ä¼šæ¿€æ´»å®ƒã€‚<br><br>ï¼ˆ2ï¼‰è€Œ Observable åºåˆ—æ¿€æ´»ä¹‹åè¦ä¸€ç›´ç­‰åˆ°å®ƒå‘å‡ºäº† .error æˆ–è€… .completed çš„ event åï¼Œå®ƒæ‰è¢«ç»ˆç»“ã€‚</p><h3 id="2ã€dispose-æ–¹æ³•"><a href="#2ã€dispose-æ–¹æ³•" class="headerlink" title="2ã€dispose() æ–¹æ³•"></a>2ã€dispose() æ–¹æ³•</h3><p>ï¼ˆ1ï¼‰ä½¿ç”¨è¯¥æ–¹æ³•æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨å–æ¶ˆä¸€ä¸ªè®¢é˜…è¡Œä¸ºã€‚<br><br>ï¼ˆ2ï¼‰å¦‚æœæˆ‘ä»¬è§‰å¾—è¿™ä¸ªè®¢é˜…ç»“æŸäº†ä¸å†éœ€è¦äº†ï¼Œå°±å¯ä»¥è°ƒç”¨ dispose() æ–¹æ³•æŠŠè¿™ä¸ªè®¢é˜…ç»™é”€æ¯æ‰ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚<br><br>ï¼ˆ2ï¼‰å½“ä¸€ä¸ªè®¢é˜…è¡Œä¸ºè¢« dispose äº†ï¼Œé‚£ä¹ˆä¹‹å observable å¦‚æœå†å‘å‡º eventï¼Œè¿™ä¸ªå·²ç» dispose çš„è®¢é˜…å°±æ”¶ä¸åˆ°æ¶ˆæ¯äº†ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä½¿ç”¨æ ·ä¾‹ã€‚<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> observable = Observable.of(<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>)</span><br><span class="line">         </span><br><span class="line"><span class="comment">//ä½¿ç”¨subscriptionå¸¸é‡å­˜å‚¨è¿™ä¸ªè®¢é˜…æ–¹æ³•</span></span><br><span class="line"><span class="keyword">let</span> subscription = observable.subscribe &#123; <span class="keyword">event</span> <span class="keyword">in</span></span><br><span class="line">    print(<span class="keyword">event</span>)</span><br><span class="line">&#125;</span><br><span class="line">         </span><br><span class="line"><span class="comment">//è°ƒç”¨è¿™ä¸ªè®¢é˜…çš„dispose()æ–¹æ³•</span></span><br><span class="line">subscription.dispose()</span><br></pre></td></tr></table></figure></p><h3 id="3ã€DisposeBag"><a href="#3ã€DisposeBag" class="headerlink" title="3ã€DisposeBag"></a>3ã€DisposeBag</h3><p>é™¤äº† dispose() æ–¹æ³•ä¹‹å¤–ï¼Œæˆ‘ä»¬æ›´ç»å¸¸ç”¨åˆ°çš„æ˜¯ä¸€ä¸ªå« DisposeBag çš„å¯¹è±¡æ¥ç®¡ç†å¤šä¸ªè®¢é˜…è¡Œä¸ºçš„é”€æ¯ï¼š<br>æˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ª DisposeBag å¯¹è±¡çœ‹æˆä¸€ä¸ªåƒåœ¾è¢‹ï¼ŒæŠŠç”¨è¿‡çš„è®¢é˜…è¡Œä¸ºéƒ½æ”¾è¿›å»ã€‚<br>è€Œè¿™ä¸ª DisposeBag å°±ä¼šåœ¨è‡ªå·±å¿«è¦ dealloc çš„æ—¶å€™ï¼Œå¯¹å®ƒé‡Œé¢çš„æ‰€æœ‰è®¢é˜…è¡Œä¸ºéƒ½è°ƒç”¨ dispose() æ–¹æ³•ã€‚<br>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä½¿ç”¨æ ·ä¾‹ã€‚<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = DisposeBag()</span><br><span class="line">         </span><br><span class="line"><span class="comment">//ç¬¬1ä¸ªObservableï¼ŒåŠå…¶è®¢é˜…</span></span><br><span class="line"><span class="keyword">let</span> observable1 = Observable.of(<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>)</span><br><span class="line">observable1.subscribe &#123; <span class="keyword">event</span> <span class="keyword">in</span></span><br><span class="line">    print(<span class="keyword">event</span>)</span><br><span class="line">&#125;.disposed(<span class="keyword">by</span>: disposeBag)</span><br><span class="line"> </span><br><span class="line"><span class="comment">//ç¬¬2ä¸ªObservableï¼ŒåŠå…¶è®¢é˜…</span></span><br><span class="line"><span class="keyword">let</span> observable2 = Observable.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">observable2.subscribe &#123; <span class="keyword">event</span> <span class="keyword">in</span></span><br><span class="line">    print(<span class="keyword">event</span>)</span><br><span class="line">&#125;.disposed(<span class="keyword">by</span>: disposeBag)</span><br></pre></td></tr></table></figure></p><h1 id="è§‚å¯Ÿè€…ï¼ˆObserverï¼‰ä»‹ç»"><a href="#è§‚å¯Ÿè€…ï¼ˆObserverï¼‰ä»‹ç»" class="headerlink" title="è§‚å¯Ÿè€…ï¼ˆObserverï¼‰ä»‹ç»"></a>è§‚å¯Ÿè€…ï¼ˆObserverï¼‰ä»‹ç»</h1><p>è§‚å¯Ÿè€…ï¼ˆObserverï¼‰çš„ä½œç”¨å°±æ˜¯ç›‘å¬äº‹ä»¶ï¼Œç„¶åå¯¹è¿™ä¸ªäº‹ä»¶åšå‡ºå“åº”ã€‚æˆ–è€…è¯´ä»»ä½•å“åº”äº‹ä»¶çš„è¡Œä¸ºéƒ½æ˜¯è§‚å¯Ÿè€…ã€‚æ¯”å¦‚ï¼š</p><ul><li>å½“æˆ‘ä»¬ç‚¹å‡»æŒ‰é’®ï¼Œå¼¹å‡ºä¸€ä¸ªæç¤ºæ¡†ã€‚é‚£ä¹ˆè¿™ä¸ªâ€œå¼¹å‡ºä¸€ä¸ªæç¤ºæ¡†â€å°±æ˜¯è§‚å¯Ÿè€… Observer<void></void></li><li>å½“æˆ‘ä»¬è¯·æ±‚ä¸€ä¸ªè¿œç¨‹çš„ json æ•°æ®åï¼Œå°†å…¶æ‰“å°å‡ºæ¥ã€‚é‚£ä¹ˆè¿™ä¸ªâ€œæ‰“å° json æ•°æ®â€å°±æ˜¯è§‚å¯Ÿè€… Observer<json></json></li></ul><h1 id="ç›´æ¥åœ¨-subscribeã€bind-æ–¹æ³•ä¸­åˆ›å»ºè§‚å¯Ÿè€…"><a href="#ç›´æ¥åœ¨-subscribeã€bind-æ–¹æ³•ä¸­åˆ›å»ºè§‚å¯Ÿè€…" class="headerlink" title="ç›´æ¥åœ¨ subscribeã€bind æ–¹æ³•ä¸­åˆ›å»ºè§‚å¯Ÿè€…"></a>ç›´æ¥åœ¨ subscribeã€bind æ–¹æ³•ä¸­åˆ›å»ºè§‚å¯Ÿè€…</h1><h3 id="1-åœ¨-subscribe-æ–¹æ³•ä¸­åˆ›å»º"><a href="#1-åœ¨-subscribe-æ–¹æ³•ä¸­åˆ›å»º" class="headerlink" title="1. åœ¨ subscribe æ–¹æ³•ä¸­åˆ›å»º"></a>1. åœ¨ subscribe æ–¹æ³•ä¸­åˆ›å»º</h3><p>ï¼ˆ1ï¼‰åˆ›å»ºè§‚å¯Ÿè€…æœ€ç›´æ¥çš„æ–¹æ³•å°±æ˜¯åœ¨ Observable çš„ subscribe æ–¹æ³•åé¢æè¿°å½“äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œéœ€è¦å¦‚ä½•åšå‡ºå“åº”ã€‚<br><br>ï¼ˆ2ï¼‰æ¯”å¦‚ä¸‹é¢çš„æ ·ä¾‹ï¼Œè§‚å¯Ÿè€…å°±æ˜¯ç”±åé¢çš„ onNextï¼ŒonErrorï¼ŒonCompleted è¿™äº›é—­åŒ…æ„å»ºå‡ºæ¥çš„ã€‚<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">let observable = Observable.of(<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>)</span><br><span class="line">          </span><br><span class="line">observable.subscribe(onNext: &#123; element <span class="keyword">in</span></span><br><span class="line">    <span class="builtin-name">print</span>(element)</span><br><span class="line">&#125;, onError: &#123; <span class="builtin-name">error</span> <span class="keyword">in</span></span><br><span class="line">    <span class="builtin-name">print</span>(error)</span><br><span class="line">&#125;, onCompleted: &#123;</span><br><span class="line">    <span class="builtin-name">print</span>(<span class="string">"completed"</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p><h3 id="2-åœ¨-bind-æ–¹æ³•ä¸­åˆ›å»º"><a href="#2-åœ¨-bind-æ–¹æ³•ä¸­åˆ›å»º" class="headerlink" title="2. åœ¨ bind æ–¹æ³•ä¸­åˆ›å»º"></a>2. åœ¨ bind æ–¹æ³•ä¸­åˆ›å»º</h3><p>ä¸‹é¢ä»£ç æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå®šæ—¶ç”Ÿæˆç´¢å¼•æ•°çš„ Observable åºåˆ—ï¼Œå¹¶å°†ç´¢å¼•æ•°ä¸æ–­æ˜¾ç¤ºåœ¨ label æ ‡ç­¾ä¸Šï¼š<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> RxSwift</span><br><span class="line"><span class="keyword">import</span> RxCocoa</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@IBOutlet</span> <span class="keyword">weak</span> <span class="keyword">var</span> label: <span class="type">UILabel</span>!</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//Observableåºåˆ—ï¼ˆæ¯éš”1ç§’é’Ÿå‘å‡ºä¸€ä¸ªç´¢å¼•æ•°ï¼‰</span></span><br><span class="line">        <span class="keyword">let</span> observable = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.interval(<span class="number">1</span>, scheduler: <span class="type">MainScheduler</span>.instance)</span><br><span class="line"> </span><br><span class="line">        observable</span><br><span class="line">            .<span class="built_in">map</span> &#123; <span class="string">"å½“å‰ç´¢å¼•æ•°ï¼š\($0 )"</span>&#125;</span><br><span class="line">            .bind &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>](text) <span class="keyword">in</span></span><br><span class="line">                <span class="comment">//æ”¶åˆ°å‘å‡ºçš„ç´¢å¼•æ•°åæ˜¾ç¤ºåˆ°labelä¸Š</span></span><br><span class="line">                <span class="keyword">self</span>?.label.text = text</span><br><span class="line">            &#125;</span><br><span class="line">            .disposed(by: disposeBag)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="ä½¿ç”¨-AnyObserver-åˆ›å»ºè§‚å¯Ÿè€…"><a href="#ä½¿ç”¨-AnyObserver-åˆ›å»ºè§‚å¯Ÿè€…" class="headerlink" title="ä½¿ç”¨ AnyObserver åˆ›å»ºè§‚å¯Ÿè€…"></a>ä½¿ç”¨ AnyObserver åˆ›å»ºè§‚å¯Ÿè€…</h1><p>AnyObserver å¯ä»¥ç”¨æ¥æå™ä»»æ„ä¸€ç§è§‚å¯Ÿè€…ã€‚</p><h3 id="1ã€é…åˆ-subscribe-æ–¹æ³•ä½¿ç”¨"><a href="#1ã€é…åˆ-subscribe-æ–¹æ³•ä½¿ç”¨" class="headerlink" title="1ã€é…åˆ subscribe æ–¹æ³•ä½¿ç”¨"></a>1ã€é…åˆ subscribe æ–¹æ³•ä½¿ç”¨</h3><p>æ¯”å¦‚ä¸Šé¢ç¬¬ä¸€ä¸ªæ ·ä¾‹æˆ‘ä»¬å¯ä»¥æ”¹æˆå¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è§‚å¯Ÿè€…</span></span><br><span class="line">let observer: AnyObserver&lt;String&gt; = AnyObserver &#123; (<span class="keyword">event</span>) <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">switch</span> <span class="keyword">event</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> .next(let data):</span><br><span class="line">        <span class="keyword">print</span>(data)</span><br><span class="line">    <span class="keyword">case</span> .<span class="keyword">error</span>(let <span class="keyword">error</span>):</span><br><span class="line">        <span class="keyword">print</span>(<span class="keyword">error</span>)</span><br><span class="line">    <span class="keyword">case</span> .completed:</span><br><span class="line">        <span class="keyword">print</span>(<span class="string">"completed"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">let observable = Observable.of(<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>)</span><br><span class="line">observable.subscribe(observer)</span><br></pre></td></tr></table></figure></p><h3 id="2ã€é…åˆ-bindTo-æ–¹æ³•ä½¿ç”¨"><a href="#2ã€é…åˆ-bindTo-æ–¹æ³•ä½¿ç”¨" class="headerlink" title="2ã€é…åˆ bindTo æ–¹æ³•ä½¿ç”¨"></a>2ã€é…åˆ bindTo æ–¹æ³•ä½¿ç”¨</h3><p>ä¹Ÿå¯é…åˆ Observable çš„æ•°æ®ç»‘å®šæ–¹æ³•ï¼ˆbindToï¼‰ä½¿ç”¨ã€‚æ¯”å¦‚ä¸Šé¢çš„ç¬¬äºŒä¸ªæ ·ä¾‹æˆ‘å¯ä»¥æ”¹æˆå¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> RxSwift</span><br><span class="line"><span class="keyword">import</span> RxCocoa</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@IBOutlet</span> <span class="keyword">weak</span> <span class="keyword">var</span> label: <span class="type">UILabel</span>!</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//è§‚å¯Ÿè€…</span></span><br><span class="line">        <span class="keyword">let</span> observer: <span class="type">AnyObserver</span>&lt;<span class="type">String</span>&gt; = <span class="type">AnyObserver</span> &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] (event) <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">switch</span> event &#123;</span><br><span class="line">            <span class="keyword">case</span> .next(<span class="keyword">let</span> text):</span><br><span class="line">                <span class="comment">//æ”¶åˆ°å‘å‡ºçš„ç´¢å¼•æ•°åæ˜¾ç¤ºåˆ°labelä¸Š</span></span><br><span class="line">                <span class="keyword">self</span>?.label.text = text</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//Observableåºåˆ—ï¼ˆæ¯éš”1ç§’é’Ÿå‘å‡ºä¸€ä¸ªç´¢å¼•æ•°ï¼‰</span></span><br><span class="line">        <span class="keyword">let</span> observable = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.interval(<span class="number">1</span>, scheduler: <span class="type">MainScheduler</span>.instance)</span><br><span class="line">        observable</span><br><span class="line">            .<span class="built_in">map</span> &#123; <span class="string">"å½“å‰ç´¢å¼•æ•°ï¼š\($0 )"</span>&#125;</span><br><span class="line">            .bind(to: observer)</span><br><span class="line">            .disposed(by: disposeBag)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="ä½¿ç”¨-Binder-åˆ›å»ºè§‚å¯Ÿè€…"><a href="#ä½¿ç”¨-Binder-åˆ›å»ºè§‚å¯Ÿè€…" class="headerlink" title="ä½¿ç”¨ Binder åˆ›å»ºè§‚å¯Ÿè€…"></a>ä½¿ç”¨ Binder åˆ›å»ºè§‚å¯Ÿè€…</h1><h3 id="1ã€åŸºæœ¬ä»‹ç»"><a href="#1ã€åŸºæœ¬ä»‹ç»" class="headerlink" title="1ã€åŸºæœ¬ä»‹ç»"></a>1ã€åŸºæœ¬ä»‹ç»</h3><p>ï¼ˆ1ï¼‰ç›¸è¾ƒäº AnyObserver çš„å¤§è€Œå…¨ï¼ŒBinder æ›´ä¸“æ³¨äºç‰¹å®šçš„åœºæ™¯ã€‚Binder ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ä¸ªç‰¹å¾ï¼š</p><ul><li>ä¸ä¼šå¤„ç†é”™è¯¯äº‹ä»¶</li><li>ç¡®ä¿ç»‘å®šéƒ½æ˜¯åœ¨ç»™å®š Scheduler ä¸Šæ‰§è¡Œï¼ˆé»˜è®¤ MainSchedulerï¼‰</li></ul><p>ï¼ˆ2ï¼‰ä¸€æ—¦äº§ç”Ÿé”™è¯¯äº‹ä»¶ï¼Œåœ¨è°ƒè¯•ç¯å¢ƒä¸‹å°†æ‰§è¡Œ fatalErrorï¼Œåœ¨å‘å¸ƒç¯å¢ƒä¸‹å°†æ‰“å°é”™è¯¯ä¿¡æ¯ã€‚</p><h3 id="ä½¿ç”¨æ ·ä¾‹-1"><a href="#ä½¿ç”¨æ ·ä¾‹-1" class="headerlink" title="ä½¿ç”¨æ ·ä¾‹"></a>ä½¿ç”¨æ ·ä¾‹</h3><p>ï¼ˆ1ï¼‰åœ¨ä¸Šé¢åºåˆ—æ•°æ˜¾ç¤ºæ ·ä¾‹ä¸­ï¼Œlabel æ ‡ç­¾çš„æ–‡å­—æ˜¾ç¤ºå°±æ˜¯ä¸€ä¸ªå…¸å‹çš„ UI è§‚å¯Ÿè€…ã€‚å®ƒåœ¨å“åº”äº‹ä»¶æ—¶ï¼Œåªä¼šå¤„ç† next äº‹ä»¶ï¼Œè€Œä¸”æ›´æ–° UI çš„æ“ä½œéœ€è¦åœ¨ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œã€‚é‚£ä¹ˆè¿™ç§æƒ…å†µä¸‹æ›´å¥½çš„æ–¹æ¡ˆå°±æ˜¯ä½¿ç”¨ Binderã€‚<br><br>ï¼ˆ2ï¼‰ä¸Šé¢çš„æ ·ä¾‹æˆ‘ä»¬æ”¹ç”¨ Binder ä¼šç®€å•è®¸å¤šï¼š<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> RxSwift</span><br><span class="line"><span class="keyword">import</span> RxCocoa</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@IBOutlet</span> <span class="keyword">weak</span> <span class="keyword">var</span> label: <span class="type">UILabel</span>!</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">                 </span><br><span class="line">        <span class="comment">//è§‚å¯Ÿè€…</span></span><br><span class="line">        <span class="keyword">let</span> observer: <span class="type">Binder</span>&lt;<span class="type">String</span>&gt; = <span class="type">Binder</span>(label) &#123; (view, text) <span class="keyword">in</span></span><br><span class="line">            <span class="comment">//æ”¶åˆ°å‘å‡ºçš„ç´¢å¼•æ•°åæ˜¾ç¤ºåˆ°labelä¸Š</span></span><br><span class="line">            view.text = text</span><br><span class="line">        &#125;</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//Observableåºåˆ—ï¼ˆæ¯éš”1ç§’é’Ÿå‘å‡ºä¸€ä¸ªç´¢å¼•æ•°ï¼‰</span></span><br><span class="line">        <span class="keyword">let</span> observable = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.interval(<span class="number">1</span>, scheduler: <span class="type">MainScheduler</span>.instance)</span><br><span class="line">        observable</span><br><span class="line">            .<span class="built_in">map</span> &#123; <span class="string">"å½“å‰ç´¢å¼•æ•°ï¼š\($0 )"</span>&#125;</span><br><span class="line">            .bind(to: observer)</span><br><span class="line">            .disposed(by: disposeBag)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="é™„ï¼šBinder-åœ¨-RxCocoa-ä¸­çš„åº”ç”¨"><a href="#é™„ï¼šBinder-åœ¨-RxCocoa-ä¸­çš„åº”ç”¨" class="headerlink" title="é™„ï¼šBinder åœ¨ RxCocoa ä¸­çš„åº”ç”¨"></a>é™„ï¼šBinder åœ¨ RxCocoa ä¸­çš„åº”ç”¨</h3><p>ï¼ˆ1ï¼‰å…¶å® RxCocoa åœ¨å¯¹è®¸å¤š UI æ§ä»¶è¿›è¡Œæ‰©å±•æ—¶ï¼Œå°±åˆ©ç”¨ Binder å°†æ§ä»¶å±æ€§å˜æˆè§‚æŸ¥è€…ï¼Œæ¯”å¦‚ UIControl+Rx.swift ä¸­çš„ isEnabled å±æ€§ä¾¿æ˜¯ä¸€ä¸ª observer ï¼š<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> RxSwift</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Reactive</span> <span class="title">where</span> <span class="title">Base</span>: <span class="title">UIControl</span> </span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="comment">/// Bindable sink for `enabled` property.</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> isEnabled: <span class="type">Binder</span>&lt;<span class="type">Bool</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Binder</span>(<span class="keyword">self</span>.base) &#123; control, value <span class="keyword">in</span></span><br><span class="line">            control.isEnabled = value</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ï¼ˆ2ï¼‰å› æ­¤æˆ‘ä»¬å¯ä»¥å°†åºåˆ—ç›´æ¥ç»‘å®šåˆ°å®ƒä¸Šé¢ã€‚æ¯”å¦‚ä¸‹é¢æ ·ä¾‹ï¼Œbutton ä¼šåœ¨å¯ç”¨ã€ä¸å¯ç”¨è¿™ä¸¤ç§çŠ¶æ€é—´äº¤æ›¿å˜æ¢ï¼ˆæ¯éš”ä¸€ç§’ï¼‰ã€‚<br><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Observableåºåˆ—ï¼ˆæ¯éš”1ç§’é’Ÿå‘å‡ºä¸€ä¸ªç´¢å¼•æ•°ï¼‰</span></span><br><span class="line"><span class="keyword">let</span> observable = Observable&lt;Int&gt;.interval(<span class="number">1</span>, scheduler: MainScheduler.instance)</span><br><span class="line">observable</span><br><span class="line">    .<span class="built_in">map</span> &#123; $<span class="number">0</span> % <span class="number">2</span> == <span class="number">0</span> &#125;</span><br><span class="line">    .bind(<span class="keyword">to</span>: button.<span class="literal">rx</span>.isEnabled)</span><br><span class="line">    .disposed(<span class="keyword">by</span>: disposeBag)</span><br></pre></td></tr></table></figure></p><h1 id="è‡ªå®šä¹‰å¯ç»‘å®šå±æ€§"><a href="#è‡ªå®šä¹‰å¯ç»‘å®šå±æ€§" class="headerlink" title="è‡ªå®šä¹‰å¯ç»‘å®šå±æ€§"></a>è‡ªå®šä¹‰å¯ç»‘å®šå±æ€§</h1><p>æœ‰æ—¶æˆ‘ä»¬æƒ³è®© UI æ§ä»¶åˆ›å»ºå‡ºæ¥åé»˜è®¤å°±æœ‰ä¸€äº›è§‚å¯Ÿè€…ï¼Œè€Œä¸å¿…æ¯æ¬¡éƒ½ä¸ºå®ƒä»¬å•ç‹¬å»åˆ›å»ºè§‚å¯Ÿè€…ã€‚æ¯”å¦‚æˆ‘ä»¬æƒ³è¦è®©æ‰€æœ‰çš„ UIlabel éƒ½æœ‰ä¸ª fontSize å¯ç»‘å®šå±æ€§ï¼Œå®ƒä¼šæ ¹æ®äº‹ä»¶å€¼è‡ªåŠ¨æ”¹å˜æ ‡ç­¾çš„å­—ä½“å¤§å°ã€‚</p><h3 id="æ–¹å¼ä¸€ï¼šé€šè¿‡å¯¹-UI-ç±»è¿›è¡Œæ‰©å±•"><a href="#æ–¹å¼ä¸€ï¼šé€šè¿‡å¯¹-UI-ç±»è¿›è¡Œæ‰©å±•" class="headerlink" title="æ–¹å¼ä¸€ï¼šé€šè¿‡å¯¹ UI ç±»è¿›è¡Œæ‰©å±•"></a>æ–¹å¼ä¸€ï¼šé€šè¿‡å¯¹ UI ç±»è¿›è¡Œæ‰©å±•</h3><p>è¿™é‡Œæˆ‘ä»¬é€šè¿‡å¯¹ UILabel è¿›è¡Œæ‰©å±•ï¼Œå¢åŠ äº†ä¸€ä¸ª fontSize å¯ç»‘å®šå±æ€§ã€‚<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> RxSwift</span><br><span class="line"><span class="keyword">import</span> RxCocoa</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@IBOutlet</span> <span class="keyword">weak</span> <span class="keyword">var</span> label: <span class="type">UILabel</span>!</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//Observableåºåˆ—ï¼ˆæ¯éš”0.5ç§’é’Ÿå‘å‡ºä¸€ä¸ªç´¢å¼•æ•°ï¼‰</span></span><br><span class="line">        <span class="keyword">let</span> observable = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.interval(<span class="number">0.5</span>, scheduler: <span class="type">MainScheduler</span>.instance)</span><br><span class="line">        observable</span><br><span class="line">            .<span class="built_in">map</span> &#123; <span class="type">CGFloat</span>($<span class="number">0</span>) &#125;</span><br><span class="line">            .bind(to: label.fontSize) <span class="comment">//æ ¹æ®ç´¢å¼•æ•°ä¸æ–­å˜æ”¾å¤§å­—ä½“</span></span><br><span class="line">            .disposed(by: disposeBag)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UILabel</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> fontSize: <span class="type">Binder</span>&lt;<span class="type">CGFloat</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Binder</span>(<span class="keyword">self</span>) &#123; label, fontSize <span class="keyword">in</span></span><br><span class="line">            label.font = <span class="type">UIFont</span>.systemFont(ofSize: fontSize)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="æ–¹å¼äºŒï¼šé€šè¿‡å¯¹-Reactive-ç±»è¿›è¡Œæ‰©å±•"><a href="#æ–¹å¼äºŒï¼šé€šè¿‡å¯¹-Reactive-ç±»è¿›è¡Œæ‰©å±•" class="headerlink" title="æ–¹å¼äºŒï¼šé€šè¿‡å¯¹ Reactive ç±»è¿›è¡Œæ‰©å±•"></a>æ–¹å¼äºŒï¼šé€šè¿‡å¯¹ Reactive ç±»è¿›è¡Œæ‰©å±•</h3><p>æ—¢ç„¶ä½¿ç”¨äº† RxSwiftï¼Œé‚£ä¹ˆæ›´è§„èŒƒçš„å†™æ³•åº”è¯¥æ˜¯å¯¹ Reactive è¿›è¡Œæ‰©å±•ã€‚è¿™é‡ŒåŒæ ·æ˜¯ç»™ UILabel å¢åŠ äº†ä¸€ä¸ª fontSize å¯ç»‘å®šå±æ€§ã€‚<br><br>ï¼ˆæ³¨æ„ï¼šè¿™ç§æ–¹å¼ä¸‹ï¼Œæˆ‘ä»¬ç»‘å®šå±æ€§æ—¶è¦å†™æˆ label.rx.fontSizeï¼‰<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> RxSwift</span><br><span class="line"><span class="keyword">import</span> RxCocoa</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@IBOutlet</span> <span class="keyword">weak</span> <span class="keyword">var</span> label: <span class="type">UILabel</span>!</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//Observableåºåˆ—ï¼ˆæ¯éš”0.5ç§’é’Ÿå‘å‡ºä¸€ä¸ªç´¢å¼•æ•°ï¼‰</span></span><br><span class="line">        <span class="keyword">let</span> observable = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.interval(<span class="number">0.5</span>, scheduler: <span class="type">MainScheduler</span>.instance)</span><br><span class="line">        observable</span><br><span class="line">            .<span class="built_in">map</span> &#123; <span class="type">CGFloat</span>($<span class="number">0</span>) &#125;</span><br><span class="line">            .bind(to: label.rx.fontSize) <span class="comment">//æ ¹æ®ç´¢å¼•æ•°ä¸æ–­å˜æ”¾å¤§å­—ä½“</span></span><br><span class="line">            .disposed(by: disposeBag)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Reactive</span> <span class="title">where</span> <span class="title">Base</span>: <span class="title">UILabel</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> fontSize: <span class="type">Binder</span>&lt;<span class="type">CGFloat</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Binder</span>(<span class="keyword">self</span>.base) &#123; label, fontSize <span class="keyword">in</span></span><br><span class="line">            label.font = <span class="type">UIFont</span>.systemFont(ofSize: fontSize)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="RxSwift-è‡ªå¸¦çš„å¯ç»‘å®šå±æ€§ï¼ˆUI-è§‚å¯Ÿè€…ï¼‰"><a href="#RxSwift-è‡ªå¸¦çš„å¯ç»‘å®šå±æ€§ï¼ˆUI-è§‚å¯Ÿè€…ï¼‰" class="headerlink" title="RxSwift è‡ªå¸¦çš„å¯ç»‘å®šå±æ€§ï¼ˆUI è§‚å¯Ÿè€…ï¼‰"></a>RxSwift è‡ªå¸¦çš„å¯ç»‘å®šå±æ€§ï¼ˆUI è§‚å¯Ÿè€…ï¼‰</h1><p>ï¼ˆ1ï¼‰å…¶å® RxSwift å·²ç»ä¸ºæˆ‘ä»¬æä¾›è®¸å¤šå¸¸ç”¨çš„å¯ç»‘å®šå±æ€§ã€‚æ¯”å¦‚ UILabel å°±æœ‰ text å’Œ attributedText è¿™ä¸¤ä¸ªå¯ç»‘å®šå±æ€§ã€‚<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> RxSwift</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Reactive</span> <span class="title">where</span> <span class="title">Base</span>: <span class="title">UILabel</span> </span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="comment">/// Bindable sink for `text` property.</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> text: <span class="type">Binder</span>&lt;<span class="type">String</span>?&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Binder</span>(<span class="keyword">self</span>.base) &#123; label, text <span class="keyword">in</span></span><br><span class="line">            label.text = text</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/// Bindable sink for `attributedText` property.</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> attributedText: <span class="type">Binder</span>&lt;<span class="type">NSAttributedString</span>?&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Binder</span>(<span class="keyword">self</span>.base) &#123; label, text <span class="keyword">in</span></span><br><span class="line">            label.attributedText = text</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ï¼ˆ2ï¼‰é‚£ä¹ˆä¸Šæ–‡é‚£ä¸ªå®šæ—¶æ˜¾ç¤ºç´¢å¼•æ•°çš„æ ·ä¾‹ï¼Œæˆ‘ä»¬å…¶å®ä¸éœ€è¦è‡ªå®šä¹‰ UI è§‚å¯Ÿè€…ï¼Œç›´æ¥ä½¿ç”¨ RxSwift æä¾›çš„ç»‘å®šå±æ€§å³å¯ã€‚<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> RxSwift</span><br><span class="line"><span class="keyword">import</span> RxCocoa</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@IBOutlet</span> <span class="keyword">weak</span> <span class="keyword">var</span> label: <span class="type">UILabel</span>!</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//Observableåºåˆ—ï¼ˆæ¯éš”1ç§’é’Ÿå‘å‡ºä¸€ä¸ªç´¢å¼•æ•°ï¼‰</span></span><br><span class="line">        <span class="keyword">let</span> observable = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.interval(<span class="number">1</span>, scheduler: <span class="type">MainScheduler</span>.instance)</span><br><span class="line">        observable</span><br><span class="line">            .<span class="built_in">map</span> &#123; <span class="string">"å½“å‰ç´¢å¼•æ•°ï¼š\($0 )"</span>&#125;</span><br><span class="line">            .bind(to: label.rx.text) <span class="comment">//æ”¶åˆ°å‘å‡ºçš„ç´¢å¼•æ•°åæ˜¾ç¤ºåˆ°labelä¸Š</span></span><br><span class="line">            .disposed(by: disposeBag)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="Subjects-ä»‹ç»"><a href="#Subjects-ä»‹ç»" class="headerlink" title="Subjects ä»‹ç»"></a>Subjects ä»‹ç»</h1><h3 id="Subjects-åŸºæœ¬ä»‹ç»"><a href="#Subjects-åŸºæœ¬ä»‹ç»" class="headerlink" title="Subjects åŸºæœ¬ä»‹ç»"></a>Subjects åŸºæœ¬ä»‹ç»</h3><p>ï¼ˆ1ï¼‰Subjects æ—¢æ˜¯è®¢é˜…è€…ï¼Œä¹Ÿæ˜¯ Observableï¼š</p><ul><li>è¯´å®ƒæ˜¯è®¢é˜…è€…ï¼Œæ˜¯å› ä¸ºå®ƒèƒ½å¤ŸåŠ¨æ€åœ°æ¥æ”¶æ–°çš„å€¼ã€‚</li><li>è¯´å®ƒåˆæ˜¯ä¸€ä¸ª Observableï¼Œæ˜¯å› ä¸ºå½“ Subjects æœ‰äº†æ–°çš„å€¼ä¹‹åï¼Œå°±ä¼šé€šè¿‡ Event å°†æ–°å€¼å‘å‡ºç»™ä»–çš„æ‰€æœ‰è®¢é˜…è€…ã€‚</li></ul><p>ï¼ˆ2ï¼‰ä¸€å…±æœ‰å››ç§ Subjectsï¼Œåˆ†åˆ«ä¸ºï¼šPublishSubjectã€BehaviorSubjectã€ReplaySubjectã€Variableã€‚ä»–ä»¬ä¹‹é—´æ—¢æœ‰å„è‡ªçš„ç‰¹ç‚¹ï¼Œä¹Ÿæœ‰ç›¸åŒä¹‹å¤„ï¼š</p><ul><li>é¦–å…ˆä»–ä»¬éƒ½æ˜¯ Observableï¼Œä»–ä»¬çš„è®¢é˜…è€…éƒ½èƒ½æ”¶åˆ°ä»–ä»¬å‘å‡ºçš„æ–°çš„ Eventã€‚</li><li>ç›´åˆ° Subject å‘å‡º .complete æˆ–è€… .error çš„ Event åï¼Œè¯¥ Subject ä¾¿ç»ˆç»“äº†ï¼ŒåŒæ—¶å®ƒä¹Ÿå°±ä¸ä¼šå†å‘å‡º .next äº‹ä»¶ã€‚</li><li>å¯¹äºé‚£äº›åœ¨ Subject ç»ˆç»“åå†è®¢é˜…ä»–çš„è®¢é˜…è€…ï¼Œä¹Ÿèƒ½æ”¶åˆ° subject å‘å‡ºçš„ä¸€æ¡ .complete æˆ– .error çš„ eventï¼Œå‘Šè¯‰è¿™ä¸ªæ–°çš„è®¢é˜…è€…å®ƒå·²ç»ç»ˆç»“äº†ã€‚</li><li>ä»–ä»¬ä¹‹é—´æœ€å¤§çš„åŒºåˆ«åªæ˜¯åœ¨äºï¼šå½“ä¸€ä¸ªæ–°çš„è®¢é˜…è€…åˆšè®¢é˜…å®ƒçš„æ—¶å€™ï¼Œèƒ½ä¸èƒ½æ”¶åˆ° Subject ä»¥å‰å‘å‡ºè¿‡çš„æ—§ Eventï¼Œå¦‚æœèƒ½çš„è¯åˆèƒ½æ”¶åˆ°å¤šå°‘ä¸ªã€‚</li></ul><p>ï¼ˆ3ï¼‰Subject å¸¸ç”¨çš„å‡ ä¸ªæ–¹æ³•ï¼š</p><ul><li>onNext(:)ï¼šæ˜¯ on(.next(:)) çš„ç®€ä¾¿å†™æ³•ã€‚è¯¥æ–¹æ³•ç›¸å½“äº subject æ¥æ”¶åˆ°ä¸€ä¸ª .next äº‹ä»¶ã€‚</li><li>onError(:)ï¼šæ˜¯ on(.error(:)) çš„ç®€ä¾¿å†™æ³•ã€‚è¯¥æ–¹æ³•ç›¸å½“äº subject æ¥æ”¶åˆ°ä¸€ä¸ª .error äº‹ä»¶ã€‚</li><li>onCompleted()ï¼šæ˜¯ on(.completed) çš„ç®€ä¾¿å†™æ³•ã€‚è¯¥æ–¹æ³•ç›¸å½“äº subject æ¥æ”¶åˆ°ä¸€ä¸ª .completed äº‹ä»¶ã€‚</li></ul><h3 id="PublishSubject"><a href="#PublishSubject" class="headerlink" title="PublishSubject"></a>PublishSubject</h3><p>ï¼ˆ1ï¼‰åŸºæœ¬ä»‹ç»</p><ul><li>PublishSubject æ˜¯æœ€æ™®é€šçš„ Subjectï¼Œå®ƒä¸éœ€è¦åˆå§‹å€¼å°±èƒ½åˆ›å»ºã€‚</li><li>PublishSubject çš„è®¢é˜…è€…ä»ä»–ä»¬å¼€å§‹è®¢é˜…çš„æ—¶é—´ç‚¹èµ·ï¼Œå¯ä»¥æ”¶åˆ°è®¢é˜…å Subject å‘å‡ºçš„æ–° Eventï¼Œè€Œä¸ä¼šæ”¶åˆ°ä»–ä»¬åœ¨è®¢é˜…å‰å·²å‘å‡ºçš„ Eventã€‚<br>ï¼ˆ2ï¼‰æ—¶åºå›¾</li><li>æœ€ä¸Šé¢ä¸€æ¡æ˜¯ BehaviorSubjectã€‚<br>-ä¸‹é¢ä¸¤æ¡åˆ†åˆ«è¡¨ç¤ºä¸¤ä¸ªæ–°çš„è®¢é˜…ï¼Œå®ƒä»¬è®¢é˜…çš„æ—¶é—´ç‚¹ä¸åŒï¼Œå¯ä»¥å‘ç° BehaviorSubject çš„è®¢é˜…è€…ä¸€å¼€å§‹å°±èƒ½æ”¶åˆ° BehaviorSubjects ä¹‹å‰å‘å‡ºçš„ä¸€ä¸ª Eventã€‚<br><img src="https://upload-images.jianshu.io/upload_images/3334769-516513ae6b34d5b2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ—¶åºå›¾"><br><br>ï¼ˆ3ï¼‰ä½¿ç”¨æ ·ä¾‹<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = DisposeBag()</span><br><span class="line"> </span><br><span class="line"><span class="comment">//åˆ›å»ºä¸€ä¸ªBehaviorSubject</span></span><br><span class="line"><span class="keyword">let</span> subject = BehaviorSubject(<span class="keyword">value</span>: <span class="string">"111"</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment">//ç¬¬1æ¬¡è®¢é˜…subject</span></span><br><span class="line">subject.subscribe &#123; <span class="keyword">event</span> <span class="keyword">in</span></span><br><span class="line">    print(<span class="string">"ç¬¬1æ¬¡è®¢é˜…ï¼š"</span>, <span class="keyword">event</span>)</span><br><span class="line">&#125;.disposed(<span class="keyword">by</span>: disposeBag)</span><br><span class="line"> </span><br><span class="line"><span class="comment">//å‘é€nextäº‹ä»¶</span></span><br><span class="line">subject.onNext(<span class="string">"222"</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment">//å‘é€erroräº‹ä»¶</span></span><br><span class="line">subject.onError(NSError(domain: <span class="string">"local"</span>, code: <span class="number">0</span>, userInfo: nil))</span><br><span class="line"> </span><br><span class="line"><span class="comment">//ç¬¬2æ¬¡è®¢é˜…subject</span></span><br><span class="line">subject.subscribe &#123; <span class="keyword">event</span> <span class="keyword">in</span></span><br><span class="line">    print(<span class="string">"ç¬¬2æ¬¡è®¢é˜…ï¼š"</span>, <span class="keyword">event</span>)</span><br><span class="line">&#125;.disposed(<span class="keyword">by</span>: disposeBag)</span><br></pre></td></tr></table></figure></li></ul><h3 id="ReplaySubject"><a href="#ReplaySubject" class="headerlink" title="ReplaySubject"></a>ReplaySubject</h3><p>ï¼ˆ1ï¼‰åŸºæœ¬ä»‹ç»</p><ul><li>ReplaySubject åœ¨åˆ›å»ºæ—¶å€™éœ€è¦è®¾ç½®ä¸€ä¸ª bufferSizeï¼Œè¡¨ç¤ºå®ƒå¯¹äºå®ƒå‘é€è¿‡çš„ event çš„ç¼“å­˜ä¸ªæ•°ã€‚</li><li>æ¯”å¦‚ä¸€ä¸ª ReplaySubject çš„ bufferSize è®¾ç½®ä¸º 2ï¼Œå®ƒå‘å‡ºäº† 3 ä¸ª .next çš„ eventï¼Œé‚£ä¹ˆå®ƒä¼šå°†åä¸¤ä¸ªï¼ˆæœ€è¿‘çš„ä¸¤ä¸ªï¼‰event ç»™ç¼“å­˜èµ·æ¥ã€‚æ­¤æ—¶å¦‚æœæœ‰ä¸€ä¸ª subscriber è®¢é˜…äº†è¿™ä¸ª ReplaySubjectï¼Œé‚£ä¹ˆè¿™ä¸ª subscriber å°±ä¼šç«‹å³æ”¶åˆ°å‰é¢ç¼“å­˜çš„ä¸¤ä¸ª .next çš„ eventã€‚</li><li>å¦‚æœä¸€ä¸ª subscriber è®¢é˜…å·²ç»ç»“æŸçš„ ReplaySubjectï¼Œé™¤äº†ä¼šæ”¶åˆ°ç¼“å­˜çš„ .next çš„ event å¤–ï¼Œè¿˜ä¼šæ”¶åˆ°é‚£ä¸ªç»ˆç»“çš„ .error æˆ–è€… .complete çš„ eventã€‚</li></ul><p>ï¼ˆ2ï¼‰æ—¶åºå›¾</p><ul><li>æœ€ä¸Šé¢ä¸€æ¡æ˜¯ ReplaySubjectï¼ˆbufferSize è®¾ä¸ºä¸º 2ï¼‰ã€‚</li><li>ä¸‹é¢ä¸¤æ¡åˆ†åˆ«è¡¨ç¤ºä¸¤ä¸ªæ–°çš„è®¢é˜…ï¼Œå®ƒä»¬è®¢é˜…çš„æ—¶é—´ç‚¹ä¸åŒã€‚å¯ä»¥å‘ç° ReplaySubject çš„è®¢é˜…è€…ä¸€å¼€å§‹å°±èƒ½æ”¶åˆ° ReplaySubject ä¹‹å‰å‘å‡ºçš„ä¸¤ä¸ª Eventï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚<br><img src="https://upload-images.jianshu.io/upload_images/3334769-4dec2ddcf714e9ac.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ—¶åºå›¾"><br><br>ï¼ˆ3ï¼‰ä½¿ç”¨æ ·ä¾‹<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> disposeBag = DisposeBag()</span><br><span class="line"> </span><br><span class="line"><span class="comment">//åˆ›å»ºä¸€ä¸ªbufferSizeä¸º2çš„ReplaySubject</span></span><br><span class="line"><span class="keyword">let</span> subject = ReplaySubject&lt;String&gt;.create(bufferSize: <span class="number">2</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment">//è¿ç»­å‘é€3ä¸ªnextäº‹ä»¶</span></span><br><span class="line">subject.onNext(<span class="string">"111"</span>)</span><br><span class="line">subject.onNext(<span class="string">"222"</span>)</span><br><span class="line">subject.onNext(<span class="string">"333"</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment">//ç¬¬1æ¬¡è®¢é˜…subject</span></span><br><span class="line">subject.subscribe &#123; <span class="keyword">event</span> <span class="keyword">in</span></span><br><span class="line">    print(<span class="string">"ç¬¬1æ¬¡è®¢é˜…ï¼š"</span>, <span class="keyword">event</span>)</span><br><span class="line">&#125;.disposed(<span class="keyword">by</span>: disposeBag)</span><br><span class="line"> </span><br><span class="line"><span class="comment">//å†å‘é€1ä¸ªnextäº‹ä»¶</span></span><br><span class="line">subject.onNext(<span class="string">"444"</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment">//ç¬¬2æ¬¡è®¢é˜…subject</span></span><br><span class="line">subject.subscribe &#123; <span class="keyword">event</span> <span class="keyword">in</span></span><br><span class="line">    print(<span class="string">"ç¬¬2æ¬¡è®¢é˜…ï¼š"</span>, <span class="keyword">event</span>)</span><br><span class="line">&#125;.disposed(<span class="keyword">by</span>: disposeBag)</span><br><span class="line"> </span><br><span class="line"><span class="comment">//è®©subjectç»“æŸ</span></span><br><span class="line">subject.onCompleted()</span><br><span class="line"> </span><br><span class="line"><span class="comment">//ç¬¬3æ¬¡è®¢é˜…subject</span></span><br><span class="line">subject.subscribe &#123; <span class="keyword">event</span> <span class="keyword">in</span></span><br><span class="line">    print(<span class="string">"ç¬¬3æ¬¡è®¢é˜…ï¼š"</span>, <span class="keyword">event</span>)</span><br><span class="line">&#125;.disposed(<span class="keyword">by</span>: disposeBag)</span><br></pre></td></tr></table></figure></li></ul><h3 id="Variable"><a href="#Variable" class="headerlink" title="Variable"></a>Variable</h3><p>ï¼ˆæ³¨æ„ï¼šç”±äº Variable åœ¨ä¹‹åç‰ˆæœ¬ä¸­å°†è¢«åºŸå¼ƒï¼Œå»ºè®®ä½¿ç”¨ Varible çš„åœ°æ–¹éƒ½æ”¹ç”¨ä¸‹é¢ä»‹ç»çš„ BehaviorRelay ä½œä¸ºæ›¿ä»£ã€‚ï¼‰<br><br>ï¼ˆ1ï¼‰åŸºæœ¬ä»‹ç»</p><ul><li>Variable å…¶å®å°±æ˜¯å¯¹ BehaviorSubject çš„å°è£…ï¼Œæ‰€ä»¥å®ƒä¹Ÿå¿…é¡»è¦é€šè¿‡ä¸€ä¸ªé»˜è®¤çš„åˆå§‹å€¼è¿›è¡Œåˆ›å»ºã€‚</li><li>Variable å…·æœ‰ BehaviorSubject çš„åŠŸèƒ½ï¼Œèƒ½å¤Ÿå‘å®ƒçš„è®¢é˜…è€…å‘å‡ºä¸Šä¸€ä¸ª event ä»¥åŠä¹‹åæ–°åˆ›å»ºçš„ eventã€‚</li><li>ä¸åŒçš„æ˜¯ï¼ŒVariable è¿˜æŠŠä¼šæŠŠå½“å‰å‘å‡ºçš„å€¼ä¿å­˜ä¸ºè‡ªå·±çš„çŠ¶æ€ã€‚åŒæ—¶å®ƒä¼šåœ¨é”€æ¯æ—¶è‡ªåŠ¨å‘é€ .complete çš„ eventï¼Œä¸éœ€è¦ä¹Ÿä¸èƒ½æ‰‹åŠ¨ç»™ Variables å‘é€ completed æˆ–è€… error äº‹ä»¶æ¥ç»“æŸå®ƒã€‚</li><li>ç®€å•åœ°è¯´å°±æ˜¯ Variable æœ‰ä¸€ä¸ª value å±æ€§ï¼Œæˆ‘ä»¬æ”¹å˜è¿™ä¸ª value å±æ€§çš„å€¼å°±ç›¸å½“äºè°ƒç”¨ä¸€èˆ¬ Subjects çš„ onNext() æ–¹æ³•ï¼Œè€Œè¿™ä¸ªæœ€æ–°çš„ onNext() çš„å€¼å°±è¢«ä¿å­˜åœ¨ value å±æ€§é‡Œäº†ï¼Œç›´åˆ°æˆ‘ä»¬å†æ¬¡ä¿®æ”¹å®ƒã€‚<blockquote><p>æ³¨æ„ï¼š<br><br>Variables æœ¬èº«æ²¡æœ‰ subscribe() æ–¹æ³•ï¼Œä½†æ˜¯æ‰€æœ‰ Subjects éƒ½æœ‰ä¸€ä¸ª asObservable() æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•è¿”å›è¿™ä¸ª Variable çš„ Observable ç±»å‹ï¼Œæ‹¿åˆ°è¿™ä¸ª Observable ç±»å‹æˆ‘ä»¬å°±èƒ½è®¢é˜…å®ƒäº†ã€‚</p></blockquote></li></ul><p>ï¼ˆ2ï¼‰ä½¿ç”¨æ ·ä¾‹<br><figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> RxSwift</span><br><span class="line"><span class="keyword">import</span> RxCocoa</span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> ViewController: UIViewController &#123;</span><br><span class="line">     </span><br><span class="line">    override func viewDidLoad() &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">let</span> disposeBag = DisposeBag()</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//åˆ›å»ºä¸€ä¸ªåˆå§‹å€¼ä¸º111çš„Variable</span></span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">variable</span> = Variable(<span class="string">"111"</span>)</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//ä¿®æ”¹valueå€¼</span></span><br><span class="line">        <span class="keyword">variable</span>.<span class="keyword">value</span> = <span class="string">"222"</span></span><br><span class="line">         </span><br><span class="line">        <span class="comment">//ç¬¬1æ¬¡è®¢é˜…</span></span><br><span class="line">        <span class="keyword">variable</span>.asObservable().subscribe &#123;</span><br><span class="line">            print(<span class="string">"ç¬¬1æ¬¡è®¢é˜…ï¼š"</span>, <span class="number">$0</span>)</span><br><span class="line">        &#125;.disposed(<span class="meta">by</span>: disposeBag)</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//ä¿®æ”¹valueå€¼</span></span><br><span class="line">        <span class="keyword">variable</span>.<span class="keyword">value</span> = <span class="string">"333"</span></span><br><span class="line">         </span><br><span class="line">        <span class="comment">//ç¬¬2æ¬¡è®¢é˜…</span></span><br><span class="line">        <span class="keyword">variable</span>.asObservable().subscribe &#123;</span><br><span class="line">            print(<span class="string">"ç¬¬2æ¬¡è®¢é˜…ï¼š"</span>, <span class="number">$0</span>)</span><br><span class="line">        &#125;.disposed(<span class="meta">by</span>: disposeBag)</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//ä¿®æ”¹valueå€¼</span></span><br><span class="line">        <span class="keyword">variable</span>.<span class="keyword">value</span> = <span class="string">"444"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="BehaviorRelay"><a href="#BehaviorRelay" class="headerlink" title="BehaviorRelay"></a>BehaviorRelay</h3><p>ï¼ˆ1ï¼‰åŸºæœ¬ä»‹ç»</p><ul><li>BehaviorRelay æ˜¯ä½œä¸º Variable çš„æ›¿ä»£è€…å‡ºç°çš„ã€‚å®ƒçš„æœ¬è´¨å…¶å®ä¹Ÿæ˜¯å¯¹ BehaviorSubject çš„å°è£…ï¼Œæ‰€ä»¥å®ƒä¹Ÿå¿…é¡»è¦é€šè¿‡ä¸€ä¸ªé»˜è®¤çš„åˆå§‹å€¼è¿›è¡Œåˆ›å»ºã€‚</li><li>BehaviorRelay å…·æœ‰ BehaviorSubject çš„åŠŸèƒ½ï¼Œèƒ½å¤Ÿå‘å®ƒçš„è®¢é˜…è€…å‘å‡ºä¸Šä¸€ä¸ª event ä»¥åŠä¹‹åæ–°åˆ›å»ºçš„ eventã€‚</li><li>ä¸ BehaviorSubject ä¸åŒçš„æ˜¯ï¼Œä¸éœ€è¦ä¹Ÿä¸èƒ½æ‰‹åŠ¨ç»™ BehaviorReply å‘é€ completed æˆ–è€… error äº‹ä»¶æ¥ç»“æŸå®ƒï¼ˆBehaviorRelay ä¼šåœ¨é”€æ¯æ—¶ä¹Ÿä¸ä¼šè‡ªåŠ¨å‘é€ .complete çš„ eventï¼‰ã€‚</li><li>BehaviorRelay æœ‰ä¸€ä¸ª value å±æ€§ï¼Œæˆ‘ä»¬é€šè¿‡è¿™ä¸ªå±æ€§å¯ä»¥è·å–æœ€æ–°å€¼ã€‚è€Œé€šè¿‡å®ƒçš„ accept() æ–¹æ³•å¯ä»¥å¯¹å€¼è¿›è¡Œä¿®æ”¹ã€‚</li></ul><p>ï¼ˆ2ï¼‰ä¸Šé¢çš„ Variable æ ·ä¾‹æˆ‘ä»¬å¯ä»¥æ”¹ç”¨æˆ BehaviorRelayï¼Œä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> RxSwift</span><br><span class="line"><span class="keyword">import</span> RxCocoa</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//åˆ›å»ºä¸€ä¸ªåˆå§‹å€¼ä¸º111çš„BehaviorRelay</span></span><br><span class="line">        <span class="keyword">let</span> subject = <span class="type">BehaviorRelay</span>&lt;<span class="type">String</span>&gt;(value: <span class="string">"111"</span>)</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//ä¿®æ”¹valueå€¼</span></span><br><span class="line">        subject.accept(<span class="string">"222"</span>)</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//ç¬¬1æ¬¡è®¢é˜…</span></span><br><span class="line">        subject.asObservable().subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"ç¬¬1æ¬¡è®¢é˜…ï¼š"</span>, $<span class="number">0</span>)</span><br><span class="line">            &#125;.disposed(by: disposeBag)</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//ä¿®æ”¹valueå€¼</span></span><br><span class="line">        subject.accept(<span class="string">"333"</span>)</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//ç¬¬2æ¬¡è®¢é˜…</span></span><br><span class="line">        subject.asObservable().subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"ç¬¬2æ¬¡è®¢é˜…ï¼š"</span>, $<span class="number">0</span>)</span><br><span class="line">            &#125;.disposed(by: disposeBag)</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//ä¿®æ”¹valueå€¼</span></span><br><span class="line">        subject.accept(<span class="string">"444"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ï¼ˆ3ï¼‰å¦‚æœæƒ³å°†æ–°å€¼åˆå¹¶åˆ°åŸå€¼ä¸Šï¼Œå¯ä»¥é€šè¿‡ accept() æ–¹æ³•ä¸ value å±æ€§é…åˆæ¥å®ç°ã€‚ï¼ˆè¿™ä¸ªå¸¸ç”¨åœ¨è¡¨æ ¼ä¸Šæ‹‰åŠ è½½åŠŸèƒ½ä¸Šï¼ŒBehaviorRelay ç”¨æ¥ä¿å­˜æ‰€æœ‰åŠ è½½åˆ°çš„æ•°æ®ï¼‰<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> RxSwift</span><br><span class="line"><span class="keyword">import</span> RxCocoa</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//åˆ›å»ºä¸€ä¸ªåˆå§‹å€¼ä¸ºåŒ…å«ä¸€ä¸ªå…ƒç´ çš„æ•°ç»„çš„BehaviorRelay</span></span><br><span class="line">        <span class="keyword">let</span> subject = <span class="type">BehaviorRelay</span>&lt;[<span class="type">String</span>]&gt;(value: [<span class="string">"1"</span>])</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//ä¿®æ”¹valueå€¼</span></span><br><span class="line">        subject.accept(subject.value + [<span class="string">"2"</span>, <span class="string">"3"</span>])</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//ç¬¬1æ¬¡è®¢é˜…</span></span><br><span class="line">        subject.asObservable().subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"ç¬¬1æ¬¡è®¢é˜…ï¼š"</span>, $<span class="number">0</span>)</span><br><span class="line">            &#125;.disposed(by: disposeBag)</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//ä¿®æ”¹valueå€¼</span></span><br><span class="line">        subject.accept(subject.value + [<span class="string">"4"</span>, <span class="string">"5"</span>])</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//ç¬¬2æ¬¡è®¢é˜…</span></span><br><span class="line">        subject.asObservable().subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"ç¬¬2æ¬¡è®¢é˜…ï¼š"</span>, $<span class="number">0</span>)</span><br><span class="line">            &#125;.disposed(by: disposeBag)</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//ä¿®æ”¹valueå€¼</span></span><br><span class="line">        subject.accept(subject.value + [<span class="string">"6"</span>, <span class="string">"7"</span>])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Observable-ä»‹ç»&quot;&gt;&lt;a href=&quot;#Observable-ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;Observable ä»‹ç»&quot;&gt;&lt;/a&gt;Observable ä»‹ç»&lt;/h1&gt;&lt;h2 id=&quot;Observable&quot;&gt;&lt;a href=&quot;
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>CALayerçš„å±æ€§å’Œä½¿ç”¨(æœªå®Œç»“)</title>
    <link href="https://wudan-ios.github.io/2018/11/23/CALayer%E7%9A%84%E5%B1%9E%E6%80%A7%E5%92%8C%E4%BD%BF%E7%94%A8(%E6%9C%AA%E5%AE%8C%E7%BB%93)/"/>
    <id>https://wudan-ios.github.io/2018/11/23/CALayerçš„å±æ€§å’Œä½¿ç”¨(æœªå®Œç»“)/</id>
    <published>2018-11-23T08:19:32.074Z</published>
    <updated>2018-11-23T08:24:37.392Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€CALayerçš„å¸¸ç”¨å±æ€§"><a href="#ä¸€ã€CALayerçš„å¸¸ç”¨å±æ€§" class="headerlink" title="ä¸€ã€CALayerçš„å¸¸ç”¨å±æ€§"></a>ä¸€ã€CALayerçš„å¸¸ç”¨å±æ€§</h2><blockquote><ul><li><p>1ã€@propertyCGPoint position;<br>å›¾å±‚ä¸­å¿ƒç‚¹çš„ä½ç½®ï¼Œç±»ä¼¼ä¸UIViewçš„centerï¼›ç”¨æ¥è®¾ç½®CALayeråœ¨çˆ¶å±‚ä¸­çš„ä½ç½®ï¼›ä»¥çˆ¶å±‚çš„å·¦ä¸Šè§’ä¸ºåŸç‚¹ï¼ˆ0ï¼Œ0ï¼‰</p></li><li><p>2ã€ @property CGPoint anchorPoint;<br>ç§°ã€å®šä½ç‚¹ã€ã€ã€é”šç‚¹ã€ï¼Œè¯¥æè¿°æ˜¯ç›¸å¯¹äºxã€yä½ç½®æ¯”ä¾‹è€Œè¨€çš„é»˜è®¤åœ¨å›¾åƒä¸­å¿ƒç‚¹ï¼ˆ0.5ã€0.5ï¼‰çš„ä½ç½®ï¼›å†³å®šç€CALayerèº«ä¸Šçš„å“ªä¸ªç‚¹ä¼šå†positionå±æ€§æ‰€æŒ‡çš„ä½ç½®ï¼Œä»¥è‡ªå·±çš„å·¦ä¸Šè§’ä¸ºåŸç‚¹ï¼ˆ0ï¼Œ0ï¼‰ï¼›å®ƒçš„xã€yå–å€¼èŒƒå›´éƒ½æ˜¯0~1</p></li><li><p>3ã€ @property(nullable) CGColorRef backgroundColor<br>å›¾å±‚èƒŒæ™¯é¢œè‰²</p></li><li><p>4ã€ @property(nullable) CGColorRef borderColor<br>å›¾å±‚è¾¹æ¡†é¢œè‰²</p></li><li><p>5ã€ @property CGFloat borderWidth<br>å›¾å±‚è¾¹æ¡†å®½åº¦</p></li><li><p>6ã€ @property CGRect bounds<br>å›¾å±‚å¤§å°</p></li><li><p>7ã€ @property(nullable, strong) id contents<br>å›¾å±‚æ˜¾ç¤ºå†…å®¹ï¼Œä¾‹å¦‚å¯ä»¥å°†å›¾ç‰‡ä½œä¸ºå›¾å±‚å†…å®¹æ˜¾ç¤º</p></li><li><p>8ã€ @property CGRect contentsRect<br>å›¾å±‚æ˜¾ç¤ºå†…å®¹çš„å¤§å°å’Œä½ç½®</p></li><li><p>9ã€ @property CGFloat cornerRadius<br>åœ†è§’åŠå¾„</p></li><li><p>10ã€ @property(getter=isDoubleSided) BOOL doubleSided<br>å›¾å±‚èƒŒæ™¯æ˜¯å¦æ˜¾ç¤ºï¼Œé»˜è®¤æ˜¯YES</p></li><li><p>11ã€ @property CGRect frame<br>å›¾å±‚å¤§å°å’Œä½ç½®ï¼Œä¸æ”¯æŒéšå¼åŠ¨ç”»ï¼Œæ‰€ä»¥CALyaerä¸­å¾ˆå°‘ä½¿ç”¨frameï¼Œé€šå¸¸ä½¿ç”¨boundå’Œpositionä»£æ›¿</p></li><li><p>12ã€ @property(getter=isHidden) BOOL hidden<br>æ˜¯å¦éšè—</p></li><li><p>13ã€ @property(nullable, strong) CALayer *mask<br>å›¾å±‚è’™ç‰ˆ</p></li><li><p>14ã€ @property BOOL masksToBounds<br>å­å›¾å±‚æ˜¯å¦å‰ªåˆ‡å›¾å±‚è¾¹ç•Œï¼Œé»˜è®¤æ˜¯NO</p></li><li><p>15ã€ @property float opacit;<br>å›¾å±‚é€æ˜åº¦ï¼Œç±»ä¼¼ä¸UIViewçš„alpha</p></li><li><p>16ã€ @property(nullable) CGColorRef shadowColor<br>é˜´å½±é¢œè‰²</p></li><li><p>17ã€ @property CGSize shadowOffset<br>é˜´å½±åç§»é‡</p></li><li><p>18ã€ @property float shadowOpacity<br>é˜´å½±é€æ˜åº¦ï¼Œæ³¨æ„é»˜è®¤ä¸º0ï¼Œå¦‚æœè®¾ç½®é˜´å½±å¿…é¡»è®¾ç½®æ­¤å±æ€§</p></li><li><p>19ã€ @property(nullable) CGPathRef shadowPath<br>é˜´å½±å½¢çŠ¶</p></li><li><p>20ã€ @property CGFloat shadowRadius<br>é˜´å½±æ¨¡ç³ŠåŠå¾„</p></li><li><p>21ã€ @property(nullable, copy) NSArray</p></li></ul></blockquote><h2 id="äºŒã€CALayerä¸å¸¸ç”¨å±æ€§"><a href="#äºŒã€CALayerä¸å¸¸ç”¨å±æ€§" class="headerlink" title="äºŒã€CALayerä¸å¸¸ç”¨å±æ€§"></a>äºŒã€CALayerä¸å¸¸ç”¨å±æ€§</h2><blockquote><ul><li><p>1ã€ @property CGFloat zPosition<br>å›¾å±‚ä¸­å¿ƒç‚¹åœ¨zè½´ä¸­çš„ä½ç½®</p></li><li><p>2ã€ @property CGFloat anchorPointZ<br>å›¾å±‚åœ¨zè½´ä¸­çš„é”šç‚¹ï¼›</p></li><li><p>3ã€ - (CGAffineTransform)affineTransform</p></li><li><p>4ã€- (void)setAffineTransform:(CGAffineTransform)m<br>ä»¥ä¸Šå±æ€§ä¸ºå›¾å±‚å½¢å˜ï¼›è¯¥å±æ€§å€¼æŒ‡å®šä¸€ä¸ªCGAffineTransformå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä»£è¡¨å¯¹CALayeræ‰§è¡ŒXã€Yä¸¤ä¸ªç»´åº¦ï¼ˆä¹Ÿå°±æ˜¯å¹³é¢ï¼‰ä¸Šçš„æ—‹è½¬ã€ç¼©æ”¾ã€ä½ç§»ã€æ–œåˆ‡ã€é•œåƒç­‰å˜æ¢çŸ©é˜µ</p></li><li><p>5ã€ @property(nullable, readonly) CALayer *superlayer<br>å›¾å±‚çš„çˆ¶å›¾å±‚</p></li></ul></blockquote><h2 id="ä¸‰ã€CALayerå›¾å±‚æ“ä½œ"><a href="#ä¸‰ã€CALayerå›¾å±‚æ“ä½œ" class="headerlink" title="ä¸‰ã€CALayerå›¾å±‚æ“ä½œ"></a>ä¸‰ã€CALayerå›¾å±‚æ“ä½œ</h2><blockquote><ul><li><p>1ã€ - (void)addSublayer:(CALayer *)layer<br>æ·»åŠ å­å›¾å±‚</p></li><li><p>2ã€ - (void)removeFromSuperlayer<br>å°†è‡ªå·±ä»çˆ¶å›¾å±‚ä¸­ç§»é™¤</p></li><li><p>3ã€ - (void)insertSublayer:(CALayer *)layer atIndex:(unsigned)idx<br>åœ¨è‡ªå·±å­å›¾å±‚æ•°ç»„ä¸­çš„ç¬¬idxä½ç½®æ·»åŠ å›¾å±‚</p></li><li><p>4ã€ - (void)insertSublayer:(CALayer )layer below:(nullable CALayer )sibling<br>å°†å›¾å±‚layeræ·»åŠ åœ¨å­å›¾å±‚siblingçš„ä¸‹é¢</p></li><li><p>5ã€ - (void)insertSublayer:(CALayer )layer above:(nullable CALayer )sibling<br>å°†å›¾å±‚layeræ·»åŠ åœ¨å­å›¾å±‚siblingçš„ä¸Šé¢</p></li><li><p>6ã€ - (void)replaceSublayer:(CALayer )layer with:(CALayer )layer2<br>å°†å›¾å±‚layeræ›¿æ¢layer2ï¼›</p></li></ul></blockquote><h2 id="å››ã€CALayeråŠ¨ç”»æ“ä½œ"><a href="#å››ã€CALayeråŠ¨ç”»æ“ä½œ" class="headerlink" title="å››ã€CALayeråŠ¨ç”»æ“ä½œ"></a>å››ã€CALayeråŠ¨ç”»æ“ä½œ</h2><blockquote><ul><li><p>1ã€ - (void)addAnimation:(CAAnimation )anim forKey:(nullable NSString )key<br>å›¾å±‚æ·»åŠ æŸä¸€å±æ€§çš„åŠ¨ç”»</p></li><li><p>2ã€ - (nullable NSArray&lt; NSString &gt; )animationKeys<br>è·å–æ‰€æœ‰åŠ¨ç”»çš„å±æ€§</p></li><li><p>3ã€ - (nullable CAAnimation )animationForKey:(NSString )key<br>è·å–æŸä¸€å±æ€§çš„åŠ¨ç”»</p></li><li><p>4ã€ - (void)removeAnimationForKey:(NSString *)key<br>ç§»é™¤æŸä¸€å±æ€§åŠ¨ç”»</p></li><li><p>5ã€ - (void)removeAllAnimations<br>ç§»é™¤æ‰€æœ‰åŠ¨ç”»</p></li></ul></blockquote><h2 id="äº”ã€CALayerå­ç±»å…¶ä»–è¯´æ˜"><a href="#äº”ã€CALayerå­ç±»å…¶ä»–è¯´æ˜" class="headerlink" title="äº”ã€CALayerå­ç±»å…¶ä»–è¯´æ˜"></a>äº”ã€CALayerå­ç±»å…¶ä»–è¯´æ˜</h2><table><thead><tr><th>å­ç±»åç§°</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td>CAEmitterLayer</td><td>å‘å°„å™¨å±‚ï¼Œç”¨æ¥æ§åˆ¶ç²’å­æ•ˆæœ</td></tr><tr><td>CAGradientLayer</td><td>æ¢¯åº¦å±‚ï¼Œé¢œè‰²æ¸å˜</td></tr><tr><td>CAEAGLayer</td><td>ç”¨OpenGL ESç»˜åˆ¶çš„å±‚</td></tr><tr><td>CAReplicationLayer</td><td>ç”¨æ¥è‡ªåŠ¨å¤åˆ¶sublayer</td></tr><tr><td>CAShapeLayer</td><td>ç»˜åˆ¶ç«‹ä½“çš„è´å¡å°”æ›²çº¿</td></tr><tr><td>CAScrollLayer</td><td>ç”¨æ¥ç®¡ç†å¯æ»‘åŠ¨çš„åŒºåŸŸ</td></tr><tr><td>CATextLayer</td><td>å¯ä»¥ç»˜åˆ¶AttributeString</td></tr><tr><td>CATiledLayer</td><td>ç”¨æ¥ç®¡ç†ä¸€å‰¯å¯ä»¥è¢«åˆ†å‰²çš„å¤§å›¾</td></tr><tr><td>CATransformLayer</td><td>ç”¨æ¥æ¸²æŸ“3D layerçš„å±‚æ¬¡ç»“æ„</td></tr></tbody></table><h3 id="1-CAShapeLayer"><a href="#1-CAShapeLayer" class="headerlink" title="1. CAShapeLayer"></a>1. CAShapeLayer</h3><p>CAShapeLayerå±äºQuartzCoreæ¡†æ¶ï¼Œç»§æ‰¿è‡ªCALayerã€‚CAShapeLayeræ˜¯åœ¨åæ ‡ç³»å†…ç»˜åˆ¶è´å¡å°”æ›²çº¿çš„ï¼Œé€šè¿‡ç»˜åˆ¶è´å¡å°”æ›²çº¿ï¼Œè®¾ç½®shape(å½¢çŠ¶)çš„path(è·¯å¾„)ï¼Œä»è€Œç»˜åˆ¶å„ç§å„æ ·çš„å›¾å½¢ä»¥åŠä¸è§„åˆ™å›¾å½¢ã€‚å› æ­¤ï¼Œä½¿ç”¨CAShapeLayeréœ€è¦ä¸UIBezierPathä¸€èµ·ä½¿ç”¨ã€‚<br>UIBezierPathç±»å…è®¸ä½ åœ¨è‡ªå®šä¹‰çš„ View ä¸­ç»˜åˆ¶å’Œæ¸²æŸ“ç”±ç›´çº¿å’Œæ›²çº¿ç»„æˆçš„è·¯å¾„.ã€‚ä½ å¯ä»¥åœ¨åˆå§‹åŒ–çš„æ—¶å€™ç›´æ¥ä¸ºä½ çš„UIBezierPathæŒ‡å®šä¸€ä¸ªå‡ ä½•å›¾å½¢ã€‚<br>é€šä¿—ç‚¹å°±æ˜¯UIBezierPathç”¨æ¥æŒ‡å®šç»˜åˆ¶å›¾å½¢è·¯å¾„ï¼Œè€ŒCAShapeLayerå°±æ˜¯æ ¹æ®è·¯å¾„æ¥ç»˜å›¾çš„ã€‚</p><h4 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h4><blockquote><ul><li><p>1ã€@property(nullable) CGPathRef path;  å‘ˆç°çš„å½¢çŠ¶çš„è·¯å¾„</p></li><li><p>2ã€@property(nullable) CGColorRef fillColor;å¡«å……è·¯å¾„çš„é¢œè‰²  </p></li><li><p>3ã€@property(copy) CAShapeLayerFillRule fillRule;   å½“åœ¨å¡«å……é¢œè‰²çš„æ—¶å€™åˆ™å°±éœ€è¦è¿™ç§å¡«å……è§„åˆ™ï¼Œå€¼æœ‰ä¸¤ç§ï¼Œéé›¶å’Œå¥‡å¶æ•°ï¼Œä½†é»˜è®¤æ˜¯éé›¶å€¼ã€‚</p></li><li><p>4ã€@property(nullable) CGColorRef strokeColor;è®¾ç½®æè¾¹è‰²ï¼Œé»˜è®¤æ— è‰²ã€‚</p></li><li><p>5ã€@property CGFloat strokeStart; ç»˜åˆ¶è¾¹çº¿è½®å»“è·¯å¾„çš„å­åŒºåŸŸã€‚è¯¥å€¼å¿…é¡»åœ¨[0,1]èŒƒå›´ï¼Œ0ä»£è¡¨è·¯å¾„çš„å¼€å§‹ï¼Œ1ä»£è¡¨è·¯å¾„çš„ç»“æŸã€‚ é»˜è®¤ä¸º0</p></li><li><p>6ã€@property CGFloat strokeEnd; é»˜è®¤ä¸º1</p></li><li><p>7ã€@property CGFloat lineWidth; çº¿çš„å®½åº¦ é»˜è®¤ä¸º1</p></li><li><p>8ã€@property CGFloat miterLimit;æœ€å¤§æ–œæ¥é•¿åº¦ã€‚æ–œæ¥é•¿åº¦æŒ‡çš„æ˜¯åœ¨ä¸¤æ¡çº¿äº¤æ±‡å¤„å’Œå¤–äº¤ä¹‹é—´çš„è·ç¦»ã€‚åªæœ‰lineJoinå±æ€§ä¸ºkCALineJoinMiteræ—¶miterLimitæ‰æœ‰æ•ˆã€‚è¾¹è§’çš„è§’åº¦è¶Šå°ï¼Œæ–œæ¥é•¿åº¦å°±ä¼šè¶Šå¤§ã€‚ä¸ºäº†é¿å…æ–œæ¥é•¿åº¦è¿‡é•¿ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨miterLimitå±æ€§ã€‚å¦‚æœæ–œæ¥é•¿åº¦è¶…è¿‡miterLimitçš„å€¼ï¼Œè¾¹è§’ä¼šä»¥lineJoinçš„â€œbevelâ€å³kCALineJoinBevelç±»å‹æ¥æ˜¾ç¤ºã€‚</p></li><li><p>9ã€@property(copy) CAShapeLayerLineCap lineCap; çº¿ç«¯ç‚¹ç±»å‹ï¼Œå€¼æœ‰ä¸‰ä¸ªç±»å‹ï¼Œåˆ†åˆ«ä¸ºkCALineCapButt ã€kCALineCapRound ã€kCALineCapSquareï¼Œé»˜è®¤å€¼ä¸ºButtï¼›</p></li><li><p>10ã€@property(copy) CAShapeLayerLineJoin lineJoin;lineJoinä¸ºçº¿è¿æ¥ç±»å‹ï¼Œå…¶å€¼ä¹Ÿæœ‰ä¸‰ä¸ªç±»å‹ï¼Œåˆ†åˆ«ä¸ºkCALineJoinMiterã€kCALineJoinRoundã€kCALineJoinBevelï¼Œé»˜è®¤å€¼æ˜¯Miterã€‚</p></li><li><p>11ã€@property CGFloat lineDashPhase;ä¸ºçº¿å‹æ¨¡ç‰ˆçš„èµ·å§‹ä½ç½®ï¼›lineDashPatternä¸ºçº¿æ€§æ¨¡ç‰ˆï¼Œè¿™æ˜¯ä¸€ä¸ªNSNumberçš„æ•°ç»„ï¼Œç´¢å¼•ä»1å¼€å§‹è®°ï¼Œå¥‡æ•°ä½æ•°å€¼è¡¨ç¤ºå®çº¿é•¿åº¦ï¼Œå¶æ•°ä½æ•°å€¼è¡¨ç¤ºç©ºç™½é•¿åº¦ã€‚<br>æ³¨ï¼šfillColorä¸strokeColoréƒ½æ˜¯åœ¨æœ‰UIBezierPathå‚æ•°é…ç½®çš„æƒ…å†µä¸‹æ‰èƒ½å‘ç”Ÿä½œç”¨</p></li><li><p>12ã€@property(nullable, copy) NSArray<nsnumber *=""> *lineDashPattern;</nsnumber></p></li></ul></blockquote><h3 id="2-CAReplicationLayer"><a href="#2-CAReplicationLayer" class="headerlink" title="2.CAReplicationLayer"></a>2.CAReplicationLayer</h3><h4 id="å±æ€§-1"><a href="#å±æ€§-1" class="headerlink" title="å±æ€§"></a>å±æ€§</h4><blockquote><ul><li><p>1ã€@property NSInteger instanceCount;  å¤åˆ¶subLayerä¸ªæ•°ï¼Œé»˜è®¤ä¸º1</p></li><li><p>2ã€@property BOOL preservesDepth; æ˜¯å¦å°†3Dä¾‹å­ç³»ç»Ÿå¹³é¢åŒ–åˆ°ä¸€ä¸ªå›¾å±‚ï¼ˆé»˜è®¤å€¼ï¼‰æˆ–è€…å¯ä»¥åœ¨3Dç©ºé—´ä¸­æ··åˆå…¶ä»–çš„å›¾å±‚</p></li><li><p>3ã€@property CFTimeInterval instanceDelay; è®¾ç½®å¤åˆ¶å­å±‚çš„å»¶è¿ŸåŠ¨ç”»æ—¶é•¿</p></li><li><p>4ã€@property CATransform3D instanceTransform; è®¾ç½®å¤åˆ¶å­å±‚çš„ç›¸å¯¹ä½ç½®</p></li><li><p>5ã€@property(nullable) CGColorRef instanceColor; å­å±‚é¢œè‰²ï¼Œä¼šå’ŒåŸç”Ÿå­å±‚èƒŒæ™¯è‰²å†²çªï¼Œå› æ­¤äºŒè€…é€‰å…¶ä¸€è®¾ç½®</p></li><li><p>6ã€@property float instanceRedOffset;<br>è®¾ç½®æ¯ä¸ªå¤åˆ¶å›¾å±‚ç›¸å¯¹ä¸Šä¸€ä¸ªå¤åˆ¶å›¾å±‚çš„çº¢è‰²åç§»é‡</p></li><li>7ã€@property float instanceRedOffset;<br>è®¾ç½®æ¯ä¸ªå¤åˆ¶å›¾å±‚ç›¸å¯¹ä¸Šä¸€ä¸ªå¤åˆ¶å›¾å±‚çš„ç»¿è‰²åç§»é‡</li><li><p>8ã€@property float instanceBlueOffset;è®¾ç½®æ¯ä¸ªå¤åˆ¶å›¾å±‚ç›¸å¯¹ä¸Šä¸€ä¸ªå¤åˆ¶å›¾å±‚çš„è“è‰²åç§»é‡</p></li><li><p>9ã€@property float instanceAlphaOffset;è®¾ç½®æ¯ä¸ªå¤åˆ¶å›¾å±‚ç›¸å¯¹ä¸Šä¸€ä¸ªå¤åˆ¶å›¾å±‚çš„é€æ˜åº¦åç§»é‡</p></li></ul></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;ä¸€ã€CALayerçš„å¸¸ç”¨å±æ€§&quot;&gt;&lt;a href=&quot;#ä¸€ã€CALayerçš„å¸¸ç”¨å±æ€§&quot; class=&quot;headerlink&quot; title=&quot;ä¸€ã€CALayerçš„å¸¸ç”¨å±æ€§&quot;&gt;&lt;/a&gt;ä¸€ã€CALayerçš„å¸¸ç”¨å±æ€§&lt;/h2&gt;&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;
      
    
    </summary>
    
    
  </entry>
  
</feed>
