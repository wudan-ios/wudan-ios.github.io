<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Flutter-GridView(UICollectionView)]]></title>
    <url>%2F2019%2F04%2F26%2FFlutter-GridView(UICollectionView)%2F</url>
    <content type="text"><![CDATA[ListViewåˆ—è¡¨è§†å›¾ï¼Œç±»ä¼¼iOSä¸­çš„UITableViewï¼Œä½¿ç”¨æ›´åŠ æ–¹ä¾¿å’Œä¸ªæ€§åŒ–ï¼Œé‡Œé¢childrenè§†å›¾å¯ä»¥æ˜¯ä»»æ„çš„Widgeã€‚1234567891011121314151617181920212223242526272829303132333435363738void main() =&gt; runApp(WudanTableViewPage());class WudanTableViewPage extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return MaterialApp( title: 'Class Name', home: Scaffold( appBar: AppBar(title: Text('UITableView')), body: Center( child: ListView( scrollDirection: Axis.vertical, // æ»šåŠ¨æ–¹å‘ children: &lt;Widget&gt;[ new ListTile( title: Text("æ ‡é¢˜"), subtitle: Text("å‰¯æ ‡é¢˜"), leading: Icon(Icons.add_box),// å·¦è¾¹Widge trailing: Icon(Icons.airline_seat_flat), // å³è¾¹Widge isThreeLine: true, // æ˜¯å¦é»˜è®¤3è¡Œé«˜åº¦ï¼Œsubtitleä¸ä¸ºç©ºæ—¶æ‰èƒ½ä½¿ç”¨ dense: false, // è®¾ç½®ä¸ºtrueåŽå­—ä½“å˜å° selected: false, // å±•ç¤ºæ˜¯å¦é»˜è®¤æ˜¾ç¤ºé€‰ä¸­ ), new Image.network( "https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1554110093883&amp;di=9db9b92f1e6ee0396b574a093cc987d6&amp;imgtype=0&amp;src=http%3A%2F%2Fn.sinaimg.cn%2Fsinacn20%2F151%2Fw2048h1303%2F20180429%2F37c0-fzvpatr1915813.jpg", height: 60, fit: BoxFit.fitWidth, ), new Container( margin: EdgeInsets.all(10), color: Colors.orange, height: 100, ) ], ), ), ), ); &#125;&#125; å±žæ€§ä»‹ç» paddingï¼šå†…è¾¹è· scrollDirectionï¼šæ»šåŠ¨æ–¹å‘]]></content>
  </entry>
  <entry>
    <title><![CDATA[Flutter-ListView(UITableView)]]></title>
    <url>%2F2019%2F04%2F26%2FFlutter-ListView(UITableView)%2F</url>
    <content type="text"><![CDATA[ListViewåˆ—è¡¨è§†å›¾ï¼Œç±»ä¼¼iOSä¸­çš„UITableViewï¼Œä½¿ç”¨æ›´åŠ æ–¹ä¾¿å’Œä¸ªæ€§åŒ–ï¼Œé‡Œé¢childrenè§†å›¾å¯ä»¥æ˜¯ä»»æ„çš„Widgeã€‚1234567891011121314151617181920212223242526272829303132333435363738void main() =&gt; runApp(WudanTableViewPage());class WudanTableViewPage extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return MaterialApp( title: 'Class Name', home: Scaffold( appBar: AppBar(title: Text('UITableView')), body: Center( child: ListView( scrollDirection: Axis.vertical, // æ»šåŠ¨æ–¹å‘ children: &lt;Widget&gt;[ new ListTile( title: Text("æ ‡é¢˜"), subtitle: Text("å‰¯æ ‡é¢˜"), leading: Icon(Icons.add_box),// å·¦è¾¹Widge trailing: Icon(Icons.airline_seat_flat), // å³è¾¹Widge isThreeLine: true, // æ˜¯å¦é»˜è®¤3è¡Œé«˜åº¦ï¼Œsubtitleä¸ä¸ºç©ºæ—¶æ‰èƒ½ä½¿ç”¨ dense: false, // è®¾ç½®ä¸ºtrueåŽå­—ä½“å˜å° selected: false, // å±•ç¤ºæ˜¯å¦é»˜è®¤æ˜¾ç¤ºé€‰ä¸­ ), new Image.network( "https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1554110093883&amp;di=9db9b92f1e6ee0396b574a093cc987d6&amp;imgtype=0&amp;src=http%3A%2F%2Fn.sinaimg.cn%2Fsinacn20%2F151%2Fw2048h1303%2F20180429%2F37c0-fzvpatr1915813.jpg", height: 60, fit: BoxFit.fitWidth, ), new Container( margin: EdgeInsets.all(10), color: Colors.orange, height: 100, ) ], ), ), ), ); &#125;&#125; å±žæ€§ä»‹ç» paddingï¼šå†…è¾¹è· scrollDirectionï¼šæ»šåŠ¨æ–¹å‘]]></content>
  </entry>
  <entry>
    <title><![CDATA[Flutter-Image(UIImageView)]]></title>
    <url>%2F2019%2F04%2F26%2FFlutter-Image(UIImageView)%2F</url>
    <content type="text"><![CDATA[Imageå°±æ˜¯ç›¸å¯¹äºŽiOSå¼€å‘ä¸­çš„UIImageViewï¼ŒæŠŠä¸ŽUIImageViewè®¾ç½®å·®åˆ«å¾ˆå¤§çš„ç‚¹æ‹Žå‡ºæ¥è¯´æ˜Žä¸€ä¸‹ã€‚123456789101112131415161718void main() =&gt; runApp(WudanImageViewPage());class WudanImageViewPage extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return MaterialApp( title: 'Class Name', home: Scaffold( appBar: AppBar(title: Text('UIImageView')), body: Center( child: Image.network( "https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1554110093883&amp;di=9db9b92f1e6ee0396b574a093cc987d6&amp;imgtype=0&amp;src=http%3A%2F%2Fn.sinaimg.cn%2Fsinacn20%2F151%2Fw2048h1303%2F20180429%2F37c0-fzvpatr1915813.jpg", fit: BoxFit.cover, ), ), ), ); &#125;&#125; åŠ è½½æ–¹å¼ Image.assetï¼šåŠ è½½èµ„æºå›¾ç‰‡ï¼Œå°±æ˜¯åŠ è½½é¡¹ç›®èµ„æºç›®å½•ä¸­çš„å›¾ç‰‡,åŠ å…¥å›¾ç‰‡åŽä¼šå¢žå¤§æ‰“åŒ…çš„åŒ…ä½“ä½“ç§¯ï¼Œç”¨çš„æ˜¯ç›¸å¯¹è·¯å¾„ã€‚ Image.networkï¼šç½‘ç»œèµ„æºå›¾ç‰‡ Image.fileï¼šåŠ è½½æœ¬åœ°å›¾ç‰‡ï¼Œå°±æ˜¯åŠ è½½æœ¬åœ°æ–‡ä»¶ä¸­çš„å›¾ç‰‡ï¼Œè¿™ä¸ªæ˜¯ä¸€ä¸ªç»å¯¹è·¯å¾„ï¼Œè·ŸåŒ…ä½“æ— å…³ã€‚ Image.memoryï¼šåŠ è½½Uint8Listèµ„æºå›¾ç‰‡fitå±žæ€§çš„è®¾ç½® BoxFit.fill:å…¨å›¾æ˜¾ç¤ºï¼Œå›¾ç‰‡ä¼šè¢«æ‹‰ä¼¸ï¼Œå¹¶å……æ»¡çˆ¶å®¹å™¨ã€‚ BoxFit.contain:å…¨å›¾æ˜¾ç¤ºï¼Œæ˜¾ç¤ºåŽŸæ¯”ä¾‹ï¼Œå¯èƒ½ä¼šæœ‰ç©ºéš™ã€‚BoxFit.coverï¼šæ˜¾ç¤ºå¯èƒ½æ‹‰ä¼¸ï¼Œå¯èƒ½è£åˆ‡ï¼Œå……æ»¡ï¼ˆå›¾ç‰‡è¦å……æ»¡æ•´ä¸ªå®¹å™¨ï¼Œè¿˜ä¸å˜å½¢ï¼‰ã€‚ BoxFit.fitWidthï¼šå®½åº¦å……æ»¡ï¼ˆæ¨ªå‘å……æ»¡ï¼‰ï¼Œæ˜¾ç¤ºå¯èƒ½æ‹‰ä¼¸ï¼Œå¯èƒ½è£åˆ‡ã€‚ BoxFit.fitHeight ï¼šé«˜åº¦å……æ»¡ï¼ˆç«–å‘å……æ»¡ï¼‰,æ˜¾ç¤ºå¯èƒ½æ‹‰ä¼¸ï¼Œå¯èƒ½è£åˆ‡ã€‚ BoxFit.scaleDownï¼šæ•ˆæžœå’Œcontainå·®ä¸å¤šï¼Œä½†æ˜¯æ­¤å±žæ€§ä¸å…è®¸æ˜¾ç¤ºè¶…è¿‡æºå›¾ç‰‡å¤§å°ï¼Œå¯å°ä¸å¯å¤§ã€‚å›¾ç‰‡çš„æ··åˆæ¨¡å¼å›¾ç‰‡æ··åˆæ¨¡å¼ï¼ˆcolorBlendModeï¼‰å’Œcolorå±žæ€§é…åˆä½¿ç”¨ï¼Œèƒ½è®©å›¾ç‰‡æ”¹å˜é¢œè‰²ï¼Œé‡Œè¾¹çš„æ¨¡å¼éžå¸¸çš„å¤šï¼Œäº§ç”Ÿçš„æ•ˆæžœä¹Ÿæ˜¯éžå¸¸ä¸°å¯Œçš„ã€‚12345child: Image.network( 'https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1554110093883&amp;di=9db9b92f1e6ee0396b574a093cc987d6&amp;imgtype=0&amp;src=http%3A%2F%2Fn.sinaimg.cn%2Fsinacn20%2F151%2Fw2048h1303%2F20180429%2F37c0-fzvpatr1915813.jpg', color: Colors.greenAccent, colorBlendMode: BlendMode.darken,),]]></content>
  </entry>
  <entry>
    <title><![CDATA[Flutter-Container(UIView)]]></title>
    <url>%2F2019%2F04%2F26%2FFlutter-Container(UIView)%2F</url>
    <content type="text"><![CDATA[Containerå°±æ˜¯ç›¸å¯¹äºŽiOSå¼€å‘ä¸­çš„UIViewï¼ŒæŠŠä¸ŽUIViewè®¾ç½®å·®åˆ«å¾ˆå¤§çš„ç‚¹æ‹Žå‡ºæ¥è¯´æ˜Žä¸€ä¸‹ã€‚1234567891011121314151617181920212223void main() =&gt; runApp(WudanViewPage());class WudanViewPage extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return MaterialApp( title: 'Class Name', home: Scaffold( appBar: AppBar(title: Text('UIView')), body: Center( child: Container( height: 300, color: Colors.red, padding: EdgeInsets.fromLTRB(10, 30, 30, 10), // å†…è¾¹è· margin: EdgeInsets.fromLTRB(5, 5, 5, 5), // å¤–è¾¹è· child: Container( color: Colors.orange, ), ), ), ), ); &#125;&#125; æ·»åŠ å­è§†å›¾ä½¿ç”¨childï¼Œåœ¨å…¶å†…éƒ¨è®¾ç½®å­è§†å›¾æ ·å¼ ç›’å­æ¨¡åž‹ fromLTRB æ˜¯(Left, Top, Right, Bottom) paddingå†…è¾¹è· marginå¤–è¾¹è·]]></content>
  </entry>
  <entry>
    <title><![CDATA[Flutter-Text(UILabel)]]></title>
    <url>%2F2019%2F04%2F26%2FFlutter-Text(UILabel)%2F</url>
    <content type="text"><![CDATA[Textå°±æ˜¯ç›¸å¯¹äºŽiOSå¼€å‘ä¸­çš„UILabelï¼ŒæŠŠä¸ŽUILabelè®¾ç½®å·®åˆ«å¾ˆå¤§çš„ç‚¹æ‹Žå‡ºæ¥è¯´æ˜Žä¸€ä¸‹ã€‚1234567891011121314151617181920212223242526void main() =&gt; runApp(WudanUILabel());class WudanUILabel extends StatelessWidget &#123; @override Widget build(BuildContext context) &#123; return MaterialApp( title: 'Class Name', home: Scaffold( appBar: AppBar(title: Text('UILabel')), body: Center( child: Text( "Flutteræ˜¯è°·æ­Œçš„ç§»åŠ¨UIæ¡†æž¶ï¼Œå¯ä»¥å¿«é€Ÿåœ¨iOSå’ŒAndroidä¸Šæž„å»ºé«˜è´¨é‡çš„åŽŸç”Ÿç”¨æˆ·ç•Œé¢ã€‚ Flutterå¯ä»¥ä¸ŽçŽ°æœ‰çš„ä»£ç ä¸€èµ·å·¥ä½œã€‚åœ¨å…¨ä¸–ç•Œï¼ŒFlutteræ­£åœ¨è¢«è¶Šæ¥è¶Šå¤šçš„å¼€å‘è€…å’Œç»„ç»‡ä½¿ç”¨ï¼Œå¹¶ä¸”Flutteræ˜¯å®Œå…¨å…è´¹ã€å¼€æºçš„ã€‚", // å†…å®¹ maxLines: 2, // æœ€å¤§æ˜¾ç¤ºè¡Œæ•°ï¼Œé»˜è®¤ä¸ºæœ€å¤§ textAlign: TextAlign.left, // å¯¹é½æ–¹å¼ overflow: TextOverflow.ellipsis, // æ–‡å­—æ˜¾ç¤ºä¸å…¨æ ·å¼ style: TextStyle( // å­—ä½“æ ·å¼ color: Colors.pink, // é¢œè‰² fontSize: 18, // å¤§å° decoration: TextDecoration.underline, // åˆ’çº¿ä½ç½® decorationStyle: TextDecorationStyle.solid // åˆ’çº¿æ ·å¼ ), ), ), ), ); &#125;&#125; overflowå±žæ€§ç±»ä¼¼ä¸ŽUILabelä¸­çš„lineBreakMode clipï¼šç›´æŽ¥åˆ‡æ–­ï¼Œå‰©ä¸‹çš„æ–‡å­—å°±æ²¡æœ‰äº†ï¼Œæ„Ÿè§‰ä¸å¤ªå‹å¥½ï¼Œä½“éªŒæ€§ä¸å¥½ã€‚ ellipsis: åœ¨åŽè¾¹æ˜¾ç¤ºçœç•¥å·ï¼Œä½“éªŒæ€§è¾ƒå¥½ï¼Œè¿™ä¸ªåœ¨å·¥ä½œä¸­ç»å¸¸ä½¿ç”¨ã€‚ fade: æº¢å‡ºçš„éƒ¨åˆ†ä¼šè¿›è¡Œä¸€ä¸ªæ¸å˜æ¶ˆå¤±çš„æ•ˆæžœï¼Œå½“ç„¶æ˜¯ä¸Šçº¿çš„æ¸å˜ã€‚decorationç±»ä¼¼äºŽNSAttributedStringåˆ¶ä½œçš„åˆ’çº¿ noneï¼šé»˜è®¤æ ·å¼ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰ underlineï¼šä¸‹åˆ’çº¿ lineThroughï¼šç©¿è¿‡æ–‡å­—ä¸­é—´ overlineï¼šæ–‡å­—é¡¶éƒ¨ decorationStyleåˆ’çº¿çš„æ ·å¼ solidï¼šå®žçº¿ doubleï¼šåŒçº¿ dashedï¼šè™šçº¿(å¤§ç‚¹) dottedï¼šè™šçº¿(å°ç‚¹) wavyï¼šæ³¢æµªçº¿]]></content>
  </entry>
  <entry>
    <title><![CDATA[iOSè‡ªå®šä¹‰æŽ§ä»¶ï¼šå›¾ç‰‡æµè§ˆå™¨]]></title>
    <url>%2F2019%2F04%2F19%2FiOS%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%A7%E4%BB%B6%EF%BC%9A%E5%9B%BE%E7%89%87%E6%B5%8F%E8%A7%88%E5%99%A8%2F</url>
    <content type="text"><![CDATA[ä¸€ç›´æƒ³å†™ä¸€ä¸ªè‡ªå·±çš„å›¾ç‰‡æµè§ˆå™¨ï¼Œä½†æ˜¯è‡ªå·±èƒ½åŠ›åˆä¸æ˜¯å¾ˆå¤Ÿï¼Œæ‰€ä»¥ä¸€ç›´æ‹–è¿™ï¼Œæœ€è¿‘è¶è‡ªå·±æ—¶é—´å……è£•ï¼Œè‡ªå·±ç ”ç©¶äº†ä¸€ä¸‹è¿™æ–¹é¢çš„çŸ¥è¯†ã€‚æ„Ÿè§‰æœ‰ä»¥ä¸‹å‡ ä¸ªéš¾ç‚¹ï¼š æ˜¾ç¤ºå’Œæ¶ˆå¤±çš„è½¬åœºåŠ¨ç”» æ‰‹åŠ¿æ‹–æ‹½ å›¾ç‰‡åŠ è½½ åŠ è½½æ–¹å¼å’Œè½¬åœºåŠ¨ç”» é€šè¿‡ControlleråŠ è½½ï¼šéœ€è¦ä½¿ç”¨ViewControllerå®žçŽ°UIViewControllerAnimatedTransitioningå®žçŽ°è½¬åœºæ•ˆæžœ é€šè¿‡ViewåŠ è½½ï¼šä½¿ç”¨UIViewåŠ¨ç”»è¯•ä¸‹è½¬åœºæ•ˆæžœ è½¬åœºåŠ¨ç”»å¿…è¦å…ƒç´  æ˜¾ç¤ºæ—¶éœ€è¦fromViewçš„frame æ¶ˆå¤±æ—¶éœ€è¦toViewçš„frameæ˜¾ç¤ºé€šè¿‡ä¿®æ”¹å½“å‰éœ€è¦æ˜¾ç¤ºå›¾ç‰‡çš„CollectionViewCellä¸­ImageViewçš„frameï¼ŒåŒæ—¶ä¿®æ”¹å½“æœŸViewçš„èƒŒæ™¯é¢œè‰²é€æ˜Žåº¦1234567WDImageCollectionViewCell *cell = (WDImageCollectionViewCell *)[self.collectionView cellForItemAtIndexPath:[NSIndexPath indexPathForRow:self.tappedIndex inSection:0]];CGRect fromFrame = [self.originView convertRect:self.originView.bounds toView:cell.contentView];cell.imageView.frame = fromFrame;[UIView animateWithDuration:0.5 animations:^&#123; self.backgroundColor = [[UIColor alloc] initWithWhite:0 alpha:1]; cell.imageView.frame = cell.contentView.bounds;&#125;]; æ¶ˆå¤±åŽŸç†ä¸Žæ˜¾ç¤ºç›¸åŒ12345678CGRect toRect = [self.originView convertRect:self.originView.bounds toView:self.window];[UIView animateWithDuration:0.5 animations:^&#123; cell.imageView.clipsToBounds = YES; cell.imageView.frame = toRect; self.backgroundColor = [[UIColor alloc] initWithWhite:0 alpha:0];&#125; completion:^(BOOL finished) &#123; [self removeFromSuperview];&#125;]; æ‹–æ‹½çš„æ‰‹åŠ¿å°†æ‰‹åŠ¿æ·»åŠ åœ¨CollectionViewCellä¸­ScrollViewä¸Šï¼Œå¹¶éµå¾ªUIGestureRecognizerDelegateåè®®ï¼Œä¸ç„¶ä¼šCollectionViewæ— æ³•è¿›è¡Œæ»šåŠ¨æ“ä½œã€‚ å£°æ˜Žä¸€ä¸ªå…¨å±€å±žæ€§ 1CGPoint firstTouchPoint; å®žçŽ°ä»£ç† 12345678910111213141516171819#pragma mark - UIGestureRecognizer Delegate Method- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch &#123; firstTouchPoint = [touch locationInView:self.window]; return YES;&#125;- (BOOL)gestureRecognizerShouldBegin:(UIGestureRecognizer *)gestureRecognizer &#123; CGPoint touchPoint = [gestureRecognizer locationInView:self.window]; CGFloat dirTop = firstTouchPoint.y - touchPoint.y; if (dirTop &gt; -10 &amp;&amp; dirTop &lt; 10) &#123; return NO; &#125; CGFloat dirLift = firstTouchPoint.x - touchPoint.x; if (dirLift &gt; -10 &amp;&amp; dirLift &lt; 10 &amp;&amp; self.scrollView.frame.size.height &gt; [[UIScreen mainScreen] bounds].size.height) &#123; return NO; &#125; return YES;&#125;``` æ‹–åŠ¨æ‰‹åŠ¿æ“ä½œï¼ŒåŒæ„ä»£ç†ä¼ ç»™View åè®®æ–¹æ³• 1234567```@class WDImageCollectionViewCell;@protocol WDImageCollectionViewCellDelegate &lt;NSObject&gt;- (void)collectionViewCell:(WDImageCollectionViewCell *)cell singleTapActionWithImageUrl:(NSString *)imageUrl;- (void)collectionViewCell:(WDImageCollectionViewCell *)cell panActionWithPercent:(CGFloat)percent;- (void)collectionViewCell:(WDImageCollectionViewCell *)cell dimssViewWithImageUrl:(NSString *)imageUrl;@end æ‹–åŠ¨æ‰‹åŠ¿æ–¹æ³• 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758#pragma mark - UIGestureRecognizer Target Event/** æ»‘åŠ¨æ‰‹åŠ¿ */- (void)didRecognizedPanGuesture:(UIPanGestureRecognizer *)pan &#123; CGPoint point = [pan translationInView:self.window]; CGFloat scale = 1.0 - ABS(point.y) / [[UIScreen mainScreen] bounds].size.height; switch (pan.state) &#123; case UIGestureRecognizerStateBegan: &#123;&#125; break; case UIGestureRecognizerStateChanged: &#123; scale = MAX(scale, 0); CGFloat s = MAX(scale, 0.5); CGAffineTransform translation = CGAffineTransformMakeTranslation(point.x / s, point.y / s); CGAffineTransform translationScale = CGAffineTransformMakeScale(s, s); self.imageView.transform = CGAffineTransformConcat(translation, translationScale); // ä¼ å‡ºtranslationScaleï¼Œä¿®æ”¹èƒŒæ™¯é¢œè‰²é€æ˜Žåº¦ if (self.delegate &amp;&amp; [self.delegate respondsToSelector:@selector(collectionViewCell:panActionWithPercent:)]) &#123; [self.delegate collectionViewCell:self panActionWithPercent:scale]; &#125; &#125; break; case UIGestureRecognizerStateCancelled | UIGestureRecognizerStateFailed: &#123; self.imageView.transform = CGAffineTransformIdentity; // å›žå¤åˆå§‹æ ·å¼ï¼Œä¼ å‡ºtranslationScaleï¼Œä¿®æ”¹èƒŒæ™¯é¢œè‰²é€æ˜Žåº¦ if (self.delegate &amp;&amp; [self.delegate respondsToSelector:@selector(collectionViewCell:panActionWithPercent:)]) &#123; [self.delegate collectionViewCell:self panActionWithPercent:1]; &#125; &#125; break; case UIGestureRecognizerStateEnded: &#123; [UIView animateWithDuration:0.5 animations:^&#123; CGAffineTransform transform1 = CGAffineTransformMakeTranslation(0,0); self.imageView.transform = CGAffineTransformScale(transform1, 1, 1); &#125;]; // å›žå¤åˆå§‹æ ·å¼ï¼Œä¼ å‡ºtranslationScaleï¼Œä¿®æ”¹èƒŒæ™¯é¢œè‰²é€æ˜Žåº¦ if (self.delegate &amp;&amp; [self.delegate respondsToSelector:@selector(collectionViewCell:panActionWithPercent:)]) &#123; [self.delegate collectionViewCell:self panActionWithPercent:scale]; &#125; if (scale &lt; 0.7) &#123; // æ‹–åŠ¨ç»“æŸï¼Œè®©é¡µé¢æ¶ˆå¤± if (self.delegate &amp;&amp; [self.delegate respondsToSelector:@selector(collectionViewCell:dimssViewWithImageUrl:)]) &#123; [self.delegate collectionViewCell:self dimssViewWithImageUrl:self.imageUrl]; &#125; &#125; else &#123; // å›žå¤åˆå§‹æ ·å¼ï¼Œä¼ å‡ºtranslationScaleï¼Œä¿®æ”¹èƒŒæ™¯é¢œè‰²é€æ˜Žåº¦ if (self.delegate &amp;&amp; [self.delegate respondsToSelector:@selector(collectionViewCell:panActionWithPercent:)]) &#123; [self.delegate collectionViewCell:self panActionWithPercent:1]; &#125; &#125; &#125; break; default: break; &#125;&#125; å›¾ç‰‡åŠ è½½ä½¿ç”¨SDWebImageèŽ·å–å›¾ç‰‡ï¼Œé€šè¿‡FLAnimatedImageViewåŠ è½½gifå›¾ Githubåœ°å€é¡¹ç›®åœ°å€ æ•ˆæžœå›¾]]></content>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptä¸ŽåŽŸç”Ÿäº¤äº’]]></title>
    <url>%2F2019%2F03%2F29%2FJavaScript%E4%B8%8E%E5%8E%9F%E7%94%9F%E4%BA%A4%E4%BA%92%2F</url>
    <content type="text"><![CDATA[åŽŸç”Ÿé¡µé¢ä¸ŽHTMLé¡µé¢è¿›è¡Œç›¸äº’è°ƒç”¨æ–¹å¼ | é€‚ç”¨å¯¹è±¡â€”|â€”æ‹¦æˆªURL | UIWebViewå’ŒWKWebViewJavaScriptCore | UIWebViewMessageHandler | WKWebViewWebViewJavascriptBridge| UIWebViewå’ŒWKWebView å®žä¾‹HTMLä»£ç 1234567891011121314151617181920212223242526272829303132333435&lt;body&gt; &lt;h2&gt;æŒ‰é’®ç‚¹å‡»&lt;/h2&gt; &lt;button type="submit" onclick="buttonEvent()" id="submitButto"&gt;æäº¤&lt;/button&gt; &lt;h2&gt;æ–‡ä»¶ä¸Šä¼ &lt;/h2&gt; &lt;input type="file" /&gt; &lt;h2&gt;åŽŸç”Ÿæ³¨å…¥æ•°æ®&lt;/h2&gt; &lt;input type="text" id="textField"&gt; &lt;input type="button" onclick="getTextEvent()" value="å¼€å§‹æ³¨å…¥"&gt; &lt;script&gt; function loadURL(url) &#123; var iFrame; iFrame = document.createElement("iframe"); iFrame.setAttribute("src", url); iFrame.setAttribute("style", "display:none;"); iFrame.setAttribute("height", "0px"); iFrame.setAttribute("width", "0px"); iFrame.setAttribute("frameborder", "0"); document.body.appendChild(iFrame); iFrame.parentNode.removeChild(iFrame); iFrame = null; &#125; function buttonEvent()&#123; loadURL("/buttonEvent"); buttonDidPapped(); &#125; function getTextEvent() &#123; loadURL("/getText"); getTextButtonDidPapped(); &#125; function getText(text)&#123; document.getElementById("textField").value = text; &#125; &lt;/script&gt;&lt;/body&gt; æ‹¦æˆªURLUIWebViewéµå¾ªUIWebViewDelegateè°ƒç”¨- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationTypeæ–¹æ³•ï¼Œåˆ¤æ–­èŽ·å–çš„Urlåœ°å€123456789101112131415// è°ƒç”¨JSif ([request.URL.absoluteString hasSuffix:@"buttonEvent"]) &#123; UIAlertController *vc = [UIAlertControlleralertControllerWithTitle:@"æ¸©é¦¨æç¤º" message:@"ç‚¹å‡»äº†æäº¤æŒ‰é’®" preferredStyle:UIAlertControllerStyleAlert]; [vc addAction:[UIAlertAction actionWithTitle:@"ç¡®å®š" style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) &#123; &#125;]]; [self presentViewController:vc animated:true completion:nil]; return NO;&#125; // æ³¨å…¥æ•°æ®ç»™JSif ([request.URL.absoluteString hasSuffix:@"getText"]) &#123; [webView stringByEvaluatingJavaScriptFromString:@"getText('å“ˆå“ˆ')"]; return NO;&#125;return YES; WKWebViewéµå¾ªWKNavigationDelegateè°ƒç”¨- (void)webView:(WKWebView *)webView decidePolicyForNavigationAction:(WKNavigationAction *)navigationAction decisionHandler:(void (^)(WKNavigationActionPolicy))decisionHandleræ–¹æ³•åˆ¤æ–­èŽ·å–çš„åœ°å€1234567891011121314151617NSString *strRequest = [navigationAction.request.URL.absoluteString stringByRemovingPercentEncoding];// è°ƒç”¨JSif ([strRequest hasSuffix:@"buttonEvent"]) &#123; UIAlertController *vc = [UIAlertController alertControllerWithTitle:@"æ¸©é¦¨æç¤º" message:@"ç‚¹å‡»äº†æäº¤æŒ‰é’®" preferredStyle:UIAlertControllerStyleAlert]; [vc addAction:[UIAlertAction actionWithTitle:@"ç¡®å®š" style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) &#123; &#125;]]; [self presentViewController:vc animated:true completion:nil]; decisionHandler(WKNavigationActionPolicyCancel);&#125; else if ([strRequest hasSuffix:@"getText"]) &#123; // æ³¨å…¥æ•°æ®ç»™JS [webView evaluateJavaScript:@"getText('å“ˆå“ˆ')" completionHandler:^(id _Nullable info, NSError * _Nullable error) &#123; NSLog(@"Error--%@, info--%@", error, info); &#125;]; decisionHandler(WKNavigationActionPolicyCancel);&#125; else &#123; decisionHandler(WKNavigationActionPolicyAllow);&#125; JavaScriptCore å¯¼å…¥&lt;JavaScriptCore/JavaScriptCore.h&gt; éµå¾ª&lt;UIWebViewDelegate&gt;å¹¶å®žçŽ°- (void)webViewDidFinishLoad:(UIWebView *)webViewæ–¹æ³•ã€‚ 12345678910111213141516171819202122// å¯¹JSContextå¯¹è±¡è¿›è¡Œåˆå§‹åŒ–JSContext *context = [self.webView valueForKeyPath:@"documentView.webView.mainFrame.javaScriptContext"];// éªŒè¯JSContextå¯¹è±¡æ˜¯å¦åˆå§‹åŒ–æˆåŠŸcontext.exceptionHandler = ^(JSContext *context, JSValue *exceptionValue)&#123; context.exception = exceptionValue;&#125;; // è°ƒç”¨JS context[@"buttonDidPapped"] = ^&#123; UIAlertController *vc = [UIAlertController alertControllerWithTitle:@"æ¸©é¦¨æç¤º" message:@"ç‚¹å‡»äº†æäº¤æŒ‰é’®" preferredStyle:UIAlertControllerStyleAlert]; [vc addAction:[UIAlertAction actionWithTitle:@"ç¡®å®š" style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) &#123; &#125;]]; [self presentViewController:vc animated:true completion:nil];&#125;; // æ³¨å…¥æ•°æ®ç»™JS context[@"getTextButtonDidPapped"] = ^&#123; dispatch_async(dispatch_get_main_queue(), ^&#123; [self.webView stringByEvaluatingJavaScriptFromString:@"getText('å“ˆå“ˆ')"]; &#125;);&#125;; MessageHandler ä¿®æ”¹jsä¸­çš„æ–¹æ³•ï¼Œ é€šè¿‡window.webkit.messageHandlers+æ“ä½œæ–¹æ³• 1234567function buttonEvent()&#123; window.webkit.messageHandlers.buttonEvent.postMessage(null);&#125; function getTextEvent() &#123; window.webkit.messageHandlers.getTextEvent.postMessage(null);&#125; éµå¾ªWKScriptMessageHandler åœ¨- (void)viewWillAppear:(BOOL)animatedä¸­æ·»åŠ scriptMessageHandler åœ¨- (void)viewWillDisappear:(BOOL)animatedä¸­ç§»é™¤scriptMessageHandler å®žçŽ°WKScriptMessageHandleræ–¹æ³• 1234567891011121314151617181920212223242526272829303132- (void)viewWillAppear:(BOOL)animated &#123; [super viewWillAppear:animated]; [self.webView.configuration.userContentController addScriptMessageHandler:self name:@"buttonEvent"]; [self.webView.configuration.userContentController addScriptMessageHandler:self name:@"getTextEvent"];&#125;- (void)viewWillDisappear:(BOOL)animated &#123; [super viewWillDisappear:animated]; [self.webView.configuration.userContentController removeScriptMessageHandlerForName:@"buttonEvent"]; [self.webView.configuration.userContentController removeScriptMessageHandlerForName:@"getTextEvent"];&#125;#pragma mark - WKScriptMessageHandler Method- (void)userContentController:(WKUserContentController *)userContentController didReceiveScriptMessage:(WKScriptMessage *)message &#123; // è°ƒç”¨JS if ([message.name isEqualToString:@"buttonEvent"]) &#123; UIAlertController *vc = [UIAlertController alertControllerWithTitle:@"æ¸©é¦¨æç¤º" message:@"ç‚¹å‡»äº†æäº¤æŒ‰é’®" preferredStyle:UIAlertControllerStyleAlert]; [vc addAction:[UIAlertAction actionWithTitle:@"ç¡®å®š" style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) &#123; &#125;]]; [self presentViewController:vc animated:true completion:nil]; return; &#125; // æ³¨å…¥æ•°æ®ç»™JS if ([message.name isEqualToString:@"getTextEvent"]) &#123; [self.webView evaluateJavaScript:@"getText('å“ˆå“ˆ')" completionHandler:^(id _Nullable info, NSError * _Nullable error) &#123; NSLog(@"Error--%@, info--%@", error, info); &#125;]; return; &#125;&#125; WebViewJavascriptBridgeHTMLä»£ç 123456789101112131415161718192021222324252627282930313233343536&lt;body&gt; &lt;h2&gt;æŒ‰é’®ç‚¹å‡»&lt;/h2&gt; &lt;input id = 'submitBtn' type="button" value="æäº¤æŒ‰é’®" onclick="submitClick()"/&gt; &lt;h2&gt;æ–‡ä»¶é€‰æ‹©&lt;/h2&gt; &lt;input type="file" id="image"&gt; &lt;h2&gt;æ³¨å…¥æ•°æ®&lt;/h2&gt; &lt;input type="text" id="getTextField" /&gt; &lt;input type="button" value="å¼€å§‹èŽ·å–" id = 'startGet' onclick="getTextClick()"/&gt; &lt;script&gt; function setupWebViewJavascriptBridge(callback) &#123; if (window.WebViewJavascriptBridge) &#123; return callback(WebViewJavascriptBridge); &#125; if (window.WVJBCallbacks) &#123; return window.WVJBCallbacks.push(callback); &#125; window.WVJBCallbacks = [callback]; var WVJBIframe = document.createElement('iframe'); WVJBIframe.style.display = 'none'; WVJBIframe.src = 'https://__bridge_loaded__'; document.documentElement.appendChild(WVJBIframe); setTimeout(function() &#123; document.documentElement.removeChild(WVJBIframe) &#125;, 0) &#125; setupWebViewJavascriptBridge(function(bridge) &#123; &#125;) function submitClick() &#123; WebViewJavascriptBridge.callHandler('submitClick', null, function(response) &#123; &#125;); &#125; function getTextClick() &#123; WebViewJavascriptBridge.callHandler('getTextClick', null, function(response) &#123; document.getElementById("getTextField").value = response; &#125;); &#125; &lt;/script&gt;&lt;/body&gt; ç¬¬ä¸‰æ–¹åº“ï¼šåœ°å€ æ·»åŠ WebViewJavascriptBridgeåº“ å¯¼å…¥å¤´æ–‡ä»¶#import &lt;WebViewJavascriptBridge.h&gt; å£°æ˜Žæ–¹æ³•@property WebViewJavascriptBridge* bridge; ä¸ŽWebViewå…³è” 123_bridge = [WebViewJavascriptBridge bridgeForWebView:self.webView];[_bridge setWebViewDelegate:self]; è°ƒç”¨js 1234567[_bridge registerHandler:@"submitClick" handler:^(id data, WVJBResponseCallback responseCallback) &#123; UIAlertController *vc = [UIAlertController alertControllerWithTitle:@"æ¸©é¦¨æç¤º" message:@"ç‚¹å‡»äº†æäº¤æŒ‰é’®" preferredStyle:UIAlertControllerStyleAlert]; [vc addAction:[UIAlertAction actionWithTitle:@"ç¡®å®š" style:UIAlertActionStyleDefault handler:^(UIAlertAction * _Nonnull action) &#123; &#125;]]; [self presentViewController:vc animated:true completion:nil];&#125;]; æ³¨å…¥æ•°æ® 123[_bridge registerHandler:@"getTextClick" handler:^(id data, WVJBResponseCallback responseCallback) &#123; responseCallback(@"å“ˆå“ˆå“ˆ");&#125;];]]></content>
  </entry>
  <entry>
    <title><![CDATA[iOS å•å…ƒæµ‹è¯•]]></title>
    <url>%2F2019%2F03%2F27%2FiOS%20%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%2F</url>
    <content type="text"><![CDATA[å•å…ƒæµ‹è¯•ä»¥æµ‹è¯•ViewControllerä¸ºä¾‹ã€‚ ViewController.hæ–‡ä»¶1234567891011#import &lt;UIKit/UIKit.h&gt;@interface ViewController : UIViewController/** é€»è¾‘æµ‹è¯• */- (int)getSumWithNum1:(int)a num2:(int)b;/** å¼‚æ­¥æµ‹è¯• */- (void)loadDataComplete:(void(^)(id info))complete;/** æ€§èƒ½æµ‹è¯• */- (void)openCamera;@end ViewController.mæ–‡ä»¶1234567891011121314151617181920212223- (int)getSumWithNum1:(int)a num2:(int)b &#123; return a + b;&#125;- (void)loadDataComplete:(void (^)(id))complete &#123; dispatch_async(dispatch_get_global_queue(0, 0), ^&#123; sleep(2); NSString *data = @"ðŸ˜"; dispatch_async(dispatch_get_main_queue(), ^&#123; complete(data); &#125;); &#125;);&#125;- (void)openCamera &#123; for(int i = 0; i &lt; 1000; ++i) &#123; NSLog(@"è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²%d", i); &#125;&#125;- (void)viewDidLoad &#123; [super viewDidLoad];&#125; ä¸ºäº†è¿›è¡Œå•å…ƒåŒ–æµ‹è¯•ï¼Œæ‰€ä»¥æ–°å»ºä¸€ä¸ªViewControllerTestæ–‡ä»¶ã€‚æ­¥éª¤ å¯¼å…¥æµ‹è¯•å¤´æ–‡ä»¶#import &quot;ViewController.h&quot; å£°æ˜Žå±žæ€§@property (nonatomic, strong) ViewController *vc; åœ¨- (void)setUp;è¿›è¡Œåˆå§‹åŒ–ä»£ç  123- (void)setUp &#123; self.vc = [[ViewController alloc] init];&#125; 1ã€é€»è¾‘æµ‹è¯• ç»™å‡ºæµ‹è¯•æ•°æ® è¿›è¡Œæµ‹è¯• ä½¿ç”¨æ–­è¨€è¿›è¡Œåˆ¤å®š 123456789- (void)testSum &#123;// 1. givenint a = 10;int b = 22;// 2. whenint sum = [self.vc getSumWithNum1:a num2:b];// 3. thenXCTAssertEqual(sum, 32, @"é”™è¯¯");&#125; 2ã€å¼‚æ­¥æµ‹è¯• åˆ›å»ºXCTestExpectationï¼Œè®¾ç½®é”™è¯¯æç¤º è°ƒç”¨æ–¹æ³•ï¼Œåœ¨å¼‚æ­¥ä¸­è°ƒç”¨fulfill è¿›è¡Œåˆ¤æ–­æ—¶é—´ï¼Œæ˜¯å¦åœ¨é¢„æœŸæ—¶é—´å†…å®¹ 12345678XCTestExpectation *exp = [self expectationWithDescription:@"è¶…è¿‡é¢„æœŸæ—¶é—´"];[self.vc loadDataComplete:^(id info) &#123; XCTAssertNil(info, @"æ•°æ®ä¸ºç©º"); [exp fulfill];&#125;];[self waitForExpectationsWithTimeout:4 handler:^(NSError * _Nullable error) &#123; NSLog(@"%@", error);&#125;]; 3ã€æ€§èƒ½æµ‹è¯• è®¾ç½®Baselineæ—¶é—´ Max STDDEV æœ€å¤§æ ·æœ¬æ ‡å‡†åå·®æ¯”ä¾‹ 12345- (void)testPerformanceExample &#123; [self measureBlock:^&#123; [self.vc openCamera]; &#125;];&#125; UIæµ‹è¯•1ã€å½•åˆ¶è„šæœ¬2ã€ç¼–è¾‘è„šæœ¬3ã€è‡ªåŠ¨åŒ–æµ‹è¯• èŽ·å–ä»£ç è¦†ç›–çŽ‡1ã€ç‚¹å‡»Edit Secheme2ã€é€‰æ‹©Test-&gt;Options-&gt;Code Coverageå‹¾èµ·3ã€è¿è¡Œä»£ç æŸ¥çœ‹ç»“æžœ]]></content>
  </entry>
  <entry>
    <title><![CDATA[å±žæ€§ä¿®é¥°è¯]]></title>
    <url>%2F2019%2F03%2F27%2F%E5%B1%9E%E6%80%A7%E4%BF%AE%E9%A5%B0%E8%AF%8D%2F</url>
    <content type="text"><![CDATA[@propertyé»˜è®¤æ ¼å¼ï¼š@syntheszie var = _var; ARCä¸­ï¼Œé»˜è®¤ä¿®é¥° åŸºæœ¬æ•°æ®ç±»åž‹@property (atomic, assign) å¯¹è±¡æ•°æ®ç±»åž‹@property (atomic, strong) ä¿®é¥°è¯è§£é‡Š nonatomic éžåŽŸå­æ€§è®¿é—®ï¼Œä¸å¯¹setæ–¹æ³•åŠ é”ï¼Œä¸æ˜¯å®‰å…¨çº¿ç¨‹ï¼Œä½†æ˜¯æ€§èƒ½é«˜ã€‚ atomic åŽŸå­æ€§è®¿é—®ï¼Œå¯¹ç”Ÿæˆçš„ set æ–¹æ³•åŠ äº’æ–¥é” @synchronized(é”å¯¹è±¡ï¼‰ï¼Œå®‰å…¨çº¿ç¨‹ï¼ˆä¸æ˜¯ç»å¯¹å®‰å…¨çº¿ç¨‹ï¼‰,æ€§èƒ½å·®ã€‚ strongARCä¸­ä½¿ç”¨ï¼Œä¿®é¥°OCå¯¹è±¡ï¼Œæ‹¥æœ‰å…³ç³»ï¼Œå¼•ç”¨è®¡æ•°å™¨+1ã€‚ reatainMRCä¸­ä½¿ç”¨ï¼Œä¿®é¥°OCå¯¹è±¡ï¼Œæ‹¥æœ‰å…³ç³»ï¼Œå¼•ç”¨è®¡æ•°å™¨+1ã€‚ assignä¿®é¥°åŸºç¡€æ•°æ®ç±»åž‹ï¼Œç›´æŽ¥èµ‹å€¼ï¼Œéžæ‹¥æœ‰å…³ç³»ï¼Œä¸ä½¿ç”¨å¼•ç”¨è®¡æ•°å™¨ã€‚ weakä¿®é¥°åè®®ï¼ŒæŽ§ä»¶ï¼Œéžæ‹¥æœ‰å…³ç³»ï¼ŒæŒ‡å‘çš„å¯¹è±¡é”€æ¯ï¼ŒæŒ‡é’ˆä¼šè‡ªåŠ¨ç½®ä¸ºnilï¼Œä¸ä½¿ç”¨å¼•ç”¨è®¡æ•°å™¨ã€‚ unsafe_unretainedä¸Žweakç±»ä¼¼ï¼Œä¸ä¼šè‡ªåŠ¨nilåŒ–ï¼Œå¦‚æžœæ‰€æŒ‡å‘çš„å†…å­˜åŒºåŸŸè¢«é‡Šæ”¾äº†ï¼Œè¿™ä¸ªæŒ‡é’ˆå°±æ˜¯ä¸€ä¸ªé‡ŽæŒ‡é’ˆã€‚ copyåœ¨ MRC æ—¶æ˜¯è¿™æ ·åšçš„ release æ—§å¯¹è±¡( æ—§å¯¹è±¡çš„å¼•ç”¨è®¡æ•°å™¨ -1 ) , copy æ–°å¯¹è±¡( æ–°å¯¹è±¡çš„å¼•ç”¨è®¡æ•°å™¨ +1 ) , ç„¶åŽæŒ‡å‘æ–°å¯¹è±¡ .ï¼ˆæ–°å¯¹è±¡æ˜¯æŒ‡æœ€ç»ˆæŒ‡å‘çš„é‚£ä¸ªå¯¹è±¡ï¼Œä¸ç®¡æ·±æ‹·è´è¿˜æ˜¯æµ…æ‹·è´ï¼‰ï¼Œåœ¨ ARC æ—¶æ˜¯è¿™ä¹ˆå¹²çš„ copy æ–°å¯¹è±¡( æ–°å¯¹è±¡çš„å¼•ç”¨è®¡æ•°å™¨ +1 ) , ç„¶åŽæŒ‡å‘æ–°å¯¹è±¡ã€‚ readonlyåªç”Ÿæˆgetæ–¹æ³•ï¼Œä¸æƒ³æŠŠæš´éœ²çš„å±žæ€§è¢«äººéšä¾¿æ›¿æ¢æ—¶ , å¯ä»¥ä½¿ç”¨ã€‚ readwriteç”Ÿæˆget/setæ–¹æ³•ã€‚ @dynamicå‘Šè¯‰ç¼–è¯‘å™¨:å±žæ€§çš„ setter ä¸Ž getter æ–¹æ³•ç”±ç”¨æˆ·è‡ªå·±å®žçŽ°,ä¸è‡ªåŠ¨ç”Ÿæˆã€‚(å½“ç„¶å¯¹äºŽ readonly çš„å±žæ€§åªéœ€æä¾› getter å³å¯) @synthesizeå¦‚æžœä½ æ²¡æœ‰æ‰‹åŠ¨å®žçŽ° setter æ–¹æ³•å’Œ getter æ–¹æ³•,é‚£ä¹ˆç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ä¸ºä½ åŠ ä¸Šè¿™ä¸¤ä¸ªæ–¹æ³•ã€‚ @synchronizedçº¿ç¨‹åŒæ­¥é” é—®é¢˜ï¼šï¼ˆ1ï¼‰ä»€ä¹ˆæƒ…å†µä½¿ç”¨ weak å…³é”®å­—ï¼Ÿç›¸æ¯” assign æœ‰ä»€ä¹ˆä¸åŒ? ä½¿ç”¨ åè®®å£°æ˜Žä½¿ç”¨weak IBOutlet ä½¿ç”¨weak weak å’Œ assign çš„ä¸åŒç‚¹: weak ç­–ç•¥åœ¨å±žæ€§æ‰€æŒ‡çš„å¯¹è±¡é­åˆ°æ‘§æ¯æ—¶,ç³»ç»Ÿä¼šå°† weak ä¿®é¥°çš„å±žæ€§å¯¹è±¡çš„æŒ‡é’ˆæŒ‡å‘ nil,åœ¨ OC ç»™ nil å‘æ¶ˆæ¯æ˜¯ä¸ä¼šæœ‰ä»€ä¹ˆé—®é¢˜çš„;å¦‚æžœä½¿ç”¨ assign ç­–ç•¥åœ¨å±žæ€§æ‰€æŒ‡çš„å¯¹è±¡é­åˆ°æ‘§æ¯æ—¶,å±žæ€§å¯¹è±¡æŒ‡é’ˆè¿˜æŒ‡å‘åŽŸæ¥çš„å¯¹è±¡,ç”±äºŽå¯¹è±¡å·²ç»è¢«é”€æ¯,è¿™æ—¶å€™å°±äº§ç”Ÿäº†é‡ŽæŒ‡é’ˆ,å¦‚æžœè¿™æ—¶å€™åœ¨ç»™æ­¤å¯¹è±¡å‘é€æ¶ˆæ¯,å¾ˆå®¹é€ æˆç¨‹åºå¥”æºƒassigin å¯ä»¥ç”¨äºŽä¿®é¥°éž OC å¯¹è±¡,è€Œ weak å¿…é¡»ç”¨äºŽ OC å¯¹è±¡ã€‚ ï¼ˆ2ï¼‰ä½¿ç”¨ atomic ä¸€å®šæ˜¯çº¿ç¨‹å®‰å…¨çš„å—? ä¸æ˜¯,atomic çš„æœ¬æ„æ˜¯æŒ‡å±žæ€§çš„å­˜å–æ–¹æ³•æ˜¯çº¿ç¨‹å®‰å…¨çš„,å¹¶ä¸ä¿è¯æ•´ä¸ªå¯¹è±¡æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ ä¾‹å¦‚ï¼š å£°æ˜Žä¸€ä¸ª NSMutableArray çš„åŽŸå­å±žæ€§ stuff,æ­¤æ—¶ self.stuff å’Œ self.stuff =othersulf éƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä½†æ˜¯,ä½¿ç”¨[self.stuff objectAtIndex:index]å°±ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„,éœ€è¦ç”¨äº’æ–¥é”æ¥ä¿è¯çº¿ç¨‹å®‰å…¨æ€§ã€‚ ï¼ˆ3ï¼‰@synthesize å’Œ @dynamic åˆ†åˆ«æœ‰ä»€ä¹ˆä½œç”¨ @property æœ‰ä¸¤ä¸ªå¯¹åº”çš„è¯,ä¸€ä¸ªæ˜¯@synthesize,ä¸€ä¸ªæ˜¯@dynamicã€‚å¦‚æžœ@synthesize å’Œ@dynamic éƒ½æ²¡å†™,é‚£ä¹ˆé»˜è®¤çš„å°±æ˜¯@syntheszie var = _var; @synthesize çš„è¯­ä¹‰æ˜¯å¦‚æžœä½ æ²¡æœ‰æ‰‹åŠ¨å®žçŽ° setter æ–¹æ³•å’Œ getter æ–¹æ³•,é‚£ä¹ˆç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ä¸ºä½ åŠ ä¸Šè¿™ä¸¤ä¸ªæ–¹æ³•ã€‚ @dynamic å‘Šè¯‰ç¼–è¯‘å™¨:å±žæ€§çš„ setter ä¸Ž getter æ–¹æ³•ç”±ç”¨æˆ·è‡ªå·±å®žçŽ°,ä¸è‡ªåŠ¨ç”Ÿæˆã€‚(å½“ç„¶å¯¹äºŽ readonly çš„å±žæ€§åªéœ€æä¾› getter å³å¯) å‡å¦‚ä¸€ä¸ªå±žæ€§è¢«å£°æ˜Žä¸º@dynamic varï¼›ç„¶åŽä½ æ²¡æœ‰æä¾›@setter æ–¹æ³•å’Œ@getter æ–¹æ³•,ç¼–è¯‘çš„æ—¶å€™æ²¡é—®é¢˜,ä½†æ˜¯å½“ç¨‹åºè¿è¡Œåˆ° instance.var = someVar,ç”±äºŽç¼º setteræ–¹æ³•ä¼šå¯¼è‡´ç¨‹åºå´©æºƒ;æˆ–è€…å½“è¿è¡Œåˆ° someVar = instance.var æ—¶,ç”±äºŽç¼º getter æ–¹æ³•åŒæ ·ä¼šå¯¼è‡´å´©æºƒã€‚ ï¼ˆ4ï¼‰ARC ä¸‹,ä¸æ˜¾å¼æŒ‡å®šä»»ä½•å±žæ€§å…³é”®å­—æ—¶,é»˜è®¤çš„å…³é”®å­—éƒ½æœ‰å“ªäº›? åŸºæœ¬æ•°æ®ï¼š atomic,readwrite,assign æ™®é€šçš„ OC å¯¹è±¡: atomic,readwrite,strong ï¼ˆ5ï¼‰ç”¨@property å£°æ˜Žçš„ NSString(æˆ– NSArray,NSDictionary)ç»å¸¸ä½¿ç”¨ copy å…³é”®å­—,ä¸ºä»€ä¹ˆ?å¦‚æžœæ”¹ç”¨ strong å…³é”®å­—,å¯èƒ½é€ æˆä»€ä¹ˆé—®é¢˜? å› ä¸ºçˆ¶ç±»æŒ‡é’ˆå¯ä»¥æŒ‡å‘å­ç±»å¯¹è±¡,ä½¿ç”¨ copy çš„ç›®çš„æ˜¯ä¸ºäº†è®©æœ¬å¯¹è±¡çš„å±žæ€§ä¸å—å¤–ç•Œå½±å“,ä½¿ç”¨ copy æ— è®ºç»™æˆ‘ä¼ å…¥æ˜¯ä¸€ä¸ªå¯å˜å¯¹è±¡è¿˜æ˜¯ä¸å¯å¯¹è±¡,æˆ‘æœ¬èº«æŒæœ‰çš„å°±æ˜¯ä¸€ä¸ªä¸å¯å˜çš„å‰¯æœ¬. å¦‚æžœæˆ‘ä»¬ä½¿ç”¨æ˜¯ strong,é‚£ä¹ˆè¿™ä¸ªå±žæ€§å°±æœ‰å¯èƒ½æŒ‡å‘ä¸€ä¸ªå¯å˜å¯¹è±¡,å¦‚æžœè¿™ä¸ªå¯å˜å¯¹è±¡åœ¨å¤–éƒ¨è¢«ä¿®æ”¹äº†,é‚£ä¹ˆä¼šå½±å“è¯¥å±žæ€§. ï¼ˆ6ï¼‰è¿™ä¸ªå†™æ³•ä¼šå‡ºä»€ä¹ˆé—®é¢˜: @property(copy)NSMutableArray *array; å› ä¸º copy ç­–ç•¥æ‹·è´å‡ºæ¥çš„æ˜¯ä¸€ä¸ªä¸å¯å˜å¯¹è±¡,ç„¶è€Œå´æŠŠå®ƒå½“æˆå¯å˜å¯¹è±¡ä½¿ç”¨,å¾ˆå®¹æ˜“é€ æˆç¨‹åºå¥”æºƒè¿™é‡Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜,è¯¥å±žæ€§ä½¿ç”¨äº†åŒæ­¥é”,ä¼šåœ¨åˆ›å»ºæ—¶ç”Ÿæˆä¸€äº›é¢å¤–çš„ä»£ç ç”¨äºŽå¸®åŠ©ç¼–å†™å¤šçº¿ç¨‹ç¨‹åº,è¿™ä¼šå¸¦æ¥æ€§èƒ½é—®é¢˜,é€šè¿‡å£°æ˜Ž nonatomic å¯ä»¥èŠ‚çœè¿™äº›è™½ç„¶å¾ˆå°ä½†æ˜¯ä¸å¿…è¦é¢å¤–å¼€é”€,åœ¨ iOS å¼€å‘ä¸­åº”è¯¥ä½¿ç”¨ nonatomic æ›¿ä»£ atomic. ï¼ˆ7ï¼‰å¦‚ä½•è®©è‡ªå®šä¹‰ç±»å¯ä»¥ç”¨ copy ä¿®é¥°ç¬¦?å¦‚ä½•é‡å†™å¸¦ copy å…³é”®å­—çš„ setter? è‹¥æƒ³ä»¤è‡ªå·±æ‰€å†™çš„å¯¹è±¡å…·æœ‰æ‹·è´åŠŸèƒ½,åˆ™éœ€å®žçŽ° NSCopying åè®®ã€‚1234567// å®žçŽ°ä¸å¯å˜ç‰ˆæœ¬æ‹·è´- (id)copyWithZone:(NSZone *)zone; // å®žçŽ°å¯å˜ç‰ˆæœ¬æ‹·è´- (id)mutableCopyWithZone:(NSZone *)zone;// é‡å†™å¸¦ copy å…³é”®å­—çš„ setter- (void)setName:(NSString *)name &#123; _name = [name copy];&#125; æ·±æ‹·è´å’Œæµ…æ‹·è´copy å’Œ mutableCopy copyæ‹·è´å‡ºæ¥çš„å¯¹è±¡ç±»åž‹æ€»æ˜¯ä¸å¯å˜ç±»åž‹(ä¾‹å¦‚, NSString, NSDictionary, NSArrayç­‰ç­‰) mutableCopyæ‹·è´å‡ºæ¥çš„å¯¹è±¡ç±»åž‹æ€»æ˜¯å¯å˜ç±»åž‹(ä¾‹å¦‚, NSMutableString, NSMutableDictionary, NSMutableArrayç­‰ç­‰) copy å¯¹äºŽå¯å˜å¯¹è±¡ä¸ºæ·±æ‹·è´ï¼Œå¯¹äºŽä¸å¯å˜å¯¹è±¡ä¸ºæµ…æ‹·è´ mutableCopy å§‹ç»ˆæ˜¯æ·±æ‹·è´]]></content>
  </entry>
  <entry>
    <title><![CDATA[Block]]></title>
    <url>%2F2019%2F03%2F26%2FBlock%2F</url>
    <content type="text"><![CDATA[Blockçš„å®žè´¨æœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ä¸ªOCå¯¹è±¡ï¼Œä»–å†…éƒ¨ä¹Ÿæœ‰ä¸€ä¸ªisaæŒ‡é’ˆã€‚Blockæ˜¯å°è£…äº†å‡½æ•°è°ƒç”¨ä»¥åŠå‡½æ•°è°ƒç”¨çŽ¯å¢ƒçš„OCå¯¹è±¡ã€‚ Blockä¸‰ç§ç±»åž‹ ç±»åž‹ å­˜å‚¨åŒºåŸŸ GlobalBlock æ•°æ®åŒº StackBlock æ ˆåŒº MallocBlock å †åŒº Blocké¿å…å¾ªçŽ¯å¼•ç”¨çš„ä¸‰ç§æ–¹å¼1ã€åˆ©ç”¨ __weakå’Œ__strong123456 __weak typeof(self) weakSelf = self;self.block = ^&#123; __strong typeof(self) strongSelf = weakSelf; NSLog(@"%@", NSStringFromCGRect(strongSelf.view.frame));&#125;;self.block(); 2ã€åˆ©ç”¨é€ æˆå¾ªçŽ¯å¼•ç”¨çš„ä¸´æ—¶å˜é‡123456__block ViewController *vc = self;self.block = ^&#123; NSLog(@"%@", NSStringFromCGRect(vc.view.frame)); vc = nil;&#125;;self.block(); 3ã€ç›´æŽ¥å£°æ˜ŽBlockä¸­æ·»åŠ é€ æˆå¾ªçŽ¯å¼•ç”¨çš„å‚æ•°123456typedef void(^Block)(UIViewController *vc);self.block = ^(UIViewController *vc)&#123; NSLog(@"%@", NSStringFromCGRect(vc.view.frame));&#125;;self.block(self);]]></content>
  </entry>
  <entry>
    <title><![CDATA[KVO]]></title>
    <url>%2F2019%2F03%2F26%2FKVO%2F</url>
    <content type="text"><![CDATA[ç±»çš„å•ä¸ªå±žæ€§è§‚å¯Ÿè§‚å¯Ÿå€¼çš„4ä¸­æ¨¡å¼123456/** * NSKeyValueObservingOptionNew æ–°å€¼ * NSKeyValueObservingOptionOld æ—§å€¼ * NSKeyValueObservingOptionInitial æ³¨å†Œå‘é€é€šçŸ¥ï¼Œæ”¹å˜æ—¶å‘é€é€šçŸ¥ * NSKeyValueObservingOptionPrior æ”¹å˜ä¹‹å‰å‘é€é€šçŸ¥ï¼Œæ”¹å˜åŽå‘é€é€šçŸ¥ */ é’ˆå¯¹Personç±»é‡Œé¢çš„nameå±žæ€§è¿›è¡Œè§‚å¯Ÿ1[person addObserver:self forKeyPath:@"name" options:NSKeyValueObservingOptionNew context:nil]; æŸ¥çœ‹è§‚å¯Ÿ123- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary&lt;NSKeyValueChangeKey,id&gt; *)change context:(void *)context &#123; NSLog(@"%@", change);&#125; æ‰“å°æ•ˆæžœ12342019-03-22 09:20:16.875033+0800 KVO[1844:81256] &#123; kind = 1; new = 0;&#125; ç±»çš„é‡Œé¢åµŒå¥—å…¶ä»–çš„å±žæ€§è§‚å¯Ÿè§‚å¯ŸPersoné‡Œé¢Dogç±»çš„ageï¼Œé€šè¿‡ç‚¹è¯­æ³•ç›´æŽ¥ç›‘å¬1[person addObserver:self forKeyPath:@"dog.age" options:NSKeyValueObservingOptionNew context:nil]; è¾“å…¥ç»“æžœ12342019-03-22 09:23:25.854859+0800 KVO[1876:84141] &#123; kind = 1; new = 11;&#125; ä¸€æ¬¡æ€§è§‚å¯Ÿå¤šä¸ªå€¼ä¾‹å¦‚è§‚å¯ŸPersoné‡Œé¢çš„Dogçš„ageå’Œlevelï¼Œåˆ™åœ¨Personç±»ä¸­é‡æ–°+ (NSSet&lt;NSString *&gt; *)keyPathsForValuesAffectingValueForKey:(NSString *)key12345678+ (NSSet&lt;NSString *&gt; *)keyPathsForValuesAffectingValueForKey:(NSString *)key &#123; NSSet *keyPaths = [super keyPathsForValuesAffectingValueForKey:key]; if ([key isEqualToString:@"dog"]) &#123; NSArray *array = @[@"_dog.name", @"_dog.level"]; keyPaths = [keyPaths setByAddingObjectsFromArray:array]; &#125; return keyPaths;&#125; ç›´æŽ¥è§‚å¯ŸDogç±»1[person addObserver:self forKeyPath:@"dog" options:NSKeyValueObservingOptionNew context:nil]; æ‰“å°ç»“æžœ12342019-03-22 09:27:11.485240+0800 KVO[1929:87568] &#123; kind = 1; new = "&lt;Dog: 0x6000027c0b80&gt;";&#125; æ‰‹åŠ¨æ¨¡å¼åœ¨Personç±»ä¸­é‡å†™+ (BOOL)automaticallyNotifiesObserversForKey:(NSString *)key1234+ (BOOL)automaticallyNotifiesObserversForKey:(NSString *)key &#123; // ä¿®æ”¹ä¸ºæ‰‹åŠ¨æ¨¡å¼ return NO;&#125; æ‰‹åŠ¨è§¦å‘12[self.person willChangeValueForKey:@"name"];[self.person didChangeValueForKey:@"name"]; è§‚å¯Ÿå®¹å™¨ç±»éœ€è¦åˆ©ç”¨KVCä¾‹å¦‚è§‚å¯Ÿpersonä¸­çš„array1[[self.person mutableArrayValueForKey:@"array"] addObject:@"obj"]; è¾“å‡ºç»“æžœ12345672019-03-22 11:02:13.996095+0800 KVO[5521:170395] &#123; indexes = "&lt;_NSCachedIndexSet: 0x600002216160&gt;[number of indexes: 1 (in 1 ranges), indexes: (0)]"; kind = 2; new = ( obj );&#125; KVOçš„åº•å±‚å®žçŽ°å®žè´¨ï¼šè§‚å¯Ÿå€¼çš„setteræ–¹æ³•é€šè¿‡runtimeï¼Œæ–°å»ºä¸€ä¸ªå­ç±»ç»§æ‰¿äºŽè§‚å¯Ÿç±»ï¼ˆNSKVONotifing_ç±»åï¼‰ï¼ŒåŠ¨æ€çš„ä¿®æ”¹äº†è§‚å¯Ÿç±»çš„ç±»åž‹ä¸ºå­ç±»çš„ç±»åž‹,åœ¨å­ç±»é‡Œé¢é‡å†™setæ–¹æ³•ï¼Œè°ƒç”¨12345- (void)setName:(NSString *)name &#123; [self willChangeValueForKey:@"name"]; [super setName:name]; [self didChangeValueForKey:@"name"]; &#125;]]></content>
  </entry>
  <entry>
    <title><![CDATA[iOS-3D Touch]]></title>
    <url>%2F2019%2F03%2F21%2FiOS-3D%20Touch%2F</url>
    <content type="text"><![CDATA[æ¡Œé¢å›¾æ ‡ç‚¹å‡»éœ€è¦åœ¨AppDelegateé‡Œé¢è¿›è¡Œä»£ç ç¼–å†™ã€‚1ã€åˆ›å»ºæ–¹å¼123456789101112131415161718192021/** type å”¯ä¸€æ ‡ç¤ºrç¬¦* localizedTitle æ ‡é¢˜* localizedSubtitle å‰¯æ ‡é¢˜* icon UIApplicationShortcutIconå¯¹è±¡* userInfo ä¼ é€’ä¿¡æ¯*/// ä½¿ç”¨ç³»ç»Ÿæä¾›çš„å›¾æ ‡ç”ŸæˆUIApplicationShortcutIconå¯¹è±¡UIApplicationShortcutItem *shoreItem1 = [[UIApplicationShortcutItem alloc] initWithType:@"type1"localizedTitle:@"æ ‡é¢˜"localizedSubtitle:@"å‰¯æ ‡é¢˜"icon:[UIApplicationShortcutIcon iconWithType:UIApplicationShortcutIconTypeCompose]userInfo:nil];// ä½¿ç”¨è‡ªå®šä¹‰å›¾ç‰‡ç”ŸæˆUIApplicationShortcutIconå¯¹è±¡UIApplicationShortcutItem *shoreItem2 = [[UIApplicationShortcutItem alloc] initWithType:@"type2"localizedTitle:@"æ ‡é¢˜2"localizedSubtitle:@"å‰¯æ ‡é¢˜2"icon:[UIApplicationShortcutIcon iconWithTemplateImageName:@"éªŒè¯ç "]userInfo:nil];[UIApplication sharedApplication].shortcutItems = @[shoreItem1, shoreItem2]; æ³¨ï¼šç³»ç»Ÿçš„UIApplicationShortcutIconæ ·å¼ï¼Œè‡ªå·±åŽ»ç ”ç©¶å§ï¼ç‚¹å‡»è¿™ä¸ªæ˜¯å®˜æ–¹åœ°å€ 2ã€ç‚¹å‡»å›žè°ƒï¼Œå¯ä»¥æ ¹æ®shortcutItem.type è¿›è¡Œåˆ¤æ–­ç‚¹å‡»çš„æ˜¯å“ªä¸ªitem123- (void)application:(UIApplication *)application performActionForShortcutItem:(UIApplicationShortcutItem *)shortcutItem completionHandler:(void (^)(BOOL))completionHandler &#123;NSLog(@"ç‚¹å‡»äº†%@", shortcutItem);&#125; åº”ç”¨å†…ï¼Œç‚¹å‡»è¿›è¡Œé¡µé¢æ“ä½œ1ã€éµå¾ªä»£ç†UIViewControllerPreviewingDelegate 2ã€åˆ¤æ–­è®¾å¤‡æ˜¯å¦æ”¯æŒ123456if (self.traitCollection.forceTouchCapability == UIForceTouchCapabilityAvailable)&#123;[self registerForPreviewingWithDelegate:self sourceView:self.view];NSLog(@"3D Touch å¯ç”¨!");&#125; else &#123;NSLog(@"3D Touch ä¸å¯ç”¨!");&#125; 3ã€å®žçŽ°ä»£ç†æ–¹æ³•12345678- (nullable UIViewController *)previewingContext:(id &lt;UIViewControllerPreviewing&gt;)previewingContext viewControllerForLocation:(CGPoint)location &#123;NextViewController *vc = [[NextViewController alloc] init];return vc;&#125;-(void)previewingContext:(id&lt;UIViewControllerPreviewing&gt;)previewingContext commitViewController:(UIViewController *)viewControllerToCommit &#123;[self showViewController:viewControllerToCommit sender:self];&#125; 4ã€åœ¨éœ€è¦æ˜¾ç¤ºçš„é¡µé¢é‡Œé¢è°ƒç”¨- (NSArray&lt;id&lt;UIPreviewActionItem&gt;&gt; *)previewActionItemsæ·»åŠ Items12345678910111213141516- (NSArray&lt;id&lt;UIPreviewActionItem&gt;&gt; *)previewActionItems &#123;UIPreviewAction *action1 = [UIPreviewAction actionWithTitle:@"æ ‡é¢˜1" style:UIPreviewActionStyleDefault handler:^(UIPreviewAction * _Nonnull action, UIViewController * _Nonnull previewViewController) &#123;NSLog(@"click---æ ‡é¢˜1");&#125;];UIPreviewAction *action2 = [UIPreviewAction actionWithTitle:@"æ ‡é¢˜2" style:UIPreviewActionStyleSelected handler:^(UIPreviewAction * _Nonnull action, UIViewController * _Nonnull previewViewController) &#123;NSLog(@"click---æ ‡é¢˜2");&#125;];UIPreviewAction *action3 = [UIPreviewAction actionWithTitle:@"æ ‡é¢˜3" style:UIPreviewActionStyleDestructive handler:^(UIPreviewAction * _Nonnull action, UIViewController * _Nonnull previewViewController) &#123;NSLog(@"click---æ ‡é¢˜3");&#125;];NSArray *actions = @[action1,action2,action3];return actions;&#125; æ¸©é¦¨æç¤º ç‚¹å‡»Appå›¾æ ‡æ˜¾ç¤ºæœ€åˆ†äº«æŒ‰é’®ï¼Œæ˜¯è‹¹æžœç»™ä¸Šæž¶Appæ·»åŠ çš„ ç‚¹å‡»åˆ†äº«çš„æ•ˆæžœ]]></content>
  </entry>
  <entry>
    <title><![CDATA[Runtime-æ¶ˆæ¯è½¬å‘]]></title>
    <url>%2F2019%2F03%2F19%2FRuntime-%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91%2F</url>
    <content type="text"><![CDATA[iOS æ–¹æ³•çš„åŠ¨æ€è§£æžå’Œæ¶ˆæ¯è½¬å‘ ä»¥åˆ›å»ºçš„Messageç±»ä¸ºç¤ºä¾‹Message.h1234567@interface Message : NSObject- (void)sendMessage:(NSString *)message;+ (void)sendClassMessage:(NSString *)message;@end Message.m123@implementation Message@end åŠ¨æ€æ–¹æ³•è§£æžå¾è¯¢æŽ¥æ”¶è€…æ‰€å±žçš„ç±»ï¼Œæ˜¯å¦éœ€è¦åŠ¨æ€æ·»åŠ ç±»æ–¹æ³•æˆ–å®žä¾‹æ–¹æ³•ï¼Œæ¥å¤„ç†è¿™ä¸ªæœªæ‰¾åˆ°çš„æ–¹æ³•ã€‚ é¦–å…ˆåˆ¤æ–­æ˜¯å¦å®žçŽ°äº† resolveInstanceMethodï¼Œå¦‚æžœæ²¡æœ‰å®žçŽ°ï¼Œè¿›å…¥ä¸‹ä¸€æ­¥å¤„ç†ï¼› å¦‚æžœå®žçŽ°äº†ï¼Œè°ƒç”¨ resolveInstanceMethodï¼ŒèŽ·å–è¿”å›žå€¼ï¼› å¦‚æžœè¿”å›žå€¼ä¸º YESï¼Œè¡¨ç¤º resolveInstanceMethod å£°ç§°å®ƒå·²ç»æä¾›äº† selector çš„å®žçŽ°ï¼Œå› æ­¤å†æ¬¡æŸ¥æ‰¾ method listï¼Œå¦‚æžœæ‰¾åˆ°å¯¹åº”çš„ IMPï¼Œåˆ™è¿”å›žè¯¥å®žçŽ°ï¼Œå¦åˆ™æç¤ºè­¦å‘Šä¿¡æ¯ï¼Œè¿›å…¥ä¸‹ä¸€æ­¥å¤„ç†ï¼› å¦‚æžœè¿”å›žå€¼ä¸º NOï¼Œè¿›å…¥ä¸‹ä¸€æ­¥å¤„ç†ï¼›1. å¯¹è±¡æ–¹æ³•é€šè¿‡+ (BOOL)resolveInstanceMethod:(SEL)sel;æ–¹æ³•è¿›è¡Œè§£æž1234567891011+ (BOOL)resolveInstanceMethod:(SEL)sel &#123; if (sel == @selector(sendMessage:)) &#123; class_addMethod([self class], sel, (IMP)innerSenderMessageMetod, "v@:@"); return YES; &#125; return [super resolveInstanceMethod:sel];&#125;void innerSenderMessageMetod(id obj, SEL _cmd) &#123; NSLog(@"å¯¹è±¡æ–¹æ³•ï¼ŒåŠ¨æ€è§£æž");&#125; 2. ç±»æ–¹æ³•é€šè¿‡+ (BOOL)resolveClassMethod:(SEL)sel;æ–¹æ³•è¿›è¡Œè§£æž1234567891011+ (BOOL)resolveClassMethod:(SEL)sel &#123; if (sel == @selector(sendClassMessage:)) &#123; class_addMethod(object_getClass(self), sel, (IMP)innerSenderClassMessageMetod, "v@:@"); return YES; &#125; return [super resolveClassMethod:sel];&#125;void innerSenderClassMessageMetod(id obj, SEL _cmd) &#123; NSLog(@"ç±»æ–¹æ³•ï¼ŒåŠ¨æ€è§£æž");&#125; é‡å®šå‘å¦‚æžœæ²¡æœ‰åŠ¨æ€æ·»åŠ æ–¹æ³•ï¼Œåˆ™ä¼šè¿›å…¥æ­¤é˜¶æ®µï¼Œæ­¤æ—¶è¯¢é—®æ˜¯å¦è¦å°†è¿™æ¡æ¶ˆæ¯è½¬å‘ç»™å…¶ä»–çš„å¯¹è±¡ï¼Œæ¥å¤„ç†è¿™ä¸ªæ–¹æ³•ã€‚å¦‚æžœè¿”å›žnilï¼Œå³è¡¨ç¤ºä¸è½¬å‘ç»™å…¶ä»–å¯¹è±¡ï¼Œæ­¤æ—¶ä¼šè¿›å…¥ç¬¬3é˜¶æ®µåˆ›å»ºäº†ä¸€ä¸ªå¤‡ç”¨ç±»MessageTempMessageTemp.h12345@interface MessageTemp : NSObject- (void)sendMessage:(NSString *)message;- (void)sendClassMessage:(NSString *)message;@end MessageTemp.m12345678@implementation MessageTemp- (void)sendMessage:(NSString *)message &#123; NSLog(@"å¤‡ç”¨Messageï¼Œè§£æžå¯¹è±¡æ–¹æ³•");&#125;- (void)sendClassMessage:(NSString *)message &#123; NSLog(@"å¤‡ç”¨Messageï¼Œè§£æžç±»æ–¹æ³•");&#125;@end 1. å¯¹è±¡æ–¹æ³•123456- (id)forwardingTargetForSelector:(SEL)aSelector &#123; if (aSelector == @selector(sendMessage:)) &#123; return [MessageTemp new]; &#125; return [super forwardingTargetForSelector:aSelector];&#125; 2. ç±»æ–¹æ³•123456+ (id)forwardingTargetForSelector:(SEL)aSelector &#123; if (aSelector == @selector(sendClassMessage:)) &#123; return [MessageTemp new]; &#125; return [super forwardingTargetForSelector:aSelector];&#125; æ¶ˆæ¯è½¬å‘å½“ forwardingTargetForSelector: æ–¹æ³•æœªåšå‡ºä»»ä½•å“åº”çš„è¯ï¼Œä¼šæ¥åˆ°æ¶ˆæ¯è½¬å‘æµç¨‹ã€‚æ¶ˆæ¯è½¬å‘æ—¶ä¼šé¦–å…ˆè°ƒç”¨ methodSignatureForSelector: æ–¹æ³•ï¼Œåœ¨æ–¹æ³•å†…éƒ¨ç”Ÿæˆ NSMethodSignature ç±»åž‹çš„æ–¹æ³•ç­¾åå¯¹è±¡ã€‚åœ¨ç”Ÿæˆç­¾åå¯¹è±¡æ—¶ï¼Œå¯ä»¥æŒ‡å®š target å’Œ SELï¼Œå¯ä»¥å°†è¿™ä¸¤ä¸ªå‚æ•°æ¢æˆå…¶ä»–å‚æ•°ï¼Œå°†æ¶ˆæ¯è½¬å‘ç»™å…¶ä»–å¯¹è±¡ã€‚ 1. å¯¹è±¡æ–¹æ³•1234567891011121314- (void)forwardInvocation:(NSInvocation *)anInvocation &#123; if ([anInvocation selector] == @selector(sendMessage:)) &#123; [anInvocation invokeWithTarget:[MessageTemp new]]; &#125; else &#123; [super forwardInvocation:anInvocation]; &#125;&#125;- (NSMethodSignature *)methodSignatureForSelector:(SEL)aSelector &#123; if (aSelector == @selector(sendMessage:)) &#123; return [NSMethodSignature signatureWithObjCTypes:"v@:@"]; &#125; return [super methodSignatureForSelector:aSelector];&#125; 2. ç±»æ–¹æ³•1234567891011121314+ (void)forwardInvocation:(NSInvocation *)anInvocation &#123; if ([anInvocation selector] == @selector(sendClassMessage:)) &#123; [anInvocation invokeWithTarget:[MessageTemp new]]; &#125; else &#123; [super forwardInvocation:anInvocation]; &#125;&#125;+ (NSMethodSignature *)methodSignatureForSelector:(SEL)aSelector &#123; if (aSelector == @selector(sendClassMessage:)) &#123; return [NSMethodSignature signatureWithObjCTypes:"v@:@"]; &#125; return [super methodSignatureForSelector:aSelector];&#125; åº”ç”¨åœºæ™¯ é€‚ç”¨äºŽæŠŠæ“ä½œç»™å¦å¤–ä¸€ä¸ªç±»æ¥å®žçŽ° åˆ©ç”¨åˆ†ç±»ï¼Œé˜²æ­¢åº”ç”¨ç¨‹åºå› ä¸ºæœªå¤„ç†æ¶ˆæ¯è€Œå´©æºƒ Jspatch Aspects BlocksKit]]></content>
  </entry>
  <entry>
    <title><![CDATA[iOSä»£ç å—(Snippet)]]></title>
    <url>%2F2019%2F03%2F13%2F%E4%BB%A3%E7%A0%81%E5%9D%97(Snippet)%2F</url>
    <content type="text"><![CDATA[ä»£ç å—(Snippet)ï¼Œæ–¹ä¾¿äº†ä»£ç å¿«é€Ÿåˆ›å»ºã€‚ ç®¡ç†ï¼šåœ¨æ–°ç‰ˆXcodeä¸­ç®¡ç†é¡µé¢åœ¨ç¼–è¯‘å™¨çš„å³ä¸Šè§’ æ·»åŠ ï¼šé€‰ä¸­ä»£ç é¼ æ ‡å³å‡» ç¼–è¾‘ Titleï¼šæ ‡é¢˜ã€‚ Summaryï¼šæè¿°æ–‡å­—ã€‚ Platformï¼šå¯ä»¥ä½¿ç”¨çš„å¹³å°ï¼ˆå¦‚iOSã€Mac OSï¼‰ã€‚ Languageï¼šå¯ä»¥åœ¨å“ªäº›è¯­è¨€ä¸­ä½¿ç”¨ï¼ˆå¦‚ Objective-Cã€Swiftï¼‰ã€‚ Completion Shortcutï¼šå¿«æ·æ–¹å¼ï¼Œä»¥å­—æ¯å¼€å¤´ï¼ˆæ”¯æŒå°‘æ•°ç¬¦å·ï¼Œå¦‚@ï¼‰ã€‚ Completion Scopesï¼šä½œç”¨èŒƒå›´ï¼Œä¸€èˆ¬å†™åœ¨æ­£ç¡®çš„ä½ç½®æ‹–åŠ¨å³å¯ï¼ŒXcodeä¼šè‡ªè¡Œé€‰æ‹©å¥½ã€‚å±žæ€§12345@property (nonatomic, strong) &lt;#ClassName#&gt; *&lt;#class#&gt;; ///&lt; &lt;#æ³¨é‡Š#&gt;@property (nonatomic, assign) &lt;#DataType#&gt; &lt;#name#&gt;; ///&lt; &lt;#æ³¨é‡Š#&gt;@property (nonatomic, copy) &lt;#ClassName#&gt; *&lt;#name#&gt;; ///&lt; &lt;#æ³¨é‡Š#&gt;@property (nonatomic, weak) id&lt;&lt;#delegateOrDataSouce#&gt;&gt; &lt;#delegateOrDataSouce#&gt;; ///&lt; &lt;#æ³¨é‡Š#&gt;@property (nonatomic, weak) &lt;#Class#&gt; *&lt;#name#&gt;; ///&lt; &lt;#æ³¨é‡Š#&gt; å¸¸ç”¨æ³¨é‡Š é¡¶éƒ¨æ³¨é‡Š 1/** &lt;#å±žæ€§æ³¨é‡Š#&gt; */ å³ä¾§æ³¨é‡Š 1///&lt; &lt;#æ³¨é‡Š#&gt; ç®€è¿°é¡¶éƒ¨æ³¨é‡Š 123/** &lt;#ç®€è¦æè¿°#&gt; * &lt;#è¯¦ç»†æè¿°#&gt; */ Pragma æœ‰åˆ†å‰²çº¿ 1#pragma mark &lt;#mark#&gt; æ— åˆ†å‰²çº¿ 1#pragma mark - &lt;#mark&gt; æˆ– // MARK: &lt;#mark#&gt; Warning(è­¦å‘Š) 1#warning &lt;#message#&gt; ???(ä¸ç¡®å®š) 1// ???: &lt;#???#&gt; !!!(è­¦å‘Š) 1// !!!: &lt;#???#&gt; FIXME(éœ€è¦ä¿®æ”¹çš„åœ°æ–¹) 1// FIXME: &lt;#Fixè¯¦æƒ…#&gt; å¸¸ç”¨æ–¹æ³• 123456789#pragma mark - é¡µé¢æŽ§ä»¶é…ç½®- (void)setupSubViewsProperties &#123; &#125;#pragma mark - é¡µé¢æŽ§ä»¶å¸ƒå±€- (void)setupSubViewsConstraint &#123; &#125; æžšä¸¾ 1234567typedef NS_ENUM(NSInteger, &lt;#TypeName#&gt;) &#123; &#125;;typedef NS_OPTIONS(NSUInteger, &lt;#TypeName#&gt;) &#123; &#125;; IFDEBUG 12345#if DEBUG&lt;#TODO#&gt;#else&lt;#TODO#&gt;#endif å¿«æ·åˆå§‹åŒ–UILabel 123456UILabel *l = [[UILabel alloc] init];l.font = [UIFont &lt;#font#&gt;];l.text = @"&lt;#conent#&gt;";l.textColor = [UIColor &lt;#textColor#&gt;];l.numberOfLines = 0;[&lt;#view#&gt; addSubview:l]; å¿«æ·åˆå§‹åŒ–UIButton 12345678UIButton *b = [UIButton buttonWithType:UIButtonTypeCustom];b.backgroundColor = [UIColor &lt;#backgroundColor#&gt;];b.titleLabel.font = [UIFont &lt;#font#&gt;];[b setTitle:&lt;#title#&gt; forState:UIControlStateNormal];[b setTitleColor:[UIColor &lt;#titleColor#&gt;] forState:UIControlStateNormal];[b setImage:[UIImage imageNamed:&lt;#(nonnull NSString *)#&gt;] forState:UIControlStateNormal][b addTarget:self action:@selector(didTapped&lt;#Button Name#&gt;:) forControlEvents:UIControlEventTouchUpInside];[&lt;#view#&gt; addSubview:b]; UIButton ç‚¹å‡»äº‹ä»¶ 1234/** &lt;#ButtonName#&gt;ç‚¹å‡»äº‹ä»¶ */- (void)didTapped&lt;#ButtonName#&gt;:(UIButton *)sender &#123; &#125; Notificationäº‹ä»¶ 1234/** &lt;#Notification Name#&gt;é€šçŸ¥äº‹ä»¶ */- (void)didReceive&lt;#Notification Name#&gt;:(NSNotification *)notification &#123; &#125; UIGestureRecognizerè§¦æ‘¸äº‹ä»¶ 1234/** &lt;#GestureRecognizer Name#&gt;è§¦æ‘¸äº‹ä»¶ */- (void)didRecognized&lt;#GestureRecognizer Name#&gt;:(UIGestureRecognizer *)recognizer &#123; &#125; ç»“æŸè¯­è¿™ä¹Ÿæ˜¯ä¸ºäº†ä¸ªäººæ„è§ï¼Œå…¶ä»–è¿˜æœ‰å¾ˆå¤šå¯ä»¥åšæˆä»£ç å—çš„ï¼Œä¾‹å¦‚CGDï¼ŒTableViewDataSourceç­‰ç­‰ï¼Œå¸Œæœ›çŸ­çŸ­çš„æ–‡ç« å¯ä»¥è®©ä½ ä»£ç å¯ä»¥å†™çš„æ›´å¥½ã€‚]]></content>
  </entry>
  <entry>
    <title><![CDATA[iOSå·¥å…·ç±»-æ—¶é—´å·®]]></title>
    <url>%2F2019%2F02%2F26%2FiOS%E5%B7%A5%E5%85%B7%E7%B1%BB-%E6%97%B6%E9%97%B4%E5%B7%AE%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘æƒ³å†™ç‚¹æ—¥å¸¸ä½¿ç”¨çš„å·¥å…·ç±»ï¼Œæ–¹ä¾¿å¼€å‘ã€‚é¦–å…ˆæƒ³åˆ°å°±æ˜¯æ—¶é—´ä¹‹ç±»çš„é—®é¢˜ï¼Œæ‰€ä»¥æ‰“å¼€Xocdeï¼Œè¿›è¡Œä»£ç ç¼–è¾‘ã€‚è¿™ä¸ªä»£ç è€ƒè™‘ä¸æ˜¯å¾ˆå®Œå…¨ï¼Œæ—¥åŽæœ‰æ—¶é—´å†è¿›è¡Œä¿®æ”¹è¡¥å……ã€‚ æŽ¥å£æ–‡ä»¶æˆ‘ä½¿ç”¨çš„ç±»åç§°ä¸ºDateHandleUtils123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354NS_ASSUME_NONNULL_BEGINtypedef NS_ENUM(NSInteger, WeiBoTimeStyle) &#123; WeiBoTimeStyleSecond, WeiBoTimeStyleMillisecond&#125;;@interface DateHandleUtils : NSObject/** æ ¹æ®æ—¶é—´è¿”å›žæ–‡å­—æ—¶é—´æˆ³ @param timeInterval æ¯”è¾ƒæ—¶é—´ @param style æ—¶é—´æˆ³æ ¼å¼ @return `åˆšåˆš`ã€`10ç§’å‰`ã€`10åˆ†é’Ÿå‰`ã€`1å°æ—¶å‰`ç­‰ç­‰ */+ (NSString *)weiboTimeWithPublicTime:(NSTimeInterval)timeInterval timeStyel:(WeiBoTimeStyle)style;/** * å½“å‰æ—¶é—´æ—¶é—´æˆ³ * @return æ¯«ç§’çš„æ—¶é—´æˆ³ */+ (NSTimeInterval)currentMilliSecondTimeInterval;/** * å½“å‰æ—¶é—´æ—¶é—´æˆ³ * @return ç§’çš„æ—¶é—´æˆ³ */+ (NSTimeInterval)currentSecondTimeInterval;/** * æ ¹æ®æ—¶é—´æˆ³èŽ·å–æ—¶é—´å·® * @param startTime å¼€å§‹æ—¶é—´çš„æ—¶é—´æˆ³ @param endTime ç»“æŸæ—¶é—´çš„æ—¶é—´æˆ³ @return è¿”å›žå·®å€¼ï¼Œå•ä½ä¸ºç§’ @warning ä¼ å€¼æ ¼å¼ä¸ºï¼šæ¯«ç§’çº§æ—¶é—´æˆ³ */+ (NSTimeInterval)timeDifferenceOfMillisecondWithStartTimeInterval:(NSTimeInterval)startTime endTimeInterval:(NSTimeInterval)endTime;/** * æ ¹æ®æ—¶é—´æˆ³èŽ·å–æ—¶é—´å·® * @param startTime å¼€å§‹æ—¶é—´çš„æ—¶é—´æˆ³ @param endTime ç»“æŸæ—¶é—´çš„æ—¶é—´æˆ³ @return è¿”å›žå·®å€¼ï¼Œå•ä½ä¸ºç§’ @warning ä¼ å€¼æ ¼å¼ä¸ºï¼šç§’çº§æ—¶é—´æˆ³ */+ (NSTimeInterval)timeDifferenceOfSecondsWithStartTimeInterval:(NSTimeInterval)startTime endTimeInterval:(NSTimeInterval)endTime;@endNS_ASSUME_NONNULL_END å®žçŽ°æ–‡ä»¶1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374@implementation DateHandleUtils+ (NSString *)weiboTimeWithPublicTime:(NSTimeInterval)timeInterval timeStyel:(WeiBoTimeStyle)style &#123; NSTimeInterval interval; switch (style) &#123; case WeiBoTimeStyleSecond: interval = [DateHandleUtils timeDifferenceOfSecondsWithStartTimeInterval:timeInterval endTimeInterval:[DateHandleUtils currentSecondTimeInterval]]; break; case WeiBoTimeStyleMillisecond: interval = [DateHandleUtils timeDifferenceOfMillisecondWithStartTimeInterval:timeInterval endTimeInterval:[DateHandleUtils currentMilliSecondTimeInterval]]; break; default: break; &#125; if (interval &lt; 10) &#123; return @"åˆšåˆš"; &#125; else if (interval &lt; 60) &#123; return [NSString stringWithFormat:@"%.fç§’å‰", interval]; &#125; else if (interval / 60 &lt; 60) &#123; return [NSString stringWithFormat:@"%.fåˆ†é’Ÿå‰", interval / 60]; &#125; else if (interval / 60 / 60 &lt; 24) &#123; return [NSString stringWithFormat:@"%.få°æ—¶å‰", interval / 60 / 60 - 1]; &#125; else if (interval / 60 / 60 / 24 &lt; 30) &#123; return [NSString stringWithFormat:@"%.få¤©å‰", interval / 60 / 60 / 24]; &#125; else if (interval / 60 / 60 / 24 / 30 &lt; 12) &#123; return [NSString stringWithFormat:@"%.fæœˆå‰", interval / 60 / 60 / 24 / 30]; &#125; else if (interval / 60 / 60 / 24 / 30 / 12 &gt;= 1)&#123; return [NSString stringWithFormat:@"%.få¹´å‰", interval / 60 / 60 / 24 / 30 / 12]; &#125; else &#123; return @"æœªçŸ¥æ—¶é—´"; &#125;&#125;+ (NSTimeInterval)currentMilliSecondTimeInterval &#123; NSDateFormatter *formatter = [[NSDateFormatter alloc] init]; [formatter setDateStyle: NSDateFormatterMediumStyle]; [formatter setTimeStyle: NSDateFormatterShortStyle]; [formatter setDateFormat: @"YYYY-MM-dd HH:mm:ss SSS"]; NSTimeZone *timeZone = [NSTimeZone timeZoneWithName: @"Asia/Shanghai"]; [formatter setTimeZone: timeZone]; NSDate *datenow = [NSDate date]; return [datenow timeIntervalSince1970] * 1000;&#125;+ (NSTimeInterval)currentSecondTimeInterval &#123; NSDateFormatter *formatter = [[NSDateFormatter alloc] init]; [formatter setDateStyle: NSDateFormatterMediumStyle]; [formatter setTimeStyle: NSDateFormatterShortStyle]; [formatter setDateFormat: @"YYYY-MM-dd HH:mm:ss SSS"]; NSTimeZone *timeZone = [NSTimeZone timeZoneWithName: @"Asia/Shanghai"]; [formatter setTimeZone: timeZone]; NSDate *datenow = [NSDate date]; return [datenow timeIntervalSince1970];&#125;+ (NSTimeInterval)timeDifferenceOfMillisecondWithStartTimeInterval:(NSTimeInterval)startTime endTimeInterval:(NSTimeInterval)endTime &#123; if (startTime &lt; endTime) &#123; return (endTime - startTime) / 1000; &#125; else &#123; return (startTime - endTime) / 1000; &#125;&#125;+ (NSTimeInterval)timeDifferenceOfSecondsWithStartTimeInterval:(NSTimeInterval)startTime endTimeInterval:(NSTimeInterval)endTime &#123; if (startTime &lt; endTime) &#123; return (endTime - startTime); &#125; else &#123; return (startTime - endTime); &#125;&#125;@end ä½¿ç”¨æ–¹å¼éƒ½æ˜¯ç±»æ–¹æ³•ï¼Œç”¨çš„æ—¶å€™ç›´æŽ¥ä½¿ç”¨ç±»åè°ƒç”¨å°±å¯ä»¥äº†(å®žä¾‹ï¼š[DateHandleUtils currentMilliSecondTimeInterval];);]]></content>
  </entry>
  <entry>
    <title><![CDATA[iOSå¼€å‘æŠ€å·§-ä¸æ–­æ›´æ–°ä¸­]]></title>
    <url>%2F2019%2F01%2F24%2F%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7%2F</url>
    <content type="text"><![CDATA[1ã€PrefixHeaderå¯¼å…¥ä½ç½®å†™æ³•1$(SRCROOT)/$(PROJECT_NAME)/&lt;#æ–‡ä»¶æ‰€åœ¨æ–‡ä»¶å¤¹åç§°#&gt;/PrefixHeader.pch 2ã€éšè—å¯¼èˆªæ çš„ä¸¤ç§æ–¹å¼1234567891011121314151617181920212223242526272829//æ–¹å¼ä¸€ ã€ŠæŽ¨èã€‹//åœ¨éœ€è¦éšè—çš„viewControllerä¸­éµå¾ª&lt;UINavigationControllerDelegate&gt;- (void)viewDidLoad &#123; [super viewDidLoad]; // è®¾ç½®å¯¼èˆªæŽ§åˆ¶å™¨çš„ä»£ç†ä¸ºself self.navigationController.delegate = self;&#125;#pragma mark - UINavigationControllerDelegate// å°†è¦æ˜¾ç¤ºæŽ§åˆ¶å™¨- (void)navigationController:(UINavigationController *)navigationController willShowViewController:(UIViewController *)viewController animated:(BOOL)animated &#123; // åˆ¤æ–­è¦æ˜¾ç¤ºçš„æŽ§åˆ¶å™¨æ˜¯å¦æ˜¯è‡ªå·± BOOL isShowHomePage = [viewController isKindOfClass:[self class]]; [self.navigationController setNavigationBarHidden:isShowHomePage animated:YES];&#125;//æ–¹å¼äºŒ- (void)viewWillAppear:(BOOL)animated &#123; [super viewWillAppear:animated]; [self.navigationController setNavigationBarHidden:YES animated:YES];&#125;- (void)viewWillDisappear:(BOOL)animated &#123; [super viewWillDisappear:animated]; [self.navigationController setNavigationBarHidden:NO animated:YES];&#125; 3ã€TabBarItemè¦æ±‚åªæ˜¾ç¤ºå›¾ç‰‡ä¸æ˜¾ç¤ºæ–‡å­—12// self è¡¨ç¤ºéœ€è¦è®¾ç½®æ ·å¼çš„æŽ§åˆ¶å™¨[self.tabBarItem setImageInsets:UIEdgeInsetsMake(6, 0, -6, 0)]; 4ã€TableViewæˆ–CollectionViewå•é€‰1234567891011&lt;!--æ­¥éª¤ä¸€ã€ å£°æ˜Žä¸€ä¸ªå…¨å±€å˜é‡--&gt;@property (nonatomic, assign) NSInteger selectedIndex;&lt;!--æ­¥éª¤äºŒã€TableViewæˆ–CollectionViewç‚¹å‡»äº‹ä»¶çš„æ–¹æ³•ä¸­ä¿å­˜ç‚¹å‡»çš„indexï¼Œå¹¶åˆ·æ–°--&gt;self.selectedIndex = indexPath.row;[collectionView reloadData];æˆ–[tableView reloadData];&lt;!--æ­¥éª¤ä¸‰ã€åœ¨cellForItemAtIndexPathæˆ–cellForRowAtIndexPathæ–¹æ³•ä¸­åˆ¤æ–­æ˜¯å¦æ˜¯æ‰€ä¿å­˜çš„index--&gt;if (self.selectedIndex == indexPath.row) &#123; // è®¾ç½®é€‰ä¸­æ ·å¼&#125; else &#123; // è®¾ç½®æˆé»˜è®¤æ ·å¼ &#125; 5ã€æ€Žä¹ˆåŒºåˆ†çœŸæœºè¿˜æ˜¯æ¨¡æ‹Ÿå™¨1234567#if TARGET_IPHONE_SIMULATOR NSLog(@"run on simulator"); #define SIMULATOR_TEST#else //ä¸å®šä¹‰SIMULATOR_TESTè¿™ä¸ªå® NSLog(@"run on device"); #endif 6ã€if Debug12345#ifdef DEBUG // do sth#else // do sth#endif 7ã€ä¸€é”®æ¸…ç†æ‰€æœ‰æ¨¡æ‹Ÿå™¨å®‰è£…è¿‡çš„APP12// å…ˆå…³é—­æ‰€æœ‰æ¨¡æ‹Ÿå™¨ åœ¨ç»ˆç«¯ä¸­è¾“å…¥ä¸‹é¢å‘½ä»¤å³å¯xcrun simctl erase all 8ã€SDWebImageæ¸…ç†ç¼“å­˜1234- (void)didReceiveMemoryWarning &#123; [super didReceiveMemoryWarning]; [[[SDWebImageManager sharedManager] imageCache] clearMemory];&#125; 9ã€UITableViewçš„HeaderViewä¸‹æ‹‰æ”¾å¤§123456789101112131ã€View1:ä½œä¸ºæ˜¾ç¤ºView2ã€View2:ä½œä¸ºtableViewçš„tableHeaderViewï¼Œå¹¶æ·»åŠ View1ï¼ŒView2çš„å¤§å°å’ŒView1å¤§å°ç›¸åŒ.3ã€åœ¨UIScrollViewDelegateæ–¹æ³•ä¸­è¿›è¡Œè®¾è®¡- (void)scrollViewDidScroll:(UIScrollView *)scrollView &#123; CGFloat width = UIScreen.mainScreen.bounds.size.width; CGFloat viewHeight = kScreenWidth * 0.5; // View1çš„åˆå§‹é«˜åº¦ CGFloat yOffset = scrollView.contentOffset.y; if (yOffset &lt; 0) &#123; CGFloat totalOffset = viewHeight + ABS(yOffset); CGFloat f = totalOffset / viewHeight; self.headerView.frame = CGRectMake(- (width * f - width) / 2, yOffset, width * f, totalOffset); &#125;&#125; 10ã€Masonryåˆ¶ä½œå°±å®«æ ¼1234567891011121314151617181920212223242526272829303132333435363738394041424344454647//Objective-C ----&gt; Masonry/** å¤šè§†å›¾å¸ƒå±€ @param viewArray è§†å›¾æ•°ç»„ @param column åˆ—æ•° @param tbSpeace è§†å›¾ä¸Šä¸‹é—´è· @param lrSpeace è§†å›¾å·¦å³é—´è· @param topSpeace å’Œçˆ¶è§†å›¾ä¸Šé—´è· @param lrSuperViewSpeace çˆ¶è§†å›¾å·¦å³é—´è· @param superView çˆ¶è§†å›¾ @param viewHeight è§†å›¾é«˜åº¦ */- (void)wd_masLayoutSubViewsWithViewArray:(NSArray&lt;UIView *&gt; *)viewArray columnOfRow:(NSInteger)column topBottomOfItemSpeace:(CGFloat)tbSpeace leftRightItemSpeace:(CGFloat)lrSpeace topOfSuperViewSpeace:(CGFloat)topSpeace leftRightSuperViewSpeace:(CGFloat)lrSuperViewSpeace addToSubperView:(UIView *)superView viewHeight:(CGFloat)viewHeight&#123; CGFloat viewWidth = superView.bounds.size.width; CGFloat itemWidth = (viewWidth - lrSuperViewSpeace * 2 - (column - 1) * lrSpeace) / column * 1.0f; CGFloat itemHeight = viewHeight; UIView *last = nil; for (int i = 0; i &lt; viewArray.count; i++) &#123; UIView *item = viewArray[i]; [superView addSubview:item]; [item mas_makeConstraints:^(MASConstraintMaker *make) &#123; make.width.mas_equalTo(itemWidth); make.height.mas_equalTo(itemHeight); CGFloat top = topSpeace + (i / column) * (itemHeight + tbSpeace); make.top.mas_offset(top); if (!last || (i % column) == 0) &#123; make.left.mas_offset(lrSuperViewSpeace); &#125;else&#123; make.left.mas_equalTo(last.mas_right).mas_offset(lrSpeace); &#125; &#125;]; last = item; &#125;&#125; 11ã€Snapkitåˆ¶ä½œä¹å®«æ ¼1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253//Swift ----&gt; SnapKit /// å¤šè§†å›¾å¸ƒå±€ /// /// - Parameters: /// - viewArray: è§†å›¾æ•°ç»„ /// - columnOfRow: åˆ—æ•° /// - topBottomOfItemSpeace: è§†å›¾ä¸Šä¸‹é—´è· /// - leftRightItemSpeace: è§†å›¾å·¦å³é—´è· /// - topOfSuperViewSpeace: å’Œçˆ¶è§†å›¾ä¸Šé—´è· /// - leftRightSuperViewSpeace: çˆ¶è§†å›¾å·¦å³é—´è· /// - addToSubperView: çˆ¶è§†å›¾ /// - viewHeight: è§†å›¾é«˜åº¦ func wd_masLayoutSubViews(viewArray:Array&lt;UIView&gt;, columnOfRow:Int, topBottomOfItemSpeace:CGFloat, leftRightItemSpeace:CGFloat, topOfSuperViewSpeace:CGFloat, leftRightSuperViewSpeace:CGFloat, addToSubperView:UIView, viewHeight:CGFloat) -&gt; Void &#123; let viewWidth = addToSubperView.bounds.width let tempW = leftRightSuperViewSpeace * 2 + CGFloat(columnOfRow - 1) * leftRightItemSpeace let itemWidth = (viewWidth - tempW) / CGFloat(columnOfRow) let itemHeight = viewHeight print(leftRightSuperViewSpeace,leftRightItemSpeace,itemWidth) var lastView:UIView? for (index) in viewArray.enumerated() &#123; let item = viewArray[i] addToSubperView.addSubview(item) item.snp.makeConstraints &#123; (make) in make.width.equalTo(itemWidth) make.height.equalTo(itemHeight) let top = topOfSuperViewSpeace + CGFloat(i / columnOfRow) * (itemHeight + topBottomOfItemSpeace) make.top.equalTo(top) if !(lastView != nil) || i%columnOfRow == 0 &#123; make.left.equalTo(leftRightSuperViewSpeace) &#125; else &#123; make.left.equalTo((lastView?.snp.right)!).offset(leftRightItemSpeace) &#125; lastView = item &#125; &#125; &#125; 12ã€æ²‰æµ¸å¼TableView(ScrollViewã€CollectionView)12345if (@available(iOS 11.0, *)) &#123; self.tableView.contentInsetAdjustmentBehavior = UIScrollViewContentInsetAdjustmentNever;&#125; else &#123; self.automaticallyAdjustsScrollViewInsets = false;&#125; 13ã€é€šè¿‡èº«ä»½è¯è®¡ç®—å¹´é¾„1234567891011121314151617181920212223242526272829303132333435363738/** é€šè¿‡èº«ä»½è¯è®¡ç®—å¹´é¾„ */- (NSString *)calculationAgeWithBirthday: (NSString *)birthday &#123; NSCalendar *calendar = [NSCalendar currentCalendar]; NSDate *nowDate = [NSDate date]; NSString *birth = birthday; NSDateFormatter *dateFormatter = [[NSDateFormatter alloc]init]; [dateFormatter setDateFormat:@"yyyy-MM-dd"]; NSDate *birthDay = [dateFormatter dateFromString:birth]; unsigned int unitFlags = NSCalendarUnitYear | NSCalendarUnitMonth | NSCalendarUnitDay; NSDateComponents *date = [calendar components:unitFlags fromDate:birthDay toDate:nowDate options:0]; if ([date year] &gt; 0) &#123; return [NSString stringWithFormat:@"%ldå²", (long)[date year]]; &#125; else if([date month] &gt; 0) &#123; return [NSString stringWithFormat:@"%ldæœˆ", (long)[date month]]; &#125; else if([date day] &gt; 0)&#123; return [NSString stringWithFormat:@"%ldå¤©", (long)[date day]]; &#125; else &#123; return @"0å¤©"; &#125;&#125;- (NSString *)ageStrFromIdentityCard:(NSString *)numberStr &#123; NSString *dateSt; NSMutableString *dateS; if (numberStr.length &gt; 15) &#123; dateSt = [numberStr substringWithRange:NSMakeRange(6, 8)]; dateS = [NSMutableString stringWithFormat:@"%@", dateSt]; [dateS insertString:@"-" atIndex:4]; [dateS insertString:@"-" atIndex:7]; &#125; else &#123; // åªè€ƒè™‘ 19å¼€å¤´çš„15ä½çš„èº«ä»½è¯å· dateSt = [NSString stringWithFormat:@"19%@",[numberStr substringWithRange:NSMakeRange(6, 6)]]; dateS = [NSMutableString stringWithFormat:@"%@", dateSt]; [dateS insertString:@"-" atIndex:4]; [dateS insertString:@"-" atIndex:7]; &#125; return [self calculationAgeWithBirthday:dateS];&#125; 14ã€åˆ©ç”¨runtimeè‡ªåŠ¨å½’æ¡£123456789101112131415161718192021222324252627// å¯¼å…¥å¤´æ–‡ä»¶#import &lt;objc/runtime.h&gt;// éµå¾ªåè®®&lt;NSCoding&gt;// å®žçŽ°æ–¹æ³•- (id)initWithCoder:(NSCoder *)aDecoder &#123; if (self = [super init]) &#123; unsigned int outCount; Ivar * ivars = class_copyIvarList([self class], &amp;outCount); for (int i = 0; i &lt; outCount; i ++) &#123; Ivar ivar = ivars[i]; NSString * key = [NSString stringWithUTF8String:ivar_getName(ivar)]; [self setValue:[aDecoder decodeObjectForKey:key] forKey:key]; &#125; &#125; return self;&#125;- (void)encodeWithCoder:(NSCoder *)aCoder &#123; unsigned int outCount; Ivar * ivars = class_copyIvarList([self class], &amp;outCount); for (int i = 0; i &lt; outCount; i ++) &#123; Ivar ivar = ivars[i]; NSString * key = [NSString stringWithUTF8String:ivar_getName(ivar)]; [aCoder encodeObject:[self valueForKey:key] forKey:key]; &#125;&#125; 15ã€ä¼˜åŒ–Snipkit æ²¡æœ‰distributeViewsAlong12]]></content>
  </entry>
  <entry>
    <title><![CDATA[AVPlayerå°è£…]]></title>
    <url>%2F2019%2F01%2F11%2FAVPlayer%E5%B0%81%E8%A3%85%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘åœ¨å†™å…³äºŽéŸ³è§†é¢‘æ’­æ”¾çš„æ¡ˆä¾‹ï¼Œæ‰€ä»¥å°±è¶æœºä¼šç ”ç©¶äº†ä¸€ä¸‹AVPlayerçš„å†…å®¹ã€‚æˆ‘å°è£…çš„ç›®å‰åªèƒ½æ’­æ”¾ç½‘ç»œéŸ³è§†é¢‘ã€‚è¿˜æœªæ·»åŠ ç¼“å­˜ï¼Œä»¥åŽæ‰¾æœºä¼šç ”ç©¶ä¸€ä¸‹å†æ›´æ–°ã€‚ä»£ç ä¸­æä¾›äº†éŸ³è§†é¢‘çš„ä¸Šä¸€æ›²ã€ä¸‹ä¸€æ›²ã€æš‚åœã€å¼€å§‹ã€åœæ­¢ã€å•æ›²æ’­æ”¾ã€é¡ºåºæ’­æ”¾ã€éšæœºæ’­æ”¾ç­‰åŠŸèƒ½ã€‚ä»£ç å†™çš„ä¸å¥½ï¼Œä»…ä¾›å‚è€ƒ~ ä»£ç æŽ¥å£æ–‡ä»¶123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171#import &lt;Foundation/Foundation.h&gt;#import &lt;AVFoundation/AVFoundation.h&gt;NS_ASSUME_NONNULL_BEGIN// å½“å‰æ’­æ”¾å™¨çš„æ’­æ”¾å½¢å¼typedef NS_ENUM(NSInteger, MediaPlayType) &#123; MediaPlayTypeCycle, ///&lt; é¡ºåº MediaPlayTypeSingle, ///&lt; å•æ›²å¾ªçŽ¯ MediaPlayTypeRandom ///&lt; éšæœºæ’­æ”¾&#125;;// å½“å‰æ’­æ”¾å™¨çš„æ’­æ”¾çŠ¶æ€typedef NS_ENUM(NSInteger, MediaPlayStatus) &#123; MediaPlayStatusStop, ///&lt; åœæ­¢æ’­æ”¾ MediaPlayStatusPause, ///&lt; æš‚åœæ’­æ”¾ MediaPlayStatusPlaying ///&lt; æ­£åœ¨æ’­æ”¾&#125;;// åª’ä½“åŠ è½½çŠ¶æ€typedef NS_ENUM(NSInteger, MediaLoadStatus) &#123; MediaLoadStatusReadyToPlay, ///&lt; å‡†å¤‡æ’­æ”¾ MediaLoadStatusUnknown, ///&lt; æœªçŸ¥ MediaPlayStatusFailed ///&lt; å¤±è´¥&#125;;@class MediaPlyerManager;@protocol MediaPlyerManagerDelegate &lt;NSObject&gt;@optional// æ•°æ®åŠ è½½çŠ¶æ€ æ ¹æ®çŠ¶æ€è¿›è¡Œæ’­æ”¾æˆ–å…¶ä»–æ“ä½œ- (void)MediaPlayer:(MediaPlyerManager *)playerManager playerItemStatus:(MediaLoadStatus)status;// ç¼“å†²è¿›åº¦- (void)MediaPlayer:(MediaPlyerManager *)playerManager netBufferValue:(CGFloat)value;// ç¼“å†²æ˜¯å¦è¶³å¤Ÿæ’­æ”¾- (void)MediaPlayer:(MediaPlyerManager *)playerManager bufferHasEnough:(BOOL)enough;// å½“å‰æ’­æ”¾çš„æ—¶é—´- (void)MediaPlayer:(MediaPlyerManager *)playerManager currentPlayTime:(NSString *)time currentPlayTimeValue:(CGFloat)value;// æ’­æ”¾æ€»æ—¶é—´- (void)MediaPlayer:(MediaPlyerManager *)playerManager mediaEndTime:(NSString *)time mediaEndTimeValue:(CGFloat)value;// æ’­æ”¾ç»“æŸ- (void)MediaPlayerCurrentMediaPlayFinish:(MediaPlyerManager *)playerManager;// æ’­æ”¾çŠ¶æ€- (void)MediaPlayer:(MediaPlyerManager *)playerManager playeStatus:(MediaPlayStatus)status;// èŽ·å–æ•°æ®åˆ‡æ¢æ—¶èŽ·å–æ­£åœ¨æ’­æ”¾çš„URLå’Œå½“å‰çš„index- (void)MediaPlayer:(MediaPlyerManager *)playerManager currentUrl:(NSString *)url currentIndex:(NSInteger)index;// ä¸ºäº†é…åˆæ‰‹æœºåŽå°æ’­æ”¾ å®žæ—¶èŽ·å–æ’­æ”¾çš„è¿›åº¦ï¼Œæ€»çš„æ—¶é—´ï¼Œå½“å‰çš„index&lt;é€šè¿‡indexèŽ·å–å›¾ç‰‡ç­‰ä¿¡æ¯&gt;- (void)MediaPlayer:(MediaPlyerManager *)playerManager currentProgressValue:(CGFloat)value totalValue:(CGFloat)totalValue currentIndex:(NSInteger)index;@endtypedef MediaPlyerManager *(^playerCurrentTime)(NSString *time);@interface MediaPlyerManager : NSObject@property (nonatomic, strong, readonly) AVPlayer *mediaPlayer; ///&lt; æ’­æ”¾å™¨@property (nonatomic, strong, readonly) AVPlayerItem *meidaPlayerItem; ///&lt; æ’­æ”¾å™¨çš„CurrentItem@property (nonatomic, strong, readonly) NSMutableArray&lt;NSString*&gt; *dataUrlArray; ///&lt; æ­£åœ¨æ’­æ”¾çš„åˆ—è¡¨æ•°æ®@property (nonatomic, assign, readonly) MediaPlayType playType; ///&lt; å½“å‰æ’­æ”¾ç±»åž‹@property (nonatomic, assign, readonly) MediaPlayStatus playStatus; ///&lt; å½“å‰æ’­æ”¾çŠ¶æ€@property (nonatomic, assign, readonly) NSInteger currentIndex; ///&lt; å½“å‰æ’­æ”¾çš„ç´¢å¼•@property (nonatomic, assign, readonly) BOOL isPlaying; ///&lt; æ˜¯å¦åœ¨æ’­æ”¾@property (nonatomic, assign, readonly) CGFloat curentPlayTimeValue; ///&lt; å½“å‰æ’­æ”¾æ—¶é—´å€¼@property (nonatomic, copy, readonly) NSString *curentPlayTime; ///&lt; å½“å‰æ’­æ”¾æ—¶é—´@property (nonatomic, assign, readonly) CGFloat endPlayTimeValue; ///&lt; å½“å‰æ’­æ”¾æ—¶é—´å€¼@property (nonatomic, copy, readonly) NSString *endPlayTime; ///&lt; å½“å‰æ’­æ”¾æ—¶é—´+ (instancetype)defaultManager;/** åˆ—è¡¨æ’­æ”¾ âš ï¸&lt;é»˜è®¤ä¸è‡ªåŠ¨æ’­æ”¾&gt; @param urls æ–‡ä»¶è·¯å¾„æ•°ç»„ @param delegate å›žè°ƒä»£ç† @return MediaPlyerManager */- (MediaPlyerManager *)playerWithUrls:(NSArray&lt;NSString *&gt; *)urls actionWithDelegate:(id&lt;MediaPlyerManagerDelegate&gt;)delegate;/** å•ä¸ªéŸ³è§†é¢‘æ’­æ”¾ âš ï¸&lt;é»˜è®¤ä¸è‡ªåŠ¨æ’­æ”¾&gt; @param url æ–‡ä»¶è·¯å¾„ @param delegate å›žè°ƒä»£ç† @return MediaPlyerManager */- (MediaPlyerManager *)playerWithUrl:(NSString *)url actionWithDelegate:(id&lt;MediaPlyerManagerDelegate&gt;)delegate;/** å¼€å§‹æ’­æ”¾ */- (void)play;/** æš‚åœæ’­æ”¾ */- (void)pause;/** åœæ­¢æ’­æ”¾ */- (void)stop;/** ä¸‹ä¸€æ›² */- (void)next;/** ä¸Šä¸€æ›² */- (void)previous;/** æŒ‡å®šè¿›åº¦å¼€å§‹æ’­æ”¾ @param progress è¿›åº¦ç™¾åˆ†æ¯” */- (void)setupPlayerSeekToProgress:(CGFloat)progress;/** åˆ¶å®šæ’­æ”¾ç±»åž‹ @param type ç±»åž‹ */- (void)setupMediaPlayerType:(MediaPlayType)type;/** æŒ‡å®šæ’­æ”¾çš„index @param index ç´¢å¼• */- (void)setupPlayerIndex:(NSInteger)index;/** æ·»åŠ æ•°æ® @param files æ–‡ä»¶æ•°ç»„ @param index ç´¢å¼• */- (void)insertMediaFile:(NSArray&lt;NSString *&gt; *)files atIndex:(NSInteger)index;/** ç§»é™¤å…¨éƒ¨æ•°æ® */- (void)removeAllFiles;/** ç§»é™¤ç´¢å¼•ä¸­çš„å•ä¸ªæ•°æ® @param index ç´¢å¼• */- (void)removeObjectAtIndex:(NSInteger)index;/** è®¾ç½®é”å±æ ·å¼ @param coverImage ä¸“è¾‘å›¾ç‰‡ @param size æ˜¾ç¤ºå¤§å° @param title æ ‡é¢˜ @param author ä¸“è¾‘ä½œè€… @param album ä¸“è¾‘åç§° @param currentTime å½“å‰æ’­æ”¾æ—¶é—´ @param duration æ’­æ”¾æ€»æ—¶é•¿ */- (void)setupLockScreenPlayInfo:(UIImage *)coverImage imageSize:(CGSize)size title:(NSString *)title ahthor:(NSString *)author album:(NSString *)album currentPlayTime:(CGFloat)currentTime duration:(CGFloat)duration;@endNS_ASSUME_NONNULL_END ä»£ç å®žçŽ°æ–‡ä»¶123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382#import "MediaPlyerManager.h"#import &lt;MediaPlayer/MediaPlayer.h&gt;@interface MediaPlyerManager ()@property (nonatomic, strong, readwrite) NSMutableArray&lt;NSString *&gt; *dataUrlArray;@property (nonatomic, strong, readwrite) AVPlayer *mediaPlayer;@property (nonatomic, assign, readwrite) BOOL isPlaying;@property (nonatomic, strong, readwrite) AVPlayerItem *meidaPlayerItem;@property (nonatomic, assign, readwrite) MediaPlayType playeType;@property (nonatomic, assign, readwrite) NSInteger currentIndex;@property (nonatomic, assign, readwrite) MediaPlayStatus playStatus;@property (nonatomic, assign, readwrite) CGFloat curentPlayTimeValue;@property (nonatomic, copy, readwrite ) NSString *curentPlayTime;@property (nonatomic, assign, readwrite) CGFloat endPlayTimeValue;@property (nonatomic, copy, readwrite ) NSString *endPlayTime;@property (nonatomic, weak ) id &lt;MediaPlyerManagerDelegate&gt; delegate;@end@implementation MediaPlyerManager+ (instancetype)defaultManager &#123; static dispatch_once_t onceToken; static MediaPlyerManager *manger; dispatch_once(&amp;onceToken, ^&#123; manger = [[MediaPlyerManager alloc] init]; &#125;); return manger;&#125;#pragma mark - åˆå§‹åŒ–- (MediaPlyerManager *)playerWithUrl:(NSString *)url actionWithDelegate:(id&lt;MediaPlyerManagerDelegate&gt;)delegate &#123; [self playerWithUrls:@[url] actionWithDelegate:delegate]; return self;&#125;- (MediaPlyerManager *)playerWithUrls:(NSArray&lt;NSString *&gt; *)urls actionWithDelegate:(id&lt;MediaPlyerManagerDelegate&gt;)delegate &#123; self.delegate = delegate; self.currentIndex = 0; self.dataUrlArray = [NSMutableArray array]; NSMutableArray *array = [NSMutableArray arrayWithCapacity:urls.count]; for (NSString *urlStr in urls) &#123; [array addObject:[self createPlayerItemWithUrl:urlStr]]; [self.dataUrlArray addObject:urlStr]; &#125; self.playeType = MediaPlayTypeCycle; self.mediaPlayer = [[AVPlayer alloc] initWithPlayerItem:array.firstObject]; self.meidaPlayerItem = self.mediaPlayer.currentItem; [self getCurrentIndex:self.currentIndex]; [self addObserver]; __weak typeof(self) weakself = self; [self.mediaPlayer addPeriodicTimeObserverForInterval:CMTimeMake(1, 1) queue:NULL usingBlock:^(CMTime time) &#123; NSString *currentString = [weakself getStringFromCMTime:time]; weakself.curentPlayTime = currentString; weakself.curentPlayTimeValue = (CGFloat)time.value/time.timescale; #pragma mark - èŽ·å–å½“å‰æ’­æ”¾æ—¶é—´ if (weakself.delegate &amp;&amp; [weakself.delegate respondsToSelector:@selector(MediaPlayer:currentPlayTime:currentPlayTimeValue:)]) &#123; [weakself.delegate MediaPlayer:weakself currentPlayTime:currentString currentPlayTimeValue:(CGFloat)time.value/time.timescale]; &#125;#pragma mark - å®žæ—¶èŽ·å–æ’­æ”¾ä¿¡æ¯ if (self.delegate &amp;&amp; [self.delegate respondsToSelector:@selector(MediaPlayer:currentProgressValue:totalValue:currentIndex:)]) &#123; [weakself.delegate MediaPlayer:weakself currentProgressValue:weakself.curentPlayTimeValue totalValue:weakself.endPlayTimeValue currentIndex:weakself.currentIndex]; &#125; &#125;]; return self;&#125;#pragma mark - æ’­æ”¾ç»“æŸ- (void)playFinish:(NSNotification *)notification &#123; if (self.delegate &amp;&amp; [self.delegate respondsToSelector:@selector(MediaPlayerCurrentMediaPlayFinish:)]) &#123; [self.delegate MediaPlayerCurrentMediaPlayFinish:self]; &#125; if (self.playeType == MediaPlayTypeSingle) &#123; [self.mediaPlayer seekToTime:kCMTimeZero]; [self play]; &#125; else &#123; if (self.currentIndex &lt; self.dataUrlArray.count - 1) &#123; self.currentIndex += 1; &#125; else &#123; self.currentIndex = 0; &#125; [self.mediaPlayer replaceCurrentItemWithPlayerItem:[self createPlayerItemWithUrl:self.dataUrlArray[self.currentIndex]]]; self.meidaPlayerItem = self.mediaPlayer.currentItem; [self getCurrentIndex:self.currentIndex]; [self play]; &#125;&#125;#pragma mark - KVO- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary&lt;NSKeyValueChangeKey,id&gt; *)change context:(void *)context &#123; AVPlayerItem *playerItem = object; if ([keyPath isEqualToString:@"status"]) &#123; MediaLoadStatus status = [change[@"new"] integerValue];#pragma mark - èŽ·å–åª’ä½“åŠ è½½çŠ¶æ€ if (self.delegate &amp;&amp; [self.delegate respondsToSelector:@selector(MediaPlayer:playerItemStatus:)]) &#123; [self.delegate MediaPlayer:self playerItemStatus:status]; &#125; &#125; else if ([keyPath isEqualToString:@"loadedTimeRanges"]) &#123; NSArray * timeRanges = playerItem.loadedTimeRanges; CMTimeRange timeRange = [timeRanges.firstObject CMTimeRangeValue]; NSTimeInterval totalLoadTime = CMTimeGetSeconds(timeRange.start) \ + CMTimeGetSeconds(timeRange.duration); NSTimeInterval duration = CMTimeGetSeconds(playerItem.duration); NSTimeInterval scale = totalLoadTime/duration; #pragma mark - èŽ·å–åª’ä½“æ€»æ—¶é—´ if ((CGFloat)duration/scale &gt;= 0) &#123; self.endPlayTime = [self getStringFromCMTime:playerItem.duration]; self.endPlayTimeValue = (CGFloat)duration/scale; if (self.delegate &amp;&amp; [self.delegate respondsToSelector:@selector(MediaPlayer:mediaEndTime:mediaEndTimeValue:)]) &#123; [self.delegate MediaPlayer:self mediaEndTime:[self getStringFromCMTime:playerItem.duration] mediaEndTimeValue:(CGFloat)duration/scale]; &#125; &#125; #pragma mark - ç¼“å†²ç™¾åˆ†æ¯” if (self.delegate &amp;&amp; [self.delegate respondsToSelector:@selector(MediaPlayer:netBufferValue:)]) &#123; [self.delegate MediaPlayer:self netBufferValue:scale]; &#125; &#125; else if ([keyPath isEqualToString:@"playbackBufferEmpty"]) &#123; #pragma mark - ç¼“å†²ä¸è¶³å¤Ÿæ’­æ”¾ if (self.delegate &amp;&amp; [self.delegate respondsToSelector:@selector(MediaPlayer:bufferHasEnough:)]) &#123; [self.delegate MediaPlayer:self bufferHasEnough:false]; &#125; &#125; else if ([keyPath isEqualToString:@"playbackLikelyToKeepUp"]) &#123; #pragma mark - ç¼“å†²è¶³å¤Ÿæ’­æ”¾ if (self.delegate &amp;&amp; [self.delegate respondsToSelector:@selector(MediaPlayer:bufferHasEnough:)]) &#123; [self.delegate MediaPlayer:self bufferHasEnough:true]; &#125; &#125;&#125;#pragma mark - å¼€å§‹æ’­æ”¾- (void)play &#123; [self.mediaPlayer play]; [self getPlayStatus:MediaPlayStatusPlaying];&#125;#pragma mark - æš‚åœæ’­æ”¾- (void)pause &#123; [self.mediaPlayer pause]; [self getPlayStatus:MediaPlayStatusPause];&#125;#pragma mark - åœæ­¢æ’­æ”¾- (void)stop &#123; [self.mediaPlayer replaceCurrentItemWithPlayerItem:nil]; [self getPlayStatus:MediaPlayStatusStop]; [self removeObserver];&#125;#pragma mark - ä¸‹ä¸€ä¸ª- (void)next &#123; if (self.playeType == MediaPlayTypeRandom) &#123; self.currentIndex = (NSInteger)arc4random_uniform((int32_t)(self.dataUrlArray.count - 1)); &#125; else &#123; if (self.currentIndex == self.dataUrlArray.count - 1) &#123; self.currentIndex = 0; &#125; else &#123; self.currentIndex += 1; &#125; &#125; [self.mediaPlayer replaceCurrentItemWithPlayerItem:[self createPlayerItemWithUrl:self.dataUrlArray[self.currentIndex]]]; self.meidaPlayerItem = self.mediaPlayer.currentItem; [self getCurrentIndex:self.currentIndex]; [self addObserver];&#125;#pragma mark - ä¸Šä¸€ä¸ª- (void)previous &#123; if (self.playeType == MediaPlayTypeRandom) &#123; self.currentIndex = (NSInteger)arc4random_uniform((int32_t)(self.dataUrlArray.count - 1)); &#125; else &#123; if (self.currentIndex == 0) &#123; self.currentIndex = self.dataUrlArray.count - 1; &#125; else &#123; self.currentIndex -= 1; &#125; &#125; [self.mediaPlayer replaceCurrentItemWithPlayerItem:[self createPlayerItemWithUrl:self.dataUrlArray[self.currentIndex]]]; self.meidaPlayerItem = self.mediaPlayer.currentItem; [self getCurrentIndex:self.currentIndex]; [self addObserver];&#125;#pragma mark - æ’­æ”¾çŠ¶æ€- (void)getPlayStatus:(MediaPlayStatus)status &#123; if (self.delegate &amp;&amp; [self.delegate respondsToSelector:@selector(MediaPlayer:playeStatus:)]) &#123; [self.delegate MediaPlayer:self playeStatus:status]; &#125; self.playStatus = status; if (status == MediaPlayStatusPlaying) &#123; self.isPlaying = true; &#125; else &#123; self.isPlaying = false; &#125;&#125;#pragma mark - æ ¹æ®indexè¿›è¡Œå›žè°ƒ- (void)getCurrentIndex:(NSInteger)index &#123; if (self.delegate &amp;&amp; [self.delegate respondsToSelector:@selector(MediaPlayer:currentUrl:currentIndex:)]) &#123; [self.delegate MediaPlayer:self currentUrl:self.dataUrlArray[index] currentIndex:index]; &#125;&#125;#pragma mark - è®¾ç½®æ’­æ”¾è¿›åº¦ç™¾åˆ†æ¯”- (void)setupPlayerSeekToProgress:(CGFloat)progress &#123; float timeValue = progress * CMTimeGetSeconds(self.mediaPlayer.currentItem.duration); [self.mediaPlayer seekToTime:CMTimeMake(timeValue, 1)];&#125;#pragma mark - è®¾ç½®æ’­æ”¾å½¢å¼- (void)setupMediaPlayerType:(MediaPlayType)type &#123; self.playeType = type;&#125;#pragma mark - æ’­æ”¾æŒ‡å®šindexçš„åª’ä½“- (void)setupPlayerIndex:(NSInteger)index &#123; if (index &gt; (self.dataUrlArray.count - 1)) &#123; @throw [NSException exceptionWithName:@"è¶Šç•Œé”™è¯¯" reason:@"index ä¸èƒ½è¶…å‡ºURLæ•°ç»„çš„é•¿åº¦" userInfo:nil]; return; &#125; self.currentIndex = index; [self.mediaPlayer replaceCurrentItemWithPlayerItem:[self createPlayerItemWithUrl:self.dataUrlArray[self.currentIndex]]]; self.meidaPlayerItem = self.mediaPlayer.currentItem; [self getCurrentIndex:self.currentIndex];&#125;#pragma mark - æ’å…¥æ•°æ®- (void)insertMediaFile:(NSArray&lt;NSString *&gt; *)files atIndex:(NSInteger)index &#123; for (NSString *urlStr in files) &#123; NSInteger i = [files indexOfObject:urlStr]; [self.dataUrlArray insertObject:urlStr atIndex:index + i]; &#125; if (index &lt; self.currentIndex) &#123; self.currentIndex += 1; &#125;&#125;#pragma mark - åˆ é™¤æ•°æ®- (void)removeAllFiles &#123; [self stop]; [self.dataUrlArray removeAllObjects]; self.dataUrlArray = [NSMutableArray array]; self.currentIndex = 0;&#125;- (void)removeObjectAtIndex:(NSInteger)index &#123; if (self.dataUrlArray.count == 1) &#123; [self removeAllFiles]; &#125; else &#123; [self.dataUrlArray removeObjectAtIndex:index]; if (index == self.currentIndex) &#123; if (index == 0) &#123; self.currentIndex = 0; [self next]; &#125; else &#123; self.currentIndex -= 1; &#125; &#125; else &#123; if (self.currentIndex &gt; index) &#123; self.currentIndex -= 1; &#125; &#125; &#125;&#125;#pragma mark - Utils- (NSString *)getStringFromCMTime:(CMTime)time &#123; float currentTimeValue = (CGFloat)time.value/time.timescale; NSDate * currentDate = [NSDate dateWithTimeIntervalSince1970:currentTimeValue]; NSCalendar *calendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSCalendarIdentifierGregorian]; NSInteger unitFlags = NSCalendarUnitHour | NSCalendarUnitMinute | NSCalendarUnitSecond; NSDateComponents *components = [calendar components:unitFlags fromDate:currentDate]; if (currentTimeValue &gt;= 3600 ) &#123; return [NSString stringWithFormat:@"%02ld:%02ld:%02ld", (long)components.hour, (long)components.minute, (long)components.second]; &#125; else &#123; return [NSString stringWithFormat:@"%02ld:%02ld", (long)components.minute, (long)components.second]; &#125;&#125;- (void)addObserver &#123; // ç›‘æŽ§çŠ¶æ€å±žæ€§ [self.meidaPlayerItem addObserver:self forKeyPath:@"status" options:(NSKeyValueObservingOptionOld|NSKeyValueObservingOptionNew) context:nil]; // ç›‘æŽ§ç¼“å†²åŠ è½½æƒ…å†µå±žæ€§ [self.meidaPlayerItem addObserver:self forKeyPath:@"loadedTimeRanges" options:(NSKeyValueObservingOptionOld|NSKeyValueObservingOptionNew) context:nil]; // ç›‘å¬ç¼“å†²ä¸è¶³å¤Ÿæ’­æ”¾ [self.meidaPlayerItem addObserver:self forKeyPath:@"playbackBufferEmpty" options:NSKeyValueObservingOptionNew context:nil]; // ç›‘å¬ç¼“å†²è¶³å¤Ÿæ’­æ”¾ [self.meidaPlayerItem addObserver:self forKeyPath:@"playbackLikelyToKeepUp" options:NSKeyValueObservingOptionNew context:nil]; // èŽ·å–æ˜¯å¦æ’­æ”¾ç»“æŸ [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(playFinish:) name:AVPlayerItemDidPlayToEndTimeNotification object:self.meidaPlayerItem];&#125;- (void)removeObserver &#123; [[NSNotificationCenter defaultCenter] removeObserver:self]; @try &#123; [self.meidaPlayerItem removeObserver:self forKeyPath:@"loadedTimeRanges"]; [self.meidaPlayerItem removeObserver:self forKeyPath:@"playbackBufferEmpty"]; [self.meidaPlayerItem removeObserver:self forKeyPath:@"playbackLikelyToKeepUp"]; [self.meidaPlayerItem removeObserver:self forKeyPath:@"status"]; &#125; @catch(NSException *exception) &#123; NSLog(@"%@", exception); &#125; &#125;#pragma mark - è®¾ç½®é”å±æ ·å¼- (void)setupLockScreenPlayInfo:(UIImage *)coverImage imageSize:(CGSize)size title:(NSString *)title ahthor:(NSString *)author album:(NSString *)album currentPlayTime:(CGFloat)currentTime duration:(CGFloat)duration &#123; Class playingInfoCenter = NSClassFromString(@"MPNowPlayingInfoCenter"); if (playingInfoCenter) &#123; NSMutableDictionary *songInfo = [[NSMutableDictionary alloc] init]; MPMediaItemArtwork *albumArt = [[MPMediaItemArtwork alloc] initWithBoundsSize:size requestHandler:^UIImage * _Nonnull(CGSize size) &#123; return coverImage; &#125;]; [songInfo setObject:title forKey:MPMediaItemPropertyTitle]; [songInfo setObject:author forKey:MPMediaItemPropertyArtist]; [songInfo setObject:album forKey:MPMediaItemPropertyAlbumTitle]; [songInfo setObject:albumArt forKey:MPMediaItemPropertyArtwork]; [songInfo setObject:[NSNumber numberWithDouble:currentTime] forKey:MPNowPlayingInfoPropertyElapsedPlaybackTime]; [songInfo setObject:[NSNumber numberWithDouble:duration] forKey:MPMediaItemPropertyPlaybackDuration]; [[MPNowPlayingInfoCenter defaultCenter] setNowPlayingInfo:songInfo]; &#125;&#125;- (AVPlayerItem *)createPlayerItemWithUrl:(NSString *)url &#123; return [AVPlayerItem playerItemWithURL:[NSURL URLWithString:url]];&#125;@end æé—®æœ¬æ¥ç›¸åŒä½¿ç”¨AVQueuePlayeræ¥è¿›è¡Œåˆ—è¡¨æ’­æ”¾çš„ï¼Œä½†æ˜¯å½“åšå•æ›²å¾ªçŽ¯çš„æ—¶å€™é‡åˆ°é—®é¢˜ï¼šé€šè¿‡é€šçŸ¥ç›‘å¬æ’­æ”¾å®Œæˆï¼Œåœ¨é€šçŸ¥çš„æ–¹æ³•é‡Œè¿›è¡Œå…·ä½“æ“ä½œï¼Œä½†æ˜¯è®¾ç½®æ— æ•ˆï¼Œç›´æŽ¥æ’­æ”¾çš„è¿˜æ˜¯ä¸‹ä¸€ä¸ªæ–‡ä»¶ã€‚å¦‚æžœæœ‰äººçŸ¥é“å¦‚ä½•è§£å†³ï¼Œå¸®å¿™å›žå¤ä¸€ä¸‹ã€‚]]></content>
  </entry>
  <entry>
    <title><![CDATA[RxSwiftå­¦ä¹ æ—¥å¸¸]]></title>
    <url>%2F2019%2F01%2F03%2FRxSwift%E5%AD%A6%E4%B9%A0%E6%97%A5%E5%B8%B8%EF%BC%88%E5%9F%BA%E7%A1%80%E4%BB%8B%E7%BB%8D%EF%BC%89%2F</url>
    <content type="text"><![CDATA[Observable ä»‹ç»Observable Observable è¿™ä¸ªç±»å°±æ˜¯ Rx æ¡†æž¶çš„åŸºç¡€ï¼Œæˆ‘ä»¬å¯ä»¥ç§°å®ƒä¸ºå¯è§‚å¯Ÿåºåˆ—ã€‚å®ƒçš„ä½œç”¨å°±æ˜¯å¯ä»¥å¼‚æ­¥åœ°äº§ç”Ÿä¸€ç³»åˆ—çš„ Eventï¼ˆäº‹ä»¶ï¼‰ï¼Œå³ä¸€ä¸ª Observable å¯¹è±¡ä¼šéšç€æ—¶é—´æŽ¨ç§»ä¸å®šæœŸåœ°å‘å‡º event(element : T) è¿™æ ·ä¸€ä¸ªä¸œè¥¿ã€‚ è€Œä¸”è¿™äº› Event è¿˜å¯ä»¥æºå¸¦æ•°æ®ï¼Œå®ƒçš„æ³›åž‹ å°±æ˜¯ç”¨æ¥æŒ‡å®šè¿™ä¸ª Event æºå¸¦çš„æ•°æ®çš„ç±»åž‹ã€‚ æœ‰äº†å¯è§‚å¯Ÿåºåˆ—ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æœ‰ä¸€ä¸ª Observerï¼ˆè®¢é˜…è€…ï¼‰æ¥è®¢é˜…å®ƒï¼Œè¿™æ ·è¿™ä¸ªè®¢é˜…è€…æ‰èƒ½æ”¶åˆ° Observable ä¸æ—¶å‘å‡ºçš„ Eventã€‚EventæŸ¥çœ‹ RxSwift æºç å¯ä»¥å‘çŽ°ï¼Œäº‹ä»¶ Event çš„å®šä¹‰å¦‚ä¸‹ï¼š 12345678910public enum Event&lt;Element&gt; &#123; /// Next element is produced. case next(Element) /// Sequence terminated with an error. case error(Swift.Error) /// Sequence completed successfully. case completed&#125; å¯ä»¥çœ‹åˆ° Event å°±æ˜¯ä¸€ä¸ªæžšä¸¾ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ª Observable æ˜¯å¯ä»¥å‘å‡º 3 ç§ä¸åŒç±»åž‹çš„ Event äº‹ä»¶ï¼š nextï¼šnext äº‹ä»¶å°±æ˜¯é‚£ä¸ªå¯ä»¥æºå¸¦æ•°æ® çš„äº‹ä»¶ï¼Œå¯ä»¥è¯´å®ƒå°±æ˜¯ä¸€ä¸ªâ€œæœ€æ­£å¸¸â€çš„äº‹ä»¶ã€‚ errorï¼šerror äº‹ä»¶è¡¨ç¤ºä¸€ä¸ªé”™è¯¯ï¼Œå®ƒå¯ä»¥æºå¸¦å…·ä½“çš„é”™è¯¯å†…å®¹ï¼Œä¸€æ—¦ Observable å‘å‡ºäº† error eventï¼Œåˆ™è¿™ä¸ª Observable å°±ç­‰äºŽç»ˆæ­¢äº†ï¼Œä»¥åŽå®ƒå†ä¹Ÿä¸ä¼šå‘å‡º event äº‹ä»¶äº†ã€‚ completedï¼šcompleted äº‹ä»¶è¡¨ç¤º Observable å‘å‡ºçš„äº‹ä»¶æ­£å¸¸åœ°ç»“æŸäº†ï¼Œè·Ÿ error ä¸€æ ·ï¼Œä¸€æ—¦ Observable å‘å‡ºäº† completed eventï¼Œåˆ™è¿™ä¸ª Observable å°±ç­‰äºŽç»ˆæ­¢äº†ï¼Œä»¥åŽå®ƒå†ä¹Ÿä¸ä¼šå‘å‡º event äº‹ä»¶äº†Observable ä¸Ž Sequenceæ¯”è¾ƒ(1)ã€ä¸ºæ›´å¥½åœ°ç†è§£ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ¯ä¸€ä¸ª Observable çš„å®žä¾‹æƒ³è±¡æˆäºŽä¸€ä¸ª Swift ä¸­çš„ Sequenceï¼š å³ä¸€ä¸ª Observableï¼ˆObservableTypeï¼‰ç›¸å½“äºŽä¸€ä¸ªåºåˆ— Sequenceï¼ˆSequenceTypeï¼‰ã€‚ ObservableType.subscribe(_:) æ–¹æ³•å…¶å®žå°±ç›¸å½“äºŽ SequenceType.generate()ã€‚ (2)ã€ä½†å®ƒä»¬ä¹‹é—´è¿˜æ˜¯æœ‰è®¸å¤šåŒºåˆ«çš„ï¼š Swift ä¸­çš„ SequenceType æ˜¯åŒæ­¥çš„å¾ªçŽ¯ï¼Œè€Œ Observable æ˜¯å¼‚æ­¥çš„ã€‚ Observable å¯¹è±¡ä¼šåœ¨æœ‰ä»»ä½• Event æ—¶å€™ï¼Œè‡ªåŠ¨å°† Event ä½œä¸ºä¸€ä¸ªå‚æ•°é€šè¿‡ ObservableType.subscribe(_:) å‘å‡ºï¼Œå¹¶ä¸éœ€è¦ä½¿ç”¨ next æ–¹æ³•ã€‚åˆ›å»º Observable åºåˆ—just() æ–¹æ³•ï¼ˆ1ï¼‰è¯¥æ–¹æ³•é€šè¿‡ä¼ å…¥ä¸€ä¸ªé»˜è®¤å€¼æ¥åˆå§‹åŒ–ã€‚ï¼ˆ2ï¼‰ä¸‹é¢æ ·ä¾‹æˆ‘ä»¬æ˜¾å¼åœ°æ ‡æ³¨å‡ºäº† observable çš„ç±»åž‹ä¸º Observableï¼Œå³æŒ‡å®šäº†è¿™ä¸ª Observable æ‰€å‘å‡ºçš„äº‹ä»¶æºå¸¦çš„æ•°æ®ç±»åž‹å¿…é¡»æ˜¯ Int ç±»åž‹çš„ã€‚ 1let observable = Observable&lt;Int&gt;.just(5) of() æ–¹æ³•ï¼ˆ1ï¼‰è¯¥æ–¹æ³•å¯ä»¥æŽ¥å—å¯å˜æ•°é‡çš„å‚æ•°ï¼ˆå¿…éœ€è¦æ˜¯åŒç±»åž‹çš„ï¼‰ï¼ˆ2ï¼‰ä¸‹é¢æ ·ä¾‹ä¸­æˆ‘æ²¡æœ‰æ˜¾å¼åœ°å£°æ˜Žå‡º Observable çš„æ³›åž‹ç±»åž‹ï¼ŒSwift ä¹Ÿä¼šè‡ªåŠ¨æŽ¨æ–­ç±»åž‹ã€‚1let observable = Observable.of("A", "B", "C") from() æ–¹æ³•ï¼ˆ1ï¼‰è¯¥æ–¹æ³•éœ€è¦ä¸€ä¸ªæ•°ç»„å‚æ•°ã€‚ï¼ˆ2ï¼‰ä¸‹é¢æ ·ä¾‹ä¸­æ•°æ®é‡Œçš„å…ƒç´ å°±ä¼šè¢«å½“åšè¿™ä¸ª Observable æ‰€å‘å‡º event æºå¸¦çš„æ•°æ®å†…å®¹ï¼Œæœ€ç»ˆæ•ˆæžœåŒä¸Šé¢é¥¿ of() æ ·ä¾‹æ˜¯ä¸€æ ·çš„ã€‚1let observable = Observable.from(["A", "B", "C"]) empty() æ–¹æ³•è¯¥æ–¹æ³•åˆ›å»ºä¸€ä¸ªç©ºå†…å®¹çš„ Observable åºåˆ—ã€‚1let observable = Observable&lt;Int&gt;.empty() never() æ–¹æ³•è¯¥æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ°¸è¿œä¸ä¼šå‘å‡º Eventï¼ˆä¹Ÿä¸ä¼šç»ˆæ­¢ï¼‰çš„ Observable åºåˆ—ã€‚1let observable = Observable&lt;Int&gt;.never() error() æ–¹æ³•è¯¥æ–¹æ³•åˆ›å»ºä¸€ä¸ªä¸åšä»»ä½•æ“ä½œï¼Œè€Œæ˜¯ç›´æŽ¥å‘é€ä¸€ä¸ªé”™è¯¯çš„ Observable åºåˆ—ã€‚123456enum MyError: Error &#123; case A case B&#125; let observable = Observable&lt;Int&gt;.error(MyError.A) range() æ–¹æ³•ï¼ˆ1ï¼‰è¯¥æ–¹æ³•é€šè¿‡æŒ‡å®šèµ·å§‹å’Œç»“æŸæ•°å€¼ï¼Œåˆ›å»ºä¸€ä¸ªä»¥è¿™ä¸ªèŒƒå›´å†…æ‰€æœ‰å€¼ä½œä¸ºåˆå§‹å€¼çš„ Observable åºåˆ—ã€‚ï¼ˆ2ï¼‰ä¸‹é¢æ ·ä¾‹ä¸­ï¼Œä¸¤ç§æ–¹æ³•åˆ›å»ºçš„ Observable åºåˆ—éƒ½æ˜¯ä¸€æ ·çš„ã€‚12345//ä½¿ç”¨range()let observable = Observable.range(start: 1, count: 5) //ä½¿ç”¨of()let observable = Observable.of(1, 2, 3 ,4 ,5) repeatElement() æ–¹æ³•è¯¥æ–¹æ³•åˆ›å»ºä¸€ä¸ªå¯ä»¥æ— é™å‘å‡ºç»™å®šå…ƒç´ çš„ Event çš„ Observable åºåˆ—ï¼ˆæ°¸ä¸ç»ˆæ­¢ï¼‰ã€‚1let observable = Observable.repeatElement(1) generate() æ–¹æ³•ï¼ˆ1ï¼‰è¯¥æ–¹æ³•åˆ›å»ºä¸€ä¸ªåªæœ‰å½“æä¾›çš„æ‰€æœ‰çš„åˆ¤æ–­æ¡ä»¶éƒ½ä¸º true çš„æ—¶å€™ï¼Œæ‰ä¼šç»™å‡ºåŠ¨ä½œçš„ Observable åºåˆ—ã€‚ï¼ˆ2ï¼‰ä¸‹é¢æ ·ä¾‹ä¸­ï¼Œä¸¤ç§æ–¹æ³•åˆ›å»ºçš„ Observable åºåˆ—éƒ½æ˜¯ä¸€æ ·çš„ã€‚123456789//ä½¿ç”¨generate()æ–¹æ³•let observable = Observable.generate( initialState: 0, condition: &#123; $0 &lt;= 10 &#125;, iterate: &#123; $0 + 2 &#125;) //ä½¿ç”¨of()æ–¹æ³•let observable = Observable.of(0 , 2 ,4 ,6 ,8 ,10) create() æ–¹æ³•ï¼ˆ1ï¼‰è¯¥æ–¹æ³•æŽ¥å—ä¸€ä¸ª block å½¢å¼çš„å‚æ•°ï¼Œä»»åŠ¡æ˜¯å¯¹æ¯ä¸€ä¸ªè¿‡æ¥çš„è®¢é˜…è¿›è¡Œå¤„ç†ã€‚ï¼ˆ2ï¼‰ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„æ ·ä¾‹ã€‚ä¸ºæ–¹ä¾¿æ¼”ç¤ºï¼Œè¿™é‡Œå¢žåŠ äº†è®¢é˜…ç›¸å…³ä»£ç ï¼ˆå…³äºŽè®¢é˜…æˆ‘ä¹‹åŽä¼šè¯¦ç»†ä»‹ç»çš„ï¼‰ã€‚123456789101112131415//è¿™ä¸ªblockæœ‰ä¸€ä¸ªå›žè°ƒå‚æ•°observerå°±æ˜¯è®¢é˜…è¿™ä¸ªObservableå¯¹è±¡çš„è®¢é˜…è€…//å½“ä¸€ä¸ªè®¢é˜…è€…è®¢é˜…è¿™ä¸ªObservableå¯¹è±¡çš„æ—¶å€™ï¼Œå°±ä¼šå°†è®¢é˜…è€…ä½œä¸ºå‚æ•°ä¼ å…¥è¿™ä¸ªblockæ¥æ‰§è¡Œä¸€äº›å†…å®¹let observable = Observable&lt;String&gt;.create&#123;observer in //å¯¹è®¢é˜…è€…å‘å‡ºäº†.nextäº‹ä»¶ï¼Œä¸”æºå¸¦äº†ä¸€ä¸ªæ•°æ®"hangge.com" observer.onNext("hangge.com") //å¯¹è®¢é˜…è€…å‘å‡ºäº†.completedäº‹ä»¶ observer.onCompleted() //å› ä¸ºä¸€ä¸ªè®¢é˜…è¡Œä¸ºä¼šæœ‰ä¸€ä¸ªDisposableç±»åž‹çš„è¿”å›žå€¼ï¼Œæ‰€ä»¥åœ¨ç»“å°¾ä¸€å®šè¦returenä¸€ä¸ªDisposable return Disposables.create()&#125; //è®¢é˜…æµ‹è¯•observable.subscribe &#123; print($0)&#125; deferred() æ–¹æ³•è¯¥ä¸ªæ–¹æ³•ç›¸å½“äºŽæ˜¯åˆ›å»ºä¸€ä¸ª Observable å·¥åŽ‚ï¼Œé€šè¿‡ä¼ å…¥ä¸€ä¸ª block æ¥æ‰§è¡Œå»¶è¿Ÿ Observable åºåˆ—åˆ›å»ºçš„è¡Œä¸ºï¼Œè€Œè¿™ä¸ª block é‡Œå°±æ˜¯çœŸæ­£çš„å®žä¾‹åŒ–åºåˆ—å¯¹è±¡çš„åœ°æ–¹ã€‚1234567891011121314151617181920212223242526//ç”¨äºŽæ ‡è®°æ˜¯å¥‡æ•°ã€è¿˜æ˜¯å¶æ•°var isOdd = true //ä½¿ç”¨deferred()æ–¹æ³•å»¶è¿ŸObservableåºåˆ—çš„åˆå§‹åŒ–ï¼Œé€šè¿‡ä¼ å…¥çš„blockæ¥å®žçŽ°Observableåºåˆ—çš„åˆå§‹åŒ–å¹¶ä¸”è¿”å›žã€‚let factory : Observable&lt;Int&gt; = Observable.deferred &#123; //è®©æ¯æ¬¡æ‰§è¡Œè¿™ä¸ªblockæ—¶å€™éƒ½ä¼šè®©å¥‡ã€å¶æ•°è¿›è¡Œäº¤æ›¿ isOdd = !isOdd //æ ¹æ®isOddå‚æ•°ï¼Œå†³å®šåˆ›å»ºå¹¶è¿”å›žçš„æ˜¯å¥‡æ•°Observableã€è¿˜æ˜¯å¶æ•°Observable if isOdd &#123; return Observable.of(1, 3, 5 ,7) &#125;else &#123; return Observable.of(2, 4, 6, 8) &#125;&#125; //ç¬¬1æ¬¡è®¢é˜…æµ‹è¯•factory.subscribe &#123; event in print("\(isOdd)", event)&#125; //ç¬¬2æ¬¡è®¢é˜…æµ‹è¯•factory.subscribe &#123; event in print("\(isOdd)", event)&#125; interval() æ–¹æ³•ï¼ˆ1ï¼‰è¿™ä¸ªæ–¹æ³•åˆ›å»ºçš„ Observable åºåˆ—æ¯éš”ä¸€æ®µè®¾å®šçš„æ—¶é—´ï¼Œä¼šå‘å‡ºä¸€ä¸ªç´¢å¼•æ•°çš„å…ƒç´ ã€‚è€Œä¸”å®ƒä¼šä¸€ç›´å‘é€ä¸‹åŽ»ã€‚ï¼ˆ2ï¼‰ä¸‹é¢æ–¹æ³•è®©å…¶æ¯ 1 ç§’å‘é€ä¸€æ¬¡ï¼Œå¹¶ä¸”æ˜¯åœ¨ä¸»çº¿ç¨‹ï¼ˆMainSchedulerï¼‰å‘é€ã€‚1234let observable = Observable&lt;Int&gt;.interval(1, scheduler: MainScheduler.instance)observable.subscribe &#123; event in print(event)&#125; timer() æ–¹æ³•ï¼ˆ1ï¼‰è¿™ä¸ªæ–¹æ³•æœ‰ä¸¤ç§ç”¨æ³•ï¼Œä¸€ç§æ˜¯åˆ›å»ºçš„ Observable åºåˆ—åœ¨ç»è¿‡è®¾å®šçš„ä¸€æ®µæ—¶é—´åŽï¼Œäº§ç”Ÿå”¯ä¸€çš„ä¸€ä¸ªå…ƒç´ ã€‚12345//5ç§’ç§åŽå‘å‡ºå”¯ä¸€çš„ä¸€ä¸ªå…ƒç´ 0let observable = Observable&lt;Int&gt;.timer(5, scheduler: MainScheduler.instance)observable.subscribe &#123; event in print(event)&#125; ï¼ˆ2ï¼‰å¦ä¸€ç§æ˜¯åˆ›å»ºçš„ Observable åºåˆ—åœ¨ç»è¿‡è®¾å®šçš„ä¸€æ®µæ—¶é—´åŽï¼Œæ¯éš”ä¸€æ®µæ—¶é—´äº§ç”Ÿä¸€ä¸ªå…ƒç´ ã€‚12345//å»¶æ—¶5ç§’ç§åŽï¼Œæ¯éš”1ç§’é’Ÿå‘å‡ºä¸€ä¸ªå…ƒç´ let observable = Observable&lt;Int&gt;.timer(5, period: 1, scheduler: MainScheduler.instance)observable.subscribe &#123; event in print(event)&#125; è®¢é˜… Observableç¬¬ä¸€ç§ç”¨æ³•ï¼šï¼ˆ1ï¼‰æˆ‘ä»¬ä½¿ç”¨ subscribe() è®¢é˜…äº†ä¸€ä¸ª Observable å¯¹è±¡ï¼Œè¯¥æ–¹æ³•çš„ block çš„å›žè°ƒå‚æ•°å°±æ˜¯è¢«å‘å‡ºçš„ event äº‹ä»¶ï¼Œæˆ‘ä»¬å°†å…¶ç›´æŽ¥æ‰“å°å‡ºæ¥ã€‚12345let observable = Observable.of("A", "B", "C") observable.subscribe &#123; event in print(event)&#125; è¾“å…¥ç»“æžœå¯ä»¥çœ‹å‡º åˆå§‹åŒ– Observable åºåˆ—æ—¶è®¾ç½®çš„é»˜è®¤å€¼éƒ½æŒ‰é¡ºåºé€šè¿‡ .next äº‹ä»¶å‘é€å‡ºæ¥ã€‚ å½“ Observable åºåˆ—çš„åˆå§‹æ•°æ®éƒ½å‘é€å®Œæ¯•ï¼Œå®ƒè¿˜ä¼šè‡ªåŠ¨å‘ä¸€ä¸ª .completed äº‹ä»¶å‡ºæ¥ã€‚ ï¼ˆ2ï¼‰å¦‚æžœæƒ³è¦èŽ·å–åˆ°è¿™ä¸ªäº‹ä»¶é‡Œçš„æ•°æ®ï¼Œå¯ä»¥é€šè¿‡ event.element å¾—åˆ°ã€‚12345let observable = Observable.of("A", "B", "C") observable.subscribe &#123; event in print(event.element)&#125; ç¬¬äºŒç§ç”¨æ³•ï¼šï¼ˆ1ï¼‰RxSwift è¿˜æä¾›äº†å¦ä¸€ä¸ª subscribe æ–¹æ³•ï¼Œå®ƒå¯ä»¥æŠŠ event è¿›è¡Œåˆ†ç±»ï¼š é€šè¿‡ä¸åŒçš„ block å›žè°ƒå¤„ç†ä¸åŒç±»åž‹çš„ eventã€‚ï¼ˆå…¶ä¸­ onDisposed è¡¨ç¤ºè®¢é˜…è¡Œä¸ºè¢« dispose åŽçš„å›žè°ƒï¼Œè¿™ä¸ªæˆ‘åŽé¢ä¼šè¯´ï¼‰ åŒæ—¶ä¼šæŠŠ event æºå¸¦çš„æ•°æ®ç›´æŽ¥è§£åŒ…å‡ºæ¥ä½œä¸ºå‚æ•°ï¼Œæ–¹ä¾¿æˆ‘ä»¬ä½¿ç”¨ã€‚1234567891011let observable = Observable.of("A", "B", "C") observable.subscribe(onNext: &#123; element in print(element)&#125;, onError: &#123; error in print(error)&#125;, onCompleted: &#123; print("completed")&#125;, onDisposed: &#123; print("disposed")&#125;) 2ï¼‰subscribe() æ–¹æ³•çš„ onNextã€onErrorã€onCompleted å’Œ onDisposed è¿™å››ä¸ªå›žè°ƒ block å‚æ•°éƒ½æ˜¯æœ‰é»˜è®¤å€¼çš„ï¼Œå³å®ƒä»¬éƒ½æ˜¯å¯é€‰çš„ã€‚æ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥åªå¤„ç† onNext è€Œä¸ç®¡å…¶ä»–çš„æƒ…å†µã€‚12345let observable = Observable.of("A", "B", "C") observable.subscribe(onNext: &#123; element in print(element)&#125;) ç›‘å¬äº‹ä»¶çš„ç”Ÿå‘½å‘¨æœŸ1ã€ doOn ä»‹ç»ï¼ˆ1ï¼‰æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ doOn æ–¹æ³•æ¥ç›‘å¬äº‹ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Œå®ƒä¼šåœ¨æ¯ä¸€æ¬¡äº‹ä»¶å‘é€å‰è¢«è°ƒç”¨ã€‚ï¼ˆ2ï¼‰åŒæ—¶å®ƒå’Œ subscribe ä¸€æ ·ï¼Œå¯ä»¥é€šè¿‡ä¸åŒçš„ block å›žè°ƒå¤„ç†ä¸åŒç±»åž‹çš„ eventã€‚æ¯”å¦‚ï¼š do(onNext:) æ–¹æ³•å°±æ˜¯åœ¨ subscribe(onNext:) å‰è°ƒç”¨ è€Œ do(onCompleted:) æ–¹æ³•åˆ™ä¼šåœ¨ subscribe(onCompleted:) å‰é¢è°ƒç”¨ã€‚ ä½¿ç”¨æ ·ä¾‹123456789101112131415161718192021let observable = Observable.of("A", "B", "C") observable .do(onNext: &#123; element in print("Intercepted Nextï¼š", element) &#125;, onError: &#123; error in print("Intercepted Errorï¼š", error) &#125;, onCompleted: &#123; print("Intercepted Completed") &#125;, onDispose: &#123; print("Intercepted Disposed") &#125;) .subscribe(onNext: &#123; element in print(element) &#125;, onError: &#123; error in print(error) &#125;, onCompleted: &#123; print("completed") &#125;, onDisposed: &#123; print("disposed") &#125;) Observable çš„é”€æ¯ï¼ˆDisposeï¼‰1ã€Observable ä»Žåˆ›å»ºåˆ°ç»ˆç»“æµç¨‹ï¼ˆ1ï¼‰ä¸€ä¸ª Observable åºåˆ—è¢«åˆ›å»ºå‡ºæ¥åŽå®ƒä¸ä¼šé©¬ä¸Šå°±å¼€å§‹è¢«æ¿€æ´»ä»Žè€Œå‘å‡º Eventï¼Œè€Œæ˜¯è¦ç­‰åˆ°å®ƒè¢«æŸä¸ªäººè®¢é˜…äº†æ‰ä¼šæ¿€æ´»å®ƒã€‚ï¼ˆ2ï¼‰è€Œ Observable åºåˆ—æ¿€æ´»ä¹‹åŽè¦ä¸€ç›´ç­‰åˆ°å®ƒå‘å‡ºäº† .error æˆ–è€… .completed çš„ event åŽï¼Œå®ƒæ‰è¢«ç»ˆç»“ã€‚ 2ã€dispose() æ–¹æ³•ï¼ˆ1ï¼‰ä½¿ç”¨è¯¥æ–¹æ³•æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨å–æ¶ˆä¸€ä¸ªè®¢é˜…è¡Œä¸ºã€‚ï¼ˆ2ï¼‰å¦‚æžœæˆ‘ä»¬è§‰å¾—è¿™ä¸ªè®¢é˜…ç»“æŸäº†ä¸å†éœ€è¦äº†ï¼Œå°±å¯ä»¥è°ƒç”¨ dispose() æ–¹æ³•æŠŠè¿™ä¸ªè®¢é˜…ç»™é”€æ¯æŽ‰ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚ï¼ˆ2ï¼‰å½“ä¸€ä¸ªè®¢é˜…è¡Œä¸ºè¢« dispose äº†ï¼Œé‚£ä¹ˆä¹‹åŽ observable å¦‚æžœå†å‘å‡º eventï¼Œè¿™ä¸ªå·²ç» dispose çš„è®¢é˜…å°±æ”¶ä¸åˆ°æ¶ˆæ¯äº†ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä½¿ç”¨æ ·ä¾‹ã€‚123456789let observable = Observable.of("A", "B", "C") //ä½¿ç”¨subscriptionå¸¸é‡å­˜å‚¨è¿™ä¸ªè®¢é˜…æ–¹æ³•let subscription = observable.subscribe &#123; event in print(event)&#125; //è°ƒç”¨è¿™ä¸ªè®¢é˜…çš„dispose()æ–¹æ³•subscription.dispose() 3ã€DisposeBagé™¤äº† dispose() æ–¹æ³•ä¹‹å¤–ï¼Œæˆ‘ä»¬æ›´ç»å¸¸ç”¨åˆ°çš„æ˜¯ä¸€ä¸ªå« DisposeBag çš„å¯¹è±¡æ¥ç®¡ç†å¤šä¸ªè®¢é˜…è¡Œä¸ºçš„é”€æ¯ï¼šæˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ª DisposeBag å¯¹è±¡çœ‹æˆä¸€ä¸ªåžƒåœ¾è¢‹ï¼ŒæŠŠç”¨è¿‡çš„è®¢é˜…è¡Œä¸ºéƒ½æ”¾è¿›åŽ»ã€‚è€Œè¿™ä¸ª DisposeBag å°±ä¼šåœ¨è‡ªå·±å¿«è¦ dealloc çš„æ—¶å€™ï¼Œå¯¹å®ƒé‡Œé¢çš„æ‰€æœ‰è®¢é˜…è¡Œä¸ºéƒ½è°ƒç”¨ dispose() æ–¹æ³•ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä½¿ç”¨æ ·ä¾‹ã€‚12345678910111213let disposeBag = DisposeBag() //ç¬¬1ä¸ªObservableï¼ŒåŠå…¶è®¢é˜…let observable1 = Observable.of("A", "B", "C")observable1.subscribe &#123; event in print(event)&#125;.disposed(by: disposeBag) //ç¬¬2ä¸ªObservableï¼ŒåŠå…¶è®¢é˜…let observable2 = Observable.of(1, 2, 3)observable2.subscribe &#123; event in print(event)&#125;.disposed(by: disposeBag) è§‚å¯Ÿè€…ï¼ˆObserverï¼‰ä»‹ç»è§‚å¯Ÿè€…ï¼ˆObserverï¼‰çš„ä½œç”¨å°±æ˜¯ç›‘å¬äº‹ä»¶ï¼Œç„¶åŽå¯¹è¿™ä¸ªäº‹ä»¶åšå‡ºå“åº”ã€‚æˆ–è€…è¯´ä»»ä½•å“åº”äº‹ä»¶çš„è¡Œä¸ºéƒ½æ˜¯è§‚å¯Ÿè€…ã€‚æ¯”å¦‚ï¼š å½“æˆ‘ä»¬ç‚¹å‡»æŒ‰é’®ï¼Œå¼¹å‡ºä¸€ä¸ªæç¤ºæ¡†ã€‚é‚£ä¹ˆè¿™ä¸ªâ€œå¼¹å‡ºä¸€ä¸ªæç¤ºæ¡†â€å°±æ˜¯è§‚å¯Ÿè€… Observer å½“æˆ‘ä»¬è¯·æ±‚ä¸€ä¸ªè¿œç¨‹çš„ json æ•°æ®åŽï¼Œå°†å…¶æ‰“å°å‡ºæ¥ã€‚é‚£ä¹ˆè¿™ä¸ªâ€œæ‰“å° json æ•°æ®â€å°±æ˜¯è§‚å¯Ÿè€… Observer ç›´æŽ¥åœ¨ subscribeã€bind æ–¹æ³•ä¸­åˆ›å»ºè§‚å¯Ÿè€…1. åœ¨ subscribe æ–¹æ³•ä¸­åˆ›å»ºï¼ˆ1ï¼‰åˆ›å»ºè§‚å¯Ÿè€…æœ€ç›´æŽ¥çš„æ–¹æ³•å°±æ˜¯åœ¨ Observable çš„ subscribe æ–¹æ³•åŽé¢æè¿°å½“äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œéœ€è¦å¦‚ä½•åšå‡ºå“åº”ã€‚ï¼ˆ2ï¼‰æ¯”å¦‚ä¸‹é¢çš„æ ·ä¾‹ï¼Œè§‚å¯Ÿè€…å°±æ˜¯ç”±åŽé¢çš„ onNextï¼ŒonErrorï¼ŒonCompleted è¿™äº›é—­åŒ…æž„å»ºå‡ºæ¥çš„ã€‚123456789let observable = Observable.of("A", "B", "C") observable.subscribe(onNext: &#123; element in print(element)&#125;, onError: &#123; error in print(error)&#125;, onCompleted: &#123; print("completed")&#125;) 2. åœ¨ bind æ–¹æ³•ä¸­åˆ›å»ºä¸‹é¢ä»£ç æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå®šæ—¶ç”Ÿæˆç´¢å¼•æ•°çš„ Observable åºåˆ—ï¼Œå¹¶å°†ç´¢å¼•æ•°ä¸æ–­æ˜¾ç¤ºåœ¨ label æ ‡ç­¾ä¸Šï¼š123456789101112131415161718192021222324import UIKitimport RxSwiftimport RxCocoa class ViewController: UIViewController &#123; @IBOutlet weak var label: UILabel! let disposeBag = DisposeBag() override func viewDidLoad() &#123; //Observableåºåˆ—ï¼ˆæ¯éš”1ç§’é’Ÿå‘å‡ºä¸€ä¸ªç´¢å¼•æ•°ï¼‰ let observable = Observable&lt;Int&gt;.interval(1, scheduler: MainScheduler.instance) observable .map &#123; "å½“å‰ç´¢å¼•æ•°ï¼š\($0 )"&#125; .bind &#123; [weak self](text) in //æ”¶åˆ°å‘å‡ºçš„ç´¢å¼•æ•°åŽæ˜¾ç¤ºåˆ°labelä¸Š self?.label.text = text &#125; .disposed(by: disposeBag) &#125;&#125; ä½¿ç”¨ AnyObserver åˆ›å»ºè§‚å¯Ÿè€…AnyObserver å¯ä»¥ç”¨æ¥æå™ä»»æ„ä¸€ç§è§‚å¯Ÿè€…ã€‚ 1ã€é…åˆ subscribe æ–¹æ³•ä½¿ç”¨æ¯”å¦‚ä¸Šé¢ç¬¬ä¸€ä¸ªæ ·ä¾‹æˆ‘ä»¬å¯ä»¥æ”¹æˆå¦‚ä¸‹ä»£ç ï¼š1234567891011121314//è§‚å¯Ÿè€…let observer: AnyObserver&lt;String&gt; = AnyObserver &#123; (event) in switch event &#123; case .next(let data): print(data) case .error(let error): print(error) case .completed: print("completed") &#125;&#125; let observable = Observable.of("A", "B", "C")observable.subscribe(observer) 2ã€é…åˆ bindTo æ–¹æ³•ä½¿ç”¨ä¹Ÿå¯é…åˆ Observable çš„æ•°æ®ç»‘å®šæ–¹æ³•ï¼ˆbindToï¼‰ä½¿ç”¨ã€‚æ¯”å¦‚ä¸Šé¢çš„ç¬¬äºŒä¸ªæ ·ä¾‹æˆ‘å¯ä»¥æ”¹æˆå¦‚ä¸‹ä»£ç ï¼š12345678910111213141516171819202122232425262728293031import UIKitimport RxSwiftimport RxCocoa class ViewController: UIViewController &#123; @IBOutlet weak var label: UILabel! let disposeBag = DisposeBag() override func viewDidLoad() &#123; //è§‚å¯Ÿè€… let observer: AnyObserver&lt;String&gt; = AnyObserver &#123; [weak self] (event) in switch event &#123; case .next(let text): //æ”¶åˆ°å‘å‡ºçš„ç´¢å¼•æ•°åŽæ˜¾ç¤ºåˆ°labelä¸Š self?.label.text = text default: break &#125; &#125; //Observableåºåˆ—ï¼ˆæ¯éš”1ç§’é’Ÿå‘å‡ºä¸€ä¸ªç´¢å¼•æ•°ï¼‰ let observable = Observable&lt;Int&gt;.interval(1, scheduler: MainScheduler.instance) observable .map &#123; "å½“å‰ç´¢å¼•æ•°ï¼š\($0 )"&#125; .bind(to: observer) .disposed(by: disposeBag) &#125;&#125; ä½¿ç”¨ Binder åˆ›å»ºè§‚å¯Ÿè€…1ã€åŸºæœ¬ä»‹ç»ï¼ˆ1ï¼‰ç›¸è¾ƒäºŽ AnyObserver çš„å¤§è€Œå…¨ï¼ŒBinder æ›´ä¸“æ³¨äºŽç‰¹å®šçš„åœºæ™¯ã€‚Binder ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ä¸ªç‰¹å¾ï¼š ä¸ä¼šå¤„ç†é”™è¯¯äº‹ä»¶ ç¡®ä¿ç»‘å®šéƒ½æ˜¯åœ¨ç»™å®š Scheduler ä¸Šæ‰§è¡Œï¼ˆé»˜è®¤ MainSchedulerï¼‰ ï¼ˆ2ï¼‰ä¸€æ—¦äº§ç”Ÿé”™è¯¯äº‹ä»¶ï¼Œåœ¨è°ƒè¯•çŽ¯å¢ƒä¸‹å°†æ‰§è¡Œ fatalErrorï¼Œåœ¨å‘å¸ƒçŽ¯å¢ƒä¸‹å°†æ‰“å°é”™è¯¯ä¿¡æ¯ã€‚ ä½¿ç”¨æ ·ä¾‹ï¼ˆ1ï¼‰åœ¨ä¸Šé¢åºåˆ—æ•°æ˜¾ç¤ºæ ·ä¾‹ä¸­ï¼Œlabel æ ‡ç­¾çš„æ–‡å­—æ˜¾ç¤ºå°±æ˜¯ä¸€ä¸ªå…¸åž‹çš„ UI è§‚å¯Ÿè€…ã€‚å®ƒåœ¨å“åº”äº‹ä»¶æ—¶ï¼Œåªä¼šå¤„ç† next äº‹ä»¶ï¼Œè€Œä¸”æ›´æ–° UI çš„æ“ä½œéœ€è¦åœ¨ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œã€‚é‚£ä¹ˆè¿™ç§æƒ…å†µä¸‹æ›´å¥½çš„æ–¹æ¡ˆå°±æ˜¯ä½¿ç”¨ Binderã€‚ï¼ˆ2ï¼‰ä¸Šé¢çš„æ ·ä¾‹æˆ‘ä»¬æ”¹ç”¨ Binder ä¼šç®€å•è®¸å¤šï¼š1234567891011121314151617181920212223242526import UIKitimport RxSwiftimport RxCocoa class ViewController: UIViewController &#123; @IBOutlet weak var label: UILabel! let disposeBag = DisposeBag() override func viewDidLoad() &#123; //è§‚å¯Ÿè€… let observer: Binder&lt;String&gt; = Binder(label) &#123; (view, text) in //æ”¶åˆ°å‘å‡ºçš„ç´¢å¼•æ•°åŽæ˜¾ç¤ºåˆ°labelä¸Š view.text = text &#125; //Observableåºåˆ—ï¼ˆæ¯éš”1ç§’é’Ÿå‘å‡ºä¸€ä¸ªç´¢å¼•æ•°ï¼‰ let observable = Observable&lt;Int&gt;.interval(1, scheduler: MainScheduler.instance) observable .map &#123; "å½“å‰ç´¢å¼•æ•°ï¼š\($0 )"&#125; .bind(to: observer) .disposed(by: disposeBag) &#125;&#125; é™„ï¼šBinder åœ¨ RxCocoa ä¸­çš„åº”ç”¨ï¼ˆ1ï¼‰å…¶å®ž RxCocoa åœ¨å¯¹è®¸å¤š UI æŽ§ä»¶è¿›è¡Œæ‰©å±•æ—¶ï¼Œå°±åˆ©ç”¨ Binder å°†æŽ§ä»¶å±žæ€§å˜æˆè§‚æŸ¥è€…ï¼Œæ¯”å¦‚ UIControl+Rx.swift ä¸­çš„ isEnabled å±žæ€§ä¾¿æ˜¯ä¸€ä¸ª observer ï¼š123456789101112import RxSwiftimport UIKit extension Reactive where Base: UIControl &#123; /// Bindable sink for `enabled` property. public var isEnabled: Binder&lt;Bool&gt; &#123; return Binder(self.base) &#123; control, value in control.isEnabled = value &#125; &#125;&#125; ï¼ˆ2ï¼‰å› æ­¤æˆ‘ä»¬å¯ä»¥å°†åºåˆ—ç›´æŽ¥ç»‘å®šåˆ°å®ƒä¸Šé¢ã€‚æ¯”å¦‚ä¸‹é¢æ ·ä¾‹ï¼Œbutton ä¼šåœ¨å¯ç”¨ã€ä¸å¯ç”¨è¿™ä¸¤ç§çŠ¶æ€é—´äº¤æ›¿å˜æ¢ï¼ˆæ¯éš”ä¸€ç§’ï¼‰ã€‚123456//Observableåºåˆ—ï¼ˆæ¯éš”1ç§’é’Ÿå‘å‡ºä¸€ä¸ªç´¢å¼•æ•°ï¼‰let observable = Observable&lt;Int&gt;.interval(1, scheduler: MainScheduler.instance)observable .map &#123; $0 % 2 == 0 &#125; .bind(to: button.rx.isEnabled) .disposed(by: disposeBag) è‡ªå®šä¹‰å¯ç»‘å®šå±žæ€§æœ‰æ—¶æˆ‘ä»¬æƒ³è®© UI æŽ§ä»¶åˆ›å»ºå‡ºæ¥åŽé»˜è®¤å°±æœ‰ä¸€äº›è§‚å¯Ÿè€…ï¼Œè€Œä¸å¿…æ¯æ¬¡éƒ½ä¸ºå®ƒä»¬å•ç‹¬åŽ»åˆ›å»ºè§‚å¯Ÿè€…ã€‚æ¯”å¦‚æˆ‘ä»¬æƒ³è¦è®©æ‰€æœ‰çš„ UIlabel éƒ½æœ‰ä¸ª fontSize å¯ç»‘å®šå±žæ€§ï¼Œå®ƒä¼šæ ¹æ®äº‹ä»¶å€¼è‡ªåŠ¨æ”¹å˜æ ‡ç­¾çš„å­—ä½“å¤§å°ã€‚ æ–¹å¼ä¸€ï¼šé€šè¿‡å¯¹ UI ç±»è¿›è¡Œæ‰©å±•è¿™é‡Œæˆ‘ä»¬é€šè¿‡å¯¹ UILabel è¿›è¡Œæ‰©å±•ï¼Œå¢žåŠ äº†ä¸€ä¸ª fontSize å¯ç»‘å®šå±žæ€§ã€‚12345678910111213141516171819202122232425262728import UIKitimport RxSwiftimport RxCocoa class ViewController: UIViewController &#123; @IBOutlet weak var label: UILabel! let disposeBag = DisposeBag() override func viewDidLoad() &#123; //Observableåºåˆ—ï¼ˆæ¯éš”0.5ç§’é’Ÿå‘å‡ºä¸€ä¸ªç´¢å¼•æ•°ï¼‰ let observable = Observable&lt;Int&gt;.interval(0.5, scheduler: MainScheduler.instance) observable .map &#123; CGFloat($0) &#125; .bind(to: label.fontSize) //æ ¹æ®ç´¢å¼•æ•°ä¸æ–­å˜æ”¾å¤§å­—ä½“ .disposed(by: disposeBag) &#125;&#125; extension UILabel &#123; public var fontSize: Binder&lt;CGFloat&gt; &#123; return Binder(self) &#123; label, fontSize in label.font = UIFont.systemFont(ofSize: fontSize) &#125; &#125;&#125; æ–¹å¼äºŒï¼šé€šè¿‡å¯¹ Reactive ç±»è¿›è¡Œæ‰©å±•æ—¢ç„¶ä½¿ç”¨äº† RxSwiftï¼Œé‚£ä¹ˆæ›´è§„èŒƒçš„å†™æ³•åº”è¯¥æ˜¯å¯¹ Reactive è¿›è¡Œæ‰©å±•ã€‚è¿™é‡ŒåŒæ ·æ˜¯ç»™ UILabel å¢žåŠ äº†ä¸€ä¸ª fontSize å¯ç»‘å®šå±žæ€§ã€‚ï¼ˆæ³¨æ„ï¼šè¿™ç§æ–¹å¼ä¸‹ï¼Œæˆ‘ä»¬ç»‘å®šå±žæ€§æ—¶è¦å†™æˆ label.rx.fontSizeï¼‰12345678910111213141516171819202122232425262728import UIKitimport RxSwiftimport RxCocoa class ViewController: UIViewController &#123; @IBOutlet weak var label: UILabel! let disposeBag = DisposeBag() override func viewDidLoad() &#123; //Observableåºåˆ—ï¼ˆæ¯éš”0.5ç§’é’Ÿå‘å‡ºä¸€ä¸ªç´¢å¼•æ•°ï¼‰ let observable = Observable&lt;Int&gt;.interval(0.5, scheduler: MainScheduler.instance) observable .map &#123; CGFloat($0) &#125; .bind(to: label.rx.fontSize) //æ ¹æ®ç´¢å¼•æ•°ä¸æ–­å˜æ”¾å¤§å­—ä½“ .disposed(by: disposeBag) &#125;&#125; extension Reactive where Base: UILabel &#123; public var fontSize: Binder&lt;CGFloat&gt; &#123; return Binder(self.base) &#123; label, fontSize in label.font = UIFont.systemFont(ofSize: fontSize) &#125; &#125;&#125; RxSwift è‡ªå¸¦çš„å¯ç»‘å®šå±žæ€§ï¼ˆUI è§‚å¯Ÿè€…ï¼‰ï¼ˆ1ï¼‰å…¶å®ž RxSwift å·²ç»ä¸ºæˆ‘ä»¬æä¾›è®¸å¤šå¸¸ç”¨çš„å¯ç»‘å®šå±žæ€§ã€‚æ¯”å¦‚ UILabel å°±æœ‰ text å’Œ attributedText è¿™ä¸¤ä¸ªå¯ç»‘å®šå±žæ€§ã€‚1234567891011121314151617181920import RxSwiftimport UIKit extension Reactive where Base: UILabel &#123; /// Bindable sink for `text` property. public var text: Binder&lt;String?&gt; &#123; return Binder(self.base) &#123; label, text in label.text = text &#125; &#125; /// Bindable sink for `attributedText` property. public var attributedText: Binder&lt;NSAttributedString?&gt; &#123; return Binder(self.base) &#123; label, text in label.attributedText = text &#125; &#125; &#125; ï¼ˆ2ï¼‰é‚£ä¹ˆä¸Šæ–‡é‚£ä¸ªå®šæ—¶æ˜¾ç¤ºç´¢å¼•æ•°çš„æ ·ä¾‹ï¼Œæˆ‘ä»¬å…¶å®žä¸éœ€è¦è‡ªå®šä¹‰ UI è§‚å¯Ÿè€…ï¼Œç›´æŽ¥ä½¿ç”¨ RxSwift æä¾›çš„ç»‘å®šå±žæ€§å³å¯ã€‚1234567891011121314151617181920import UIKitimport RxSwiftimport RxCocoa class ViewController: UIViewController &#123; @IBOutlet weak var label: UILabel! let disposeBag = DisposeBag() override func viewDidLoad() &#123; //Observableåºåˆ—ï¼ˆæ¯éš”1ç§’é’Ÿå‘å‡ºä¸€ä¸ªç´¢å¼•æ•°ï¼‰ let observable = Observable&lt;Int&gt;.interval(1, scheduler: MainScheduler.instance) observable .map &#123; "å½“å‰ç´¢å¼•æ•°ï¼š\($0 )"&#125; .bind(to: label.rx.text) //æ”¶åˆ°å‘å‡ºçš„ç´¢å¼•æ•°åŽæ˜¾ç¤ºåˆ°labelä¸Š .disposed(by: disposeBag) &#125;&#125; Subjects ä»‹ç»Subjects åŸºæœ¬ä»‹ç»ï¼ˆ1ï¼‰Subjects æ—¢æ˜¯è®¢é˜…è€…ï¼Œä¹Ÿæ˜¯ Observableï¼š è¯´å®ƒæ˜¯è®¢é˜…è€…ï¼Œæ˜¯å› ä¸ºå®ƒèƒ½å¤ŸåŠ¨æ€åœ°æŽ¥æ”¶æ–°çš„å€¼ã€‚ è¯´å®ƒåˆæ˜¯ä¸€ä¸ª Observableï¼Œæ˜¯å› ä¸ºå½“ Subjects æœ‰äº†æ–°çš„å€¼ä¹‹åŽï¼Œå°±ä¼šé€šè¿‡ Event å°†æ–°å€¼å‘å‡ºç»™ä»–çš„æ‰€æœ‰è®¢é˜…è€…ã€‚ ï¼ˆ2ï¼‰ä¸€å…±æœ‰å››ç§ Subjectsï¼Œåˆ†åˆ«ä¸ºï¼šPublishSubjectã€BehaviorSubjectã€ReplaySubjectã€Variableã€‚ä»–ä»¬ä¹‹é—´æ—¢æœ‰å„è‡ªçš„ç‰¹ç‚¹ï¼Œä¹Ÿæœ‰ç›¸åŒä¹‹å¤„ï¼š é¦–å…ˆä»–ä»¬éƒ½æ˜¯ Observableï¼Œä»–ä»¬çš„è®¢é˜…è€…éƒ½èƒ½æ”¶åˆ°ä»–ä»¬å‘å‡ºçš„æ–°çš„ Eventã€‚ ç›´åˆ° Subject å‘å‡º .complete æˆ–è€… .error çš„ Event åŽï¼Œè¯¥ Subject ä¾¿ç»ˆç»“äº†ï¼ŒåŒæ—¶å®ƒä¹Ÿå°±ä¸ä¼šå†å‘å‡º .next äº‹ä»¶ã€‚ å¯¹äºŽé‚£äº›åœ¨ Subject ç»ˆç»“åŽå†è®¢é˜…ä»–çš„è®¢é˜…è€…ï¼Œä¹Ÿèƒ½æ”¶åˆ° subject å‘å‡ºçš„ä¸€æ¡ .complete æˆ– .error çš„ eventï¼Œå‘Šè¯‰è¿™ä¸ªæ–°çš„è®¢é˜…è€…å®ƒå·²ç»ç»ˆç»“äº†ã€‚ ä»–ä»¬ä¹‹é—´æœ€å¤§çš„åŒºåˆ«åªæ˜¯åœ¨äºŽï¼šå½“ä¸€ä¸ªæ–°çš„è®¢é˜…è€…åˆšè®¢é˜…å®ƒçš„æ—¶å€™ï¼Œèƒ½ä¸èƒ½æ”¶åˆ° Subject ä»¥å‰å‘å‡ºè¿‡çš„æ—§ Eventï¼Œå¦‚æžœèƒ½çš„è¯åˆèƒ½æ”¶åˆ°å¤šå°‘ä¸ªã€‚ ï¼ˆ3ï¼‰Subject å¸¸ç”¨çš„å‡ ä¸ªæ–¹æ³•ï¼š onNext(:)ï¼šæ˜¯ on(.next(:)) çš„ç®€ä¾¿å†™æ³•ã€‚è¯¥æ–¹æ³•ç›¸å½“äºŽ subject æŽ¥æ”¶åˆ°ä¸€ä¸ª .next äº‹ä»¶ã€‚ onError(:)ï¼šæ˜¯ on(.error(:)) çš„ç®€ä¾¿å†™æ³•ã€‚è¯¥æ–¹æ³•ç›¸å½“äºŽ subject æŽ¥æ”¶åˆ°ä¸€ä¸ª .error äº‹ä»¶ã€‚ onCompleted()ï¼šæ˜¯ on(.completed) çš„ç®€ä¾¿å†™æ³•ã€‚è¯¥æ–¹æ³•ç›¸å½“äºŽ subject æŽ¥æ”¶åˆ°ä¸€ä¸ª .completed äº‹ä»¶ã€‚ PublishSubjectï¼ˆ1ï¼‰åŸºæœ¬ä»‹ç» PublishSubject æ˜¯æœ€æ™®é€šçš„ Subjectï¼Œå®ƒä¸éœ€è¦åˆå§‹å€¼å°±èƒ½åˆ›å»ºã€‚ PublishSubject çš„è®¢é˜…è€…ä»Žä»–ä»¬å¼€å§‹è®¢é˜…çš„æ—¶é—´ç‚¹èµ·ï¼Œå¯ä»¥æ”¶åˆ°è®¢é˜…åŽ Subject å‘å‡ºçš„æ–° Eventï¼Œè€Œä¸ä¼šæ”¶åˆ°ä»–ä»¬åœ¨è®¢é˜…å‰å·²å‘å‡ºçš„ Eventã€‚ï¼ˆ2ï¼‰æ—¶åºå›¾ æœ€ä¸Šé¢ä¸€æ¡æ˜¯ BehaviorSubjectã€‚-ä¸‹é¢ä¸¤æ¡åˆ†åˆ«è¡¨ç¤ºä¸¤ä¸ªæ–°çš„è®¢é˜…ï¼Œå®ƒä»¬è®¢é˜…çš„æ—¶é—´ç‚¹ä¸åŒï¼Œå¯ä»¥å‘çŽ° BehaviorSubject çš„è®¢é˜…è€…ä¸€å¼€å§‹å°±èƒ½æ”¶åˆ° BehaviorSubjects ä¹‹å‰å‘å‡ºçš„ä¸€ä¸ª Eventã€‚ï¼ˆ3ï¼‰ä½¿ç”¨æ ·ä¾‹1234567891011121314151617181920let disposeBag = DisposeBag() //åˆ›å»ºä¸€ä¸ªBehaviorSubjectlet subject = BehaviorSubject(value: "111") //ç¬¬1æ¬¡è®¢é˜…subjectsubject.subscribe &#123; event in print("ç¬¬1æ¬¡è®¢é˜…ï¼š", event)&#125;.disposed(by: disposeBag) //å‘é€nextäº‹ä»¶subject.onNext("222") //å‘é€erroräº‹ä»¶subject.onError(NSError(domain: "local", code: 0, userInfo: nil)) //ç¬¬2æ¬¡è®¢é˜…subjectsubject.subscribe &#123; event in print("ç¬¬2æ¬¡è®¢é˜…ï¼š", event)&#125;.disposed(by: disposeBag) ReplaySubjectï¼ˆ1ï¼‰åŸºæœ¬ä»‹ç» ReplaySubject åœ¨åˆ›å»ºæ—¶å€™éœ€è¦è®¾ç½®ä¸€ä¸ª bufferSizeï¼Œè¡¨ç¤ºå®ƒå¯¹äºŽå®ƒå‘é€è¿‡çš„ event çš„ç¼“å­˜ä¸ªæ•°ã€‚ æ¯”å¦‚ä¸€ä¸ª ReplaySubject çš„ bufferSize è®¾ç½®ä¸º 2ï¼Œå®ƒå‘å‡ºäº† 3 ä¸ª .next çš„ eventï¼Œé‚£ä¹ˆå®ƒä¼šå°†åŽä¸¤ä¸ªï¼ˆæœ€è¿‘çš„ä¸¤ä¸ªï¼‰event ç»™ç¼“å­˜èµ·æ¥ã€‚æ­¤æ—¶å¦‚æžœæœ‰ä¸€ä¸ª subscriber è®¢é˜…äº†è¿™ä¸ª ReplaySubjectï¼Œé‚£ä¹ˆè¿™ä¸ª subscriber å°±ä¼šç«‹å³æ”¶åˆ°å‰é¢ç¼“å­˜çš„ä¸¤ä¸ª .next çš„ eventã€‚ å¦‚æžœä¸€ä¸ª subscriber è®¢é˜…å·²ç»ç»“æŸçš„ ReplaySubjectï¼Œé™¤äº†ä¼šæ”¶åˆ°ç¼“å­˜çš„ .next çš„ event å¤–ï¼Œè¿˜ä¼šæ”¶åˆ°é‚£ä¸ªç»ˆç»“çš„ .error æˆ–è€… .complete çš„ eventã€‚ ï¼ˆ2ï¼‰æ—¶åºå›¾ æœ€ä¸Šé¢ä¸€æ¡æ˜¯ ReplaySubjectï¼ˆbufferSize è®¾ä¸ºä¸º 2ï¼‰ã€‚ ä¸‹é¢ä¸¤æ¡åˆ†åˆ«è¡¨ç¤ºä¸¤ä¸ªæ–°çš„è®¢é˜…ï¼Œå®ƒä»¬è®¢é˜…çš„æ—¶é—´ç‚¹ä¸åŒã€‚å¯ä»¥å‘çŽ° ReplaySubject çš„è®¢é˜…è€…ä¸€å¼€å§‹å°±èƒ½æ”¶åˆ° ReplaySubject ä¹‹å‰å‘å‡ºçš„ä¸¤ä¸ª Eventï¼ˆå¦‚æžœæœ‰çš„è¯ï¼‰ã€‚ï¼ˆ3ï¼‰ä½¿ç”¨æ ·ä¾‹123456789101112131415161718192021222324252627282930let disposeBag = DisposeBag() //åˆ›å»ºä¸€ä¸ªbufferSizeä¸º2çš„ReplaySubjectlet subject = ReplaySubject&lt;String&gt;.create(bufferSize: 2) //è¿žç»­å‘é€3ä¸ªnextäº‹ä»¶subject.onNext("111")subject.onNext("222")subject.onNext("333") //ç¬¬1æ¬¡è®¢é˜…subjectsubject.subscribe &#123; event in print("ç¬¬1æ¬¡è®¢é˜…ï¼š", event)&#125;.disposed(by: disposeBag) //å†å‘é€1ä¸ªnextäº‹ä»¶subject.onNext("444") //ç¬¬2æ¬¡è®¢é˜…subjectsubject.subscribe &#123; event in print("ç¬¬2æ¬¡è®¢é˜…ï¼š", event)&#125;.disposed(by: disposeBag) //è®©subjectç»“æŸsubject.onCompleted() //ç¬¬3æ¬¡è®¢é˜…subjectsubject.subscribe &#123; event in print("ç¬¬3æ¬¡è®¢é˜…ï¼š", event)&#125;.disposed(by: disposeBag) Variableï¼ˆæ³¨æ„ï¼šç”±äºŽ Variable åœ¨ä¹‹åŽç‰ˆæœ¬ä¸­å°†è¢«åºŸå¼ƒï¼Œå»ºè®®ä½¿ç”¨ Varible çš„åœ°æ–¹éƒ½æ”¹ç”¨ä¸‹é¢ä»‹ç»çš„ BehaviorRelay ä½œä¸ºæ›¿ä»£ã€‚ï¼‰ï¼ˆ1ï¼‰åŸºæœ¬ä»‹ç» Variable å…¶å®žå°±æ˜¯å¯¹ BehaviorSubject çš„å°è£…ï¼Œæ‰€ä»¥å®ƒä¹Ÿå¿…é¡»è¦é€šè¿‡ä¸€ä¸ªé»˜è®¤çš„åˆå§‹å€¼è¿›è¡Œåˆ›å»ºã€‚ Variable å…·æœ‰ BehaviorSubject çš„åŠŸèƒ½ï¼Œèƒ½å¤Ÿå‘å®ƒçš„è®¢é˜…è€…å‘å‡ºä¸Šä¸€ä¸ª event ä»¥åŠä¹‹åŽæ–°åˆ›å»ºçš„ eventã€‚ ä¸åŒçš„æ˜¯ï¼ŒVariable è¿˜æŠŠä¼šæŠŠå½“å‰å‘å‡ºçš„å€¼ä¿å­˜ä¸ºè‡ªå·±çš„çŠ¶æ€ã€‚åŒæ—¶å®ƒä¼šåœ¨é”€æ¯æ—¶è‡ªåŠ¨å‘é€ .complete çš„ eventï¼Œä¸éœ€è¦ä¹Ÿä¸èƒ½æ‰‹åŠ¨ç»™ Variables å‘é€ completed æˆ–è€… error äº‹ä»¶æ¥ç»“æŸå®ƒã€‚ ç®€å•åœ°è¯´å°±æ˜¯ Variable æœ‰ä¸€ä¸ª value å±žæ€§ï¼Œæˆ‘ä»¬æ”¹å˜è¿™ä¸ª value å±žæ€§çš„å€¼å°±ç›¸å½“äºŽè°ƒç”¨ä¸€èˆ¬ Subjects çš„ onNext() æ–¹æ³•ï¼Œè€Œè¿™ä¸ªæœ€æ–°çš„ onNext() çš„å€¼å°±è¢«ä¿å­˜åœ¨ value å±žæ€§é‡Œäº†ï¼Œç›´åˆ°æˆ‘ä»¬å†æ¬¡ä¿®æ”¹å®ƒã€‚ æ³¨æ„ï¼šVariables æœ¬èº«æ²¡æœ‰ subscribe() æ–¹æ³•ï¼Œä½†æ˜¯æ‰€æœ‰ Subjects éƒ½æœ‰ä¸€ä¸ª asObservable() æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•è¿”å›žè¿™ä¸ª Variable çš„ Observable ç±»åž‹ï¼Œæ‹¿åˆ°è¿™ä¸ª Observable ç±»åž‹æˆ‘ä»¬å°±èƒ½è®¢é˜…å®ƒäº†ã€‚ ï¼ˆ2ï¼‰ä½¿ç”¨æ ·ä¾‹12345678910111213141516171819202122232425262728293031323334import UIKitimport RxSwiftimport RxCocoa class ViewController: UIViewController &#123; override func viewDidLoad() &#123; super.viewDidLoad() let disposeBag = DisposeBag() //åˆ›å»ºä¸€ä¸ªåˆå§‹å€¼ä¸º111çš„Variable let variable = Variable("111") //ä¿®æ”¹valueå€¼ variable.value = "222" //ç¬¬1æ¬¡è®¢é˜… variable.asObservable().subscribe &#123; print("ç¬¬1æ¬¡è®¢é˜…ï¼š", $0) &#125;.disposed(by: disposeBag) //ä¿®æ”¹valueå€¼ variable.value = "333" //ç¬¬2æ¬¡è®¢é˜… variable.asObservable().subscribe &#123; print("ç¬¬2æ¬¡è®¢é˜…ï¼š", $0) &#125;.disposed(by: disposeBag) //ä¿®æ”¹valueå€¼ variable.value = "444" &#125;&#125; BehaviorRelayï¼ˆ1ï¼‰åŸºæœ¬ä»‹ç» BehaviorRelay æ˜¯ä½œä¸º Variable çš„æ›¿ä»£è€…å‡ºçŽ°çš„ã€‚å®ƒçš„æœ¬è´¨å…¶å®žä¹Ÿæ˜¯å¯¹ BehaviorSubject çš„å°è£…ï¼Œæ‰€ä»¥å®ƒä¹Ÿå¿…é¡»è¦é€šè¿‡ä¸€ä¸ªé»˜è®¤çš„åˆå§‹å€¼è¿›è¡Œåˆ›å»ºã€‚ BehaviorRelay å…·æœ‰ BehaviorSubject çš„åŠŸèƒ½ï¼Œèƒ½å¤Ÿå‘å®ƒçš„è®¢é˜…è€…å‘å‡ºä¸Šä¸€ä¸ª event ä»¥åŠä¹‹åŽæ–°åˆ›å»ºçš„ eventã€‚ ä¸Ž BehaviorSubject ä¸åŒçš„æ˜¯ï¼Œä¸éœ€è¦ä¹Ÿä¸èƒ½æ‰‹åŠ¨ç»™ BehaviorReply å‘é€ completed æˆ–è€… error äº‹ä»¶æ¥ç»“æŸå®ƒï¼ˆBehaviorRelay ä¼šåœ¨é”€æ¯æ—¶ä¹Ÿä¸ä¼šè‡ªåŠ¨å‘é€ .complete çš„ eventï¼‰ã€‚ BehaviorRelay æœ‰ä¸€ä¸ª value å±žæ€§ï¼Œæˆ‘ä»¬é€šè¿‡è¿™ä¸ªå±žæ€§å¯ä»¥èŽ·å–æœ€æ–°å€¼ã€‚è€Œé€šè¿‡å®ƒçš„ accept() æ–¹æ³•å¯ä»¥å¯¹å€¼è¿›è¡Œä¿®æ”¹ã€‚ ï¼ˆ2ï¼‰ä¸Šé¢çš„ Variable æ ·ä¾‹æˆ‘ä»¬å¯ä»¥æ”¹ç”¨æˆ BehaviorRelayï¼Œä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031323334import UIKitimport RxSwiftimport RxCocoa class ViewController: UIViewController &#123; override func viewDidLoad() &#123; super.viewDidLoad() let disposeBag = DisposeBag() //åˆ›å»ºä¸€ä¸ªåˆå§‹å€¼ä¸º111çš„BehaviorRelay let subject = BehaviorRelay&lt;String&gt;(value: "111") //ä¿®æ”¹valueå€¼ subject.accept("222") //ç¬¬1æ¬¡è®¢é˜… subject.asObservable().subscribe &#123; print("ç¬¬1æ¬¡è®¢é˜…ï¼š", $0) &#125;.disposed(by: disposeBag) //ä¿®æ”¹valueå€¼ subject.accept("333") //ç¬¬2æ¬¡è®¢é˜… subject.asObservable().subscribe &#123; print("ç¬¬2æ¬¡è®¢é˜…ï¼š", $0) &#125;.disposed(by: disposeBag) //ä¿®æ”¹valueå€¼ subject.accept("444") &#125;&#125; ï¼ˆ3ï¼‰å¦‚æžœæƒ³å°†æ–°å€¼åˆå¹¶åˆ°åŽŸå€¼ä¸Šï¼Œå¯ä»¥é€šè¿‡ accept() æ–¹æ³•ä¸Ž value å±žæ€§é…åˆæ¥å®žçŽ°ã€‚ï¼ˆè¿™ä¸ªå¸¸ç”¨åœ¨è¡¨æ ¼ä¸Šæ‹‰åŠ è½½åŠŸèƒ½ä¸Šï¼ŒBehaviorRelay ç”¨æ¥ä¿å­˜æ‰€æœ‰åŠ è½½åˆ°çš„æ•°æ®ï¼‰12345678910111213141516171819202122232425262728293031323334import UIKitimport RxSwiftimport RxCocoa class ViewController: UIViewController &#123; override func viewDidLoad() &#123; super.viewDidLoad() let disposeBag = DisposeBag() //åˆ›å»ºä¸€ä¸ªåˆå§‹å€¼ä¸ºåŒ…å«ä¸€ä¸ªå…ƒç´ çš„æ•°ç»„çš„BehaviorRelay let subject = BehaviorRelay&lt;[String]&gt;(value: ["1"]) //ä¿®æ”¹valueå€¼ subject.accept(subject.value + ["2", "3"]) //ç¬¬1æ¬¡è®¢é˜… subject.asObservable().subscribe &#123; print("ç¬¬1æ¬¡è®¢é˜…ï¼š", $0) &#125;.disposed(by: disposeBag) //ä¿®æ”¹valueå€¼ subject.accept(subject.value + ["4", "5"]) //ç¬¬2æ¬¡è®¢é˜… subject.asObservable().subscribe &#123; print("ç¬¬2æ¬¡è®¢é˜…ï¼š", $0) &#125;.disposed(by: disposeBag) //ä¿®æ”¹valueå€¼ subject.accept(subject.value + ["6", "7"]) &#125;&#125;]]></content>
  </entry>
  <entry>
    <title><![CDATA[CALayerçš„å±žæ€§å’Œä½¿ç”¨(æœªå®Œç»“)]]></title>
    <url>%2F2018%2F11%2F23%2FCALayer%E7%9A%84%E5%B1%9E%E6%80%A7%E5%92%8C%E4%BD%BF%E7%94%A8(%E6%9C%AA%E5%AE%8C%E7%BB%93)%2F</url>
    <content type="text"><![CDATA[ä¸€ã€CALayerçš„å¸¸ç”¨å±žæ€§ 1ã€@propertyCGPoint position;å›¾å±‚ä¸­å¿ƒç‚¹çš„ä½ç½®ï¼Œç±»ä¼¼ä¸ŽUIViewçš„centerï¼›ç”¨æ¥è®¾ç½®CALayeråœ¨çˆ¶å±‚ä¸­çš„ä½ç½®ï¼›ä»¥çˆ¶å±‚çš„å·¦ä¸Šè§’ä¸ºåŽŸç‚¹ï¼ˆ0ï¼Œ0ï¼‰ 2ã€ @property CGPoint anchorPoint;ç§°ã€Žå®šä½ç‚¹ã€ã€ã€Žé”šç‚¹ã€ï¼Œè¯¥æè¿°æ˜¯ç›¸å¯¹äºŽxã€yä½ç½®æ¯”ä¾‹è€Œè¨€çš„é»˜è®¤åœ¨å›¾åƒä¸­å¿ƒç‚¹ï¼ˆ0.5ã€0.5ï¼‰çš„ä½ç½®ï¼›å†³å®šç€CALayerèº«ä¸Šçš„å“ªä¸ªç‚¹ä¼šå†positionå±žæ€§æ‰€æŒ‡çš„ä½ç½®ï¼Œä»¥è‡ªå·±çš„å·¦ä¸Šè§’ä¸ºåŽŸç‚¹ï¼ˆ0ï¼Œ0ï¼‰ï¼›å®ƒçš„xã€yå–å€¼èŒƒå›´éƒ½æ˜¯0~1 3ã€ @property(nullable) CGColorRef backgroundColorå›¾å±‚èƒŒæ™¯é¢œè‰² 4ã€ @property(nullable) CGColorRef borderColorå›¾å±‚è¾¹æ¡†é¢œè‰² 5ã€ @property CGFloat borderWidthå›¾å±‚è¾¹æ¡†å®½åº¦ 6ã€ @property CGRect boundså›¾å±‚å¤§å° 7ã€ @property(nullable, strong) id contentså›¾å±‚æ˜¾ç¤ºå†…å®¹ï¼Œä¾‹å¦‚å¯ä»¥å°†å›¾ç‰‡ä½œä¸ºå›¾å±‚å†…å®¹æ˜¾ç¤º 8ã€ @property CGRect contentsRectå›¾å±‚æ˜¾ç¤ºå†…å®¹çš„å¤§å°å’Œä½ç½® 9ã€ @property CGFloat cornerRadiusåœ†è§’åŠå¾„ 10ã€ @property(getter=isDoubleSided) BOOL doubleSidedå›¾å±‚èƒŒæ™¯æ˜¯å¦æ˜¾ç¤ºï¼Œé»˜è®¤æ˜¯YES 11ã€ @property CGRect frameå›¾å±‚å¤§å°å’Œä½ç½®ï¼Œä¸æ”¯æŒéšå¼åŠ¨ç”»ï¼Œæ‰€ä»¥CALyaerä¸­å¾ˆå°‘ä½¿ç”¨frameï¼Œé€šå¸¸ä½¿ç”¨boundå’Œpositionä»£æ›¿ 12ã€ @property(getter=isHidden) BOOL hiddenæ˜¯å¦éšè— 13ã€ @property(nullable, strong) CALayer *maskå›¾å±‚è’™ç‰ˆ 14ã€ @property BOOL masksToBoundså­å›¾å±‚æ˜¯å¦å‰ªåˆ‡å›¾å±‚è¾¹ç•Œï¼Œé»˜è®¤æ˜¯NO 15ã€ @property float opacit;å›¾å±‚é€æ˜Žåº¦ï¼Œç±»ä¼¼ä¸ŽUIViewçš„alpha 16ã€ @property(nullable) CGColorRef shadowColoré˜´å½±é¢œè‰² 17ã€ @property CGSize shadowOffseté˜´å½±åç§»é‡ 18ã€ @property float shadowOpacityé˜´å½±é€æ˜Žåº¦ï¼Œæ³¨æ„é»˜è®¤ä¸º0ï¼Œå¦‚æžœè®¾ç½®é˜´å½±å¿…é¡»è®¾ç½®æ­¤å±žæ€§ 19ã€ @property(nullable) CGPathRef shadowPathé˜´å½±å½¢çŠ¶ 20ã€ @property CGFloat shadowRadiusé˜´å½±æ¨¡ç³ŠåŠå¾„ 21ã€ @property(nullable, copy) NSArray äºŒã€CALayerä¸å¸¸ç”¨å±žæ€§ 1ã€ @property CGFloat zPositionå›¾å±‚ä¸­å¿ƒç‚¹åœ¨zè½´ä¸­çš„ä½ç½® 2ã€ @property CGFloat anchorPointZå›¾å±‚åœ¨zè½´ä¸­çš„é”šç‚¹ï¼› 3ã€ - (CGAffineTransform)affineTransform 4ã€- (void)setAffineTransform:(CGAffineTransform)mä»¥ä¸Šå±žæ€§ä¸ºå›¾å±‚å½¢å˜ï¼›è¯¥å±žæ€§å€¼æŒ‡å®šä¸€ä¸ªCGAffineTransformå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä»£è¡¨å¯¹CALayeræ‰§è¡ŒXã€Yä¸¤ä¸ªç»´åº¦ï¼ˆä¹Ÿå°±æ˜¯å¹³é¢ï¼‰ä¸Šçš„æ—‹è½¬ã€ç¼©æ”¾ã€ä½ç§»ã€æ–œåˆ‡ã€é•œåƒç­‰å˜æ¢çŸ©é˜µ 5ã€ @property(nullable, readonly) CALayer *superlayerå›¾å±‚çš„çˆ¶å›¾å±‚ ä¸‰ã€CALayerå›¾å±‚æ“ä½œ 1ã€ - (void)addSublayer:(CALayer *)layeræ·»åŠ å­å›¾å±‚ 2ã€ - (void)removeFromSuperlayerå°†è‡ªå·±ä»Žçˆ¶å›¾å±‚ä¸­ç§»é™¤ 3ã€ - (void)insertSublayer:(CALayer *)layer atIndex:(unsigned)idxåœ¨è‡ªå·±å­å›¾å±‚æ•°ç»„ä¸­çš„ç¬¬idxä½ç½®æ·»åŠ å›¾å±‚ 4ã€ - (void)insertSublayer:(CALayer )layer below:(nullable CALayer )siblingå°†å›¾å±‚layeræ·»åŠ åœ¨å­å›¾å±‚siblingçš„ä¸‹é¢ 5ã€ - (void)insertSublayer:(CALayer )layer above:(nullable CALayer )siblingå°†å›¾å±‚layeræ·»åŠ åœ¨å­å›¾å±‚siblingçš„ä¸Šé¢ 6ã€ - (void)replaceSublayer:(CALayer )layer with:(CALayer )layer2å°†å›¾å±‚layeræ›¿æ¢layer2ï¼› å››ã€CALayeråŠ¨ç”»æ“ä½œ 1ã€ - (void)addAnimation:(CAAnimation )anim forKey:(nullable NSString )keyå›¾å±‚æ·»åŠ æŸä¸€å±žæ€§çš„åŠ¨ç”» 2ã€ - (nullable NSArray&lt; NSString &gt; )animationKeysèŽ·å–æ‰€æœ‰åŠ¨ç”»çš„å±žæ€§ 3ã€ - (nullable CAAnimation )animationForKey:(NSString )keyèŽ·å–æŸä¸€å±žæ€§çš„åŠ¨ç”» 4ã€ - (void)removeAnimationForKey:(NSString *)keyç§»é™¤æŸä¸€å±žæ€§åŠ¨ç”» 5ã€ - (void)removeAllAnimationsç§»é™¤æ‰€æœ‰åŠ¨ç”» äº”ã€CALayerå­ç±»å…¶ä»–è¯´æ˜Ž å­ç±»åç§° ç”¨é€” CAEmitterLayer å‘å°„å™¨å±‚ï¼Œç”¨æ¥æŽ§åˆ¶ç²’å­æ•ˆæžœ CAGradientLayer æ¢¯åº¦å±‚ï¼Œé¢œè‰²æ¸å˜ CAEAGLayer ç”¨OpenGL ESç»˜åˆ¶çš„å±‚ CAReplicationLayer ç”¨æ¥è‡ªåŠ¨å¤åˆ¶sublayer CAShapeLayer ç»˜åˆ¶ç«‹ä½“çš„è´å¡žå°”æ›²çº¿ CAScrollLayer ç”¨æ¥ç®¡ç†å¯æ»‘åŠ¨çš„åŒºåŸŸ CATextLayer å¯ä»¥ç»˜åˆ¶AttributeString CATiledLayer ç”¨æ¥ç®¡ç†ä¸€å‰¯å¯ä»¥è¢«åˆ†å‰²çš„å¤§å›¾ CATransformLayer ç”¨æ¥æ¸²æŸ“3D layerçš„å±‚æ¬¡ç»“æž„ 1. CAShapeLayerCAShapeLayerå±žäºŽQuartzCoreæ¡†æž¶ï¼Œç»§æ‰¿è‡ªCALayerã€‚CAShapeLayeræ˜¯åœ¨åæ ‡ç³»å†…ç»˜åˆ¶è´å¡žå°”æ›²çº¿çš„ï¼Œé€šè¿‡ç»˜åˆ¶è´å¡žå°”æ›²çº¿ï¼Œè®¾ç½®shape(å½¢çŠ¶)çš„path(è·¯å¾„)ï¼Œä»Žè€Œç»˜åˆ¶å„ç§å„æ ·çš„å›¾å½¢ä»¥åŠä¸è§„åˆ™å›¾å½¢ã€‚å› æ­¤ï¼Œä½¿ç”¨CAShapeLayeréœ€è¦ä¸ŽUIBezierPathä¸€èµ·ä½¿ç”¨ã€‚UIBezierPathç±»å…è®¸ä½ åœ¨è‡ªå®šä¹‰çš„ View ä¸­ç»˜åˆ¶å’Œæ¸²æŸ“ç”±ç›´çº¿å’Œæ›²çº¿ç»„æˆçš„è·¯å¾„.ã€‚ä½ å¯ä»¥åœ¨åˆå§‹åŒ–çš„æ—¶å€™ç›´æŽ¥ä¸ºä½ çš„UIBezierPathæŒ‡å®šä¸€ä¸ªå‡ ä½•å›¾å½¢ã€‚é€šä¿—ç‚¹å°±æ˜¯UIBezierPathç”¨æ¥æŒ‡å®šç»˜åˆ¶å›¾å½¢è·¯å¾„ï¼Œè€ŒCAShapeLayerå°±æ˜¯æ ¹æ®è·¯å¾„æ¥ç»˜å›¾çš„ã€‚ å±žæ€§ 1ã€@property(nullable) CGPathRef path; å‘ˆçŽ°çš„å½¢çŠ¶çš„è·¯å¾„ 2ã€@property(nullable) CGColorRef fillColor;å¡«å……è·¯å¾„çš„é¢œè‰² 3ã€@property(copy) CAShapeLayerFillRule fillRule; å½“åœ¨å¡«å……é¢œè‰²çš„æ—¶å€™åˆ™å°±éœ€è¦è¿™ç§å¡«å……è§„åˆ™ï¼Œå€¼æœ‰ä¸¤ç§ï¼Œéžé›¶å’Œå¥‡å¶æ•°ï¼Œä½†é»˜è®¤æ˜¯éžé›¶å€¼ã€‚ 4ã€@property(nullable) CGColorRef strokeColor;è®¾ç½®æè¾¹è‰²ï¼Œé»˜è®¤æ— è‰²ã€‚ 5ã€@property CGFloat strokeStart; ç»˜åˆ¶è¾¹çº¿è½®å»“è·¯å¾„çš„å­åŒºåŸŸã€‚è¯¥å€¼å¿…é¡»åœ¨[0,1]èŒƒå›´ï¼Œ0ä»£è¡¨è·¯å¾„çš„å¼€å§‹ï¼Œ1ä»£è¡¨è·¯å¾„çš„ç»“æŸã€‚ é»˜è®¤ä¸º0 6ã€@property CGFloat strokeEnd; é»˜è®¤ä¸º1 7ã€@property CGFloat lineWidth; çº¿çš„å®½åº¦ é»˜è®¤ä¸º1 8ã€@property CGFloat miterLimit;æœ€å¤§æ–œæŽ¥é•¿åº¦ã€‚æ–œæŽ¥é•¿åº¦æŒ‡çš„æ˜¯åœ¨ä¸¤æ¡çº¿äº¤æ±‡å¤„å’Œå¤–äº¤ä¹‹é—´çš„è·ç¦»ã€‚åªæœ‰lineJoinå±žæ€§ä¸ºkCALineJoinMiteræ—¶miterLimitæ‰æœ‰æ•ˆã€‚è¾¹è§’çš„è§’åº¦è¶Šå°ï¼Œæ–œæŽ¥é•¿åº¦å°±ä¼šè¶Šå¤§ã€‚ä¸ºäº†é¿å…æ–œæŽ¥é•¿åº¦è¿‡é•¿ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨miterLimitå±žæ€§ã€‚å¦‚æžœæ–œæŽ¥é•¿åº¦è¶…è¿‡miterLimitçš„å€¼ï¼Œè¾¹è§’ä¼šä»¥lineJoinçš„â€œbevelâ€å³kCALineJoinBevelç±»åž‹æ¥æ˜¾ç¤ºã€‚ 9ã€@property(copy) CAShapeLayerLineCap lineCap; çº¿ç«¯ç‚¹ç±»åž‹ï¼Œå€¼æœ‰ä¸‰ä¸ªç±»åž‹ï¼Œåˆ†åˆ«ä¸ºkCALineCapButt ã€kCALineCapRound ã€kCALineCapSquareï¼Œé»˜è®¤å€¼ä¸ºButtï¼› 10ã€@property(copy) CAShapeLayerLineJoin lineJoin;lineJoinä¸ºçº¿è¿žæŽ¥ç±»åž‹ï¼Œå…¶å€¼ä¹Ÿæœ‰ä¸‰ä¸ªç±»åž‹ï¼Œåˆ†åˆ«ä¸ºkCALineJoinMiterã€kCALineJoinRoundã€kCALineJoinBevelï¼Œé»˜è®¤å€¼æ˜¯Miterã€‚ 11ã€@property CGFloat lineDashPhase;ä¸ºçº¿åž‹æ¨¡ç‰ˆçš„èµ·å§‹ä½ç½®ï¼›lineDashPatternä¸ºçº¿æ€§æ¨¡ç‰ˆï¼Œè¿™æ˜¯ä¸€ä¸ªNSNumberçš„æ•°ç»„ï¼Œç´¢å¼•ä»Ž1å¼€å§‹è®°ï¼Œå¥‡æ•°ä½æ•°å€¼è¡¨ç¤ºå®žçº¿é•¿åº¦ï¼Œå¶æ•°ä½æ•°å€¼è¡¨ç¤ºç©ºç™½é•¿åº¦ã€‚æ³¨ï¼šfillColorä¸ŽstrokeColoréƒ½æ˜¯åœ¨æœ‰UIBezierPathå‚æ•°é…ç½®çš„æƒ…å†µä¸‹æ‰èƒ½å‘ç”Ÿä½œç”¨ 12ã€@property(nullable, copy) NSArray *lineDashPattern; 2.CAReplicationLayerå±žæ€§ 1ã€@property NSInteger instanceCount; å¤åˆ¶subLayerä¸ªæ•°ï¼Œé»˜è®¤ä¸º1 2ã€@property BOOL preservesDepth; æ˜¯å¦å°†3Dä¾‹å­ç³»ç»Ÿå¹³é¢åŒ–åˆ°ä¸€ä¸ªå›¾å±‚ï¼ˆé»˜è®¤å€¼ï¼‰æˆ–è€…å¯ä»¥åœ¨3Dç©ºé—´ä¸­æ··åˆå…¶ä»–çš„å›¾å±‚ 3ã€@property CFTimeInterval instanceDelay; è®¾ç½®å¤åˆ¶å­å±‚çš„å»¶è¿ŸåŠ¨ç”»æ—¶é•¿ 4ã€@property CATransform3D instanceTransform; è®¾ç½®å¤åˆ¶å­å±‚çš„ç›¸å¯¹ä½ç½® 5ã€@property(nullable) CGColorRef instanceColor; å­å±‚é¢œè‰²ï¼Œä¼šå’ŒåŽŸç”Ÿå­å±‚èƒŒæ™¯è‰²å†²çªï¼Œå› æ­¤äºŒè€…é€‰å…¶ä¸€è®¾ç½® 6ã€@property float instanceRedOffset;è®¾ç½®æ¯ä¸ªå¤åˆ¶å›¾å±‚ç›¸å¯¹ä¸Šä¸€ä¸ªå¤åˆ¶å›¾å±‚çš„çº¢è‰²åç§»é‡ 7ã€@property float instanceRedOffset;è®¾ç½®æ¯ä¸ªå¤åˆ¶å›¾å±‚ç›¸å¯¹ä¸Šä¸€ä¸ªå¤åˆ¶å›¾å±‚çš„ç»¿è‰²åç§»é‡ 8ã€@property float instanceBlueOffset;è®¾ç½®æ¯ä¸ªå¤åˆ¶å›¾å±‚ç›¸å¯¹ä¸Šä¸€ä¸ªå¤åˆ¶å›¾å±‚çš„è“è‰²åç§»é‡ 9ã€@property float instanceAlphaOffset;è®¾ç½®æ¯ä¸ªå¤åˆ¶å›¾å±‚ç›¸å¯¹ä¸Šä¸€ä¸ªå¤åˆ¶å›¾å±‚çš„é€æ˜Žåº¦åç§»é‡]]></content>
  </entry>
  <entry>
    <title><![CDATA[CAAniamtionçš„å±žæ€§å’Œä½¿ç”¨]]></title>
    <url>%2F2018%2F11%2F23%2FCAAniamtion%E7%9A%84%E5%B1%9E%E6%80%A7%E5%92%8C%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[CAAnimationCAAnimationæ˜¯æ‰€æœ‰åŠ¨ç”»å¯¹è±¡çš„çˆ¶ç±»ï¼Œè´Ÿè´£æŽ§åˆ¶åŠ¨ç”»çš„æŒç»­æ—¶é—´å’Œé€Ÿåº¦ï¼Œæ˜¯ä¸ªæŠ½è±¡ç±»ï¼Œä¸èƒ½ç›´æŽ¥ä½¿ç”¨ï¼Œåº”è¯¥ä½¿ç”¨å®ƒå…·ä½“çš„å­ç±»ã€‚ å±žæ€§ durationï¼šåŠ¨ç”»çš„æŒç»­æ—¶é—´ repeatCountï¼šåŠ¨ç”»çš„é‡å¤æ¬¡æ•° repeatDurationï¼šåŠ¨ç”»çš„é‡å¤æ—¶é—´ removedOnCompletionï¼šé»˜è®¤ä¸ºYESï¼Œä»£è¡¨åŠ¨ç”»æ‰§è¡Œå®Œæ¯•åŽå°±ä»Žå›¾å±‚ä¸Šç§»é™¤ï¼Œå›¾å½¢ä¼šæ¢å¤åˆ°åŠ¨ç”»æ‰§è¡Œå‰çš„çŠ¶æ€ã€‚å¦‚æžœæƒ³è®©å›¾å±‚ä¿æŒæ˜¾ç¤ºåŠ¨ç”»æ‰§è¡ŒåŽçš„çŠ¶æ€ï¼Œé‚£å°±è®¾ç½®ä¸ºNOï¼Œä¸è¿‡è¿˜è¦è®¾ç½®fillModeä¸ºkCAFillModeForwards fillModeï¼šå†³å®šå½“å‰å¯¹è±¡åœ¨éžactiveæ—¶é—´æ®µçš„è¡Œä¸ºã€‚æ¯”å¦‚åŠ¨ç”»å¼€å§‹ä¹‹å‰,åŠ¨ç”»ç»“æŸä¹‹åŽ beginTimeï¼šå¯ä»¥ç”¨æ¥è®¾ç½®åŠ¨ç”»å»¶è¿Ÿæ‰§è¡Œæ—¶é—´ï¼Œè‹¥æƒ³å»¶è¿Ÿ2sï¼Œå°±è®¾ç½®ä¸ºCACurrentMediaTime()+2ï¼ŒCACurrentMediaTime()ä¸ºå›¾å±‚çš„å½“å‰æ—¶é—´ timingFunctionï¼šé€Ÿåº¦æŽ§åˆ¶å‡½æ•°ï¼ŒæŽ§åˆ¶åŠ¨ç”»è¿è¡Œçš„èŠ‚å¥ delegateï¼šåŠ¨ç”»ä»£ç† å­ç±»1.CAPropertyAnimationæ˜¯CAAnimationçš„å­ç±»ï¼Œä¹Ÿæ˜¯ä¸ªæŠ½è±¡ç±»ï¼Œè¦æƒ³åˆ›å»ºåŠ¨ç”»å¯¹è±¡ï¼Œåº”è¯¥ä½¿ç”¨å®ƒçš„ä¸¤ä¸ªå­ç±»ï¼šCABasicAnimationå’ŒCAKeyframeAnimationã€‚ keyPath é€šè¿‡æŒ‡å®šCALayerçš„ä¸€ä¸ªå±žæ€§åç§°ä¸ºkeyPath(NSStringç±»åž‹)ï¼Œå¹¶ä¸”å¯¹CALayerçš„è¿™ä¸ªå±žæ€§çš„å€¼è¿›è¡Œä¿®æ”¹ï¼Œè¾¾åˆ°ç›¸åº”çš„åŠ¨ç”»æ•ˆæžœã€‚æ¯”å¦‚ï¼ŒæŒ‡å®š@â€positionâ€ä¸ºkeyPathï¼Œå°±ä¿®æ”¹CALayerçš„positionå±žæ€§çš„å€¼ï¼Œä»¥è¾¾åˆ°å¹³ç§»çš„åŠ¨ç”»æ•ˆæžœã€‚ 2.CABasicAnimation fromValueï¼škeyPathç›¸åº”å±žæ€§çš„åˆå§‹å€¼ã€‚ toValueï¼škeyPathç›¸åº”å±žæ€§çš„ç»“æŸå€¼ã€‚ éšç€åŠ¨ç”»çš„è¿›è¡Œï¼Œåœ¨é•¿åº¦ä¸ºdurationçš„æŒç»­æ—¶é—´å†…ï¼ŒkeyPathç›¸åº”å±žæ€§çš„å€¼ä»ŽfromValueæ¸æ¸åœ°å˜ä¸ºtoValueã€‚ å¦‚æžœfillMode=kCAFillModeForwardså’ŒremovedOnComletion=NOï¼Œé‚£ä¹ˆåœ¨åŠ¨ç”»æ‰§è¡Œå®Œæ¯•åŽï¼Œå›¾å±‚ä¼šä¿æŒæ˜¾ç¤ºåŠ¨ç”»æ‰§è¡ŒåŽçš„çŠ¶æ€ã€‚ä½†åœ¨å®žè´¨ä¸Šï¼Œå›¾å±‚çš„å±žæ€§å€¼è¿˜æ˜¯åŠ¨ç”»æ‰§è¡Œå‰çš„åˆå§‹å€¼ï¼Œå¹¶æ²¡æœ‰çœŸæ­£è¢«æ”¹å˜ã€‚æ¯”å¦‚ï¼ŒCALayerçš„positionåˆå§‹å€¼ä¸º(0,0)ï¼ŒCABasicAnimationçš„fromValueä¸º(10,10)ï¼ŒtoValueä¸º(100,100)ï¼Œè™½ç„¶åŠ¨ç”»æ‰§è¡Œå®Œæ¯•åŽå›¾å±‚ä¿æŒåœ¨(100,100)è¿™ä¸ªä½ç½®ï¼Œå®žè´¨ä¸Šå›¾å±‚çš„positionè¿˜æ˜¯ä¸º(0,0)ã€‚ 3.CAKeyframeAnimationCApropertyAnimationçš„å­ç±»ï¼Œè·ŸCABasicAnimationçš„åŒºåˆ«æ˜¯ï¼šCABasicAnimationåªèƒ½ä»Žä¸€ä¸ªæ•°å€¼(fromValue)å˜åˆ°å¦ä¸€ä¸ªæ•°å€¼(toValue)ï¼Œè€ŒCAKeyframeAnimationä¼šä½¿ç”¨ä¸€ä¸ªNSArrayä¿å­˜è¿™äº›æ•°å€¼ã€‚ valuesï¼šå°±æ˜¯ä¸Šè¿°çš„NSArrayå¯¹è±¡ã€‚é‡Œé¢çš„å…ƒç´ ç§°ä¸ºâ€å…³é”®å¸§â€(keyframe)ã€‚åŠ¨ç”»å¯¹è±¡ä¼šåœ¨æŒ‡å®šçš„æ—¶é—´(duration)å†…ï¼Œä¾æ¬¡æ˜¾ç¤ºvaluesæ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…³é”®å¸§ã€‚ pathï¼šå¯ä»¥è®¾ç½®ä¸€ä¸ªCGPathRef\CGMutablePathRef,è®©å±‚è·Ÿç€è·¯å¾„ç§»åŠ¨ã€‚pathåªå¯¹CALayerçš„anchorPointå’Œpositionèµ·ä½œç”¨ã€‚å¦‚æžœä½ è®¾ç½®äº†pathï¼Œé‚£ä¹ˆvalueså°†è¢«å¿½ç•¥ã€‚ keyTimesï¼šå¯ä»¥ä¸ºå¯¹åº”çš„å…³é”®å¸§æŒ‡å®šå¯¹åº”çš„æ—¶é—´ç‚¹,å…¶å–å€¼èŒƒå›´ä¸º0åˆ°1.0,keyTimesä¸­çš„æ¯ä¸€ä¸ªæ—¶é—´å€¼éƒ½å¯¹åº”valuesä¸­çš„æ¯ä¸€å¸§.å½“keyTimesæ²¡æœ‰è®¾ç½®çš„æ—¶å€™,å„ä¸ªå…³é”®å¸§çš„æ—¶é—´æ˜¯å¹³åˆ†çš„ã€‚ CABasicAnimationå¯çœ‹åšæ˜¯æœ€å¤šåªæœ‰2ä¸ªå…³é”®å¸§çš„CAKeyframeAnimationã€‚ 4.CAAnimationGroupCAAnimationçš„å­ç±»ï¼Œå¯ä»¥ä¿å­˜ä¸€ç»„åŠ¨ç”»å¯¹è±¡ï¼Œå°†CAAnimationGroupå¯¹è±¡åŠ å…¥å±‚åŽï¼Œç»„ä¸­æ‰€æœ‰åŠ¨ç”»å¯¹è±¡å¯ä»¥åŒæ—¶å¹¶å‘è¿è¡Œã€‚ animationsï¼šç”¨æ¥ä¿å­˜ä¸€ç»„åŠ¨ç”»å¯¹è±¡çš„NSArrayã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€ç»„åŠ¨ç”»å¯¹è±¡æ˜¯åŒæ—¶è¿è¡Œçš„ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½®åŠ¨ç”»å¯¹è±¡çš„beginTimeå±žæ€§æ¥æ›´æ”¹åŠ¨ç”»çš„å¼€å§‹æ—¶é—´ã€‚ 5.CATransitionCAAnimationçš„å­ç±»ï¼Œç”¨äºŽåšè½¬åœºåŠ¨ç”»ï¼Œèƒ½å¤Ÿä¸ºå±‚æä¾›ç§»å‡ºå±å¹•å’Œç§»å…¥å±å¹•çš„åŠ¨ç”»æ•ˆæžœã€‚iOSæ¯”Mac OS Xçš„è½¬åœºåŠ¨ç”»æ•ˆæžœå°‘ä¸€ç‚¹ã€‚UINavigationControllerå°±æ˜¯é€šè¿‡CATransitionå®žçŽ°äº†å°†æŽ§åˆ¶å™¨çš„è§†å›¾æŽ¨å…¥å±å¹•çš„åŠ¨ç”»æ•ˆæžœã€‚ typeï¼šåŠ¨ç”»è¿‡æ¸¡ç±»åž‹ã€‚ subtypeï¼šåŠ¨ç”»è¿‡æ¸¡æ–¹å‘ã€‚ startProgressï¼šåŠ¨ç”»èµ·ç‚¹(åœ¨æ•´ä½“åŠ¨ç”»çš„ç™¾åˆ†æ¯”)ã€‚ endProgressï¼šåŠ¨ç”»ç»ˆç‚¹(åœ¨æ•´ä½“åŠ¨ç”»çš„ç™¾åˆ†æ¯”)ã€‚]]></content>
  </entry>
  <entry>
    <title><![CDATA[iOSè‡ªå®šä¹‰æŽ§ä»¶ï¼šæé†’æ¡]]></title>
    <url>%2F2018%2F11%2F22%2FiOS%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%A7%E4%BB%B6%EF%BC%9A%E6%8F%90%E9%86%92%E6%9D%A1%2F</url>
    <content type="text"><![CDATA[ç®€å•çš„æé†’æ¡ï¼Œä»£ç æ¯”è¾ƒç®€å•ï¼Œä½¿ç”¨å®¹æ˜“ï¼Œä»£ç ä¸­ç›®å‰æä¾›äº†ä¸‰ç§æ˜¾ç¤ºçš„é¢œè‰²ï¼Œé»˜è®¤æ˜¾ç¤ºæ–‡æœ¬å†…å®¹ä¸ºä¸€è¡Œæ–‡å­—ï¼Œé»˜è®¤é«˜åº¦ä¸º20ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±éœ€æ±‚è‡ªå®šä¹‰æ ·å¼ã€‚ä»£ç åŒæ—¶æ”¯æŒObjective-Cå’ŒSwiftï¼Œä½¿ç”¨æ–¹å¼æœ‰ç‚¹ç‚¹å·®åˆ«ï¼Œè¯¦æƒ…çœ‹ä»£ç ã€‚ æŽ¥å£æ–‡ä»¶123456789101112131415161718192021222324252627282930313233343536#import &lt;UIKit/UIKit.h&gt;NS_ASSUME_NONNULL_BEGINtypedef NS_ENUM(NSInteger, RemindBarStyle) &#123; RemindBarStyleInfo, // æé†’ â‡ï¸ RemindBarStyleWarn, // è­¦å‘Š âš ï¸ RemindBarStyleError // é”™è¯¯ âŒ&#125;;typedef NS_ENUM(NSInteger, RemindBarPosition) &#123; RemindBarPositionStatusBar, // çŠ¶æ€æ ä¸‹é¢ RemindBarPositionNavigationBar, // å¯¼èˆªæ ä¸‹é¢&#125;;@interface LZRemindBar : UIView/** é…ç½®æ˜¾ç¤ºæ ·å¼ @param style æ ·å¼ @param position ä½ç½® @param text å†…å®¹ @return return value description */+ (LZRemindBar *)configurationWithStyle:(RemindBarStyle)style showPosition:(RemindBarPosition)position contentText:(NSString *)text;/** æ˜¾ç¤º å¹¶è®¾ç½®æ˜¾ç¤ºæ—¶é—´ @param interval æ˜¾ç¤ºæ—¶é—´ */- (void)showBarAfterTimeInterval:(NSTimeInterval)interval;@endNS_ASSUME_NONNULL_END å®žçŽ°æ–‡ä»¶123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122#import "LZRemindBar.h"#define bar_IsPhoneX UIApplication.sharedApplication.statusBarFrame.size.height != 20#define bar_topInterval bar_IsPhoneX ? UIApplication.sharedApplication.statusBarFrame.size.height : 0@interface LZRemindBar ()@property (nonatomic, strong) UILabel *contentLabel; //*! æ–‡å­—Label@property (nonatomic, assign) RemindBarPosition position; //*! æ˜¾ç¤ºä½ç½®@property (nonatomic, assign) BOOL isShowing; //*! æ˜¯å¦æ­£åœ¨æ˜¾ç¤º@end@implementation LZRemindBar+ (instancetype)remind &#123; static dispatch_once_t onceToken; static LZRemindBar *remind; dispatch_once(&amp;onceToken, ^&#123; remind = [[LZRemindBar alloc] init]; &#125;); return remind;&#125;+ (LZRemindBar *)configurationWithStyle:(RemindBarStyle)style showPosition:(RemindBarPosition)position contentText:(NSString *)text &#123; if ([LZRemindBar remind].isShowing) &#123; return [LZRemindBar remind]; &#125; [LZRemindBar remind].contentLabel = (&#123; UILabel *label = [[UILabel alloc] init]; label.backgroundColor = UIColor.clearColor; label.numberOfLines = 1; label.textAlignment = NSTextAlignmentCenter; label.font = [UIFont systemFontOfSize:13]; label.textColor = UIColor.whiteColor; [[LZRemindBar remind] addSubview:label]; label.translatesAutoresizingMaskIntoConstraints = false; [[label.leadingAnchor constraintEqualToAnchor:[LZRemindBar remind].leadingAnchor] setActive:true]; [[label.trailingAnchor constraintEqualToAnchor:[LZRemindBar remind].trailingAnchor] setActive:true]; [[label.topAnchor constraintEqualToAnchor:[LZRemindBar remind].topAnchor] setActive:true]; [[label.bottomAnchor constraintEqualToAnchor:[LZRemindBar remind].bottomAnchor] setActive:true]; label.text = text; label; &#125;); [LZRemindBar remind].isShowing = true; [LZRemindBar remind].position = position; switch (style) &#123; case RemindBarStyleInfo: [LZRemindBar remind].backgroundColor = [UIColor colorWithRed:0 green:166.0/255 blue:124.0/255 alpha:1]; break; case RemindBarStyleWarn: [LZRemindBar remind].backgroundColor = UIColor.orangeColor; break; case RemindBarStyleError: [LZRemindBar remind].backgroundColor = UIColor.redColor; break; default: break; &#125; if (position == RemindBarPositionStatusBar) &#123; [[LZRemindBar remind] setupShowStatusBarBottomWithStutus:true]; &#125; else &#123; [[LZRemindBar remind] setupShowNavigationBarBottomWithStutus:true]; &#125; return [LZRemindBar remind];&#125;- (void)setupShowStatusBarBottomWithStutus:(BOOL)show &#123; if (show) &#123; UIApplication.sharedApplication.delegate.window.windowLevel = bar_IsPhoneX ? UIWindowLevelNormal : UIWindowLevelAlert; self.frame = CGRectMake(0, bar_topInterval, UIScreen.mainScreen.bounds.size.width, 0); [UIView animateWithDuration:0.5 animations:^&#123; self.frame = CGRectMake(0, bar_topInterval, UIScreen.mainScreen.bounds.size.width, 20); &#125;]; &#125; else &#123; [UIView animateWithDuration:0.5 animations:^&#123; self.frame = CGRectMake(0, bar_topInterval, UIScreen.mainScreen.bounds.size.width, 0); &#125; completion:^(BOOL finished) &#123; UIApplication.sharedApplication.delegate.window.windowLevel = UIWindowLevelNormal; [self dismissBar]; &#125;]; &#125;&#125;- (void)setupShowNavigationBarBottomWithStutus:(BOOL)show &#123; if (show) &#123; self.frame = CGRectMake(0, UIApplication.sharedApplication.statusBarFrame.size.height + 44, UIScreen.mainScreen.bounds.size.width, 0); [UIView animateWithDuration:0.5 animations:^&#123; self.frame = CGRectMake(0, UIApplication.sharedApplication.statusBarFrame.size.height + 44, UIScreen.mainScreen.bounds.size.width, 20); &#125;]; &#125; else &#123; [UIView animateWithDuration:0.5 animations:^&#123; self.frame = CGRectMake(0, UIApplication.sharedApplication.statusBarFrame.size.height + 44, UIScreen.mainScreen.bounds.size.width, 0); &#125; completion:^(BOOL finished) &#123; [self dismissBar]; &#125;]; &#125;&#125;- (void)showBarAfterTimeInterval:(NSTimeInterval)interval &#123; [UIApplication.sharedApplication.delegate.window addSubview:self]; dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(interval * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123; if (self.position == RemindBarPositionStatusBar) &#123; [self setupShowStatusBarBottomWithStutus:false]; &#125; else &#123; [self setupShowNavigationBarBottomWithStutus:false]; &#125; &#125;);&#125;- (void)dismissBar &#123; self.isShowing = false; [self.contentLabel removeFromSuperview]; [self removeFromSuperview];&#125;@end ä½¿ç”¨æ–¹æ³•123456789// å‚æ•°RemindBarStyleï¼š æ˜¾ç¤ºæ ·å¼// å‚æ•°RemindBarPosition: æ˜¾ç¤ºä½ç½® // å‚æ•°contentText: æ˜¾ç¤ºæ–‡å­—å†…å®¹ // intervalï¼šæ˜¾ç¤ºæ—¶é—´// Objc[[LZRemindBar configurationWithStyle:RemindBarStyleInfo showPosition:RemindBarPositionStatusBar contentText:@"è¿™æ˜¯ä¸€ä¸ªæç¤º"] showBarAfterTimeInterval:1.2];// SwiftLZRemindBar.configuration(with: .info, show: .statusBar, contentText: "æç¤ºæ–‡å­—").show(afterTimeInterval: 1.2) æ•ˆæžœå›¾]]></content>
  </entry>
  <entry>
    <title><![CDATA[iOSè‡ªå®šä¹‰æŽ§ä»¶ï¼šè‡ªå®šä¹‰Alterå¼¹çª—]]></title>
    <url>%2F2018%2F11%2F21%2FiOS%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%A7%E4%BB%B6%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89Alter%E5%BC%B9%E7%AA%97%2F</url>
    <content type="text"><![CDATA[åœ¨ä¸‹å°ç™½ä¸€ä¸ªï¼Œå‡†å¤‡å†™å†™å’Œè‡ªå·±å¼€å‘æ¯æ¯ç›¸å…³çš„æŽ§ä»¶ï¼Œå¸Œæœ›å¤§å®¶æ‰¹è¯„æŒ‡æ­£ã€‚è¿™æ˜¯ç¬¬ä¸€ä¸ªå¸¸ç”¨çš„åº•éƒ¨å¼¹çª—ï¼Œä½¿ç”¨äº†æœ€ç®€å•çš„åˆ†è£…æ–¹å¼ã€‚ 1ã€å¤´æ–‡ä»¶é‡Œé¢å£°æ˜Žäº†ä¸€ä¸ªä»£ç†å’Œåˆå§‹åŒ–æ–¹æ³•ã€‚12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667#import &lt;UIKit/UIKit.h&gt;NS_ASSUME_NONNULL_BEGIN@class LZAlterView;@protocol LZAlterViewDelegate &lt;NSObject&gt;- (void)alterView:(LZAlterView *)alterView didSelectedAtIndex:(NSInteger)index;@end@interface LZAlterView : UIView+ (instancetype)alter;/** æ˜¾ç¤ºæ ·å¼ä¸€ @param mainTitle ä¸»æ ‡é¢˜ @param subTitle å‰¯æ ‡é¢˜ @param actionTitleArray äº‹ä»¶æŒ‰é’®æ•°ç»„ @param cancelTitle å–æ¶ˆæŒ‰é’® @return return value description */- (LZAlterView *)configureWithMainTitle:(NSString *)mainTitle subTitle:(NSString *)subTitle actionTitleArray:(NSArray&lt;NSString *&gt; *)actionTitleArray cancelActionTitle:(NSString *)cancelTitle;/** æ˜¾ç¤ºæ ·å¼äºŒ @param mainTitle ä¸»æ ‡é¢˜ @param subTitle å‰¯æ ‡é¢˜ @param actionTitleArray äº‹ä»¶æŒ‰é’®ç»„æ•° @return return value description */- (LZAlterView *)configureWithMainTitle:(NSString *)mainTitle subTitle:(NSString *)subTitle actionTitleArray:(NSArray&lt;NSString *&gt; *)actionTitleArray;/** æ˜¾ç¤ºæ ·å¼ä¸‰ @param actionTitleArray äº‹ä»¶æŒ‰é’®æ•°ç»„ @param cancelTitle å–æ¶ˆæŒ‰é’® @return return value description */- (LZAlterView *)configureWithActionTitleArray:(NSArray&lt;NSString *&gt; *)actionTitleArray cancelActionTitle:(NSString *)cancelTitle;/** æ˜¾ç¤ºæ ·å¼å›› @param actionTitleArray äº‹ä»¶æŒ‰é’®æ•°ç»„ @return return value description */- (LZAlterView *)configureWithActionTitleArray:(NSArray&lt;NSString *&gt; *)actionTitleArray;/** è®¾ç½®ä»£ç† @param delegate ä»£ç† @return return value description */- (LZAlterView *)setupDelegate:(id&lt;LZAlterViewDelegate&gt;)delegate;- (void)showAlter;@endNS_ASSUME_NONNULL_END 2ã€å®žçŽ°æ–‡ä»¶é‡Œé¢è¿›è¡Œé¡µé¢çš„ç»˜åˆ¶ã€æ•°æ®å¤„ç†å’Œäº‹ä»¶å¤„ç†ã€‚123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243#import "LZAlterView.h"#define alter_ScreenWidth UIScreen.mainScreen.bounds.size.width#define alter_ScreenHeight UIScreen.mainScreen.bounds.size.height#define alter_actionHeight 45 * alter_ScreenWidth/375.0#define alter_cancelSpece 5 * alter_ScreenWidth/375.0#define alter_mainTitleHeight alter_actionHeight + alter_cancelSpece#define alter_FontSize(s) [UIFont systemFontOfSize:s * alter_ScreenWidth/375.0]@interface LZAlterView ()@property (nonatomic) CGRect conterViewRect;@property (nonatomic, strong) UIView *contanerView;@property (nonatomic, weak) id &lt;LZAlterViewDelegate&gt; delegate;@end@implementation LZAlterView+ (instancetype)alter &#123; static dispatch_once_t onceToken; static LZAlterView *alter; dispatch_once(&amp;onceToken, ^&#123; alter = [[LZAlterView alloc] init]; &#125;); return alter;&#125;- (instancetype)init &#123; self = [super init]; if (self) &#123; UITapGestureRecognizer *tap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(tapGestureRecognizer:)]; [self addGestureRecognizer:tap]; &#125; return self;&#125;#pragma mark - Configuration method/** ä»£ç† */- (LZAlterView *)setupDelegate:(id&lt;LZAlterViewDelegate&gt;)delegate &#123; self.delegate = delegate; return self;&#125;/** Set title, subtitle, events and cancel */- (LZAlterView *)configureWithMainTitle:(NSString *)mainTitle subTitle:(NSString *)subTitle actionTitleArray:(NSArray&lt;NSString *&gt; *)actionTitleArray cancelActionTitle:(NSString *)cancelTitle &#123; CGFloat width = alter_actionHeight * (actionTitleArray.count + 1) + alter_cancelSpece + alter_mainTitleHeight; self.contanerView.frame = CGRectMake(0, [self safeScreenHeight] - width, alter_ScreenWidth, width); [self addSubview:self.contanerView]; UILabel *titleLabel = [self setupMainTitle:mainTitle subTitle:subTitle]; titleLabel.frame = CGRectMake(0, 0, alter_ScreenWidth, alter_mainTitleHeight); [self.contanerView addSubview:titleLabel]; UIButton *cancelButton = [self cancelButtonWithTitle:cancelTitle]; cancelButton.frame = CGRectMake(0, self.contanerView.frame.size.height - alter_actionHeight, alter_ScreenWidth, alter_actionHeight); [self.contanerView addSubview:cancelButton]; for (NSString *name in actionTitleArray) &#123; UIButton *button = [self setupActionWithTitle:name]; NSInteger index = [actionTitleArray indexOfObject:name]; button.tag = 1000 + index; button.frame = CGRectMake(0, titleLabel.frame.size.height + 0.5 + alter_actionHeight * index, alter_ScreenWidth, alter_actionHeight - 0.5); [self.contanerView addSubview:button]; &#125; self.conterViewRect = self.contanerView.frame; return self;&#125;/** Set title, subtitle and events */- (LZAlterView *)configureWithMainTitle:(NSString *)mainTitle subTitle:(NSString *)subTitle actionTitleArray:(NSArray&lt;NSString *&gt; *)actionTitleArray &#123; CGFloat width = alter_actionHeight * actionTitleArray.count + alter_mainTitleHeight; self.contanerView.frame = CGRectMake(0, [self safeScreenHeight] - width, alter_ScreenWidth, width); [self addSubview:self.contanerView]; UILabel *titleLabel = [self setupMainTitle:mainTitle subTitle:subTitle]; titleLabel.frame = CGRectMake(0, 0, alter_ScreenWidth, alter_mainTitleHeight); [self.contanerView addSubview:titleLabel]; for (NSString *name in actionTitleArray) &#123; UIButton *button = [self setupActionWithTitle:name]; NSInteger index = [actionTitleArray indexOfObject:name]; button.tag = 1000 + index; button.frame = CGRectMake(0, titleLabel.frame.size.height + 0.5 + alter_actionHeight * index, alter_ScreenWidth, alter_actionHeight - 0.5); [self.contanerView addSubview:button]; &#125; self.conterViewRect = self.contanerView.frame; return self;&#125;/** Set events and cancel */- (LZAlterView *)configureWithActionTitleArray:(NSArray&lt;NSString *&gt; *)actionTitleArray cancelActionTitle:(NSString *)cancelTitle &#123; CGFloat width = alter_actionHeight * (actionTitleArray.count + 1) + alter_cancelSpece; self.contanerView.frame = CGRectMake(0, [self safeScreenHeight] - width, alter_ScreenWidth, width); [self addSubview:self.contanerView]; UIButton *cancelButton = [self cancelButtonWithTitle:cancelTitle]; cancelButton.frame = CGRectMake(0, self.contanerView.frame.size.height - alter_actionHeight, alter_ScreenWidth, alter_actionHeight); [self.contanerView addSubview:cancelButton]; for (NSString *name in actionTitleArray) &#123; UIButton *button = [self setupActionWithTitle:name]; NSInteger index = [actionTitleArray indexOfObject:name]; button.tag = 1000 + index; button.frame = CGRectMake(0, alter_actionHeight * index, alter_ScreenWidth, alter_actionHeight-0.5); [self.contanerView addSubview:button]; &#125; self.conterViewRect = self.contanerView.frame; return self;&#125;/** Set events */- (LZAlterView *)configureWithActionTitleArray:(NSArray&lt;NSString *&gt; *)actionTitleArray &#123; CGFloat width = alter_actionHeight * actionTitleArray.count; self.contanerView.frame = CGRectMake(0, [self safeScreenHeight] - width, alter_ScreenWidth, width); [self addSubview:self.contanerView]; for (NSString *name in actionTitleArray) &#123; UIButton *button = [self setupActionWithTitle:name]; NSInteger index = [actionTitleArray indexOfObject:name]; button.tag = 1000 + index; button.frame = CGRectMake(0, alter_actionHeight * index, alter_ScreenWidth, alter_actionHeight-0.5); [self.contanerView addSubview:button]; &#125; self.conterViewRect = self.contanerView.frame; return self;&#125;/** Event button style */- (UIButton *)setupActionWithTitle:(NSString *)title &#123; UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom]; [button setTitle:title forState:UIControlStateNormal]; [button setTitleColor:UIColor.blackColor forState:UIControlStateNormal]; button.backgroundColor = [UIColor colorWithRed:0.9 green:0.9 blue:0.9 alpha:1]; button.titleLabel.font = alter_FontSize(15); [button addTarget:self action:@selector(buttonTouched:) forControlEvents:UIControlEventTouchUpInside]; return button;&#125;/** Cancel button style */- (UIButton *)cancelButtonWithTitle:(NSString *)title &#123; UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom]; [button setTitle:title forState:UIControlStateNormal]; [button setTitleColor:[UIColor colorWithRed:0.9 green:0 blue:0 alpha:1] forState:UIControlStateNormal]; button.backgroundColor = [UIColor colorWithRed:0.9 green:0.9 blue:0.9 alpha:1]; button.titleLabel.font = alter_FontSize(15); [button addTarget:self action:@selector(hidenAlter) forControlEvents:UIControlEventTouchUpInside]; return button;&#125;/** Title style */- (UILabel *)setupMainTitle:(NSString *)title subTitle:(NSString *)subTitle &#123; NSString *titleString; if (subTitle.length == 0) &#123; titleString = [NSString stringWithFormat:@"%@",title]; &#125; else &#123; titleString = [NSString stringWithFormat:@"%@\n%@",title,subTitle]; &#125; UILabel *label = [[UILabel alloc] init]; label.backgroundColor = [UIColor colorWithRed:0.9 green:0.9 blue:0.9 alpha:1]; label.textColor = UIColor.blackColor; label.font = alter_FontSize(15); NSMutableAttributedString *muAttribute = [[NSMutableAttributedString alloc] initWithString:titleString]; [muAttribute addAttribute:NSFontAttributeName value:alter_FontSize(12) range:NSMakeRange(titleString.length - subTitle.length, subTitle.length)]; [muAttribute addAttribute:NSForegroundColorAttributeName value:UIColor.grayColor range:NSMakeRange(titleString.length - subTitle.length, subTitle.length)]; label.textAlignment = NSTextAlignmentCenter; label.numberOfLines = 2; label.attributedText = muAttribute; return label;&#125;#pragma mark - Button click events and delegate- (void)buttonTouched:(UIButton *)sender &#123; [self hidenAlter]; if (self.delegate &amp;&amp; [self.delegate respondsToSelector:@selector(alterView:didSelectedAtIndex:)]) &#123; [self.delegate alterView:self didSelectedAtIndex:sender.tag - 1000]; &#125;&#125;/** iOS 11 safeArea bottom space */- (CGFloat)safeScreenHeight &#123; CGFloat safeAreaInsetsBottom = 0; if (@available(iOS 11.0, *)) &#123; safeAreaInsetsBottom = UIApplication.sharedApplication.delegate.window.safeAreaInsets.bottom; &#125; else &#123; safeAreaInsetsBottom = 0; &#125; return alter_ScreenHeight - safeAreaInsetsBottom;&#125;#pragma mark - Show alter And hiden alter/** Show alter from bottom */- (void)showAlter &#123; [UIApplication.sharedApplication.delegate.window addSubview:self]; self.backgroundColor = [UIColor colorWithWhite:0 alpha:0.3]; self.frame = CGRectMake(0, 0, alter_ScreenWidth, alter_ScreenHeight); self.alpha = 0; self.contanerView.frame = CGRectMake(0, UIScreen.mainScreen.bounds.size.height, UIScreen.mainScreen.bounds.size.height, 0); [UIView animateWithDuration:0.4 animations:^&#123; self.alpha = 1; self.contanerView.frame = self.conterViewRect; &#125;];&#125;/** Hiden alter and remove subViews from superview */- (void)hidenAlter &#123; [UIView animateWithDuration:0.4 animations:^&#123; self.alpha = 0; self.contanerView.frame = CGRectMake(0, UIScreen.mainScreen.bounds.size.height, UIScreen.mainScreen.bounds.size.height, 0); &#125; completion:^(BOOL finished) &#123; for (UIView *view in self.contanerView.subviews) &#123; [view removeFromSuperview]; &#125; [self removeFromSuperview]; &#125;];&#125;#pragma mark - Getter- (UIView *)contanerView &#123; if (!_contanerView) &#123; _contanerView = [[UIView alloc] init]; _contanerView.backgroundColor = [UIColor colorWithRed:0.9 green:0.9 blue:0.9 alpha:0.5]; &#125; return _contanerView;&#125;#pragma mark - TapGestureRecognizer event- (void)tapGestureRecognizer:(id)sender &#123; [self hidenAlter];&#125;@end 3ã€ä½¿ç”¨æ–¹æ³•ï¼Œéµå¾ªLZAlterViewDelegateæ ·å¼ä¸€1234567// Objc[[[[LZAlterView alter] configureWithMainTitle:@"é€‰æ‹©å›¾ç‰‡" subTitle:@"1" actionTitleArray:@[@"æ‰“å¼€ç›¸å†Œ", @"æ‰“å¼€ç›¸æœº"] cancelActionTitle:@"å–æ¶ˆ"] setupDelegate:self] showAlter];// SwiftLZAlterView.alter().configure(withMainTitle: "é€‰æ‹©å›¾ç‰‡", subTitle: "å‰¯æ ‡é¢˜", actionTitleArray: ["ç›¸æœº", "ç›¸å†Œ"], cancelActionTitle: "å–æ¶ˆ").setupDelegate(self).showAlter() æ ·å¼äºŒ123456// Objc [[[[LZAlterView alter] configureWithMainTitle:@"é€‰æ‹©å›¾ç‰‡" subTitle:@"2" actionTitleArray:@[@"æ‰“å¼€ç›¸å†Œ", @"æ‰“å¼€ç›¸æœº"]] setupDelegate:self] showAlter];// SwiftLZAlterView.alter().configure(withMainTitle: "é€‰æ‹©å›¾ç‰‡", subTitle: "éœ€è¦ç”¨æˆ·æƒé™", actionTitleArray: ["ç›¸æœº", "ç›¸å†Œ"]).setupDelegate(self).showAlter() æ ·å¼ä¸‰12345// Objc[[[[LZAlterView alter] configureWithActionTitleArray:@[@"æ‰“å¼€ç›¸å†Œ", @"æ‰“å¼€ç›¸æœº"] cancelActionTitle:@"å–æ¶ˆ"] setupDelegate:self] showAlter];// SwiftLZAlterView.alter().configure(withActionTitleArray: ["ç›¸æœº", "ç›¸å†Œ"], cancelActionTitle: "å–æ¶ˆ").setupDelegate(self).showAlter() æ ·å¼å››1234// Objc[[[[LZAlterView alter] configureWithActionTitleArray:@[@"æ‰“å¼€ç›¸å†Œ", @"æ‰“å¼€ç›¸æœº", @"æ‹ç…§è§†é¢‘"]] setupDelegate:self] showAlter];// SwiftLZAlterView.alter().configure(withActionTitleArray: ["ç›¸æœº", "ç›¸å†Œ"]).setupDelegate(self).showAlter() 4ã€ä»£ç†æ–¹æ³•12345678910// Objc- (void)alterView:(LZAlterView *)alterView didSelectedAtIndex:(NSInteger)index &#123; NSLog(@"ç‚¹å‡»ç¬¬%ldæŒ‰é’®", index);&#125;// Swiftextension ViewController: LZAlterViewDelegate &#123; func alterView(_ alterView: LZAlterView, didSelectedAt index: Int) &#123; print("ç‚¹å‡»ç¬¬\(index)æŒ‰é’®") &#125;&#125; 5ã€æ•ˆæžœå›¾ ç»“å°¾ï¼šæœ‰é—®é¢˜å¸Œæœ›å¤§å®¶æŒ‡æ­£ï¼ðŸ˜„ðŸ˜„ðŸ˜„]]></content>
  </entry>
  <entry>
    <title><![CDATA[iOSè‡ªå®šä¹‰æŽ§ä»¶ï¼šè‡ªå®šä¹‰åˆ†ç±»ä¸‹æ‹‰]]></title>
    <url>%2F2018%2F11%2F19%2FiOS%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%A7%E4%BB%B6%EF%BC%9A%E8%87%AA%E5%AE%9A%E4%B9%89%E5%88%86%E7%B1%BB%E4%B8%8B%E6%8B%89%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘è‡ªç”±æ—¶é—´æœ‰ç‚¹å¤šï¼Œå°±å¼€å§‹æ’¸æŽ§ä»¶ã€‚è¿™ä¸ªæ˜¯æˆ‘ä»¬å¸¸ç”¨çš„ä¸€ä¸ªä¸‹æ‹‰åˆ†ç±»æŽ§ä»¶ï¼Œçœ‹äº†å¾ˆå¤šåˆ«äººå†™çš„ï¼Œéƒ½æ˜¯ç”¨TableViewæˆ–è€…CollectionViewæ•´åˆåœ¨ä¸€èµ·çš„æ„Ÿè§‰è‡ªå®šä¹‰æ€§æ²¡æœ‰é‚£ä¹ˆå¼ºï¼Œæ‰€ä»¥å°±å°è¯•ç”¨æŠŠTableViewå’ŒCollectionViewæ›¿æ¢æˆUIViewControllerã€‚å…¶ä»–åºŸè¯ä¸å¤šè¯´äº†ã€‚ 1ã€ æŽ¥å£æ–‡ä»¶123456789101112131415161718192021222324252627282930313233343536#import &lt;UIKit/UIKit.h&gt;UIKIT_EXTERN NSString *lzDropViewNotification;NS_ASSUME_NONNULL_BEGIN@class LZDropView;@protocol LZDropViewDataSource &lt;NSObject&gt;@required/** Height corresponding to controller display */- (NSArray&lt;NSNumber *&gt; *)setupCategoryControllerHeightInDropView:(LZDropView *)dropView;/** Title corresponding controller array */- (NSArray&lt;UIViewController *&gt; *)setupCategoryControllerInDropView:(LZDropView *)dropView;/** Default display of Title Array */- (NSArray&lt;NSString *&gt; *)setupCategoryTitleNameInDropView:(LZDropView *)dropView;@end@protocol LZDropViewDelegate &lt;NSObject&gt;/** Click the column and select the information. */- (void)dropView:(LZDropView *)dropView didSelectAtColumn:(NSInteger)column info:(NSString *)info;@end@interface LZDropView : UIView/** Simple page configuration */@property (nonatomic, weak) id &lt;LZDropViewDataSource&gt; dataSorce;/** Click proxy event&lt;##&gt; */@property (nonatomic, weak) id &lt;LZDropViewDelegate&gt; delegate;@endNS_ASSUME_NONNULL_END 2ã€ å®žçŽ°æ–‡ä»¶123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167#import "LZDropView.h"NSString *lzDropViewNotification = @"nitification";@interface LZDropView ()@property (nonatomic, strong) NSArray&lt;UIViewController *&gt; *controllerArray;@property (nonatomic, strong) NSArray&lt;NSString *&gt; *titleArray;@property (nonatomic, strong) UIButton *containerView;@property (nonatomic, strong) NSArray&lt;NSNumber *&gt; *controllerHeightArray;@property (nonatomic, strong) NSMutableArray&lt;UIButton *&gt; *buttonArray;@end@implementation LZDropView#pragma mark - Release memory- (void)dealloc &#123; [[NSNotificationCenter defaultCenter] removeObserver:self];&#125;#pragma mark - Initialization- (instancetype)init &#123; self = [super init]; if (self) &#123; [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(notificationAction:) name:lzDropViewNotification object:nil]; &#125; return self;&#125;#pragma mark - Draw the page- (void)setupTitleButton:(NSArray&lt;NSString *&gt; *)array &#123; CGFloat width = UIScreen.mainScreen.bounds.size.width / array.count; self.buttonArray = [NSMutableArray array]; for (NSString *name in array) &#123; NSInteger index = [array indexOfObject:name]; UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom]; button.titleLabel.font = [UIFont systemFontOfSize:15]; [button setTitle:[NSString stringWithFormat:@"%@ â–¼", name] forState:UIControlStateNormal]; [button setTitle:[NSString stringWithFormat:@"%@ â–²", name] forState:UIControlStateSelected]; [button setTitleColor:UIColor.grayColor forState:UIControlStateNormal]; [button setTitleColor:UIColor.orangeColor forState:UIControlStateSelected]; button.frame = CGRectMake(width * index, 0, width, 45); button.tag = index + 1000; [button addTarget:self action:@selector(buttonTouched:) forControlEvents:UIControlEventTouchUpInside]; [self addSubview:button]; [self.buttonArray addObject:button]; &#125;&#125;#pragma mark - Button click event- (void)buttonTouched:(UIButton *)sender &#123; if (sender.selected) &#123; [self closeControllerView]; &#125; else &#123; [self openControllerViewWithButton:sender]; &#125;&#125;- (void)backButtonTouched:(UIButton *)sender &#123; [self closeControllerView];&#125;#pragma mark - Notification event- (void)notificationAction:(NSNotification *)notification &#123; if (![self.controllerArray containsObject:notification.object]) &#123; return; &#125; NSInteger index = [self.controllerArray indexOfObject:notification.object]; UIButton *button = self.buttonArray[index]; [button setTitle:[NSString stringWithFormat:@"%@ â–¼", notification.userInfo.allValues.firstObject] forState:UIControlStateNormal]; if (self.delegate &amp;&amp; [self.delegate respondsToSelector:@selector(dropView:didSelectAtColumn:info:)]) &#123; [self.delegate dropView:self didSelectAtColumn:index info:notification.userInfo.allValues.firstObject]; &#125; [self closeControllerView];&#125;#pragma mark - Close all controllers.- (void)closeControllerView &#123; [UIView animateWithDuration:0.8 animations:^&#123; self.containerView.alpha = 0; self.containerView.frame = CGRectMake(0, CGRectGetMaxY(self.frame), UIScreen.mainScreen.bounds.size.width, 0); &#125; completion:^(BOOL finished) &#123; [self.containerView removeFromSuperview]; &#125;]; for (UIButton *button in self.buttonArray) &#123; button.selected = false; &#125;&#125;#pragma mark - Open the corresponding controller.- (void)openControllerViewWithButton:(UIButton *)sender &#123; for (UIButton *button in self.buttonArray) &#123; button.selected = false; &#125; self.containerView.alpha = 1; for (UIView *view in self.containerView.subviews) &#123; [view removeFromSuperview]; &#125; UIViewController *vc = self.controllerArray[sender.tag - 1000]; double vcHeight = [self.controllerHeightArray[sender.tag - 1000] doubleValue]; self.containerView.frame = CGRectMake(0, CGRectGetMaxY(self.frame), self.frame.size.width, 0); vc.view.frame = CGRectMake(0, 0, UIScreen.mainScreen.bounds.size.width, 0); [self.superview addSubview:self.containerView]; [self.containerView addSubview:vc.view]; [UIView animateWithDuration:0.6 animations:^&#123; self.containerView.frame = CGRectMake(0, CGRectGetMaxY(self.frame), self.frame.size.width, UIScreen.mainScreen.bounds.size.height); vc.view.frame = CGRectMake(0, 0, UIScreen.mainScreen.bounds.size.width, vcHeight); &#125; completion:^(BOOL finished) &#123; &#125;]; sender.selected = true;&#125;#pragma mark - Getter- (UIView *)containerView &#123; if (!_containerView) &#123; _containerView = [[UIButton alloc] init]; _containerView.backgroundColor = [UIColor colorWithWhite:0 alpha:0.1]; [_containerView addTarget:self action:@selector(backButtonTouched:) forControlEvents:UIControlEventTouchUpInside]; &#125; return _containerView;&#125;#pragma mark - Setter- (void)setDataSorce:(id&lt;LZDropViewDataSource&gt;)dataSorce &#123; _dataSorce = dataSorce; if (self.dataSorce &amp;&amp; [self.dataSorce respondsToSelector:@selector(setupCategoryControllerInDropView:)])&#123; self.controllerArray = [self.dataSorce setupCategoryControllerInDropView:self]; &#125; if (self.dataSorce &amp;&amp; [self.dataSorce respondsToSelector:@selector(setupCategoryTitleNameInDropView:)])&#123; self.titleArray = [self.dataSorce setupCategoryTitleNameInDropView:self]; [self setupTitleButton:self.titleArray]; &#125; if (self.dataSorce &amp;&amp; [self.dataSorce respondsToSelector:@selector(setupCategoryControllerHeightInDropView:)]) &#123; self.controllerHeightArray = [self.dataSorce setupCategoryControllerHeightInDropView:self]; &#125; if (self.controllerArray.count != self.titleArray.count || self.controllerArray.count != self.controllerHeightArray.count) &#123; @throw [NSException exceptionWithName:NSStringFromClass([self class]) reason:@"The number of corresponding arrays is inconsistent." userInfo:nil]; &#125;&#125;@end ä½¿ç”¨æ–¹å¼ 1.éµå¾ªåè®®1&lt;LZDropViewDataSource, LZDropViewDelegate&gt; 2.åˆå§‹åŒ–123456LZDropView *view = [[LZDropView alloc] init]; view.dataSorce = self; view.delegate = self; view.backgroundColor = UIColor.whiteColor; view.frame = CGRectMake(0, 100, UIScreen.mainScreen.bounds.size.width, 45); [self.view addSubview:view]; å®žçŽ°ä»£ç†å’Œæ•°æ®æº 12345678910111213141516171819202122232425262728#pragma mark - LZDropViewDataSource- (NSArray&lt;UIViewController *&gt; *)setupCategoryControllerInDropView:(LZDropView *)dropView &#123; return @[[[TableViewController alloc] init], [[TableViewController alloc] init], [[TableViewController alloc] init], [[TableViewController alloc] init]];&#125;- (NSArray&lt;NSString *&gt; *)setupCategoryTitleNameInDropView:(LZDropView *)dropView &#123; return @[@"å…¨éƒ¨", @"é™„è¿‘", @"åªèƒ½æŽ’åº", @"ç­›é€‰"];&#125;- (NSArray&lt;NSNumber *&gt; *)setupCategoryControllerHeightInDropView:(LZDropView *)dropView &#123; return @[[NSNumber numberWithFloat:300], [NSNumber numberWithFloat:400], [NSNumber numberWithFloat:410], [NSNumber numberWithFloat:420]];&#125;#pragma mark - LZDropViewDelegate- (void)dropView:(LZDropView *)dropView didSelectAtColumn:(NSInteger)column info:(NSString *)info &#123; NSLog(@"%ld---%@", column, info);&#125; ç‚¹å‡»controllerä¸­çš„æ•°æ®æ˜¾ç¤ºåœ¨æŒ‰é’®çš„æ ‡é¢˜ä¸­ï¼Œè¿™å› ä¸ºè·¨ç•Œé¢æ˜¾ç¤ºï¼Œæˆ‘æš‚æ—¶æ²¡æœ‰æƒ³åˆ°å¥½çš„åŠžæ³•ï¼Œæ‰€ä»¥ä½¿ç”¨å¼ºå¤§çš„é€šçŸ¥ä¼ å€¼ã€‚ è®°å½•é€‰ä¸­çŠ¶æ€ï¼Œåº”è¯¥æ˜¯æŽ§åˆ¶å™¨é‡Œé¢çš„æ“ä½œï¼Œè¿™é‡Œå°±æ²¡æœ‰å®žçŽ°1[[NSNotificationCenter defaultCenter] postNotificationName:lzDropViewNotification object:self userInfo:@&#123;@"key":[NSString stringWithFormat:@"ç¬¬%ldcell", indexPath.row]&#125;]; å¦‚æžœæœ‰ä»€ä¹ˆä¸å¥½å¦‚æžœå»ºè®®çš„åœ°æ–¹ï¼Œè¯·æ‰¹è¯„æŒ‡æ­£ï¼]]></content>
  </entry>
  <entry>
    <title><![CDATA[ç³»ç»ŸSDKä»‹ç»-02]]></title>
    <url>%2F2018%2F11%2F08%2F%E7%B3%BB%E7%BB%9FSDK%E5%B0%81%E8%A3%85-02%2F</url>
    <content type="text"><![CDATA[ç³»ç»ŸSDKä»‹ç» æ‰“å¼€ç›¸å†Œé€‰æ‹©å›¾ç‰‡ æ‰“å¼€ç›¸å†Œé€‰æ‹©è§†é¢‘ æ‰“å¼€ç›¸æœºæ‹æ‘„å›¾ç‰‡ æ‰“å¼€ç›¸æœºæ‹æ‘„è§†é¢‘ é…ç½®æƒé™ï¼šåœ¨info.plistæ–‡ä»¶ä¸­æ·»åŠ éœ€è¦çš„æƒé™ ç›¸æœºæƒé™ï¼šPrivacy - Camera Usage Description å…è®¸æ­¤æƒé™æ‰èƒ½ä½¿ç”¨ç›¸æœºåŠŸï¼Œè¿™æ ·æ‰èƒ½å½•åˆ¶è§†é¢‘ï¼Œå¹¶ä¸”æƒ³è¦ä¿å­˜å›¾ç‰‡ã€‚ ç›¸å†Œæƒé™ï¼šPrivacy - Photo Library Usage Description å…è®¸æ­¤æƒé™æ‰èƒ½ä½¿ç”¨ç³»ç»Ÿç›¸å†Œã€‚ éº¦å…‹é£Žæƒé™ï¼šPrivacy - Microphone Usage Description èŽ·å–éº¦å…‹é£Žæƒé™ä¸ç„¶ä¼šå´©ï¼Œåªæœ‰å…è®¸æ­¤æƒé™æ‰èƒ½å½•éŸ³ã€‚ åˆ¤æ–­æ˜¯å¦æƒé™123456789#pragma mark - æƒé™åˆ¤æ–­- (BOOL)authorizationCamera &#123; NSString *mediaType = AVMediaTypeVideo; AVAuthorizationStatus authStatus = [AVCaptureDevice authorizationStatusForMediaType:mediaType]; if(authStatus == AVAuthorizationStatusRestricted || authStatus == AVAuthorizationStatusDenied)&#123; return false; &#125; return true;&#125; é…ç½®é€‰é¡¹123456789typedef NS_ENUM(NSInteger, LZSystemPhotoSelectorType) &#123; LZSystemPhotoSelectorTypeVideo, // é€‰æ‹©è§†é¢‘ LZSystemPhotoSelectorTypePhoto, // é€‰æ‹©å›¾ç‰‡&#125;;typedef NS_ENUM(NSInteger, LZSystemOpenDeviceType) &#123; LZSystemOpenDeviceTypeCamera, // æ‰“å¼€ç›¸æœº LZSystemOpenDeviceTypeVideo, // æ‰“å¼€æ‘„åƒæœº&#125;; æŽ¥å£æ–‡ä»¶1234567891011121314151617181920212223242526272829303132333435363738394041#import &lt;Foundation/Foundation.h&gt;NS_ASSUME_NONNULL_BEGINtypedef NS_ENUM(NSInteger, LZSystemPhotoSelectorType) &#123; LZSystemPhotoSelectorTypeVideo, // é€‰æ‹©è§†é¢‘ LZSystemPhotoSelectorTypePhoto, // é€‰æ‹©å›¾ç‰‡&#125;;typedef NS_ENUM(NSInteger, LZSystemOpenDeviceType) &#123; LZSystemOpenDeviceTypeCamera, // æ‰“å¼€ç›¸æœº LZSystemOpenDeviceTypeVideo, // æ‰“å¼€æ‘„åƒæœº&#125;;@interface LZSystemPhotoSelector : NSObject+ (instancetype)selector;/** é€‰æ‹©å›¾ç‰‡æˆ–è§†é¢‘ @param type ç±»åž‹ @param allowsEditing æ˜¯å¦å…è®¸ç¼–è¾‘ @param resultFile é€‰æ‹©ç»“æžœï¼Œå›¾ç‰‡æ˜¯UIImage è§†é¢‘æ˜¯NSUrl */- (void)lz_openAblumWithType:(LZSystemPhotoSelectorType)type allowsEditing:(BOOL)allowsEditing resultFile:(void(^)(id info))resultFile;/** æ‰“å¼€ç›¸æœºæˆ–æ‘„åƒæœº @param type ç±»åž‹ @param allowsEditing æ˜¯å¦æ‹æ‘„å®Œæˆè¿›è¡Œç¼–è¾‘ @param resultFile é€‰æ‹©ç»“æžœï¼Œå›¾ç‰‡æ˜¯UIImage è§†é¢‘æ˜¯NSUrl */- (void)lz_openDeviceWithType:(LZSystemOpenDeviceType)type allowsEditing:(BOOL)allowsEditing resultFile:(void(^)(id info))resultFile;@endNS_ASSUME_NONNULL_END å®žçŽ°æ–‡ä»¶123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113#import "LZSystemPhotoSelector.h"#import &lt;UIKit/UIKit.h&gt;#import &lt;AVFoundation/AVFoundation.h&gt;#import &lt;AssetsLibrary/AssetsLibrary.h&gt;#import &lt;MobileCoreServices/MobileCoreServices.h&gt;#define kRootViewController UIApplication.sharedApplication.delegate.window.rootViewController@interface LZSystemPhotoSelector () &lt;UIImagePickerControllerDelegate, UINavigationControllerDelegate&gt;@property (nonatomic, copy) void (^resultFile)(id info);@property (nonatomic, assign) BOOL allowsEditing;@end@implementation LZSystemPhotoSelector+ (instancetype)selector &#123; static dispatch_once_t onceToken; static LZSystemPhotoSelector *selector; dispatch_once(&amp;onceToken, ^&#123; selector = [[LZSystemPhotoSelector alloc] init]; &#125;); return selector;&#125;#pragma mark - é€‰æ‹©å›¾ç‰‡æˆ–è§†é¢‘- (void)lz_openAblumWithType:(LZSystemPhotoSelectorType)type allowsEditing:(BOOL)allowsEditing resultFile:(void(^)(id info))resultFile &#123; if (![UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypePhotoLibrary]) &#123; resultFile(@"è¯¥è®¾å¤‡æš‚æ—¶ä¸æ”¯æŒ"); return; &#125; self.allowsEditing = allowsEditing; self.resultFile = resultFile; UIImagePickerController *controller = [[UIImagePickerController alloc] init]; controller.delegate = self; controller.sourceType = UIImagePickerControllerSourceTypePhotoLibrary; if (type == LZSystemPhotoSelectorTypePhoto) &#123; controller.mediaTypes = [NSArray arrayWithObjects:@"public.image", nil]; &#125; else &#123; controller.mediaTypes = [NSArray arrayWithObjects:@"public.movie", nil]; &#125; controller.allowsEditing = allowsEditing; [kRootViewController presentViewController:controller animated:true completion:nil];&#125;#pragma mark - æ‰“å¼€ç›¸æœºæˆ–æ‘„åƒæœº- (void)lz_openDeviceWithType:(LZSystemOpenDeviceType)type allowsEditing:(BOOL)allowsEditing resultFile:(void (^)(id _Nonnull))resultFile &#123; if (![UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypeCamera]) &#123; resultFile(@"è¯¥è®¾å¤‡æš‚æ—¶ä¸æ”¯æŒ"); return; &#125; if (![self authorizationCamera]) &#123; resultFile(@"æš‚æ— ç›¸æœºæƒé™"); return; &#125; self.allowsEditing = allowsEditing; self.resultFile = resultFile; UIImagePickerController *controller = [[UIImagePickerController alloc] init]; controller.delegate = self; controller.sourceType = UIImagePickerControllerSourceTypeCamera; if (type == LZSystemOpenDeviceTypeCamera) &#123; controller.mediaTypes = [NSArray arrayWithObjects:@"public.image", nil]; &#125; else &#123; controller.mediaTypes = [NSArray arrayWithObjects:@"public.movie", nil]; &#125; controller.allowsEditing = allowsEditing; [kRootViewController presentViewController:controller animated:true completion:nil];&#125;#pragma mark - UIImagePickerControllerDelegate- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary&lt;NSString *,id&gt; *)info &#123; NSString *mediaType = [info objectForKey:UIImagePickerControllerMediaType]; if ([mediaType isEqualToString:(NSString *)kUTTypeImage]) &#123; if (self.allowsEditing) &#123; UIImage *editorImage = info[UIImagePickerControllerEditedImage]; self.resultFile(editorImage); &#125; else &#123; UIImage *editorImage = info[UIImagePickerControllerOriginalImage]; self.resultFile(editorImage); &#125; &#125; else &#123; NSURL *url = info[UIImagePickerControllerMediaURL]; self.resultFile(url); &#125; [picker dismissViewControllerAnimated:true completion:nil];&#125;- (void)imagePickerControllerDidCancel:(UIImagePickerController *)picker &#123; [picker dismissViewControllerAnimated:true completion:nil];&#125;#pragma mark - æƒé™åˆ¤æ–­- (BOOL)authorizationCamera &#123; NSString *mediaType = AVMediaTypeVideo; AVAuthorizationStatus authStatus = [AVCaptureDevice authorizationStatusForMediaType:mediaType]; if(authStatus == AVAuthorizationStatusRestricted || authStatus == AVAuthorizationStatusDenied)&#123; return false; &#125; return true;&#125;@end]]></content>
  </entry>
  <entry>
    <title><![CDATA[ç³»ç»ŸSDKä»‹ç»-01]]></title>
    <url>%2F2018%2F11%2F08%2F%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80%E5%BA%94%E7%94%A8-01%2F</url>
    <content type="text"><![CDATA[ç³»ç»ŸSDKä»‹ç» è®¿é—®è”ç³»äººï¼Œå¹¶é€‰æ‹©ä¿¡æ¯ æ‹¨å· å‘é€çŸ­ä¿¡ å‘é€é‚®ä»¶ æœ¬åœ°é€šçŸ¥ æŽ¥å£æ–‡ä»¶123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102#import &lt;Foundation/Foundation.h&gt;#import &lt;ContactsUI/ContactsUI.h&gt;NS_ASSUME_NONNULL_BEGIN@interface LZSystemSDKManager : NSObject+ (instancetype)manager;/** é€‰æ‹©è”ç³»äºº å…ˆæ·»åŠ æƒé™ @param result é€‰æ‹©çš„ä¿¡æ¯ */- (void)lz_selecteContactResulet:(void(^)(CNContact *obj))result API_AVAILABLE(ios(9.0));/** å‘é€é‚®ä»¶ @param toRecipients æ”¶ä»¶äººç¾¤ç»„ @param ccRecipients æŠ„é€äººç¾¤ç»„ @param bccRecipients å¯†é€äººç¾¤ç»„ @param theme ä¸»é¢˜ @param emailContent æ­£æ–‡å†…å®¹ @param isHTML æ˜¯å¦æ˜¯HTMLæ ¼å¼ @param result å‘é€ç»“æžœ */- (void)lz_postEmialWithToRecipients:(NSArray&lt;NSString *&gt; *)toRecipients ccRecipients:(NSArray&lt;NSString *&gt; *)ccRecipients bccRecipients:(NSArray&lt;NSString *&gt; *)bccRecipients theme:(NSString *)theme emailContent:(NSString *)emailContent isHTML:(BOOL)isHTML reslt:(void(^)(NSInteger))result;/** å‘é€çŸ­ä¿¡ @param toRecipients æ”¶ä»¶äººç¾¤ç»„ @param content å†…å®¹ @param result å‘é€ç»“æžœ */- (void)lz_sendMessageWithToRecipients:(NSArray&lt;NSString *&gt; *)toRecipients content:(NSString *)content reslt:(void(^)(NSInteger))result;/** æ‹¨å· @param phoneNum å·ç  */- (void)lz_dailPhone:(NSString *)phoneNum;/** å¼€å¯å®šä½æœåŠ¡ @param localResult å®šä½èŽ·å–ä¿¡æ¯ */- (void)lz_openLocationService:(void(^)(id info))localResult;/** IOS 10çš„é€šçŸ¥ æŽ¨é€æ¶ˆæ¯ æ”¯æŒçš„éŸ³é¢‘ å›¾ç‰‡ &lt;= 10M è§†é¢‘ &lt;= 50M @param body æ¶ˆæ¯å†…å®¹ @param promptTone æç¤ºéŸ³ @param soundName éŸ³é¢‘ @param imageName å›¾ç‰‡ @param movieName è§†é¢‘ @param identifier æ¶ˆæ¯æ ‡è¯† */-(void)lz_pushNotification_IOS_10_Title:(NSString *)title subtitle:(NSString *)subtitle body:(NSString *)body promptTone:(NSString *)promptTone soundName:(NSString *)soundName imageName:(NSString *)imageName movieName:(NSString *)movieName timeInterval:(NSTimeInterval)TimeInterval repeats:(BOOL)repeats Identifier:(NSString *)identifier API_AVAILABLE(ios(10.0));/** IOS 10å‰çš„é€šçŸ¥ @param timeInterval å»¶è¿Ÿæ—¶é—´ @param repeatInterval é‡å¤æé†’æ¬¡æ•° @param alertBody å†…å®¹ @param alertTitle æ ‡é¢˜ @param alertAction æ»‘åŠ¨æ–‡å­— @param alertLaunchImage alertLaunchImage @param soundName å£°éŸ³ ä¸ºç©ºåˆ™ä¸ºç³»ç»Ÿå£°éŸ³ @param userInfo å­—å…¸å‚æ•° */- (void)lz_pushNotifationWithTimeInterval:(NSTimeInterval)timeInterval repeatInterval:(NSInteger)repeatInterval alertBody:(NSString *)alertBody alertTitle:(NSString *)alertTitle alertAction:(NSString *)alertAction alertLaunchImage:(NSString *)alertLaunchImage soundName:(NSString *)soundName userInfo:(NSDictionary *)userInfo;@endNS_ASSUME_NONNULL_END å®žçŽ°æ–‡ä»¶123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349#import "LZSystemSDKManager.h"#import &lt;UIKit/UIKit.h&gt;#import &lt;MessageUI/MessageUI.h&gt;#import &lt;CoreLocation/CoreLocation.h&gt;#import &lt;UserNotifications/UserNotifications.h&gt;#define kRootViewController UIApplication.sharedApplication.delegate.window.rootViewController@interface LZSystemSDKManager () &lt; CNContactPickerDelegate, MFMailComposeViewControllerDelegate, MFMessageComposeViewControllerDelegate, CLLocationManagerDelegate&gt;@property (nonatomic, copy) void (^selectContactResult)(CNContact *obj) API_AVAILABLE(ios(9.0));@property (nonatomic, copy) void (^postEmailResult)(NSInteger obj);@property (nonatomic, copy) void (^sendMessageResult)(NSInteger obj);@property (nonatomic, copy) void (^locakResult)(id info);@end@implementation LZSystemSDKManager+ (instancetype)manager &#123; static dispatch_once_t onceToken; static LZSystemSDKManager *manager; dispatch_once(&amp;onceToken, ^&#123; manager = [[LZSystemSDKManager alloc] init]; &#125;); return manager;&#125;#pragma mark - é€‰æ‹©è”ç³»äººä¿¡æ¯- (void)lz_selecteContactResulet:(void(^)(CNContact *obj))result API_AVAILABLE(ios(9.0)) &#123; self.selectContactResult = result; CNAuthorizationStatus status = [CNContactStore authorizationStatusForEntityType:CNEntityTypeContacts]; if (status == CNAuthorizationStatusNotDetermined) &#123; CNContactStore *store = [[CNContactStore alloc] init]; [store requestAccessForEntityType:CNEntityTypeContacts completionHandler:^(BOOL granted, NSError * _Nullable error) &#123; if (error) &#123; [self showHUDTitle:@"æœªèŽ·å–è®¿é—®æƒé™" info:@"è¯·å‰å¾€è®¾ç½®ä¸­æ‰“å¼€è®¿é—®æƒé™"]; &#125; else &#123; CNContactPickerViewController * picker = [CNContactPickerViewController new]; picker.delegate = self; picker.displayedPropertyKeys = @[CNContactPhoneNumbersKey]; [kRootViewController presentViewController: picker animated:YES completion:nil]; &#125; &#125;]; &#125; if (status == CNAuthorizationStatusAuthorized) &#123; CNContactPickerViewController * picker = [CNContactPickerViewController new]; picker.delegate = self; picker.displayedPropertyKeys = @[CNContactPhoneNumbersKey]; [kRootViewController presentViewController: picker animated:YES completion:nil]; &#125; else&#123; [self showHUDTitle:@"æœªèŽ·å–è®¿é—®æƒé™" info:@"è¯·å‰å¾€è®¾ç½®ä¸­æ‰“å¼€è®¿é—®æƒé™"]; &#125;&#125;#pragma mark - CNContactPickerDelegate- (void)contactPicker:(CNContactPickerViewController *)picker didSelectContactProperty:(CNContactProperty *)contactProperty API_AVAILABLE(ios(9.0)) &#123; CNContact *contact = contactProperty.contact; self.selectContactResult(contact);&#125;#pragma mark - å‘é€é‚®ä»¶- (void)lz_postEmialWithToRecipients:(NSArray&lt;NSString *&gt; *)toRecipients ccRecipients:(NSArray&lt;NSString *&gt; *)ccRecipients bccRecipients:(NSArray&lt;NSString *&gt; *)bccRecipients theme:(NSString *)theme emailContent:(NSString *)emailContent isHTML:(BOOL)isHTML reslt:(nonnull void (^)(NSInteger))result &#123; self.postEmailResult = result; MFMailComposeViewController *mailCompose = [[MFMailComposeViewController alloc] init]; mailCompose.mailComposeDelegate = self; [mailCompose setToRecipients:toRecipients]; [mailCompose setCcRecipients:ccRecipients]; [mailCompose setBccRecipients:bccRecipients]; [mailCompose setSubject:theme]; [mailCompose setMessageBody:emailContent isHTML:isHTML]; [kRootViewController presentViewController:mailCompose animated:YES completion:nil];&#125;#pragma mark - MFMailComposeViewControllerDelegateçš„ä»£ç†æ–¹æ³•ï¼š-(void)mailComposeController:(MFMailComposeViewController *)controller didFinishWithResult:(MFMailComposeResult)result error:(NSError *)error &#123; [controller dismissViewControllerAnimated:YES completion:nil]; self.postEmailResult(result);&#125;#pragma mark - å‘é€çŸ­ä¿¡- (void)lz_sendMessageWithToRecipients:(NSArray&lt;NSString *&gt; *)toRecipients content:(NSString *)content reslt:(nonnull void (^)(NSInteger))result &#123; self.sendMessageResult = result; MFMessageComposeViewController *messageVC = [[MFMessageComposeViewController alloc] init]; messageVC.recipients = toRecipients; messageVC.body = content; messageVC.messageComposeDelegate = self; [kRootViewController presentViewController:messageVC animated:YES completion:nil];&#125;#pragma mark - MFMessageComposeViewControllerDelegate- (void)messageComposeViewController:(MFMessageComposeViewController *)controller didFinishWithResult:(MessageComposeResult)result &#123; [controller dismissViewControllerAnimated:true completion:nil]; self.sendMessageResult(result);&#125;#pragma mark - æ‹¨å·- (void)lz_dailPhone:(NSString *)phoneNum &#123; [[UIApplication sharedApplication] openURL:[NSURL URLWithString:[NSString stringWithFormat:@"tel:%@",phoneNum]]];&#125;#pragma mark - å®šä½æœåŠ¡- (void)lz_openLocationService:(void(^)(id info))localResult &#123; self.locakResult = localResult; CLLocationManager *localManager = [[CLLocationManager alloc] init]; localManager.delegate = self; localManager.desiredAccuracy = kCLLocationAccuracyBest; localManager.distanceFilter = kCLLocationAccuracyNearestTenMeters; [localManager requestWhenInUseAuthorization]; if ([CLLocationManager locationServicesEnabled] || [CLLocationManager authorizationStatus] == kCLAuthorizationStatusAuthorizedWhenInUse || [CLLocationManager authorizationStatus] == kCLAuthorizationStatusAuthorizedAlways) &#123; [localManager startUpdatingLocation]; &#125; else &#123; [self showHUDTitle:@"æœªèŽ·å–å®šä½æƒé™" info:@"è¯·å‰å¾€è®¾ç½®ä¸­æ‰“å¼€å®šä½æƒé™"]; &#125;&#125;#pragma mark CLLocationManagerDelegate- (void)locationManager:(CLLocationManager *)manager didUpdateLocations:(NSArray *)locations &#123; CLLocation *currLocation = [locations lastObject]; CLLocation *infLocation = [[CLLocation alloc] initWithLatitude:currLocation.coordinate.latitude longitude:currLocation.coordinate.longitude]; CLGeocoder *geocoder=[[CLGeocoder alloc]init]; [geocoder reverseGeocodeLocation:infLocation completionHandler:^(NSArray&lt;CLPlacemark *&gt; * _Nullable placemarks, NSError * _Nullable error) &#123; if (error !=nil || placemarks.count == 0) &#123; NSLog(@"%@",error); self.locakResult(nil); return ; &#125; NSDictionary *infoDic = @&#123;@"country":placemarks.firstObject.country, @"administrativeArea":placemarks.firstObject.administrativeArea, @"locality":placemarks.firstObject.locality, @"subLocality":placemarks.firstObject.subLocality, @"thoroughfare":placemarks.firstObject.thoroughfare, @"name":placemarks.firstObject.name &#125;; self.locakResult(infoDic); &#125;];&#125;-(void)locationManager:(CLLocationManager *)manager didFailWithError:(NSError *)error &#123; [self showHUDTitle:@"æœªèŽ·å–å®šä½æƒé™" info:@"è¯·å‰å¾€è®¾ç½®ä¸­æ‰“å¼€å®šä½æƒé™"];&#125;#pragma mark - æç¤ºæ¡†- (void)showHUDTitle:(NSString *)title info:(NSString *)info &#123; UIAlertController *alterController = [UIAlertController alertControllerWithTitle:title message:info preferredStyle:UIAlertControllerStyleAlert]; UIAlertAction *cancal = [UIAlertAction actionWithTitle:@"å–æ¶ˆ" style:UIAlertActionStyleCancel handler:nil]; UIAlertAction *sure = [UIAlertAction actionWithTitle:@"ç¡®å®š" style:UIAlertActionStyleDestructive handler:^(UIAlertAction * _Nonnull action) &#123; NSURL *url = [NSURL URLWithString:UIApplicationOpenSettingsURLString]; if ([[UIApplication sharedApplication] canOpenURL:url]) &#123; if (@available(iOS 10.0, *)) &#123; [[UIApplication sharedApplication] openURL:url options:@&#123;&#125; completionHandler:nil]; &#125; else &#123; &#125; &#125; &#125;]; [alterController addAction:cancal]; [alterController addAction:sure]; [kRootViewController presentViewController:alterController animated:true completion:nil];&#125;#pragma mark - IOS 10å‰çš„é€šçŸ¥- (void)lz_pushNotifationWithTimeInterval:(NSTimeInterval)timeInterval repeatInterval:(NSInteger)repeatInterval alertBody:(NSString *)alertBody alertTitle:(NSString *)alertTitle alertAction:(NSString *)alertAction alertLaunchImage:(NSString *)alertLaunchImage soundName:(NSString *)soundName userInfo:(NSDictionary *)userInfo &#123; // å®šä¹‰æœ¬åœ°é€šçŸ¥å¯¹è±¡ UILocalNotification *notification = [[UILocalNotification alloc] init]; // è®¾ç½®è°ƒç”¨æ—¶é—´ notification.timeZone = [NSTimeZone localTimeZone]; //é€šçŸ¥è§¦å‘çš„æ—¶é—´ï¼Œ10sä»¥åŽ notification.fireDate = [NSDate dateWithTimeIntervalSinceNow:timeInterval]; // é€šçŸ¥é‡å¤æ¬¡æ•° notification.repeatInterval = repeatInterval; // å½“å‰æ—¥åŽ†ï¼Œä½¿ç”¨å‰æœ€å¥½è®¾ç½®æ—¶åŒºç­‰ä¿¡æ¯ä»¥ä¾¿èƒ½å¤Ÿè‡ªåŠ¨åŒæ­¥æ—¶é—´ notification.repeatCalendar = [NSCalendar currentCalendar]; //è®¾ç½®é€šçŸ¥å±žæ€§ // é€šçŸ¥ä¸»ä½“ notification.alertBody = alertBody; if (@available(iOS 8.2, *)) &#123; notification.alertTitle = alertTitle; &#125; else &#123; // Fallback on earlier versions &#125; // åº”ç”¨ç¨‹åºå›¾æ ‡å³ä¸Šè§’æ˜¾ç¤ºçš„æ¶ˆæ¯æ•° notification.applicationIconBadgeNumber += 1; // å¾…æœºç•Œé¢çš„æ»‘åŠ¨åŠ¨ä½œæç¤º notification.alertAction = alertAction; // é€šè¿‡ç‚¹å‡»é€šçŸ¥æ‰“å¼€åº”ç”¨æ—¶çš„å¯åŠ¨å›¾ç‰‡,è¿™é‡Œä½¿ç”¨ç¨‹åºå¯åŠ¨å›¾ç‰‡ notification.alertLaunchImage = alertLaunchImage; // æ”¶åˆ°é€šçŸ¥æ—¶æ’­æ”¾çš„å£°éŸ³ï¼Œé»˜è®¤æ¶ˆæ¯å£°éŸ³ notification.soundName = soundName.length == 0 ? UILocalNotificationDefaultSoundName : soundName; //è®¾ç½®ç”¨æˆ·ä¿¡æ¯ notification.userInfo = userInfo; //è°ƒç”¨é€šçŸ¥ [[UIApplication sharedApplication] scheduleLocalNotification:notification];&#125;#pragma mark - IOS 10çš„é€šçŸ¥-(void)lz_pushNotification_IOS_10_Title:(NSString *)title subtitle:(NSString *)subtitle body:(NSString *)body promptTone:(NSString *)promptTone soundName:(NSString *)soundName imageName:(NSString *)imageName movieName:(NSString *)movieName timeInterval:(NSTimeInterval)TimeInterval repeats:(BOOL)repeats Identifier:(NSString *)identifier API_AVAILABLE(ios(10.0)) &#123; //èŽ·å–é€šçŸ¥ä¸­å¿ƒç”¨æ¥æ¿€æ´»æ–°å»ºçš„é€šçŸ¥ UNUserNotificationCenter * center = [UNUserNotificationCenter currentNotificationCenter]; UNMutableNotificationContent * content = [[UNMutableNotificationContent alloc] init]; content.title = title; content.subtitle = subtitle; content.body = body; //é€šçŸ¥çš„æç¤ºéŸ³ if ([promptTone containsString:@"."]) &#123; UNNotificationSound *sound = [UNNotificationSound soundNamed:promptTone]; content.sound = sound; &#125; __block UNNotificationAttachment *imageAtt; __block UNNotificationAttachment *movieAtt; __block UNNotificationAttachment *soundAtt; if ([imageName containsString:@"."]) &#123; [self addNotificationAttachmentContent:content attachmentName:imageName options:nil withCompletion:^(NSError *error, UNNotificationAttachment *notificationAtt) &#123; imageAtt = [notificationAtt copy]; &#125;]; &#125; if ([soundName containsString:@"."]) &#123; [self addNotificationAttachmentContent:content attachmentName:soundName options:nil withCompletion:^(NSError *error, UNNotificationAttachment *notificationAtt) &#123; soundAtt = [notificationAtt copy]; &#125;]; &#125; if ([movieName containsString:@"."]) &#123; // åœ¨è¿™é‡Œæˆªå–è§†é¢‘çš„ç¬¬10sä¸ºè§†é¢‘çš„ç¼©ç•¥å›¾ ï¼šUNNotificationAttachmentOptionsThumbnailTimeKey [self addNotificationAttachmentContent:content attachmentName:movieName options:@&#123;@"UNNotificationAttachmentOptionsThumbnailTimeKey":@10&#125; withCompletion:^(NSError *error, UNNotificationAttachment *notificationAtt) &#123; movieAtt = [notificationAtt copy]; &#125;]; &#125; NSMutableArray * array = [NSMutableArray array]; if (imageAtt) &#123; [array addObject:imageAtt]; &#125; if (soundAtt) &#123; [array addObject:soundAtt]; &#125; if (movieAtt) &#123; [array addObject:movieAtt]; &#125; content.attachments = array; //æ·»åŠ é€šçŸ¥ä¸‹æ‹‰åŠ¨ä½œæŒ‰é’® NSMutableArray * actionMutableArray = [NSMutableArray array]; UNNotificationAction * actionA = [UNNotificationAction actionWithIdentifier:@"identifierNeedUnlock" title:@"è¿›å…¥åº”ç”¨" options:UNNotificationActionOptionAuthenticationRequired]; UNNotificationAction * actionB = [UNNotificationAction actionWithIdentifier:@"identifierRed" title:@"å¿½ç•¥" options:UNNotificationActionOptionDestructive]; [actionMutableArray addObjectsFromArray:@[actionA,actionB]]; if (actionMutableArray.count &gt; 1) &#123; UNNotificationCategory * category = [UNNotificationCategory categoryWithIdentifier:@"categoryNoOperationAction" actions:actionMutableArray intentIdentifiers:@[] options:UNNotificationCategoryOptionCustomDismissAction]; [center setNotificationCategories:[NSSet setWithObjects:category, nil]]; content.categoryIdentifier = @"categoryNoOperationAction"; &#125; // UNTimeIntervalNotificationTrigger å»¶æ—¶æŽ¨é€ // UNCalendarNotificationTrigger å®šæ—¶æŽ¨é€ // UNLocationNotificationTrigger ä½ç½®å˜åŒ–æŽ¨é€ BOOL repeat = (TimeInterval &gt; 60 &amp;&amp; repeats) ? true : false; UNTimeIntervalNotificationTrigger * tirgger = [UNTimeIntervalNotificationTrigger triggerWithTimeInterval:TimeInterval repeats:repeat]; //å»ºç«‹é€šçŸ¥è¯·æ±‚ UNNotificationRequest * request = [UNNotificationRequest requestWithIdentifier:identifier content:content trigger:tirgger]; //å°†å»ºç«‹çš„é€šçŸ¥è¯·æ±‚æ·»åŠ åˆ°é€šçŸ¥ä¸­å¿ƒ [center addNotificationRequest:request withCompletionHandler:^(NSError * _Nullable error) &#123; NSLog(@"%@æœ¬åœ°æŽ¨é€ :( æŠ¥é”™ %@",identifier, error); &#125;];&#125;/** å¢žåŠ é€šçŸ¥é™„ä»¶ @param content é€šçŸ¥å†…å®¹ @param attachmentName é™„ä»¶åç§° @param options ç›¸å…³é€‰é¡¹ @param completion ç»“æžœå›žè°ƒ */-(void)addNotificationAttachmentContent:(UNMutableNotificationContent *)content attachmentName:(NSString *)attachmentName options:(NSDictionary *)options withCompletion:(void(^)(NSError * error , UNNotificationAttachment * notificationAtt))completion API_AVAILABLE(ios(10.0)) &#123; NSArray * arr = [attachmentName componentsSeparatedByString:@"."]; NSError * error; NSString * path = [[NSBundle mainBundle]pathForResource:arr[0] ofType:arr[1]]; UNNotificationAttachment * attachment = [UNNotificationAttachment attachmentWithIdentifier:[NSString stringWithFormat:@"notificationAtt_%@",arr[1]] URL:[NSURL fileURLWithPath:path] options:options error:&amp;error]; if (error) &#123; NSLog(@"attachment error %@", error); &#125; completion(error,attachment); content.launchImageName = attachmentName;&#125;@end]]></content>
  </entry>
  <entry>
    <title><![CDATA[iOSç³»ç»Ÿå°è£…ï¼šQQä¾§è¾¹èœå•]]></title>
    <url>%2F2018%2F09%2F30%2FiOS%E7%B3%BB%E7%BB%9F%E5%B0%81%E8%A3%85%EF%BC%9AQQ%E4%BE%A7%E8%BE%B9%E8%8F%9C%E5%8D%95%2F</url>
    <content type="text"><![CDATA[12345678910111213141516171819202122232425262728293031#import &lt;UIKit/UIKit.h&gt;NS_ASSUME_NONNULL_BEGIN@interface LZSliderContainerViewController : UIViewController// æ˜¯å¦å…è®¸ä¾§æ»‘æ‰‹åŠ¿@property (nonatomic, assign) BOOL allowOpenSliderView;// å•ä¾‹+ (instancetype)mamager;/** åˆå§‹åŒ–æ–¹æ³• @param mainController ä¸»é¡µé¢æŽ§åˆ¶å™¨ @param sliderController èœå•é¡µé¢æŽ§åˆ¶å™¨ @param space ç©ºéš™ @return UIViewController */- (UIViewController *)lz_setupMainController:(UIViewController *)mainController sliderController:(UIViewController *)sliderController space:(CGFloat)space;/** æ‰“å¼€ä¾§è¾¹èœå• */- (void)lz_openSlderView;/** å…³é—­ä¾§è¾¹èœå• */- (void)lz_closeSliderView;@end 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192#import "LZSliderContainerViewController.h"@interface UIView (Frame)@property (nonatomic) CGFloat left;@property (nonatomic) CGFloat right;@end@implementation UIView (Frame)- (CGFloat)left &#123; return self.frame.origin.x;&#125;- (void)setLeft:(CGFloat)x &#123; CGRect frame = self.frame; frame.origin.x = x; self.frame = frame;&#125;- (CGFloat)right &#123; return self.frame.origin.x + self.frame.size.width;&#125;- (void)setRight:(CGFloat)right &#123; CGRect frame = self.frame; frame.origin.x = right - frame.size.width; self.frame = frame;&#125;@end@interface LZSliderContainerViewController ()@property (nonatomic, strong) UIViewController *mainController;@property (nonatomic, strong) UIViewController *sliderController;@property (nonatomic, assign) CGFloat spece;@property (nonatomic, assign) CGFloat panStartX;@property (nonatomic, strong) UIView *coverView;@end@implementation LZSliderContainerViewController#pragma mark - å•ä¾‹æ–¹æ³•+ (instancetype)mamager &#123; static dispatch_once_t onceToken; static LZSliderContainerViewController *vc; dispatch_once(&amp;onceToken, ^&#123; vc = [[LZSliderContainerViewController alloc] init]; &#125;); return vc;&#125;#pragma mark - åˆå§‹åŒ–æ–¹æ³•- (UIViewController *)lz_setupMainController:(UIViewController *)mainController sliderController:(UIViewController *)sliderController space:(CGFloat)space &#123; [self lz_addChildControllerWithMainController:mainController sliderController:sliderController]; [self lz_setupCoverView]; _spece = space; return self;&#125;#pragma mark - é…ç½®é®ç½©å±‚- (void)lz_setupCoverView &#123; self.coverView = [[UIView alloc] init]; self.coverView.frame = UIScreen.mainScreen.bounds; self.coverView.backgroundColor = [[UIColor blackColor] colorWithAlphaComponent:0]; self.coverView.hidden = true; [self.coverView addGestureRecognizer:[[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(lz_closeSliderView)]]; [self.view addSubview:self.coverView];&#125;#pragma mark - æ·»åŠ VC- (void)lz_addChildControllerWithMainController:(UIViewController *)mainController sliderController:(UIViewController *)sliderController &#123; [self addChildViewController:mainController]; [mainController didMoveToParentViewController:self]; mainController.view.frame = UIScreen.mainScreen.bounds; [self.view addSubview:mainController.view]; [self addChildViewController:sliderController]; [sliderController didMoveToParentViewController:self]; sliderController.view.frame = CGRectMake(-UIScreen.mainScreen.bounds.size.width, 0, UIScreen.mainScreen.bounds.size.width, UIScreen.mainScreen.bounds.size.height); [self.view addSubview:sliderController.view]; self.mainController = mainController; self.sliderController = sliderController; [self lz_setupGusture];&#125;#pragma mark - æ·»åŠ å¹³ç§»æ‰‹åŠ¿- (void)lz_setupGusture &#123; UIPanGestureRecognizer *panGusture = [[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(lz_panGestureRecognizer:)]; [self.view addGestureRecognizer:panGusture];&#125;#pragma mark - UIPanGestureRecognizer Action- (void)lz_panGestureRecognizer:(UIPanGestureRecognizer *)sender &#123; UIView *rootView = self.mainController.view; UIView *menuView = self.sliderController.view; if (sender.state == UIGestureRecognizerStateBegan) &#123; CGFloat startPointX = [sender translationInView:self.view].x; self.panStartX = startPointX; self.coverView.hidden = false; &#125; if (self.panStartX &gt;= 40 &amp;&amp; rootView.frame.origin.x == 0) &#123; return; &#125; CGFloat translationX = [sender translationInView:rootView].x; CGFloat rootViewX = rootView.frame.origin.x; rootViewX = [self lz_minmumWithValueA:(rootViewX + translationX) valueB:(UIScreen.mainScreen.bounds.size.width - self.spece)]; rootViewX = [self lz_maxmumWithValueA:rootViewX valueB:0]; rootView.left = rootViewX; menuView.right = rootView.left; self.coverView.frame = rootView.frame; CGFloat aphal = 0.5 * rootView.frame.origin.x / (UIScreen.mainScreen.bounds.size.width - self.spece); self.coverView.backgroundColor = [[UIColor blackColor] colorWithAlphaComponent:aphal]; [sender setTranslation:CGPointZero inView:rootView]; if (sender.state == UIGestureRecognizerStateEnded || sender.state == UIGestureRecognizerStateCancelled) &#123; if (rootViewX &gt;= (UIScreen.mainScreen.bounds.size.width - self.spece)/2) &#123; [self lz_openSlderView]; &#125; else&#123; [self lz_closeSliderView]; &#125; &#125;&#125;#pragma mark - æ‰“å¼€ä¾§è¾¹èœå•- (void)lz_openSlderView &#123; [self lz_setupGusture]; UIView *rootView = self.mainController.view; UIView *menuView = self.sliderController.view; self.coverView.hidden = false; [UIView animateWithDuration:0.4 animations:^&#123; rootView.left = UIScreen.mainScreen.bounds.size.width - self.spece; menuView.right = rootView.left; self.coverView.frame = rootView.frame; self.coverView.backgroundColor = [[UIColor blackColor] colorWithAlphaComponent:0.5]; &#125;];&#125;#pragma mark - å…³é—­ä¾§è¾¹èœå•- (void)lz_closeSliderView &#123; UIView *rootView = self.mainController.view; UIView *menuView = self.sliderController.view; [UIView animateWithDuration:0.4 animations:^&#123; self.coverView.backgroundColor = [[UIColor blackColor] colorWithAlphaComponent:0]; rootView.left = 0; menuView.right = rootView.left; self.coverView.frame = rootView.frame; &#125; completion:^(BOOL finished) &#123; if (finished) &#123; self.coverView.hidden = true; &#125; &#125;];&#125;#pragma mark - æ¯”è¾ƒå¤§å°å–æœ€å°å€¼- (CGFloat)lz_minmumWithValueA:(CGFloat)a valueB:(CGFloat)b &#123; return a &gt; b ? b : a;&#125;#pragma mark - æ¯”è¾ƒå¤§å°å–æœ€å¤§å€¼- (CGFloat)lz_maxmumWithValueA:(CGFloat)a valueB:(CGFloat)b &#123; return a &gt; b ? a : b;&#125;#pragma mark - Setter- (void)setAllowOpenSliderView:(BOOL)allowOpenSliderView &#123; _allowOpenSliderView = allowOpenSliderView; if (allowOpenSliderView) &#123; [self lz_setupGusture]; &#125; else &#123; for (UIGestureRecognizer *pan in self.view.gestureRecognizers) &#123; [self.view removeGestureRecognizer:pan]; &#125; &#125;&#125;@end AppDelegateä¸­è®¾ç½®ä¸ºæ ¹æŽ§åˆ¶å™¨1self.window.rootViewController = [[LZSliderContainerViewController mamager] lz_setupMainController:tab sliderController:sldier space:200]; // å•ç‹¬æ‰“å¼€æˆ–å…³é—­1234// æ‰“å¼€é¡µé¢[[LZSliderContainerViewController mamager] lz_openSlderView];// å…³é—­é¡µé¢[[LZSliderContainerViewController mamager] lz_closeSliderView]; é»˜è®¤æ‰€æœ‰é¡µé¢éƒ½æ˜¯æ‰“å¼€çš„ï¼Œå¦‚æžœéœ€è¦å…³é—­123456789- (void)viewWillAppear:(BOOL)animated&#123; [super viewWillAppear:animated]; [LZSliderContainerViewController mamager].allowOpenSliderView = NO;&#125;- (void)viewDidDisappear:(BOOL)animated &#123; [super viewDidDisappear:animated]; [LZSliderContainerViewController mamager].allowOpenSliderView = true;&#125; æ•ˆæžœå›¾]]></content>
  </entry>
  <entry>
    <title><![CDATA[æ•°æ®å­˜å‚¨ï¼šFMDB-æ¨¡åž‹è¿›è¡Œå­˜å–]]></title>
    <url>%2F2018%2F09%2F05%2F%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%EF%BC%9AFMDB-%E6%A8%A1%E5%9E%8B%E8%BF%9B%E8%A1%8C%E5%AD%98%E5%8F%96%2F</url>
    <content type="text"><![CDATA[å†™è¿™ä¸ªBlogçš„ç›®çš„æ˜¯ä¸ºäº†è®°å½•çš„å­¦ä¹ ç»åŽ†ï¼Œä»£ç å†™çš„ä¸æ˜¯å¾ˆå¥½ï¼Œå¸Œæœ›è¯»è€…ç†è§£ã€‚æ—¥å¸¸å¯¹æ•°æ®åº“çš„æ“ä½œï¼Œéœ€è¦è®¾è®¡å­—æ®µï¼Œæ„Ÿè§‰å¤ªç¹çäº†ï¼Œæƒ³æ‰¾ä¸ªç®€åŒ–çš„æ–¹æ³•ï¼Œå°±æƒ³é€šè¿‡è¿™æ ·è¿›è¡Œå®žçŽ°ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸€ç§æ€è€ƒæ–¹å¼ã€‚å®žé™…å®žçŽ°è¿˜æ˜¯çœ‹éœ€æ±‚ã€‚å…·ä½“çœ‹ä»£ç ï¼š1ã€å¯¼å…¥FMDB1import FMDB 2ã€ä½¿ç”¨å•åˆ©æ¨¡å¼å’Œå¿…è¦å±žæ€§1234static let defaultManger = WDDataBaseManager()typealias successBlock = () -&gt;Voidtypealias failBlock = () -&gt;Voidprivate var tableName:String? 3ã€æ‡’åŠ è½½åˆ›å»ºæ•°æ®åº“ï¼ˆåç§°æˆ‘éšä¾¿å–å¾—ï¼‰12345lazy var fmdb:FMDatabase = &#123; let path = NSHomeDirectory().appending("/Documents/testDB.db") let db = FMDatabase(path: path) return db &#125;() 4ã€åˆ›å»ºè¡¨123456789func creatTable(tableName:String) -&gt; Void &#123; fmdb.open() self.tableName = tableName let creatSql = "create table if not exists \(tableName) (id integer primary key autoincrement,model BLOB)" let result = fmdb.executeUpdate(creatSql, withArgumentsIn:[]) if result&#123; print("åˆ›å»ºè¡¨æˆåŠŸ") &#125; &#125; 5ã€åˆ é™¤è¡¨1234567func dropTable() -&gt; Void &#123; let sql = "drop table if exists " + tableName! let result = fmdb.executeUpdate(sql, withArgumentsIn:[]) if result&#123; print("åˆ é™¤è¡¨æˆåŠŸ") &#125; &#125; 6ã€æ’å…¥æ•°æ®1234567891011func insert(model:NSObject, successBlock: successBlock, failBlock: failBlock) -&gt; Void &#123; let modelData = try! NSKeyedArchiver.archivedData(withRootObject: model, requiringSecureCoding: false) let insertSql = "insert into " + tableName! + " (model) values(?)" do &#123; try fmdb.executeUpdate(insertSql, values: [modelData]) successBlock() &#125; catch &#123; print(fmdb.lastError()) failBlock() &#125; &#125; 7ã€æ›´æ–°è¡¨1234567891011func update(model:NSObject,uid:Int32, successBlock: successBlock, failBlock: failBlock) -&gt; Void &#123; let modelData = try! NSKeyedArchiver.archivedData(withRootObject: model, requiringSecureCoding: false) let updateSql = "update " + tableName! + " set model = ? where id = ?" do &#123; try fmdb.executeUpdate(updateSql, values: [modelData, uid]) successBlock() &#125; catch &#123; print(fmdb.lastError()) failBlock() &#125; &#125; 8ã€æŸ¥è¯¢æ•°æ®ï¼ˆè¿™æ˜¯æŸ¥è¯¢æ‰€æœ‰æ•°æ®ï¼Œå…¶ä»–æŒ‰éœ€æ±‚è®¾è®¡ï¼‰123456789101112131415161718func selectAll() -&gt; [NSObject] &#123; var tmpArr = [NSObject]() let selectSql = "select * from " + tableName! do &#123; let rs = try fmdb.executeQuery(selectSql, values:nil) while rs.next() &#123; var model = NSObject() let modelData = rs.data(forColumn:"model") let id = rs.int(forColumn: "id") model = try! NSKeyedUnarchiver.unarchiveTopLevelObjectWithData(modelData!) as! NSObject model.wd_fmdb_id = id tmpArr.append(model) &#125; &#125; catch &#123; print(fmdb.lastError()) &#125; return tmpArr &#125; 9ã€åˆ é™¤æ•°æ®ï¼ˆè¿™æ˜¯æ ¹æ®Idåˆ é™¤çš„ï¼‰12345678910func delete(uid:Int32, successBlock: successBlock, failBlock: failBlock) -&gt; Void &#123; let deleteSql = "delete from " + tableName! + " where id = ?" do &#123; try fmdb.executeUpdate(deleteSql, values: [uid]) successBlock() &#125; catch &#123; print(fmdb.lastError()) failBlock() &#125; &#125; 10ã€æ–°å¢žåˆ†ç±»æ·»åŠ é»˜è®¤Id1234567891011private var wd_id_key: String = "key"extension NSObject &#123; open var wd_fmdb_id:Int32? &#123; get &#123; return (objc_getAssociatedObject(self, &amp;wd_id_key) as? Int32) &#125; set(newValue) &#123; objc_setAssociatedObject(self, &amp;wd_id_key, newValue, objc_AssociationPolicy.OBJC_ASSOCIATION_ASSIGN) &#125; &#125;&#125; 11ã€ä½¿ç”¨æ–¹æ³•12345678910111213141516171819202122232425//1. åœ¨Appdelegateä¸­æ‰“å¼€æ•°æ®åº“func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -&gt; Bool &#123; DataBaseManager.defaultManger.creatTable() return true &#125;//2ã€æ·»åŠ æ•°æ®WDDataBaseManager.defaultManger.insert(model: model, successBlock: &#123; print("æˆåŠŸ") &#125;, failBlock: &#123; print("å¤±è´¥") &#125;)//3ã€ä¿®æ”¹æ•°æ®WDDataBaseManager.defaultManger.update(model: model, uid: self.model!.wd_fmdb_id!, successBlock: &#123; print("æˆåŠŸ") &#125;, failBlock: &#123; print("å¤±è´¥") &#125;)//4ã€åˆ é™¤æ•°æ®WDDataBaseManager.defaultManger.delete(uid: model.wd_fmdb_id!, successBlock: &#123; print("æˆåŠŸ") &#125;, failBlock: &#123; print("å¤±è´¥") &#125;)// 5ã€æŸ¥è¯¢æ•°æ®WDDataBaseManager.defaultManger.selectAll() éµå¾ªNSCoding é‡å†™ä¸‰ä¸ªæ–¹æ³•12345678910111213141516171819202122232425import UIKitclass Model: NSObject , NSCoding&#123; public var name:String? public var phone:String? public var addres:String? override init() &#123; super.init() &#125; func encode(with aCoder: NSCoder) &#123; aCoder.encode(name, forKey: "name") aCoder.encode(phone, forKey: "phone") aCoder.encode(addres, forKey: "addres") &#125; required init?(coder aDecoder: NSCoder) &#123; super.init() self.name = aDecoder.decodeObject(forKey: "name") as? String self.addres = aDecoder.decodeObject(forKey: "addres") as? String self.phone = aDecoder.decodeObject(forKey: "phone") as? String &#125;&#125; 12ã€æ•ˆæžœå›¾ 13ã€Demoåœ°å€:https://github.com/wudan-ios/FMDB-Model.git è¡¥å……Objective-Cç‰ˆæœ¬1ã€æŽ¥å£æ–‡ä»¶12345678910111213141516171819202122232425262728293031#import &lt;Foundation/Foundation.h&gt;NS_ASSUME_NONNULL_BEGIN@interface NSObject (addId)@property (nonatomic) NSInteger wd_fmdb_id;@endtypedef void(^successBlock)(void);typedef void(^failBlock)(void);@interface WDDataBaseManager : NSObject+ (instancetype)manager;/** åˆ›å»ºè¡¨ */- (void)createTableWithName:(NSString *)name;/** åˆ é™¤è¡¨ */- (void)dropTable;/** æ·»åŠ æ•°æ® */- (void)insertDataWithModel:(NSObject *)model successBlock:(successBlock)aSuccessBlock failBlock:(failBlock)aFailBlock;/** æ›´æ–°æ•°æ® */- (void)updateDataWithModel:(NSObject *)model uid:(NSInteger)aUid successBlock:(successBlock)aSuccessBlock failBlock:(failBlock)aFailBlock;/** åˆ é™¤æ•°æ® */- (void)deleteDataWithUid:(NSInteger)uid successBlock:(successBlock)aSuccessBlock failBlock:(failBlock)aFailBlock;/** æŸ¥è¯¢å…¨éƒ¨æ•°æ® */- (NSArray&lt;NSObject *&gt; *)queryAllData;@endNS_ASSUME_NONNULL_END 2ã€å®žçŽ°æ–‡ä»¶123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120#import "WDDataBaseManager.h"#import &lt;FMDB.h&gt;#import &lt;objc/runtime.h&gt;static char *wd_id_key = "key";@implementation NSObject (addId)- (NSInteger)wd_fmdb_id &#123; NSNumber *numberValue = objc_getAssociatedObject(self, wd_id_key); return numberValue.integerValue;&#125;- (void)setWd_fmdb_id:(NSInteger)wd_fmdb_id &#123; objc_setAssociatedObject(self, wd_id_key, @(wd_fmdb_id), OBJC_ASSOCIATION_ASSIGN);&#125;@end@interface WDDataBaseManager ()@property (nonatomic, strong) FMDatabase *fmdb;@property (nonatomic, copy) NSString *tableName;@end@implementation WDDataBaseManager+ (instancetype)manager &#123; static dispatch_once_t onceToken; static WDDataBaseManager *manager = nil; dispatch_once(&amp;onceToken, ^&#123; manager = [[WDDataBaseManager alloc] init]; &#125;); return manager;&#125;- (void)createTableWithName:(NSString *)name &#123; [self.fmdb open]; self.tableName = name; NSString *sql = [NSString stringWithFormat:@"create table if not exists %@ (id integer primary key autoincrement,model BLOB)", name]; BOOL result = [self.fmdb executeUpdate:sql]; if (result) &#123; NSLog(@"è¡¨åˆ›å»ºæˆåŠŸ"); &#125;&#125;- (void)dropTable &#123; NSString *sql = [NSString stringWithFormat:@"drop table if exists %@", self.tableName]; BOOL result = [self.fmdb executeUpdate:sql]; if (result) &#123; NSLog(@"è¡¨åˆ é™¤æˆåŠŸ"); &#125;&#125;- (void)insertDataWithModel:(NSObject *)model successBlock:(successBlock)aSuccessBlock failBlock:(failBlock)aFailBlock &#123; NSData *modelData = [NSKeyedArchiver archivedDataWithRootObject:model]; NSString *sql = [NSString stringWithFormat:@"insert into %@ (model) values(?)", self.tableName]; BOOL result = [self.fmdb executeUpdate:sql withArgumentsInArray:@[modelData]]; if (result) &#123; aSuccessBlock(); &#125; else &#123; aFailBlock(); &#125;&#125;- (void)updateDataWithModel:(NSObject *)model uid:(NSInteger)aUid successBlock:(successBlock)aSuccessBlock failBlock:(failBlock)aFailBlock &#123; NSData *modelData = [NSKeyedArchiver archivedDataWithRootObject:model]; NSString *sql = [NSString stringWithFormat:@"update %@ set model = ? where id = ?", self.tableName]; BOOL result = [self.fmdb executeUpdate:sql withArgumentsInArray:@[modelData, @(aUid)]]; if (result) &#123; aSuccessBlock(); &#125; else &#123; aFailBlock(); &#125;&#125;- (void)deleteDataWithUid:(NSInteger)uid successBlock:(successBlock)aSuccessBlock failBlock:(failBlock)aFailBlock &#123; NSString *sql = [NSString stringWithFormat:@"delete from %@ where id = ?", self.tableName]; BOOL result = [self.fmdb executeUpdate:sql withArgumentsInArray:@[@(uid)]]; if (result) &#123; aSuccessBlock(); &#125; else &#123; aFailBlock(); &#125;&#125;- (NSArray&lt;NSObject *&gt; *)queryAllData &#123; NSMutableArray *array = [NSMutableArray array]; NSString *sql = [NSString stringWithFormat:@"select * from %@",self.tableName]; @try &#123; FMResultSet *rs = [self.fmdb executeQuery:sql]; while (rs.next) &#123; NSObject *model = [[NSObject alloc] init]; NSData *modelData = [rs dataForColumn:@"model"]; int uid = [rs intForColumn:@"id"]; model = [NSKeyedUnarchiver unarchiveObjectWithData:modelData]; model.wd_fmdb_id = uid; [array addObject:model]; &#125; &#125; @catch (NSException *exception) &#123; NSLog(@"%@", self.fmdb.lastError); &#125; @finally &#123; NSLog(@"æŸ¥è¯¢æ•°æ®"); &#125; return array;&#125;- (FMDatabase *)fmdb &#123; if (!_fmdb) &#123; NSString *path = [NSHomeDirectory() stringByAppendingString:@"/Documents/testDB.db"]; _fmdb = [[FMDatabase alloc] initWithPath:path]; &#125; return _fmdb;&#125;@end 3ã€ä½¿ç”¨æ–¹æ³•1234567891011121314151617181920212223242526272829// 1ã€æ‰“å¼€æ•°æ®åº“ï¼Œå¹¶åˆ›å»ºè¡¨- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions &#123; [[WDDataBaseManager manager] createTableWithName:@"test"]; return YES;&#125;// 2ã€æ·»åŠ æ•°æ® [[WDDataBaseManager manager] insertDataWithModel:model successBlock:^&#123; // TODO: &#125; failBlock:^&#123; // TODO: &#125;];// 3ã€æŸ¥è¯¢æ•°æ®[[WDDataBaseManager manager] queryAllData]// 4ã€ä¿®æ”¹æ•°æ®[[WDDataBaseManager manager] updateDataWithModel:model uid:self.model.wd_fmdb_id successBlock:^&#123; // TODO: &#125; failBlock:^&#123; // TODO: &#125;];// 5ã€åˆ é™¤æ•°æ®[[WDDataBaseManager manager] deleteDataWithUid:model.wd_fmdb_id successBlock:^&#123; // TODO: &#125; failBlock:^&#123; // TODO: &#125;];// 6ã€åˆ é™¤è¡¨[[WDDataBaseManager manager] dropTable]; æ’å…¥è¡¨ä¸­çš„Modeléœ€è¦éµå¾ª(å®žä¾‹ä»£ç )1234567891011121314- (void)encodeWithCoder:(nonnull NSCoder *)aCoder &#123; [aCoder encodeObject:self.name forKey:@"name"]; [aCoder encodeObject:self.phone forKey:@"phone"]; [aCoder encodeObject:self.address forKey:@"address"];&#125;- (nullable instancetype)initWithCoder:(nonnull NSCoder *)aDecoder &#123; if (self == [super init]) &#123; self.name = [aDecoder decodeObjectForKey:@"name"] ; self.phone = [aDecoder decodeObjectForKey:@"phone"]; self.address = [aDecoder decodeObjectForKey:@"address"]; &#125; return self;&#125;]]></content>
  </entry>
  <entry>
    <title><![CDATA[æ•°æ®å­˜å‚¨ï¼šCoreData]]></title>
    <url>%2F2018%2F09%2F01%2F%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%EF%BC%9ACoreData%2F</url>
    <content type="text"><![CDATA[CoreDataçš„ç®€å•ä½¿ç”¨ä»‹ç»ï¼ˆå·²Userè¡¨ä¸ºä¾‹ï¼‰é‡ç‚¹ç±» NSManagedObject é€šè¿‡Core Dataä»Žæ•°æ®åº“ä¸­å–å‡ºçš„å¯¹è±¡,é»˜è®¤æƒ…å†µä¸‹éƒ½æ˜¯NSManagedObjectå¯¹è±¡. NSManagedObjectçš„å·¥ä½œæ¨¡å¼æœ‰ç‚¹ç±»ä¼¼äºŽNSDictionaryå¯¹è±¡,é€šè¿‡é”®-å€¼å¯¹æ¥å­˜å–æ‰€æœ‰çš„å®žä½“å±žæ€§. setValue:forkey:å­˜å‚¨å±žæ€§å€¼(å±žæ€§åä¸ºkey); valueForKey:èŽ·å–å±žæ€§å€¼(å±žæ€§åä¸ºkey). æ¯ä¸ªNSManagedObjectéƒ½çŸ¥é“è‡ªå·±å±žäºŽå“ªä¸ªNSManagedObjectContext NSManagedObjectContextï¼šç®¡ç†å¯¹è±¡ä¸Šä¸‹æ–‡ è´Ÿè´£æ•°æ®å’Œåº”ç”¨åº“ä¹‹é—´çš„äº¤äº’(CRUDï¼Œå³å¢žåˆ æ”¹æŸ¥ã€ä¿å­˜ç­‰æŽ¥å£éƒ½åœ¨è¿™ä¸ªå¯¹è±¡ä¸­). æ‰€æœ‰çš„NSManagedObjectéƒ½å­˜åœ¨äºŽNSManagedObjectContextä¸­ï¼Œæ‰€ä»¥å¯¹è±¡å’Œcontextæ˜¯ç›¸å…³è”çš„ æ¯ä¸ª context å’Œå…¶ä»– context éƒ½æ˜¯å®Œå…¨ç‹¬ç«‹çš„ æ¯ä¸ªNSManagedObjectContextéƒ½çŸ¥é“è‡ªå·±ç®¡ç†ç€å“ªäº›NSManagedObject NSManagedObjectModelï¼šæ¨¡åž‹å¯¹è±¡ Core Dataçš„æ¨¡åž‹æ–‡ä»¶ NSPersistentStoreCoordinatorï¼šå­˜å‚¨è°ƒåº¦å™¨ æ·»åŠ æŒä¹…åŒ–å­˜å‚¨åº“ï¼ŒCoreDataçš„å­˜å‚¨ç±»åž‹ï¼ˆæ¯”å¦‚SQLiteæ•°æ®åº“å°±æ˜¯å…¶ä¸­ä¸€ç§ï¼‰ ä¸­é—´å®¡æŸ¥è€…ï¼Œç”¨æ¥å°†å¯¹è±¡å›¾ç®¡ç†éƒ¨åˆ†å’ŒæŒä¹…åŒ–éƒ¨åˆ†æ†ç»‘åœ¨ä¸€èµ·ï¼Œè´Ÿè´£ç›¸äº’ä¹‹é—´çš„äº¤æµï¼ˆä¸­ä»‹ä¸€æ ·ï¼‰ NSEntityDescriptionï¼š ç”¨æ¥æè¿°å®žä½“ï¼šç›¸å½“äºŽæ•°æ®åº“è¡¨ä¸­ä¸€ç»„æ•°æ®æè¿° Userä¸­å­—æ®µ1234@property (nonatomic) int16_t age;@property (nonatomic) int64_t id;@property (nullable, nonatomic, copy) NSString *name;@property (nonatomic) BOOL sex; ç³»ç»Ÿåº“1#import &lt;CoreData/CoreData.h&gt; æ‰“å¼€æ•°æ®åº“123456789101112131415161718192021222324252627// åˆ›å»ºæ•°æ®åº“ // 1. å®žä¾‹åŒ–æ•°æ®æ¨¡åž‹(å°†æ‰€æœ‰å®šä¹‰çš„æ¨¡åž‹éƒ½åŠ è½½è¿›æ¥) // mergeâ€”â€”åˆå¹¶ self.managedObjectModel = [NSManagedObjectModel mergedModelFromBundles:nil]; // 2. å®žä¾‹åŒ–æŒä¹…åŒ–å­˜å‚¨è°ƒåº¦ï¼Œè¦å»ºç«‹èµ·æ¡¥æ¢ï¼Œéœ€è¦æ¨¡åž‹ self.persistentStoreCoordinator = [[NSPersistentStoreCoordinator alloc] initWithManagedObjectModel:self.managedObjectModel]; // 3. æ·»åŠ ä¸€ä¸ªæŒä¹…åŒ–çš„æ•°æ®åº“åˆ°å­˜å‚¨è°ƒåº¦ // 3.1 å»ºç«‹æ•°æ®åº“ä¿å­˜åœ¨æ²™ç›’çš„URL NSString *path = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES).lastObject; NSString *filePath = [[path stringByAppendingString:@"/"] stringByAppendingString:@"wudan.sqlite"]; NSURL *pathUrl = [NSURL fileURLWithPath:filePath]; // 3.2 æ‰“å¼€æˆ–è€…æ–°å»ºæ•°æ®åº“æ–‡ä»¶ // å¦‚æžœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™æ–°å»ºä¹‹åŽæ‰“å¼€ // å¦è€…ç›´æŽ¥æ‰“å¼€æ•°æ®åº“ NSError *error; @try &#123; [self.persistentStoreCoordinator addPersistentStoreWithType:NSSQLiteStoreType configuration:nil URL:pathUrl options:nil error:&amp;error]; self.context = [[NSManagedObjectContext alloc] init]; self.context.persistentStoreCoordinator = self.persistentStoreCoordinator; &#125; @catch (NSException *exception) &#123; NSLog(@"Error:%@",error); &#125; @finally &#123; NSLog(@"æ‰“å¼€æ•°æ®åº“"); &#125; æŸ¥è¯¢æ•°æ® å…¨éƒ¨æŸ¥è¯¢12345678910111213141516- (void)queryAllResult:(void(^)(NSArray *dataArray))result &#123; NSMutableArray *array = [NSMutableArray array]; NSPredicate *predicate = [NSPredicate predicateWithFormat:@"id &gt; 0"]; NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"User"]; request.predicate = predicate; NSError *error; NSArray *re = [self.context executeFetchRequest:request error:&amp;error]; if (re.count != 0) &#123; for (User *user in re) &#123; [array addObject:user]; &#125; &#125; result(array);&#125; åˆ†é¡µæŸ¥è¯¢123456789101112131415161718- (void)queryUserInfoWithPageNo:(NSInteger)pageNo pageSize:(NSInteger)pageSize result:(void(^)(NSArray *dataArray))result &#123; NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"User"]; NSSortDescriptor *scoreSort = [NSSortDescriptor sortDescriptorWithKey:@"id" ascending:true]; request.sortDescriptors = @[scoreSort]; request.fetchOffset = (pageNo - 1) * pageSize; request.fetchLimit = pageSize; NSError *error = nil; NSArray *re = [self.context executeFetchRequest:request error:&amp;error]; NSMutableArray *array = [NSMutableArray array]; if (re.count != 0) &#123; for (User *user in re) &#123; [array addObject:user]; &#125; &#125; result(array);&#125; æ¡ä»¶æŸ¥è¯¢12345678910111213141516- (void)queryUserInfoByObject:(id)object value:(id)value result:(void(^)(NSArray *dataArray))result &#123; NSMutableArray *array = [NSMutableArray array]; NSPredicate *predicate = [NSPredicate predicateWithFormat:[NSString stringWithFormat:@"%@ = '%@'", object, value]]; NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"User"]; request.predicate = predicate; NSError *error; NSArray *re = [self.context executeFetchRequest:request error:&amp;error]; if (re.count != 0) &#123; for (User *user in re) &#123; [array addObject:user]; &#125; &#125; result(array);&#125; æ–°å¢žæ•°æ®123456789101112131415161718192021222324252627282930- (void)addUserInfo:(NSInteger)userId name:(NSString *)name sex:(BOOL)sex age:(NSInteger)age success:(void(^)(void))success fail:(void(^)(void))fail &#123; __block NSArray *array; [self queryUserInfoByObject:@"id" value:@(userId) result:^(NSArray * _Nonnull dataArray) &#123; array = dataArray; &#125;]; if (array.count == 0) &#123; User *user = [NSEntityDescription insertNewObjectForEntityForName:@"User" inManagedObjectContext:self.context]; user.name = name; user.id = userId; user.sex = sex; user.age = age; NSError *error; @try &#123; [self.context save:&amp;error]; success(); &#125; @catch (NSException *exception) &#123; NSLog(@"%@", error); fail(); &#125; @finally &#123; NSLog(@"æ–°å¢ž"); &#125; &#125; else &#123; fail(); &#125;&#125; æ›´æ–°æ•°æ®123456789101112131415161718192021222324252627- (void)updateUserInfo:(NSInteger)userId infoDic:(NSDictionary *)dic success:(void(^)(void))success fail:(void(^)(void))fail &#123; NSPredicate *predicate = [NSPredicate predicateWithFormat:[NSString stringWithFormat:@"id = %ld", userId]]; NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"User"]; request.predicate = predicate; NSError *error; if (dic.count &gt; 0) &#123; NSArray *re = [self.context executeFetchRequest:request error:&amp;error]; if (re.count &gt; 0) &#123; for (User *user in re) &#123; [dic enumerateKeysAndObjectsUsingBlock:^(id _Nonnull key, id _Nonnull obj, BOOL * _Nonnull stop) &#123; [user setValue:obj forKey:key]; &#125;]; &#125; &#125; @try &#123; [self.context save:&amp;error]; success(); &#125; @catch (NSException *exception) &#123; NSLog(@"%@", error); fail(); &#125; @finally &#123; NSLog(@"æ›´æ–°"); &#125; &#125;&#125; åˆ é™¤æ•°æ®1234567891011121314151617181920212223- (void)deleteUserInfo:(NSInteger)userId success:(void(^)(void))success fail:(void(^)(void))fail &#123; NSPredicate *predicate = [NSPredicate predicateWithFormat:[NSString stringWithFormat:@"id = %ld", userId]]; NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"User"]; request.predicate = predicate; NSError *error; NSArray *re = [self.context executeFetchRequest:request error:&amp;error]; if (re.count &gt; 0) &#123; @try &#123; [self.context deleteObject:re.firstObject]; [self.context save:nil]; success(); &#125; @catch (NSException *exception) &#123; NSLog(@"%@", error); fail(); &#125; @finally &#123; NSLog(@"åˆ é™¤æ•°æ®"); &#125; &#125; else &#123; NSLog(@"æ•°æ®åº“ä¸­æš‚æ— è¯¥æ•°æ®"); fail(); &#125;&#125;]]></content>
  </entry>
  <entry>
    <title><![CDATA[iOSè‡ªå®šä¹‰æŽ§ä»¶ï¼šåˆ†æ®µé€‰æ‹©å™¨-Swift]]></title>
    <url>%2F2018%2F08%2F29%2FiOS%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%A7%E4%BB%B6%EF%BC%9A%E5%88%86%E6%AE%B5%E9%80%89%E6%8B%A9%E5%99%A8-Swift%2F</url>
    <content type="text"><![CDATA[åºŸè¯ä¸å¤šè¯´ï¼Œç›´æŽ¥ä¸Šä»£ç  1ã€æ•°æ®æºæ–¹æ³•12345678910111213141516171819// MARK: ============ SegmentSelectorManagerDataSource ============@objc protocol SegmentSelectorManagerDataSource:NSObjectProtocol &#123; /// ä¸»è¦é…ç½® -&gt; å¿…é¡»è¦å®žçŽ° func nameOfSliderItems(segemntControl:SegmentSelectorManager) -&gt; Array&lt;String&gt; func childViewControllers(segemntControl:SegmentSelectorManager) -&gt; Array&lt;UIViewController&gt; /// å­—ä½“é¢œè‰²é…ç½® -&gt; æœ‰é»˜è®¤ @objc optional func colorOfSlider(segemntControl:SegmentSelectorManager) -&gt; UIColor @objc optional func colorOfTopView(segemntControl:SegmentSelectorManager) -&gt; UIColor /// èƒŒæ™¯é¢œè‰²é…ç½® -&gt; æœ‰é»˜è®¤ @objc optional func colorOfSliderItemsTitle(segemntControl:SegmentSelectorManager) -&gt; UIColor @objc optional func colorOfHighlightedSliderItemsTitle(segemntControl:SegmentSelectorManager) -&gt; UIColor /// é«˜åº¦é…ç½® -&gt; æœ‰é»˜è®¤ @objc optional func heightOfTopView(segemntControl:SegmentSelectorManager) -&gt; CGFloat @objc optional func heightOfSlider(segemntControl:SegmentSelectorManager) -&gt; CGFloat&#125; 2ã€ä»£ç†æ–¹æ³•1234// MARK: ============ SegmentSelectorManagerDelegate ============protocol SegmentSelectorManagerDelegate &#123; func slideView(sliderView:SegmentSelectorManager, didSelectItemAtIndex:Int) -&gt; Void&#125; 3ã€é¡µé¢å®žçŽ°123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596override init(frame: CGRect) &#123; super.init(frame: frame) &#125; required init?(coder aDecoder: NSCoder) &#123; fatalError("init(coder:) has not been implemented") &#125; /// æ•°æ®æº public weak var dataSource:SegmentSelectorManagerDataSource? &#123; didSet &#123; // åç§°æ•°ç»„ namesOfSlideItems = dataSource?.nameOfSliderItems(segemntControl: self) // æŽ§åˆ¶å™¨æ•°ç»„ childControllersArray = dataSource?.childViewControllers(segemntControl: self) if let ds = dataSource &#123; if (ds.responds(to: #selector(ds.colorOfHighlightedSliderItemsTitle(segemntControl:)))) &#123; //æŒ‰é’®å­—ä½“é¢œè‰²é»˜è®¤ colorOfSlideItemsTitle = ds.colorOfSliderItemsTitle!(segemntControl: self) &#125; if (ds.responds(to: #selector(ds.colorOfHighlightedSliderItemsTitle(segemntControl:)))) &#123; // æŒ‰é’®å­—ä½“é¢œè‰²é€‰ä¸­ colorOfHighlightedSlideItemsTitle = ds.colorOfHighlightedSliderItemsTitle!(segemntControl: self) &#125; if (ds.responds(to: #selector(ds.colorOfSlider(segemntControl:)))) &#123; // æŒ‡ç¤ºå™¨é¢œè‰² colorOfSlider = ds.colorOfSlider!(segemntControl: self) &#125; if ds.responds(to: #selector(ds.heightOfTopView(segemntControl:))) &#123; // é¡¶éƒ¨è§†å›¾é«˜åº¦ heightOfTopView = (ds.heightOfTopView!(segemntControl: self)) &#125; if ds.responds(to: #selector(ds.heightOfTopView(segemntControl:))) &#123; // æŒ‡ç¤ºå™¨é«˜åº¦ heightOfSlider = (ds.heightOfSlider!(segemntControl: self)) &#125; &#125; &#125; &#125; // ä»£ç† public var delegate:SegmentSelectorManagerDelegate? var namesOfSlideItems: Array&lt;String&gt;? = [] // åç§°æ•°ç»„ var colorOfSlider: UIColor? = UIColor.orange // æŒ‡ç¤ºå™¨é¢œè‰² var colorOfSlideView: UIColor? = UIColor.white // é¡¶éƒ¨è§†å›¾é¢œè‰² var colorOfSlideItemsTitle: UIColor? = UIColor.gray // é»˜è®¤å­—ä½“é¢œè‰² var colorOfHighlightedSlideItemsTitle: UIColor? = UIColor.orange // é€‰ä¸­å­—ä½“é¢œè‰² var heightOfTopView:CGFloat = 45 // é¡¶éƒ¨è§†å›¾é«˜åº¦ var heightOfSlider:CGFloat = 2 // æŒ‡ç¤ºå™¨é«˜åº¦ let SliderThanSliderView_WidthRatio:CGFloat = 1 // æŒ‰é’®å’ŒæŒ‡ç¤ºå™¨å®½åº¦æ¯” var buttonsArray:Array&lt;UIButton&gt;? = [] // æ‰€æœ‰æŒ‰é’®çš„æ•°ç»„ var childControllersArray:Array&lt;UIViewController&gt;? = [] // æŽ§åˆ¶å™¨æ•°ç»„ let SCREEN_WIDTH = UIScreen.main.bounds.size.width let SCREEN_HEIGHT = UIScreen.main.bounds.height /// é¡¶éƒ¨View lazy var slideBar:UIView = &#123; let view = UIView.init() view.backgroundColor = colorOfSlideView addSubview(view) view.translatesAutoresizingMaskIntoConstraints = false view.leadingAnchor.constraint(equalTo: leadingAnchor).isActive = true view.trailingAnchor.constraint(equalTo: trailingAnchor).isActive = true view.topAnchor.constraint(equalTo: topAnchor).isActive = true view.heightAnchor.constraint(equalToConstant: self.heightOfTopView).isActive = true return view &#125;() // åº•éƒ¨æŒ‡ç¤ºå™¨ var slider:UIView? /// æŽ§åˆ¶å™¨ScrollView lazy var contentScrollView:UIScrollView = &#123; let sc = UIScrollView.init() sc.isDirectionalLockEnabled = true sc.backgroundColor = UIColor.white sc.isPagingEnabled = true sc.showsHorizontalScrollIndicator = false sc.delegate = self sc.bounces = false addSubview(sc) sc.translatesAutoresizingMaskIntoConstraints = false sc.leadingAnchor.constraint(equalTo: leadingAnchor).isActive = true sc.trailingAnchor.constraint(equalTo: trailingAnchor).isActive = true sc.topAnchor.constraint(equalTo: self.slideBar.bottomAnchor).isActive = true sc.bottomAnchor.constraint(equalTo: bottomAnchor).isActive = true return sc &#125;() #####4ã€ç»˜åˆ¶é¡µé¢UI123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124 // èŽ·å–å½“å‰é¡µé¢çš„æŽ§åˆ¶å™¨ public func viewController()-&gt;UIViewController? &#123; var nextResponder: UIResponder? = self repeat &#123; nextResponder = nextResponder?.next if let viewController = nextResponder as? UIViewController &#123; return viewController &#125; &#125; while nextResponder != nil return nil &#125;override func layoutSubviews() &#123; super.layoutSubviews() addSlider() addButton() addContentScrollView() &#125;/// æ·»åŠ æŒ‰é’®åˆ°é¡¶éƒ¨è§†å›¾ func addButton() &#123; let numberOfItems:Int = (namesOfSlideItems?.count)! let slideItemWidth = SCREEN_WIDTH / CGFloat(numberOfItems) let sliderWidth = slideItemWidth * SliderThanSliderView_WidthRatio let position_x = (slideItemWidth - sliderWidth) / 2.0 for index in 0..&lt;numberOfItems &#123; let b = UIButton.init(type: .custom) b.tag = index b.setTitle(namesOfSlideItems![index], for: .normal) b.setTitleColor(colorOfSlideItemsTitle, for: .normal) b.titleLabel?.textAlignment = .center b.addTarget(self, action: #selector(buttonTouched(button:)), for: .touchUpInside) buttonsArray?.append(b) b.frame = CGRect(x: position_x + slideItemWidth * CGFloat(index), y: 5, width: sliderWidth, height: heightOfTopView-5) slideBar.addSubview(b) if index == 0 &#123; b.setTitleColor(colorOfHighlightedSlideItemsTitle!, for: .normal) &#125; &#125; &#125; // æ·»åŠ åº•éƒ¨æŒ‡ç¤ºå™¨åˆ°é¡¶éƒ¨è§†å›¾ func addSlider() &#123; let slideItemWidth = SCREEN_WIDTH / CGFloat((namesOfSlideItems?.count)!) let sliderWidth = slideItemWidth * SliderThanSliderView_WidthRatio let position_x = (slideItemWidth - sliderWidth) / 2.0 slideBar.addSubview(sliderView(frame: CGRect(x: position_x, y: heightOfTopView - heightOfSlider, width: sliderWidth, height: heightOfSlider))) slideBar.backgroundColor = colorOfSlideView slider?.backgroundColor = colorOfSlider &#125; // æ·»åŠ ScrollView func addContentScrollView() &#123; contentScrollView.contentSize = CGSize(width: SCREEN_WIDTH * CGFloat((namesOfSlideItems?.count)!), height: 0) for (index) in (childControllersArray?.enumerated())! &#123; index.element.view.frame = CGRect(x: CGFloat(index.offset) * SCREEN_WIDTH, y: 0, width: contentScrollView.frame.width, height: contentScrollView.frame.height) contentScrollView.addSubview(index.element.view) viewController()?.addChild(index.element) index.element.didMove(toParent: viewController()) &#125; &#125; // vcæ»šåŠ¨åŠ¨ç”» func animateSlider(tag:Int) -&gt; Void &#123; contentScrollView.setContentOffset(CGPoint(x: SCREEN_WIDTH * CGFloat(tag), y: 0), animated: true) &#125; // æŒ‡ç¤ºå™¨æ»šåŠ¨åŠ¨ç”» func animateSliderToPosition(offset:CGPoint) -&gt; Void &#123; let slideItemWidth = SCREEN_WIDTH / CGFloat((namesOfSlideItems?.count)!) let sliderWidth = slideItemWidth * SliderThanSliderView_WidthRatio let position_x = (slideItemWidth - sliderWidth) / 2.0 let newFrame = CGRect(x: (offset.x / SCREEN_WIDTH) * slideItemWidth + position_x, y: (slider?.frame.origin.y)!, width: (slider?.frame.width)!, height: (slider?.frame.height)!) slider?.frame = newFrame for (index) in (buttonsArray?.enumerated())! &#123; index.element.setTitleColor(colorOfSlideItemsTitle, for: .normal) &#125; var buttonTag = 0 let ratio = offset.x / SCREEN_WIDTH let tempRation = Int(ratio) let decimal:CGFloat = ratio - CGFloat(tempRation) if decimal &gt;= 0.5 &#123; buttonTag = Int(ratio) + 1 &#125; else &#123; buttonTag = Int(ratio) &#125; buttonsArray![buttonTag].setTitleColor(colorOfHighlightedSlideItemsTitle, for: .normal) &#125; /// æ ¹æ®frameåˆå§‹åŒ–æŒ‡ç¤ºå™¨ func sliderView(frame:CGRect) -&gt; UIView &#123; slider = UIView.init(frame: frame) return slider! &#125; /// ç‚¹å‡»äº‹ä»¶ @objc func buttonTouched(button:UIButton) &#123; delegate?.slideView(sliderView: self, didSelectItemAtIndex: button.tag) animateSlider(tag: tag) contentScrollView.setContentOffset(CGPoint(x: SCREEN_WIDTH * CGFloat(button.tag), y: 0), animated: true) &#125; 5ã€ä½¿ç”¨Extensionå®žçŽ°UIScrollViewDidScrollDelegate123456// MARK: ============ UIScrollViewDidScrollDelegate ============extension SegmentSelectorManager:UIScrollViewDelegate &#123; func scrollViewDidScroll(_ scrollView: UIScrollView) &#123; animateSliderToPosition(offset: scrollView.contentOffset) &#125;&#125; 6ã€ä½¿ç”¨æ–¹æ³•(å®žä¾‹ä»£ç )12345678910111213141516override func setupSubViewsProperties() &#123; segmentView = SegmentSelectorManager.init(frame: CGRect.zero) segmentView?.delegate = self segmentView?.dataSource = self view.addSubview(segmentView!) &#125; override func setupSubViewsConstrains() &#123; if let seg = segmentView &#123; seg.translatesAutoresizingMaskIntoConstraints = false seg.leadingAnchor.constraint(equalTo: view.leadingAnchor).isActive = true seg.trailingAnchor.constraint(equalTo: view.trailingAnchor).isActive = true seg.bottomAnchor.constraint(equalTo: view.bottomAnchor, constant: -kTabBarHeight).isActive = true seg.topAnchor.constraint(equalTo: wd_navgationBar_normal.bottomAnchor).isActive = true &#125; &#125; 12345678910111213141516171819202122232425262728293031323334353637383940extension HotPlayController: SegmentSelectorManagerDataSource &#123; func nameOfSliderItems(segemntControl: SegmentSelectorManager) -&gt; Array&lt;String&gt; &#123; return ["æ­£åœ¨çƒ­æ˜ ", "å³å°†ä¸Šæ˜ "] &#125; func childViewControllers(segemntControl: SegmentSelectorManager) -&gt; Array&lt;UIViewController&gt; &#123; return [HotPlayingController(), HotWillPlayViewController()] &#125; func heightOfTopView(segemntControl: SegmentSelectorManager) -&gt; CGFloat &#123; return 45 &#125; func heightOfSlider(segemntControl: SegmentSelectorManager) -&gt; CGFloat &#123; return 3 &#125; func colorOfSlider(segemntControl slider: SegmentSelectorManager) -&gt; UIColor &#123; return UIColor.wd_init(r: 73, g: 73, b: 73) &#125; func colorOfTopView(segemntControl: SegmentSelectorManager) -&gt; UIColor &#123; return UIColor.white &#125; func colorOfSliderItemsTitle(segemntControl: SegmentSelectorManager) -&gt; UIColor &#123; return UIColor.gray &#125; func colorOfHighlightedSliderItemsTitle(segemntControl: SegmentSelectorManager) -&gt; UIColor &#123; return UIColor.wd_init(r: 73, g: 73, b: 73) &#125;&#125;extension HotPlayController: SegmentSelectorManagerDelegate &#123; func slideView(sliderView: SegmentSelectorManager, didSelectItemAtIndex: Int) &#123; &#125;&#125; 7ã€æ•ˆæžœå›¾]]></content>
  </entry>
  <entry>
    <title><![CDATA[æ•°æ®å­˜å‚¨ï¼šKeyChain]]></title>
    <url>%2F2018%2F08%2F20%2F%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%EF%BC%9AKeyChain%2F</url>
    <content type="text"><![CDATA[KeyChainæ˜¯åˆ©ç”¨ç³»ç»Ÿé’¥åŒ™ä¸²è¿›è¡Œç®€å•çš„ä¿¡æ¯å­˜å–ã€‚ç±»ä¼¼äºŽUserDefault; æŽ¥å£æ–‡ä»¶ 123456789101112131415161718192021222324252627282930313233#import &lt;Foundation/Foundation.h&gt;NS_ASSUME_NONNULL_BEGIN@interface LZKeyChainManager : NSObject+ (instancetype)manager;/** å†™å…¥æ•°æ® @param service åç§° @param data æ•°æ® */- (void)save:(NSString *)service data:(id)data;/** æŸ¥è¯¢æ•°æ® @param service såç§° @return return value description */- (id)load:(NSString *)service;/** åˆ é™¤ @param service åç§° */- (void)deleteInfo:(NSString *)service;@endNS_ASSUME_NONNULL_END å®žçŽ°æ–‡ä»¶ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061#import "LZKeyChainManager.h"@implementation LZKeyChainManager+ (instancetype)manager &#123; static dispatch_once_t onceToken; static LZKeyChainManager *manager; dispatch_once(&amp;onceToken, ^&#123; manager = [[LZKeyChainManager alloc] init]; &#125;); return manager;&#125;- (NSMutableDictionary *)getKeychainQuery:(NSString *)service &#123; return [NSMutableDictionary dictionaryWithObjectsAndKeys:(id)kSecClassGenericPassword,(id)kSecClass, service, (id)kSecAttrService, service, (id)kSecAttrAccount, (id)kSecAttrAccessibleAfterFirstUnlock,(id)kSecAttrAccessible, nil]; &#125;#pragma mark - å†™å…¥- (void)save:(NSString *)service data:(id)data &#123; NSMutableDictionary *keychainQuery = [self getKeychainQuery:service]; SecItemDelete((CFDictionaryRef)keychainQuery); [keychainQuery setObject:[NSKeyedArchiver archivedDataWithRootObject:data] forKey:(id)kSecValueData]; SecItemAdd((CFDictionaryRef)keychainQuery, NULL);&#125;#pragma mark - è¯»å–- (id)load:(NSString *)service &#123; id ret = nil; NSMutableDictionary *keychainQuery = [self getKeychainQuery:service]; [keychainQuery setObject:(id)kCFBooleanTrue forKey:(id)kSecReturnData]; [keychainQuery setObject:(id)kSecMatchLimitOne forKey:(id)kSecMatchLimit]; CFDataRef keyData = NULL; if (SecItemCopyMatching((CFDictionaryRef)keychainQuery, (CFTypeRef *)&amp;keyData) == noErr) &#123; @try &#123; ret = [NSKeyedUnarchiver unarchiveObjectWithData:(__bridge NSData *)keyData]; &#125; @catch (NSException *e) &#123; NSLog(@"Unarchive of %@ failed: %@", service, e); &#125; @finally &#123; &#125; &#125; if (keyData) CFRelease(keyData); return ret;&#125;#pragma mark - åˆ é™¤- (void)deleteInfo:(NSString *)service &#123; NSMutableDictionary *keychainQuery = [self getKeychainQuery:service]; SecItemDelete((CFDictionaryRef)keychainQuery);&#125;@end]]></content>
  </entry>
  <entry>
    <title><![CDATA[iOSè‡ªå®šä¹‰æŽ§ä»¶ï¼šä¸€ä¸ªç®€æ˜“çš„Combobox]]></title>
    <url>%2F2018%2F08%2F18%2FiOS%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%A7%E4%BB%B6%EF%BC%9A%E4%B8%80%E4%B8%AA%E7%AE%80%E6%98%93%E7%9A%84Combobox%2F</url>
    <content type="text"><![CDATA[ä»£ç ç®€å•æ˜“æ‡‚ï¼Œå±žäºŽè‡ªå·±ç»ƒæ‰‹çš„ä»£ç ï¼Œè¿˜åœ¨å­¦ä¹ ï¼Œå†™çš„ä¸å¥½ï¼Œå¸Œæœ›å‹¿å–·1ã€å¤´æ–‡ä»¶123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657#import &lt;UIKit/UIKit.h&gt;NS_ASSUME_NONNULL_BEGINtypedef NS_ENUM(NSInteger, WDComboBoxControlDirection) &#123; WDComboBoxControlDirectionTop, WDComboBoxControlDirectionLeading, WDComboBoxControlDirectionTrailing, WDComboBoxControlDirectionBottom,&#125;;@protocol WDComboBoxControlDataSource &lt;NSObject&gt;@optional/** &lt; æ•°æ®æ•°ç»„ &gt; */- (NSArray&lt;NSArray&lt;NSString *&gt; *&gt; *)dataSourceOfColunm;@required/** &lt; æ ‡é¢˜æ•°ç»„ &gt; */- (NSArray&lt;NSString *&gt; *)titleOfSection;@end@protocol WDComboBoxControlDelegate &lt;NSObject&gt;/** ç‚¹å‡»äº‹ä»¶ @param indexPath indexPath description @param title title description @param sourceView sourceView description */- (void)selectedAtIndexPath:(NSIndexPath *)indexPath resultTitle:(NSString *)title fromSourceView:(UIView *)sourceView;@end@interface WDComboBoxControl : UIView@property (nonatomic, weak) id &lt;WDComboBoxControlDataSource&gt; dataSource;@property (nonatomic, weak) id &lt;WDComboBoxControlDelegate&gt; delegate;/** &lt; èƒŒæ™¯æŒ‰é’®ï¼Œå¯ä»¥å®šä¹‰éœ€è¦çš„å±žæ€§ &gt; */@property (nonatomic, strong) UIButton *backgroundButton;/** &lt; å†…å®¹TableViewï¼Œä¹Ÿå¯ä»¥å®šä¹‰ä¸€äº›å±žæ€§ &gt; */@property (nonatomic, strong) UITableView *tableView;/** åˆå§‹åŒ–æ–¹æ³• @param height æ˜¾ç¤ºå†…å®¹é«˜åº¦ @param view å‚è€ƒView @return return value description */- (instancetype)initViewWithMaxHeight:(CGFloat)height fromView:(UIView *)view showDirection:(WDComboBoxControlDirection)direction;/** æ˜¾ç¤ºé¡µé¢ */- (void)showInView;@endNS_ASSUME_NONNULL_END 2ã€å®žçŽ°æ–‡ä»¶123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140#import "WDComboBoxControl.h"@interface WDComboBoxControl () &lt;UITableViewDelegate, UITableViewDataSource&gt;@property (nonatomic, assign) CGFloat viewHeight;@property (nonatomic, strong) NSArray&lt;NSArray&lt;NSString *&gt; *&gt; * dataArray;@property (nonatomic, strong) NSArray&lt;NSString *&gt; * titleArray;@property (nonatomic, strong) UIView *sourceView;@property (nonatomic, assign) WDComboBoxControlDirection direction;@end@implementation WDComboBoxControl#pragma mark =============== åˆå§‹åŒ–é¡µé¢ ===============- (instancetype)initViewWithMaxHeight:(CGFloat)height fromView:(UIView *)view showDirection:(WDComboBoxControlDirection)direction &#123; self = [super init]; if (self) &#123; _viewHeight = height; _sourceView = view; _direction = direction; [self setupSubViewsPropertys]; [self setupSubViewsConstraints]; &#125; return self;&#125;#pragma mark =============== æ˜¾ç¤ºé¡µé¢ ===============- (void)showInView &#123; self.frame = UIScreen.mainScreen.bounds; [UIApplication.sharedApplication.delegate.window addSubview:self];&#125;#pragma mark =============== è®©é¡µé¢æ¶ˆå¤± ===============- (void)dismisssView &#123; [self removeFromSuperview];&#125;#pragma mark =============== èŽ·å–æ•°æ®æº ===============- (void)setDataSource:(id&lt;WDComboBoxControlDataSource&gt;)dataSource &#123; _dataSource = dataSource; if (self.dataSource &amp;&amp; [self.dataSource respondsToSelector:@selector(dataSourceOfColunm)]) &#123; self.dataArray = [self.dataSource dataSourceOfColunm]; &#125; if (self.dataArray &amp;&amp; [self.dataSource respondsToSelector:@selector(titleOfSection)]) &#123; self.titleArray = [self.dataSource titleOfSection]; &#125; [self.tableView reloadData];&#125;#pragma mark =============== Add controls, set properties ===============- (void)setupSubViewsPropertys &#123; self.backgroundButton = [[UIButton alloc] init]; self.backgroundButton.backgroundColor = UIColor.clearColor; [self.backgroundButton addTarget:self action:@selector(dismisssView) forControlEvents:UIControlEventTouchUpInside]; [self addSubview:self.backgroundButton]; self.tableView = [[UITableView alloc] init]; self.tableView.delegate = self; self.tableView.dataSource = self; self.tableView.tableFooterView = [[UIView alloc] init]; self.tableView.layer.borderColor = UIColor.lightGrayColor.CGColor; self.tableView.layer.borderWidth = 0.5; self.tableView.estimatedRowHeight = 45; self.tableView.layer.cornerRadius = 5; self.tableView.rowHeight = UITableViewAutomaticDimension; [self addSubview:self.tableView];&#125;#pragma mark =============== Setting control layout constraints ===============- (void)setupSubViewsConstraints &#123; self.backgroundButton.frame = UIScreen.mainScreen.bounds; switch (self.direction) &#123; case WDComboBoxControlDirectionBottom:&#123; self.tableView.frame = CGRectMake(CGRectGetMinX(self.sourceView.frame), CGRectGetMaxY(self.sourceView.frame), self.sourceView.frame.size.width, self.viewHeight); &#125; break; case WDComboBoxControlDirectionTop:&#123; self.tableView.frame = CGRectMake(CGRectGetMinX(self.sourceView.frame), CGRectGetMaxY(self.sourceView.frame) - self.viewHeight - self.sourceView.frame.size.height, self.sourceView.frame.size.width, self.viewHeight); &#125; break; case WDComboBoxControlDirectionLeading:&#123; self.tableView.frame = CGRectMake(CGRectGetMinX(self.sourceView.frame) - self.sourceView.frame.size.width, CGRectGetMinY(self.sourceView.frame), self.sourceView.frame.size.width, self.viewHeight); &#125; break; case WDComboBoxControlDirectionTrailing:&#123; self.tableView.frame = CGRectMake(CGRectGetMinX(self.sourceView.frame) + self.sourceView.frame.size.width, CGRectGetMinY(self.sourceView.frame), self.sourceView.frame.size.width, self.viewHeight); &#125; break; default: break; &#125; &#125;#pragma mark =============== UITableViewDelegate, UITableViewDataSource ===============- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section &#123; return self.titleArray[section];&#125;- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView &#123; return self.dataArray.count;&#125;- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section &#123; return [self.dataArray[section] count];&#125;- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath &#123; UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"cell"]; if (!cell) &#123; cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"cell"]; &#125; cell.textLabel.text = self.dataArray[indexPath.section][indexPath.row]; cell.textLabel.numberOfLines = 0; return cell;&#125;- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath &#123; if (self.delegate &amp;&amp; [self.delegate respondsToSelector:@selector(selectedAtIndexPath:resultTitle: fromSourceView:)]) &#123; [self.delegate selectedAtIndexPath:indexPath resultTitle:self.dataArray[indexPath.section][indexPath.row] fromSourceView:self.sourceView]; [self dismisssView]; &#125;&#125;@end 3ã€ä½¿ç”¨æ–¹æ³•1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374// 1ã€å¯¼å…¥å¤´æ–‡ä»¶#import "WDComboBoxControl.h"// 2ã€éµå¾ªä»£ç†å’Œæ•°æ®æº&lt;WDComboBoxControlDataSource, WDComboBoxControlDelegate&gt;// 3ã€å®žçŽ°æ–¹æ³•#pragma mark =============== WDComBoxControlDataSource ===============- (NSArray&lt;NSString *&gt; *)titleOfSection;- (NSArray&lt;NSArray&lt;NSString *&gt; *&gt; *)dataSourceOfColunm;#pragma mark =============== WDComBoxControlDelegate ===============- (void)selectedAtIndexPath:(NSIndexPath *)indexPath resultTitle:(NSString *)title fromSourceView:(UIView *)sourceView;// ä¸‹é¢æ˜¯å®žä¾‹ï¼š@property (nonatomic, strong) UIButton *button;@property (nonatomic, strong) UIButton *button2;- (void)viewDidLoad &#123; [super viewDidLoad]; // Do any additional setup after loading the view. UIButton *button = [[UIButton alloc] init]; [button setTitleColor:UIColor.blackColor forState:UIControlStateNormal]; [button addTarget:self action:@selector(buttonShow:) forControlEvents:UIControlEventTouchUpInside]; [self.view addSubview:button]; button.layer.borderColor = UIColor.lightGrayColor.CGColor; button.layer.borderWidth = 0.5; [button setTitle:@"æŒ‰é’®" forState:UIControlStateNormal]; [button mas_makeConstraints:^(MASConstraintMaker *make) &#123; make.centerX.mas_equalTo(self.view); make.top.mas_equalTo(self.wdNavigationBar.mas_bottom); make.width.mas_equalTo(300); &#125;]; self.button = button; UIButton *button2 = [[UIButton alloc] init]; [button2 setTitleColor:UIColor.blackColor forState:UIControlStateNormal]; [button2 addTarget:self action:@selector(buttonShow:) forControlEvents:UIControlEventTouchUpInside]; [self.view addSubview:button2]; button2.layer.borderColor = UIColor.lightGrayColor.CGColor; button2.layer.borderWidth = 0.5; [button2 setTitle:@"æŒ‰é’®2" forState:UIControlStateNormal]; button2.bounds = CGRectMake(0, 0, 300, 50); button2.center = self.view.center; self.button2 = button2;&#125;- (void)buttonShow:(UIButton *)sender &#123; WDComboBoxControl *view = [[WDComboBoxControl alloc] initViewWithMaxHeight:400 fromView:sender showDirection:WDComboBoxControlDirectionBottom]; view.dataSource = self; view.delegate = self; view.backgroundButton.backgroundColor = [UIColor colorWithWhite:0 alpha:0.3]; [view showInView];&#125;#pragma mark =============== WDComBoxControlDataSource ===============- (NSArray&lt;NSString *&gt; *)titleOfSection &#123; return @[@"å®‰å¾½çœ", @"æµ™æ±Ÿçœ", @"æ±Ÿè‹çœ", @"å®‰å¾½çœ", @"æµ™æ±Ÿçœ", @"æ±Ÿè‹çœ"];&#125;- (NSArray&lt;NSArray&lt;NSString *&gt; *&gt; *)dataSourceOfColunm &#123; return @[@[@"åˆè‚¥", @"èŠœæ¹–", @"å®‰åº†"], @[@"å—äº¬", @"è‹å·ž", @"æ— é”¡"], @[@"æ­å·ž", @"å®æ³¢", @"æ¸©å·ž"], @[@"åˆè‚¥", @"èŠœæ¹–", @"å®‰åº†"], @[@"å—äº¬", @"è‹å·ž", @"æ— é”¡"], @[@"æ­å·ž", @"å®æ³¢", @"æ¸©å·ž"]];&#125;#pragma mark =============== WDComBoxControlDelegate ===============- (void)selectedAtIndexPath:(NSIndexPath *)indexPath resultTitle:(NSString *)title fromSourceView:(UIView *)sourceView &#123; UIButton *sender = (UIButton *)sourceView; [sender setTitle:title forState:UIControlStateNormal];&#125; 4ã€æ•ˆæžœå›¾ 5ã€Demoåœ°å€ï¼ˆä»£ç éƒ½åœ¨è¿™é‡Œäº†ï¼Œå°±ä¸å¼„ä¸ªDemoäº†ï¼Œè¿™ä¸ªå¯ä»¥è‡ªå®šä¹‰çš„åœ°æ–¹è¿˜æœ‰å¾ˆå¤šï¼ŒTableViewå’ŒèƒŒæ™¯çš„Buttonéƒ½å¯ä»¥ï¼Œéšå¿ƒæ‰€æ¬²å§ï¼ï¼‰]]></content>
  </entry>
  <entry>
    <title><![CDATA[æ•°æ®å­˜å‚¨ï¼šå½’æ¡£ã€è§£æ¡£]]></title>
    <url>%2F2018%2F08%2F15%2F%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%EF%BC%9A%E5%BD%92%E6%A1%A3%E3%80%81%E8%A7%A3%E6%A1%A3%2F</url>
    <content type="text"><![CDATA[å½’æ¡£ æ‰€è°“çš„å½’æ¡£ï¼Œå°±æ˜¯å°†æ•°æ®å†™åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œé¢åŽ»ã€‚ä¸€èˆ¬æˆ‘ä»¬çš„åº”ç”¨çš„å˜é‡å¸¸é‡ä¹‹ç±»çš„æ•°æ®éƒ½æ˜¯åœ¨å†…å­˜é‡Œé¢çš„ï¼Œåªè¦APPå…³é—­ï¼Œè¿™äº›æ•°æ®éƒ½ä¼šä¸¢å¤±ã€‚ä½†æ˜¯æŠŠæ•°æ®å­˜å‚¨åˆ°æ–‡ä»¶é‡Œé¢åŽ»ï¼Œå°±èƒ½å°†æ•°æ®ä¿å­˜åˆ°æœ¬åœ°ç£ç›˜é‡Œé¢ï¼ˆç›®å‰iOSåŸºæœ¬å°±æ˜¯åœ¨æ²™ç›’é‡Œé¢æ“ä½œäº†ï¼‰ï¼Œä¸ç®¡æ˜¯APPå…³é—­è¿˜æ˜¯é‡å¯è®¾å¤‡ï¼Œä¸‹æ¬¡å¯åŠ¨APPçš„æ—¶å€™éƒ½èƒ½å¤Ÿè¯»å‡ºæ¥ã€‚ è§£æ¡£ æ‰€è°“è§£æ¡£(åˆ«äººä¹Ÿå«åå½’æ¡£)ï¼Œå°±æ˜¯å°†æ•°æ®ä»Žæ–‡ä»¶é‡Œé¢è¯»å–å‡ºæ¥ã€‚åœ¨ç¨‹åºé‡Œé¢ä½¿ç”¨ã€‚å¦‚æžœå¯¹è±¡æ˜¯NSStringã€NSDictionaryã€NSArrayã€NSDataã€NSNumberç­‰ç±»åž‹ï¼Œå¯ä»¥ç›´æŽ¥ç”¨NSKeyedArchiverè¿›è¡Œå½’æ¡£å’Œæ¢å¤ã€‚ä¸æ˜¯æ‰€æœ‰çš„å¯¹è±¡éƒ½å¯ä»¥ç›´æŽ¥ç”¨è¿™ç§æ–¹æ³•è¿›è¡Œå½’æ¡£ï¼Œåªæœ‰éµå®ˆäº†NSCodingåè®®çš„å¯¹è±¡æ‰å¯ä»¥ åŸºæœ¬ç±»åž‹æ•°æ®å½’æ¡£12345678910111213141516// æ²™ç›’ducumentç›®å½•NSString *docPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];// å®Œæ•´çš„æ–‡ä»¶è·¯å¾„NSString *path = [docPath stringByAppendingPathComponent:@"åç§°"];NSString *str = @"æµ‹è¯•æ–‡å­—";NSArray *array = @[@"1", @"2", @"3"];NSDictionary *dic = @&#123;@"name":@"å¼ ä¸‰", @"sex":@"ç”·", @"age":@"22"&#125;;NSError *error;NSData *data = [NSKeyedArchiver archivedDataWithRootObject:dic requiringSecureCoding:true error:&amp;error];if (![data writeToFile:path atomically:YES]) &#123; NSLog(@"Failed to write file to filePath");&#125; else &#123; NSLog(@"Success to write file to filePath");&#125; è§£æ¡£123NSString *docPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];NSString *path = [docPath stringByAppendingPathComponent:@"åç§°"];id obj = [NSKeyedUnarchiver unarchiveObjectWithFile:path]; Modelæ•°æ®é¦–å…ˆModeléœ€è¦éµå¾ªï¼Œå¹¶é‡æ–°å…¶ä¸¤ä¸ªæ–¹æ³•1234567891011121314151617181920212223@interface Model : NSObject &lt;NSCoding&gt;@property (nonatomic, copy) NSString *name;@property (nonatomic, assign) NSInteger age;@property (nonatomic, assign) BOOL sex;@end- (void)encodeWithCoder:(nonnull NSCoder *)aCoder &#123; [aCoder encodeObject:self.name forKey:@"name"]; [aCoder encodeObject:@(self.age) forKey:@"age"]; [aCoder encodeObject:@(self.sex) forKey:@"sex"];&#125;- (nullable instancetype)initWithCoder:(nonnull NSCoder *)aDecoder &#123; self = [super init]; if (self) &#123; self.name = [aDecoder decodeObjectForKey:@"name"]; self.age = (NSInteger)[aDecoder decodeObjectForKey:@"age"]; self.sex = [aDecoder decodeObjectForKey:@"sex"]; &#125; return self;&#125; å½’æ¡£123456789101112131415161718// èµ‹å€¼Model *model = [[Model alloc] init];model.name = @"å¼ ä¸‰";model.age = 12;model.sex = true;// æ²™ç›’ducumentç›®å½•NSString *docPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];NSString *mdoelPath = [docPath stringByAppendingPathComponent:@"åç§°"];NSError *error;NSData *modelData = [NSKeyedArchiver archivedDataWithRootObject:model requiringSecureCoding:false error:&amp;error];if (![modelData writeToFile:mdoelPath atomically:YES]) &#123; NSLog(@"Failed to write file to filePath");&#125; else &#123; NSLog(@"Success to write file to filePath");&#125; è§£æ¡£123NSString *docPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];NSString *path = [docPath stringByAppendingPathComponent:@"åç§°"];id obj = [NSKeyedUnarchiver unarchiveObjectWithFile:path]; å·¥å…·ç±»123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657/** åŸºæœ¬ç±»åž‹å½’æ¡£ @param obj å½’æ¡£å¯¹è±¡ @param fileName å½’æ¡£æ–‡ä»¶åç§° @param success æˆåŠŸå›žè°ƒ */- (void)lz_archiverObjectToFile:(id)obj archiverFileName:(NSString *)fileName success:(void(^)(void))success &#123; NSString *docPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0]; NSString *path = [docPath stringByAppendingPathComponent:fileName]; NSError *error; NSData *data = [NSKeyedArchiver archivedDataWithRootObject:obj requiringSecureCoding:true error:&amp;error]; if (![data writeToFile:path atomically:YES]) &#123; NSLog(@"Failed to write file to filePath"); &#125; else &#123; NSLog(@"Success to write file to filePath"); success(); &#125;&#125;/** Modelå½’æ¡£ @param obj å½’æ¡£å¯¹è±¡ @param fileName å½’æ¡£æ–‡ä»¶åç§° @param success æˆåŠŸå›žè°ƒ */- (void)lz_archiverModelToFile:(NSObject *)obj archiverFileName:(NSString *)fileName success:(void(^)(void))success &#123; NSString *docPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0]; NSString *path = [docPath stringByAppendingPathComponent:fileName]; NSError *error; NSData *data = [NSKeyedArchiver archivedDataWithRootObject:obj requiringSecureCoding:false error:&amp;error]; if (![data writeToFile:path atomically:YES]) &#123; NSLog(@"Failed to write file to filePath"); &#125; else &#123; NSLog(@"Success to write file to filePath"); success(); &#125;&#125;/** è§£æ¡£ @param fileName è§£æ¡£æ–‡ä»¶åç§° @param success æˆåŠŸå›žè°ƒ */- (void)lz_unArchiverFileWithFileName:(NSString *)fileName success:(void(^)(id obj))success &#123; NSString *docPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0]; NSString *path = [docPath stringByAppendingPathComponent:fileName]; id obj = [NSKeyedUnarchiver unarchiveObjectWithFile:path]; success(obj);&#125;]]></content>
  </entry>
  <entry>
    <title><![CDATA[iOSè‡ªå®šä¹‰æŽ§ä»¶ï¼šç©ºæ•°æ®å ä½å›¾]]></title>
    <url>%2F2018%2F08%2F10%2FiOS%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%A7%E4%BB%B6%EF%BC%9A%E7%A9%BA%E6%95%B0%E6%8D%AE%E5%8D%A0%E4%BD%8D%E5%9B%BE%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘ç”±äºŽä¸šåŠ¡éœ€æ±‚ï¼Œéœ€è¦å°è£…è¿™æ ·çš„ä¸€ä¸ªæç¤ºé¡µé¢ã€‚çœ‹äº†ç½‘ä¸Šæ–¹æ³•æ„Ÿè§‰éƒ½å¤§åŒå°å¼‚ï¼Œå…¶ä¸­DZNEmptyDataSetæ˜¯å¾ˆå¥½çš„ä¸€ä¸ªåº“ï¼Œä½†æ˜¯å¯¹æˆ‘ä¸ªäººè€Œè¨€æœ‰ç‚¹å¤§è´¢å°ç”¨äº†ã€‚æ‰€ä»¥å°±å€Ÿé‰´ä¸€ä¸‹å…¶æ–¹æ³•ï¼Œè‡ªå·±å°è£…ä¸€ä¸ªã€‚æ„Ÿè§‰æœ‰æ›´é«˜çš„è‡ªå®šä¹‰æ€§å§ã€‚ï¼ˆæˆ‘æ˜¯åˆå­¦è€…ï¼Œè¯·å¤§ä½¬çˆ±æŠ¤ï¼Œå‹¿å–·ï¼‰ä¸€ã€å°è£…ä»£ç ï¼šåˆ©ç”¨UIScrollViewçš„åˆ†ç±»å®žçŽ°1234567891011#import &lt;UIKit/UIKit.h&gt;NS_ASSUME_NONNULL_BEGIN@interface UIScrollView (WD_NoData)// éœ€è¦æ˜¾ç¤ºçš„å ä½é¡µé¢@property (nonatomic, strong) UIView *noDataView;@endNS_ASSUME_NONNULL_END å®žçŽ°ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101#import "UIScrollView+WD_NoData.h"#import &lt;objc/runtime.h&gt;static char *noDataViewKey = "noDataViewKey";@implementation UIScrollView (WD_NoData)/** äº¤æ¢æ–¹æ³• @param sel1 åŽŸæ–¹æ³• @param sel2 è‡ªå®šä¹‰æ–¹æ³• @param cls ç±» */void exchangeSelector(SEL sel1, SEL sel2, Class cls) &#123; Class class = [cls class]; Method originalMethod = class_getInstanceMethod(class, sel1); Method swizzledMethod = class_getInstanceMethod(class, sel2); BOOL success = class_addMethod(class, sel1, method_getImplementation(swizzledMethod), method_getTypeEncoding(swizzledMethod)); if (success) &#123; class_replaceMethod(class, sel2, method_getImplementation(originalMethod), method_getTypeEncoding(originalMethod)); &#125; else &#123; method_exchangeImplementations(originalMethod, swizzledMethod); &#125;&#125;#pragma mark =============== Setter ===============- (void)setNoDataView:(UIView *)noDataView &#123; static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, ^&#123; exchangeSelector(@selector(reloadData), @selector(wd_reloadData), [self class]); &#125;); objc_setAssociatedObject(self, noDataViewKey, noDataView, OBJC_ASSOCIATION_RETAIN_NONATOMIC);&#125;#pragma mark =============== Getter ===============- (UIView *)noDataView &#123; UIView *noDataView = objc_getAssociatedObject(self, noDataViewKey); noDataView.frame = self.frame; return noDataView;&#125;- (void)wd_reloadData &#123; [self wd_reloadData]; [self wd_checkData];&#125;#pragma mark =============== èŽ·å–æ•°æ® ===============- (void)wd_checkData &#123; NSInteger items = 0; if (![self respondsToSelector:@selector(dataSource)]) &#123; return; &#125; // UITableView support if ([self isKindOfClass:[UITableView class]]) &#123; UITableView *tableView = (UITableView *)self; id &lt;UITableViewDataSource&gt; dataSource = tableView.dataSource; NSInteger sections = 1; if (dataSource &amp;&amp; [dataSource respondsToSelector:@selector(numberOfSectionsInTableView:)]) &#123; sections = [dataSource numberOfSectionsInTableView:tableView]; &#125; if (dataSource &amp;&amp; [dataSource respondsToSelector:@selector(tableView:numberOfRowsInSection:)]) &#123; for (NSInteger section = 0; section &lt; sections; section++) &#123; items += [dataSource tableView:tableView numberOfRowsInSection:section]; &#125; &#125; &#125; // UICollectionView support else if ([self isKindOfClass:[UICollectionView class]]) &#123; UICollectionView *collectionView = (UICollectionView *)self; id &lt;UICollectionViewDataSource&gt; dataSource = collectionView.dataSource; NSInteger sections = 1; if (dataSource &amp;&amp; [dataSource respondsToSelector:@selector(numberOfSectionsInCollectionView:)]) &#123; sections = [dataSource numberOfSectionsInCollectionView:collectionView]; &#125; if (dataSource &amp;&amp; [dataSource respondsToSelector:@selector(collectionView:numberOfItemsInSection:)]) &#123; for (NSInteger section = 0; section &lt; sections; section++) &#123; items += [dataSource collectionView:collectionView numberOfItemsInSection:section]; &#125; &#125; &#125; if ( items == 0 ) &#123; [self.superview addSubview:self.noDataView]; &#125; else &#123; [self.noDataView removeFromSuperview]; &#125;&#125;@end äºŒã€ä½¿ç”¨æ–¹æ³•123#import "UIScrollView+WD_NoData.h"// è‡ªå®šä¹‰é¡µé¢#import "WDTestEmptyView.h" 1234//ç¤ºä¾‹çš„è§†å›¾ WDTestEmptyView *view = [NSBundle.mainBundle loadNibNamed:@"WDTestEmptyView" owner:self options:nil].firstObject;// è®¾ç½®è§†å›¾self.tableView.noDataView = view; ä¸‰ã€æ•ˆæžœå›¾]]></content>
  </entry>
  <entry>
    <title><![CDATA[æ•°æ®å­˜å‚¨ï¼šNSUserDefaults]]></title>
    <url>%2F2018%2F08%2F10%2F%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%EF%BC%9ANSUserDefault%2F</url>
    <content type="text"><![CDATA[æ™®é€šç±»åž‹æ•°æ®è¯»å–12345678910111213141516171819/** ä¿å­˜åŸºæœ¬ç±»åž‹æ•°æ® @param obj ä¿å­˜å¯¹è±¡ @param key é”®å€¼ */- (void)lz_userDefaultsSetObject:(id)obj keyName:(NSString *)key &#123; [[NSUserDefaults standardUserDefaults] setObject:obj forKey:key];&#125;/** è¯»å–åŸºæœ¬ç±»åž‹æ•°æ® @param key é”®å€¼ @return return value description */- (id)lz_getUserUserDefaultsForKey:(NSString *)key &#123; return [[NSUserDefaults standardUserDefaults] objectForKey:key];&#125; Modelå¯¹è±¡å­˜å‚¨ï¼Œéœ€è¦ä½¿ç”¨è§„å½’æ¡£é…åˆä½¿ç”¨ï¼Œæ‰€æœ‰å¿…é¡»æ˜¯è¦éµå¾ªçš„å¯¹è±¡1234567891011121314151617181920/** Modelæ•°æ®ä¿å­˜ @param obj ä¿å­˜å¯¹è±¡ @param key é”®å€¼ */- (void)lz_userDefaultsSetModel:(NSObject *)obj keyName:(NSString *)key &#123; NSData *data = [NSKeyedArchiver archivedDataWithRootObject:obj requiringSecureCoding:false error:nil]; [[NSUserDefaults standardUserDefaults] setObject:data forKey:key];&#125;/** è¯»å–åŸºæœ¬ç±»åž‹æ•°æ® @param key é”®å€¼ @return return value description */- (id)lz_getUserUserDefaultsForKey:(NSString *)key &#123; return [[NSUserDefaults standardUserDefaults] objectForKey:key];&#125;]]></content>
  </entry>
  <entry>
    <title><![CDATA[iOSå¼€å‘æŠ€å·§-ä¸æ–­æ›´æ–°ä¸­]]></title>
    <url>%2F2018%2F08%2F06%2FiOS%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7%2F</url>
    <content type="text"><![CDATA[1ã€PrefixHeaderå¯¼å…¥ä½ç½®å†™æ³•1$(SRCROOT)/$(PROJECT_NAME)/&lt;#æ–‡ä»¶æ‰€åœ¨æ–‡ä»¶å¤¹åç§°#&gt;/PrefixHeader.pch 2ã€éšè—å¯¼èˆªæ çš„ä¸¤ç§æ–¹å¼1234567891011121314151617181920212223242526//æ–¹å¼ä¸€ ã€ŠæŽ¨èã€‹//åœ¨éœ€è¦éšè—çš„viewControllerä¸­éµå¾ª&lt;UINavigationControllerDelegate&gt;- (void)viewDidLoad &#123; [super viewDidLoad]; // è®¾ç½®å¯¼èˆªæŽ§åˆ¶å™¨çš„ä»£ç†ä¸ºself self.navigationController.delegate = self;&#125;#pragma mark - UINavigationControllerDelegate// å°†è¦æ˜¾ç¤ºæŽ§åˆ¶å™¨- (void)navigationController:(UINavigationController *)navigationController willShowViewController:(UIViewController *)viewController animated:(BOOL)animated &#123; // åˆ¤æ–­è¦æ˜¾ç¤ºçš„æŽ§åˆ¶å™¨æ˜¯å¦æ˜¯è‡ªå·± BOOL isShowHomePage = [viewController isKindOfClass:[self class]]; [self.navigationController setNavigationBarHidden:isShowHomePage animated:YES];&#125;//æ–¹å¼äºŒ- (void)viewWillAppear:(BOOL)animated &#123; [super viewWillAppear:animated]; [self.navigationController setNavigationBarHidden:YES animated:YES];&#125;- (void)viewWillDisappear:(BOOL)animated &#123; [super viewWillDisappear:animated]; [self.navigationController setNavigationBarHidden:NO animated:YES];&#125; 3ã€TabBarItemè¦æ±‚åªæ˜¾ç¤ºå›¾ç‰‡ä¸æ˜¾ç¤ºæ–‡å­—12// self è¡¨ç¤ºéœ€è¦è®¾ç½®æ ·å¼çš„æŽ§åˆ¶å™¨[self.tabBarItem setImageInsets:UIEdgeInsetsMake(6, 0, -6, 0)]; 4ã€TableViewæˆ–CollectionViewå•é€‰1234567891011&lt;!--æ­¥éª¤ä¸€ã€ å£°æ˜Žä¸€ä¸ªå…¨å±€å˜é‡--&gt;@property (nonatomic, assign) NSInteger selectedIndex;&lt;!--æ­¥éª¤äºŒã€TableViewæˆ–CollectionViewç‚¹å‡»äº‹ä»¶çš„æ–¹æ³•ä¸­ä¿å­˜ç‚¹å‡»çš„indexï¼Œå¹¶åˆ·æ–°--&gt;self.selectedIndex = indexPath.row;[collectionView reloadData];æˆ–[tableView reloadData];&lt;!--æ­¥éª¤ä¸‰ã€åœ¨cellForItemAtIndexPathæˆ–cellForRowAtIndexPathæ–¹æ³•ä¸­åˆ¤æ–­æ˜¯å¦æ˜¯æ‰€ä¿å­˜çš„index--&gt;if (self.selectedIndex == indexPath.row) &#123; // è®¾ç½®é€‰ä¸­æ ·å¼&#125; else &#123; // è®¾ç½®æˆé»˜è®¤æ ·å¼ &#125; 5ã€æ€Žä¹ˆåŒºåˆ†çœŸæœºè¿˜æ˜¯æ¨¡æ‹Ÿå™¨1234567#if TARGET_IPHONE_SIMULATOR NSLog(@"run on simulator"); #define SIMULATOR_TEST#else //ä¸å®šä¹‰SIMULATOR_TESTè¿™ä¸ªå® NSLog(@"run on device"); #endif 6ã€if Debug12345#ifdef DEBUG // do sth#else // do sth#endif 7ã€ä¸€é”®æ¸…ç†æ‰€æœ‰æ¨¡æ‹Ÿå™¨å®‰è£…è¿‡çš„APP12// å…ˆå…³é—­æ‰€æœ‰æ¨¡æ‹Ÿå™¨ åœ¨ç»ˆç«¯ä¸­è¾“å…¥ä¸‹é¢å‘½ä»¤å³å¯xcrun simctl erase all 8ã€SDWebImageæ¸…ç†ç¼“å­˜1234- (void)didReceiveMemoryWarning &#123; [super didReceiveMemoryWarning]; [[[SDWebImageManager sharedManager] imageCache] clearMemory];&#125; 9ã€UITableViewçš„HeaderViewä¸‹æ‹‰æ”¾å¤§123456789101112131ã€View1:ä½œä¸ºæ˜¾ç¤ºView2ã€View2:ä½œä¸ºtableViewçš„tableHeaderViewï¼Œå¹¶æ·»åŠ View1ï¼ŒView2çš„å¤§å°å’ŒView1å¤§å°ç›¸åŒ.3ã€åœ¨UIScrollViewDelegateæ–¹æ³•ä¸­è¿›è¡Œè®¾è®¡- (void)scrollViewDidScroll:(UIScrollView *)scrollView &#123; CGFloat width = UIScreen.mainScreen.bounds.size.width; CGFloat viewHeight = kScreenWidth * 0.5; // View1çš„åˆå§‹é«˜åº¦ CGFloat yOffset = scrollView.contentOffset.y; if (yOffset &lt; 0) &#123; CGFloat totalOffset = viewHeight + ABS(yOffset); CGFloat f = totalOffset / viewHeight; self.headerView.frame = CGRectMake(- (width * f - width) / 2, yOffset, width * f, totalOffset); &#125;&#125; 10ã€Masonryåˆ¶ä½œå°±å®«æ ¼123456789101112131415161718192021222324252627282930313233343536373839404142434445//Objective-C ----&gt; Masonry/**å¤šè§†å›¾å¸ƒå±€@param viewArray è§†å›¾æ•°ç»„@param column åˆ—æ•°@param tbSpeace è§†å›¾ä¸Šä¸‹é—´è·@param lrSpeace è§†å›¾å·¦å³é—´è·@param topSpeace å’Œçˆ¶è§†å›¾ä¸Šé—´è·@param lrSuperViewSpeace çˆ¶è§†å›¾å·¦å³é—´è·@param superView çˆ¶è§†å›¾@param viewHeight è§†å›¾é«˜åº¦*/- (void)wd_masLayoutSubViewsWithViewArray:(NSArray&lt;UIView *&gt; *)viewArray columnOfRow:(NSInteger)column topBottomOfItemSpeace:(CGFloat)tbSpeace leftRightItemSpeace:(CGFloat)lrSpeace topOfSuperViewSpeace:(CGFloat)topSpeace leftRightSuperViewSpeace:(CGFloat)lrSuperViewSpeace addToSubperView:(UIView *)superView viewHeight:(CGFloat)viewHeight&#123; CGFloat viewWidth = superView.bounds.size.width; CGFloat itemWidth = (viewWidth - lrSuperViewSpeace * 2 - (column - 1) * lrSpeace) / column * 1.0f; CGFloat itemHeight = viewHeight; UIView *last = nil; for (int i = 0; i &lt; viewArray.count; i++) &#123; UIView *item = viewArray[i]; [superView addSubview:item]; [item mas_makeConstraints:^(MASConstraintMaker *make) &#123; make.width.mas_equalTo(itemWidth); make.height.mas_equalTo(itemHeight); CGFloat top = topSpeace + (i / column) * (itemHeight + tbSpeace); make.top.mas_offset(top); if (!last || (i % column) == 0) &#123; make.left.mas_offset(lrSuperViewSpeace); &#125;else&#123; make.left.mas_equalTo(last.mas_right).mas_offset(lrSpeace); &#125; &#125;]; last = item; &#125;&#125; 11ã€Snapkitåˆ¶ä½œä¹å®«æ ¼12345678910111213141516171819202122232425262728293031323334353637383940414243444546//Swift ----&gt; SnapKit/// å¤šè§†å›¾å¸ƒå±€////// - Parameters:/// - viewArray: è§†å›¾æ•°ç»„/// - columnOfRow: åˆ—æ•°/// - topBottomOfItemSpeace: è§†å›¾ä¸Šä¸‹é—´è·/// - leftRightItemSpeace: è§†å›¾å·¦å³é—´è·/// - topOfSuperViewSpeace: å’Œçˆ¶è§†å›¾ä¸Šé—´è·/// - leftRightSuperViewSpeace: çˆ¶è§†å›¾å·¦å³é—´è·/// - addToSubperView: çˆ¶è§†å›¾/// - viewHeight: è§†å›¾é«˜åº¦func wd_masLayoutSubViews(viewArray:Array&lt;UIView&gt;, columnOfRow:Int, topBottomOfItemSpeace:CGFloat, leftRightItemSpeace:CGFloat, topOfSuperViewSpeace:CGFloat, leftRightSuperViewSpeace:CGFloat, addToSubperView:UIView, viewHeight:CGFloat) -&gt; Void &#123; let viewWidth = addToSubperView.bounds.width let tempW = leftRightSuperViewSpeace * 2 + CGFloat(columnOfRow - 1) * leftRightItemSpeace let itemWidth = (viewWidth - tempW) / CGFloat(columnOfRow) let itemHeight = viewHeight var lastView:UIView? for (index) in viewArray.enumerated() &#123; let item = viewArray[i] addToSubperView.addSubview(item) item.snp.makeConstraints &#123; (make) in make.width.equalTo(itemWidth) make.height.equalTo(itemHeight) let top = topOfSuperViewSpeace + CGFloat(i / columnOfRow) * (itemHeight + topBottomOfItemSpeace) make.top.equalTo(top) if !(lastView != nil) || i%columnOfRow == 0 &#123; make.left.equalTo(leftRightSuperViewSpeace) &#125; else &#123; make.left.equalTo((lastView?.snp.right)!).offset(leftRightItemSpeace) &#125; lastView = item &#125; &#125;&#125; 13ã€é€šè¿‡èº«ä»½è¯è®¡ç®—å¹´é¾„1234567891011121314151617181920212223242526272829303132333435363738/** é€šè¿‡èº«ä»½è¯è®¡ç®—å¹´é¾„ */- (NSString *)calculationAgeWithBirthday: (NSString *)birthday &#123; NSCalendar *calendar = [NSCalendar currentCalendar]; NSDate *nowDate = [NSDate date]; NSString *birth = birthday; NSDateFormatter *dateFormatter = [[NSDateFormatter alloc]init]; [dateFormatter setDateFormat:@"yyyy-MM-dd"]; NSDate *birthDay = [dateFormatter dateFromString:birth]; unsigned int unitFlags = NSCalendarUnitYear | NSCalendarUnitMonth | NSCalendarUnitDay; NSDateComponents *date = [calendar components:unitFlags fromDate:birthDay toDate:nowDate options:0]; if ([date year] &gt; 0) &#123; return [NSString stringWithFormat:@"%ldå²", (long)[date year]]; &#125; else if([date month] &gt; 0) &#123; return [NSString stringWithFormat:@"%ldæœˆ", (long)[date month]]; &#125; else if([date day] &gt; 0)&#123; return [NSString stringWithFormat:@"%ldå¤©", (long)[date day]]; &#125; else &#123; return @"0å¤©"; &#125;&#125;- (NSString *)ageStrFromIdentityCard:(NSString *)numberStr &#123; NSString *dateSt; NSMutableString *dateS; if (numberStr.length &gt; 15) &#123; dateSt = [numberStr substringWithRange:NSMakeRange(6, 8)]; dateS = [NSMutableString stringWithFormat:@"%@", dateSt]; [dateS insertString:@"-" atIndex:4]; [dateS insertString:@"-" atIndex:7]; &#125; else &#123; // åªè€ƒè™‘ 19å¼€å¤´çš„15ä½çš„èº«ä»½è¯å· dateSt = [NSString stringWithFormat:@"19%@",[numberStr substringWithRange:NSMakeRange(6, 6)]]; dateS = [NSMutableString stringWithFormat:@"%@", dateSt]; [dateS insertString:@"-" atIndex:4]; [dateS insertString:@"-" atIndex:7]; &#125; return [self calculationAgeWithBirthday:dateS];&#125; 14ã€åˆ©ç”¨runtimeè‡ªåŠ¨å½’æ¡£123456789101112131415161718192021222324252627// å¯¼å…¥å¤´æ–‡ä»¶#import &lt;objc/runtime.h&gt;// éµå¾ªåè®®&lt;NSCoding&gt;// å®žçŽ°æ–¹æ³•- (id)initWithCoder:(NSCoder *)aDecoder &#123; if (self = [super init]) &#123; unsigned int outCount; Ivar * ivars = class_copyIvarList([self class], &amp;outCount); for (int i = 0; i &lt; outCount; i ++) &#123; Ivar ivar = ivars[i]; NSString * key = [NSString stringWithUTF8String:ivar_getName(ivar)]; [self setValue:[aDecoder decodeObjectForKey:key] forKey:key]; &#125; &#125; return self;&#125;- (void)encodeWithCoder:(NSCoder *)aCoder &#123; unsigned int outCount; Ivar * ivars = class_copyIvarList([self class], &amp;outCount); for (int i = 0; i &lt; outCount; i ++) &#123; Ivar ivar = ivars[i]; NSString * key = [NSString stringWithUTF8String:ivar_getName(ivar)]; [aCoder encodeObject:[self valueForKey:key] forKey:key]; &#125;&#125;]]></content>
  </entry>
  <entry>
    <title><![CDATA[æ•°æ®å­˜å‚¨ï¼šplist]]></title>
    <url>%2F2018%2F08%2F05%2F%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%EF%BC%9Aplist%2F</url>
    <content type="text"><![CDATA[æ²™ç›’å­˜å‚¨ä¸­å››ä¸ªæ–‡ä»¶å¤¹ Document:Documentsä¸­ä¸€èˆ¬ä¿å­˜åº”ç”¨ç¨‹åºæœ¬èº«äº§ç”Ÿæ–‡ä»¶æ•°æ®ï¼Œä¾‹å¦‚æ¸¸æˆè¿›åº¦ï¼Œç»˜å›¾è½¯ä»¶çš„ç»˜å›¾ç­‰ï¼Œ iTuneså¤‡ä»½å’Œæ¢å¤çš„æ—¶å€™ï¼Œä¼šåŒ…æ‹¬æ­¤ç›®å½•ï¼Œ æ³¨æ„ï¼šåœ¨æ­¤ç›®å½•ä¸‹ä¸è¦ä¿å­˜ä»Žç½‘ç»œä¸Šä¸‹è½½çš„æ–‡ä»¶ï¼Œå¦åˆ™appæ— æ³•ä¸Šæž¶ï¼ Library:ç›®å½•ä¸‹æœ‰ä¸¤ä¸ªå­ç›®å½•ï¼šCaches å’Œ Preferences Caches:æ­¤ç›®å½•ç”¨æ¥ä¿å­˜åº”ç”¨ç¨‹åºè¿è¡Œæ—¶ç”Ÿæˆçš„éœ€è¦æŒä¹…åŒ–çš„æ•°æ®ï¼Œè¿™äº›æ•°æ®ä¸€èˆ¬å­˜å‚¨ä½“ç§¯æ¯”è¾ƒå¤§ï¼Œåˆä¸æ˜¯ååˆ†é‡è¦ï¼Œæ¯”å¦‚ç½‘ç»œè¯·æ±‚æ•°æ®ç­‰ã€‚è¿™äº›æ•°æ®éœ€è¦ç”¨æˆ·è´Ÿè´£åˆ é™¤ã€‚iTunesåŒæ­¥è®¾å¤‡æ—¶ä¸ä¼šå¤‡ä»½è¯¥ç›®å½• Preferencesï¼šæ­¤ç›®å½•ä¿å­˜åº”ç”¨ç¨‹åºçš„æ‰€æœ‰åå¥½è®¾ç½®ï¼ŒiOSçš„Settings(è®¾ç½®)åº”ç”¨ä¼šåœ¨è¯¥ç›®å½•ä¸­æŸ¥æ‰¾åº”ç”¨çš„è®¾ç½®ä¿¡æ¯ã€‚iTunesåŒæ­¥è®¾å¤‡æ—¶ä¼šå¤‡ä»½è¯¥ç›®å½•åœ¨Preferences/ä¸‹ä¸èƒ½ç›´æŽ¥åˆ›å»ºåå¥½è®¾ç½®æ–‡ä»¶ï¼Œè€Œæ˜¯åº”è¯¥ä½¿ç”¨NSUserDefaultsç±»æ¥å–å¾—å’Œè®¾ç½®åº”ç”¨ç¨‹åºçš„åå¥½ SystemData:å­˜æ”¾ç³»ç»Ÿæ•°æ®ã€‚ tmp:æ­¤ç›®å½•ä¿å­˜åº”ç”¨ç¨‹åºè¿è¡Œæ—¶æ‰€éœ€çš„ä¸´æ—¶æ•°æ®ï¼Œä½¿ç”¨å®Œæ¯•åŽå†å°†ç›¸åº”çš„æ–‡ä»¶ä»Žè¯¥ç›®å½•åˆ é™¤ã€‚åº”ç”¨æ²¡æœ‰è¿è¡Œæ—¶ï¼Œç³»ç»Ÿä¹Ÿå¯èƒ½ä¼šæ¸…é™¤è¯¥ç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚iTunesåŒæ­¥è®¾å¤‡æ—¶ä¸ä¼šå¤‡ä»½è¯¥ç›®å½• æ·»åŠ /ä¿®æ”¹æ•°æ®:æ ¹æ®Keyå€¼ 12[dd setObject:@"æˆ‘æ·»åŠ çš„æ–°å†…å®¹" forKey:@"content"];[dataDic writeToFile:filePatch atomically:YES]; ç§»é™¤æ•°æ®:æ ¹æ®Keyå€¼ 1[dataDic removeObjectForKey:@"age"]; è¯»å–æ•°æ® è¯»å–é¡¹ç›®ä¸­Plistæ–‡ä»¶ 12345// èŽ·å–æ–‡ä»¶è·¯å¾„NSString *path = [[NSBundle mainBundle] pathForResource:@"DataInfo" ofType:@"plist"];// ç±»åž‹è‡ªå·±é€‰å–NSDictionary *dic = [NSDictionary dictionaryWithContentsOfFile:path];NSArray *array = [NSArray arrayWithContentsOfFile:path]; è¯»å–,æˆ–ç”Ÿæˆæ²™ç›’ä¸­Plistæ–‡ä»¶ 1234567// èŽ·å–è·¯å¾„å¯¹è±¡NSArray *pathArray = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);NSString *patPath = [pathArray objectAtIndex:0];// æ ¹æ® ç”Ÿæˆçš„Plistçš„åç§°èŽ·å–æœ€åŽè·¯å¾„NSString *filePatch = [patPath stringByAppendingPathComponent:@"test.plist"];NSDictionary *fileDic = [NSDictionary dictionaryWithContentsOfFile:filePatch];NSArray *fileArray = [NSArray arrayWithContentsOfFile:filePatch]; æ·»åŠ æ•°æ®1234567891011121314// èŽ·å–è·¯å¾„å¯¹è±¡NSArray *pathArray = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);NSString *path = [pathArray objectAtIndex:0];// èŽ·å–æ–‡ä»¶çš„å®Œæ•´è·¯å¾„NSString *filePatch = [path stringByAppendingPathComponent:@"test.plist"]; // å†™å…¥æ•°æ®åˆ°plistæ–‡ä»¶NSMutableDictionary *dic1 = [NSMutableDictionary dictionaryWithObjectsAndKeys:@"å°å°è™Ž",@"name", @"5",@"age", @"boy",@"sex", nil];NSMutableDictionary *dic2 = [NSMutableDictionary dictionaryWithObjectsAndKeys:@"å°å°å…®",@"name", @"6",@"age", @"girl",@"sex", nil];// å°†ä¸Šé¢2ä¸ªå°å­—å…¸ä¿å­˜åˆ°å¤§å­—å…¸é‡Œé¢NSMutableDictionary *dataDic = [NSMutableDictionary dictionary];[dataDic setObject:dic1 forKey:@"ä¸€å¹´çº§"];[dataDic setObject:dic2 forKey:@"äºŒå¹´çº§"]; // å†™å…¥plisté‡Œé¢[dataDic writeToFile:filePatch atomically:YES]; //è¯»å–plistæ–‡ä»¶çš„å†…å®¹ ä¿®æ”¹æ•°æ®12345678910111213141516// èŽ·å–plistæ–‡ä»¶çš„è·¯å¾„NSArray *pathArray = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);NSString *path1 = [pathArray objectAtIndex:0];NSString *myPath = [path1 stringByAppendingPathComponent:@"test.plist"]; NSMutableDictionary *dataDictionary = [[NSMutableDictionary alloc] initWithContentsOfFile:myPath]; // ä¿®æ”¹å­—å…¸é‡Œé¢çš„å†…å®¹,å…ˆæŒ‰ç…§ç»“æž„å–åˆ°ä½ æƒ³ä¿®æ”¹å†…å®¹çš„å°å­—å…¸NSMutableDictionary *dd = [dataDictionary objectForKey:@"ä¸€å¹´çº§"];[dd setObject:@"æˆ‘æ”¹åå­—äº†å“¦" forKey:@"name"];[dd setObject:@"æˆ‘æ·»åŠ çš„æ–°å†…å®¹" forKey:@"content"];[dd removeObjectForKey:@"age"]; //ä¿®æ”¹æˆåŠŸä»¥åŽï¼Œå°†è¿™ä¸ªå°å­—å…¸é‡æ–°æ·»åŠ åˆ°å¤§å­—å…¸é‡Œé¢[dataDictionary setObject:dd forKey:@"ä¸€å¹´çº§"];[dataDictionary writeToFile:myPath atomically:YES]; åˆ é™¤Plistæ–‡ä»¶12345678NSFileManager *fileMger = [NSFileManager defaultManager];NSString *xiaoXiPath = [[NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES)objectAtIndex:0] stringByAppendingPathComponent:@"test.plist"];// å¦‚æžœæ–‡ä»¶è·¯å¾„å­˜åœ¨çš„è¯BOOL bRet = [fileMger fileExistsAtPath:xiaoXiPath];if (bRet) &#123; NSError *err; [fileMger removeItemAtPath:xiaoXiPath error:&amp;err];&#125;]]></content>
  </entry>
</search>
